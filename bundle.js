/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";var t={};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}();const e=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=63&r|128):55296==(64512&r)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&t.charCodeAt(++i)),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=63&r|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=63&r|128)}return e},n={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let e=0;e<t.length;e+=3){const r=t[e],s=e+1<t.length,o=s?t[e+1]:0,a=e+2<t.length,u=a?t[e+2]:0,c=r>>2,h=(3&r)<<4|o>>4;let l=(15&o)<<2|u>>6,d=63&u;a||(d=64,s||(l=64)),i.push(n[c],n[h],n[l],n[d])}return i.join("")},encodeString(t,n){return this.HAS_NATIVE_SUPPORT&&!n?btoa(t):this.encodeByteArray(e(t),n)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,i=0;for(;n<t.length;){const r=t[n++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=t[n++];e[i++]=String.fromCharCode((31&r)<<6|63&s)}else if(r>239&&r<365){const s=((7&r)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[i++]=String.fromCharCode(55296+(s>>10)),e[i++]=String.fromCharCode(56320+(1023&s))}else{const s=t[n++],o=t[n++];e[i++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let e=0;e<t.length;){const r=n[t.charAt(e++)],s=e<t.length?n[t.charAt(e)]:0;++e;const o=e<t.length?n[t.charAt(e)]:64;++e;const a=e<t.length?n[t.charAt(e)]:64;if(++e,null==r||null==s||null==o||null==a)throw Error();const u=r<<2|s>>4;if(i.push(u),64!==o){const t=s<<4&240|o>>2;if(i.push(t),64!==a){const t=o<<6&192|a;i.push(t)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},i=function(t){return function(t){const i=e(t);return n.encodeByteArray(i,!0)}(t).replace(/\./g,"")},r=function(t){try{return n.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function s(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function o(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function a(){return"object"==typeof indexedDB}function u(){return new Promise(((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var t;e((null===(t=r.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}}))}const c=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==t.g)return t.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const t=process.env.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if("undefined"==typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(t){return}const e=t&&r(t[1]);return e&&JSON.parse(e)})()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}},h=t=>{var e,n;return null===(n=null===(e=c())||void 0===e?void 0:e.emulatorHosts)||void 0===n?void 0:n[t]},l=t=>{var e;return null===(e=c())||void 0===e?void 0:e[`_${t}`]};class d{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}class f extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,f.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,p.prototype.create)}}class p{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},i=`${this.service}/${t}`,r=this.errors[t],s=r?function(t,e){return t.replace(m,((t,n)=>{const i=e[n];return null!=i?String(i):`<${n}?>`}))}(r,n):"Error",o=`${this.serviceName}: ${s} (${i}).`;return new f(i,o,n)}}const m=/\{\$([^}]+)}/g;function g(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const r of n){if(!i.includes(r))return!1;const n=t[r],s=e[r];if(y(n)&&y(s)){if(!g(n,s))return!1}else if(n!==s)return!1}for(const t of i)if(!n.includes(t))return!1;return!0}function y(t){return null!==t&&"object"==typeof t}function v(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach((t=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(t))})):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function _(t){const e={};return t.replace(/^\?/,"").split("&").forEach((t=>{if(t){const[n,i]=t.split("=");e[decodeURIComponent(n)]=decodeURIComponent(i)}})),e}function w(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}class b{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((()=>{t(this)})).catch((t=>{this.error(t)}))}next(t){this.forEachObserver((e=>{e.next(t)}))}error(t){this.forEachObserver((e=>{e.error(t)})),this.close(t)}complete(){this.forEachObserver((t=>{t.complete()})),this.close()}subscribe(t,e,n){let i;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");i=function(t,e){if("object"!=typeof t||null===t)return!1;for(const e of["next","error","complete"])if(e in t&&"function"==typeof t[e])return!0;return!1}(t)?t:{next:t,error:e,complete:n},void 0===i.next&&(i.next=T),void 0===i.error&&(i.error=T),void 0===i.complete&&(i.complete=T);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(t){}})),this.observers.push(i),r}unsubscribeOne(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function T(){}function I(t,e=1e3,n=2){const i=e*Math.pow(n,t),r=Math.round(.5*i*(Math.random()-.5)*2);return Math.min(144e5,i+r)}function E(t){return t&&t._delegate?t._delegate:t}class S{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const k="[DEFAULT]";class C{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new d;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(t){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(i)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:k})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(t){}}}}clearInstance(t="[DEFAULT]"){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t="[DEFAULT]"){return this.instances.has(t)}getOptions(t="[DEFAULT]"){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[t,e]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(t)&&e.resolve(i);return i}onInit(t,e){var n;const i=this.normalizeInstanceIdentifier(e),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(t),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&t(s,i),()=>{r.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const i of n)try{i(t,e)}catch(t){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===k?void 0:i),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(t){}var i;return n||null}normalizeInstanceIdentifier(t="[DEFAULT]"){return this.component?this.component.multipleInstances?t:k:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class A{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new C(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const D=[];var N,R;(R=N||(N={}))[R.DEBUG=0]="DEBUG",R[R.VERBOSE=1]="VERBOSE",R[R.INFO=2]="INFO",R[R.WARN=3]="WARN",R[R.ERROR=4]="ERROR",R[R.SILENT=5]="SILENT";const O={debug:N.DEBUG,verbose:N.VERBOSE,info:N.INFO,warn:N.WARN,error:N.ERROR,silent:N.SILENT},x=N.INFO,M={[N.DEBUG]:"log",[N.VERBOSE]:"log",[N.INFO]:"info",[N.WARN]:"warn",[N.ERROR]:"error"},L=(t,e,...n)=>{if(e<t.logLevel)return;const i=(new Date).toISOString(),r=M[e];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[r](`[${i}]  ${t.name}:`,...n)};class P{constructor(t){this.name=t,this._logLevel=x,this._logHandler=L,this._userLogHandler=null,D.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in N))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?O[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,N.DEBUG,...t),this._logHandler(this,N.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,N.VERBOSE,...t),this._logHandler(this,N.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,N.INFO,...t),this._logHandler(this,N.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,N.WARN,...t),this._logHandler(this,N.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,N.ERROR,...t),this._logHandler(this,N.ERROR,...t)}}let U,F;const V=new WeakMap,B=new WeakMap,j=new WeakMap,q=new WeakMap,z=new WeakMap;let $={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return B.get(t);if("objectStoreNames"===e)return t.objectStoreNames||j.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return K(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function H(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(F||(F=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(G(this),t),K(V.get(this))}:function(...t){return K(e.apply(G(this),t))}:function(t,...n){const i=e.call(G(this),t,...n);return j.set(i,t.sort?t.sort():[t]),K(i)}:(t instanceof IDBTransaction&&function(t){if(B.has(t))return;const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("complete",r),t.removeEventListener("error",s),t.removeEventListener("abort",s)},r=()=>{e(),i()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",r),t.addEventListener("error",s),t.addEventListener("abort",s)}));B.set(t,e)}(t),n=t,(U||(U=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((t=>n instanceof t))?new Proxy(t,$):t);var e,n}function K(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("success",r),t.removeEventListener("error",s)},r=()=>{e(K(t.result)),i()},s=()=>{n(t.error),i()};t.addEventListener("success",r),t.addEventListener("error",s)}));return e.then((e=>{e instanceof IDBCursor&&V.set(e,t)})).catch((()=>{})),z.set(e,t),e}(t);if(q.has(t))return q.get(t);const e=H(t);return e!==t&&(q.set(t,e),z.set(e,t)),e}const G=t=>z.get(t);function W(t,e,{blocked:n,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(t,e),a=K(o);return i&&o.addEventListener("upgradeneeded",(t=>{i(K(o.result),t.oldVersion,t.newVersion,K(o.transaction))})),n&&o.addEventListener("blocked",(()=>n())),a.then((t=>{s&&t.addEventListener("close",(()=>s())),r&&t.addEventListener("versionchange",(()=>r()))})).catch((()=>{})),a}const Q=["get","getKey","getAll","getAllKeys","count"],X=["put","add","delete","clear"],Y=new Map;function J(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(Y.get(e))return Y.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,r=X.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!Q.includes(n))return;const s=async function(t,...e){const s=this.transaction(t,r?"readwrite":"readonly");let o=s.store;return i&&(o=o.index(e.shift())),(await Promise.all([o[n](...e),r&&s.done]))[0]};return Y.set(e,s),s}var Z;Z=$,$={...Z,get:(t,e,n)=>J(t,e)||Z.get(t,e,n),has:(t,e)=>!!J(t,e)||Z.has(t,e)};class tt{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const et="@firebase/app",nt="0.8.4",it=new P("@firebase/app"),rt="[DEFAULT]",st={[et]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},ot=new Map,at=new Map;function ut(t,e){try{t.container.addComponent(e)}catch(n){it.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function ct(t){const e=t.name;if(at.has(e))return it.debug(`There were multiple attempts to register component ${e}.`),!1;at.set(e,t);for(const e of ot.values())ut(e,t);return!0}function ht(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}const lt=new p("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class dt{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new S("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw lt.create("app-deleted",{appName:this._name})}}const ft="9.14.0";function pt(t,e={}){let n=t;"object"!=typeof e&&(e={name:e});const i=Object.assign({name:rt,automaticDataCollectionEnabled:!1},e),r=i.name;if("string"!=typeof r||!r)throw lt.create("bad-app-name",{appName:String(r)});if(n||(n=(()=>{var t;return null===(t=c())||void 0===t?void 0:t.config})()),!n)throw lt.create("no-options");const s=ot.get(r);if(s){if(g(n,s.options)&&g(i,s.config))return s;throw lt.create("duplicate-app",{appName:r})}const o=new A(r);for(const t of at.values())o.addComponent(t);const a=new dt(n,i,o);return ot.set(r,a),a}function mt(t="[DEFAULT]"){const e=ot.get(t);if(!e&&t===rt)return pt();if(!e)throw lt.create("no-app",{appName:t});return e}function gt(t,e,n){var i;let r=null!==(i=st[t])&&void 0!==i?i:t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const t=[`Unable to register library "${r}" with version "${e}":`];return s&&t.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&t.push("and"),o&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void it.warn(t.join(" "))}ct(new S(`${r}-version`,(()=>({library:r,version:e})),"VERSION"))}const yt="firebase-heartbeat-store";let vt=null;function _t(){return vt||(vt=W("firebase-heartbeat-database",1,{upgrade:(t,e)=>{0===e&&t.createObjectStore(yt)}}).catch((t=>{throw lt.create("idb-open",{originalErrorMessage:t.message})}))),vt}async function wt(t,e){var n;try{const n=(await _t()).transaction(yt,"readwrite"),i=n.objectStore(yt);return await i.put(e,bt(t)),n.done}catch(t){if(t instanceof f)it.warn(t.message);else{const e=lt.create("idb-set",{originalErrorMessage:null===(n=t)||void 0===n?void 0:n.message});it.warn(e.message)}}}function bt(t){return`${t.name}!${t.options.appId}`}class Tt{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new Et(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),e=It();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==e&&!this._heartbeatsCache.heartbeats.some((t=>t.date===e)))return this._heartbeatsCache.heartbeats.push({date:e,agent:t}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const t=It(),{heartbeatsToSend:e,unsentEntries:n}=function(t,e=1024){const n=[];let i=t.slice();for(const r of t){const t=n.find((t=>t.agent===r.agent));if(t){if(t.dates.push(r.date),St(n)>e){t.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),St(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),r=i(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function It(){return(new Date).toISOString().substring(0,10)}class Et{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!a()&&u().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const t=await async function(t){var e;try{return(await _t()).transaction(yt).objectStore(yt).get(bt(t))}catch(t){if(t instanceof f)it.warn(t.message);else{const n=lt.create("idb-get",{originalErrorMessage:null===(e=t)||void 0===e?void 0:e.message});it.warn(n.message)}}}(this.app);return t||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return wt(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return wt(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function St(t){return i(JSON.stringify({version:2,heartbeats:t})).length}ct(new S("platform-logger",(t=>new tt(t)),"PRIVATE")),ct(new S("heartbeat",(t=>new Tt(t)),"PRIVATE")),gt(et,nt,""),gt(et,nt,"esm2017"),gt("fire-js",""),gt("firebase","9.14.0","app");const kt="@firebase/installations",Ct="0.5.16",At="w:0.5.16",Dt=new p("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function Nt(t){return t instanceof f&&t.code.includes("request-failed")}function Rt({projectId:t}){return`https://firebaseinstallations.googleapis.com/v1/projects/${t}/installations`}function Ot(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}async function xt(t,e){const n=(await e.json()).error;return Dt.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function Mt({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}async function Lt(t){const e=await t();return e.status>=500&&e.status<600?t():e}function Pt(t){return new Promise((e=>{setTimeout(e,t)}))}const Ut=/^[cdef][\w-]{21}$/;function Ft(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const e=function(t){return(e=t,btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var e}(t);return Ut.test(e)?e:""}catch(t){return""}}function Vt(t){return`${t.appName}!${t.appId}`}const Bt=new Map;function jt(t,e){const n=Vt(t);qt(n,e),function(t,e){const n=(!zt&&"BroadcastChannel"in self&&(zt=new BroadcastChannel("[Firebase] FID Change"),zt.onmessage=t=>{qt(t.data.key,t.data.fid)}),zt);n&&n.postMessage({key:t,fid:e}),0===Bt.size&&zt&&(zt.close(),zt=null)}(n,e)}function qt(t,e){const n=Bt.get(t);if(n)for(const t of n)t(e)}let zt=null;const $t="firebase-installations-store";let Ht=null;function Kt(){return Ht||(Ht=W("firebase-installations-database",1,{upgrade:(t,e)=>{0===e&&t.createObjectStore($t)}})),Ht}async function Gt(t,e){const n=Vt(t),i=(await Kt()).transaction($t,"readwrite"),r=i.objectStore($t),s=await r.get(n);return await r.put(e,n),await i.done,s&&s.fid===e.fid||jt(t,e.fid),e}async function Wt(t){const e=Vt(t),n=(await Kt()).transaction($t,"readwrite");await n.objectStore($t).delete(e),await n.done}async function Qt(t,e){const n=Vt(t),i=(await Kt()).transaction($t,"readwrite"),r=i.objectStore($t),s=await r.get(n),o=e(s);return void 0===o?await r.delete(n):await r.put(o,n),await i.done,!o||s&&s.fid===o.fid||jt(t,o.fid),o}async function Xt(t){let e;const n=await Qt(t.appConfig,(n=>{const i=function(t){return Zt(t||{fid:Ft(),registrationStatus:0})}(n),r=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(Dt.create("app-offline"))};const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=async function(t,e){try{const n=await async function({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const i=Rt(t),r=Mt(t),s=e.getImmediate({optional:!0});if(s){const t=await s.getHeartbeatsHeader();t&&r.append("x-firebase-client",t)}const o={fid:n,authVersion:"FIS_v2",appId:t.appId,sdkVersion:At},a={method:"POST",headers:r,body:JSON.stringify(o)},u=await Lt((()=>fetch(i,a)));if(u.ok){const t=await u.json();return{fid:t.fid||n,registrationStatus:2,refreshToken:t.refreshToken,authToken:Ot(t.authToken)}}throw await xt("Create Installation",u)}(t,e);return Gt(t.appConfig,n)}catch(n){throw Nt(n)&&409===n.customData.serverCode?await Wt(t.appConfig):await Gt(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}(t,n);return{installationEntry:n,registrationPromise:i}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:Yt(t)}:{installationEntry:e}}(t,i);return e=r.registrationPromise,r.installationEntry}));return""===n.fid?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}async function Yt(t){let e=await Jt(t.appConfig);for(;1===e.registrationStatus;)await Pt(100),e=await Jt(t.appConfig);if(0===e.registrationStatus){const{installationEntry:e,registrationPromise:n}=await Xt(t);return n||e}return e}function Jt(t){return Qt(t,(t=>{if(!t)throw Dt.create("installation-not-found");return Zt(t)}))}function Zt(t){return 1===(e=t).registrationStatus&&e.registrationTime+1e4<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}async function te({appConfig:t,heartbeatServiceProvider:e},n){const i=function(t,{fid:e}){return`${Rt(t)}/${e}/authTokens:generate`}(t,n),r=function(t,{refreshToken:e}){const n=Mt(t);return n.append("Authorization",function(t){return`FIS_v2 ${t}`}(e)),n}(t,n),s=e.getImmediate({optional:!0});if(s){const t=await s.getHeartbeatsHeader();t&&r.append("x-firebase-client",t)}const o={installation:{sdkVersion:At,appId:t.appId}},a={method:"POST",headers:r,body:JSON.stringify(o)},u=await Lt((()=>fetch(i,a)));if(u.ok)return Ot(await u.json());throw await xt("Generate Auth Token",u)}async function ee(t,e=!1){let n;const i=await Qt(t.appConfig,(i=>{if(!ie(i))throw Dt.create("not-registered");const r=i.authToken;if(!e&&(2===(s=r).requestStatus&&!function(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+36e5}(s)))return i;var s;if(1===r.requestStatus)return n=async function(t,e){let n=await ne(t.appConfig);for(;1===n.authToken.requestStatus;)await Pt(100),n=await ne(t.appConfig);const i=n.authToken;return 0===i.requestStatus?ee(t,e):i}(t,e),i;{if(!navigator.onLine)throw Dt.create("app-offline");const e=function(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}(i);return n=async function(t,e){try{const n=await te(t,e),i=Object.assign(Object.assign({},e),{authToken:n});return await Gt(t.appConfig,i),n}catch(n){if(!Nt(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Gt(t.appConfig,n)}else await Wt(t.appConfig);throw n}}(t,e),e}}));return n?await n:i.authToken}function ne(t){return Qt(t,(t=>{if(!ie(t))throw Dt.create("not-registered");return 1===(e=t.authToken).requestStatus&&e.requestTime+1e4<Date.now()?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t;var e}))}function ie(t){return void 0!==t&&2===t.registrationStatus}function re(t){return Dt.create("missing-app-config-values",{valueName:t})}const se="installations";ct(new S(se,(t=>{const e=t.getProvider("app").getImmediate(),n=function(t){if(!t||!t.options)throw re("App Configuration");if(!t.name)throw re("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw re(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e);return{app:e,appConfig:n,heartbeatServiceProvider:ht(e,"heartbeat"),_delete:()=>Promise.resolve()}}),"PUBLIC")),ct(new S("installations-internal",(t=>{const e=ht(t.getProvider("app").getImmediate(),se).getImmediate();return{getId:()=>async function(t){const e=t,{installationEntry:n,registrationPromise:i}=await Xt(e);return i?i.catch(console.error):ee(e).catch(console.error),n.fid}(e),getToken:t=>async function(t,e=!1){const n=t;return await async function(t){const{registrationPromise:e}=await Xt(t);e&&await e}(n),(await ee(n,e)).token}(e,t)}}),"PRIVATE")),gt(kt,Ct),gt(kt,Ct,"esm2017");const oe="analytics",ae="https://www.googletagmanager.com/gtag/js",ue=new P("@firebase/analytics");function ce(t){return Promise.all(t.map((t=>t.catch((t=>t)))))}const he=new p("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),le=new class{constructor(t={},e=1e3){this.throttleMetadata=t,this.intervalMillis=e}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,e){this.throttleMetadata[t]=e}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}};function de(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function fe(t,e=le,n){const{appId:i,apiKey:r,measurementId:s}=t.options;if(!i)throw he.create("no-app-id");if(!r){if(s)return{measurementId:s,appId:i};throw he.create("no-api-key")}const o=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new me;return setTimeout((async()=>{a.abort()}),void 0!==n?n:6e4),pe({appId:i,apiKey:r,measurementId:s},o,a,e)}async function pe(t,{throttleEndTimeMillis:e,backoffCount:n},i,r=le){var s,o;const{appId:a,measurementId:u}=t;try{await function(t,e){return new Promise(((n,i)=>{const r=Math.max(e-Date.now(),0),s=setTimeout(n,r);t.addEventListener((()=>{clearTimeout(s),i(he.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}(i,e)}catch(t){if(u)return ue.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${u} provided in the "measurementId" field in the local Firebase config. [${null===(s=t)||void 0===s?void 0:s.message}]`),{appId:a,measurementId:u};throw t}try{const e=await async function(t){var e;const{appId:n,apiKey:i}=t,r={method:"GET",headers:de(i)},s="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),o=await fetch(s,r);if(200!==o.status&&304!==o.status){let t="";try{const n=await o.json();(null===(e=n.error)||void 0===e?void 0:e.message)&&(t=n.error.message)}catch(t){}throw he.create("config-fetch-failed",{httpStatus:o.status,responseMessage:t})}return o.json()}(t);return r.deleteThrottleMetadata(a),e}catch(e){const s=e;if(!function(t){if(!(t instanceof f&&t.customData))return!1;const e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(s)){if(r.deleteThrottleMetadata(a),u)return ue.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${u} provided in the "measurementId" field in the local Firebase config. [${null==s?void 0:s.message}]`),{appId:a,measurementId:u};throw e}const c=503===Number(null===(o=null==s?void 0:s.customData)||void 0===o?void 0:o.httpStatus)?I(n,r.intervalMillis,30):I(n,r.intervalMillis),h={throttleEndTimeMillis:Date.now()+c,backoffCount:n+1};return r.setThrottleMetadata(a,h),ue.debug(`Calling attemptFetch again in ${c} millis`),pe(t,h,i,r)}}class me{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach((t=>t()))}}let ge,ye;async function ve(t,e,n,i,r,s,o){var c;const h=fe(t);h.then((e=>{n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&ue.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${e.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((t=>ue.error(t))),e.push(h);const l=async function(){var t;if(!a())return ue.warn(he.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await u()}catch(e){return ue.warn(he.create("indexeddb-unavailable",{errorInfo:null===(t=e)||void 0===t?void 0:t.toString()}).message),!1}return!0}().then((t=>t?i.getId():void 0)),[d,f]=await Promise.all([h,l]);(function(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(ae)&&n.src.includes(t))return n;return null})(s)||function(t,e){const n=document.createElement("script");n.src=`${ae}?l=${t}&id=${e}`,n.async=!0,document.head.appendChild(n)}(s,d.measurementId),ye&&(r("consent","default",ye),ye=void 0),r("js",new Date);const p=null!==(c=null==o?void 0:o.config)&&void 0!==c?c:{};return p.origin="firebase",p.update=!0,null!=f&&(p.firebase_id=f),r("config",d.measurementId,p),ge&&(r("set",ge),ge=void 0),d.measurementId}class _e{constructor(t){this.app=t}_delete(){return delete we[this.app.options.appId],Promise.resolve()}}let we={},be=[];const Te={};let Ie,Ee,Se="dataLayer",ke=!1;function Ce(t,e,n){!function(){const t=[];if(o()&&t.push("This is a browser extension environment."),"undefined"!=typeof navigator&&navigator.cookieEnabled||t.push("Cookies are not available."),t.length>0){const e=t.map(((t,e)=>`(${e+1}) ${t}`)).join(" "),n=he.create("invalid-analytics-context",{errorInfo:e});ue.warn(n.message)}}();const i=t.options.appId;if(!i)throw he.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw he.create("no-api-key");ue.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=we[i])throw he.create("already-exists",{id:i});if(!ke){!function(t){let e=[];Array.isArray(window.dataLayer)?e=window.dataLayer:window.dataLayer=e}();const{wrappedGtag:t,gtagCore:e}=function(t,e,n,i,r){let s=function(...t){window.dataLayer.push(arguments)};return window.gtag&&"function"==typeof window.gtag&&(s=window.gtag),window.gtag=function(t,e,n,i){return async function(r,s,o){try{"event"===r?await async function(t,e,n,i,r){try{let s=[];if(r&&r.send_to){let t=r.send_to;Array.isArray(t)||(t=[t]);const i=await ce(n);for(const n of t){const t=i.find((t=>t.measurementId===n)),r=t&&e[t.appId];if(!r){s=[];break}s.push(r)}}0===s.length&&(s=Object.values(e)),await Promise.all(s),t("event",i,r||{})}catch(t){ue.error(t)}}(t,e,n,s,o):"config"===r?await async function(t,e,n,i,r,s){const o=i[r];try{if(o)await e[o];else{const t=(await ce(n)).find((t=>t.measurementId===r));t&&await e[t.appId]}}catch(t){ue.error(t)}t("config",r,s)}(t,e,n,i,s,o):"consent"===r?t("consent","update",o):t("set",s)}catch(t){ue.error(t)}}}(s,t,e,n),{gtagCore:s,wrappedGtag:window.gtag}}(we,be,Te);Ee=t,Ie=e,ke=!0}return we[i]=ve(t,be,Te,e,Ie,Se,n),new _e(t)}const Ae="@firebase/analytics",De="0.8.4";ct(new S(oe,((t,{options:e})=>Ce(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),e)),"PUBLIC")),ct(new S("analytics-internal",(function(t){try{const e=t.getProvider(oe).getImmediate();return{logEvent:(t,n,i)=>function(t,e,n,i){t=E(t),async function(t,e,n,i,r){if(r&&r.global)t("event",n,i);else{const r=await e;t("event",n,Object.assign(Object.assign({},i),{send_to:r}))}}(Ee,we[t.app.options.appId],e,n,i).catch((t=>ue.error(t)))}(e,t,n,i)}}catch(t){throw he.create("interop-component-reg-failed",{reason:t})}}),"PRIVATE")),gt(Ae,De),gt(Ae,De,"esm2017");const Ne=pt({apiKey:"AIzaSyAfLyWlU3BMjia7qU9-qYDGGMuuPEBtFqU",authDomain:"blitz-chat-d6dc9.firebaseapp.com",projectId:"blitz-chat-d6dc9",storageBucket:"blitz-chat-d6dc9.appspot.com",messagingSenderId:"909983333760",appId:"1:909983333760:web:be045f1d22c5d9378ed565",measurementId:"G-8VW8H07175"}),Re=(function(t=mt()){const e=ht(t=E(t),oe);e.isInitialized()?e.getImmediate():function(t,e={}){const n=ht(t,oe);if(n.isInitialized()){const t=n.getImmediate();if(g(e,n.getOptions()))return t;throw he.create("already-initialized")}n.initialize({options:e})}(t)}(Ne),document.getElementById("register-btn"),document.getElementById("login-btn"),document.getElementById("logout-btn")),Oe=document.getElementById("create-chat-btn"),xe=(document.getElementById("complete-create-chat-btn"),[...document.querySelectorAll(".back-btn")]),Me=document.getElementById("register-page"),Le=document.getElementById("login-page"),Pe=document.getElementById("chatrooms-page"),Ue=document.getElementById("chat-page"),Fe=document.getElementById("create-chat-page"),Ve=[Me,Le,Pe,Ue,Fe],Be=document.getElementById("register-form"),je=document.getElementById("register-form-err"),qe=document.getElementById("register-name-err"),ze=document.getElementById("register-email-err"),$e=document.getElementById("register-password-err"),He=document.getElementById("login-link"),Ke=document.getElementById("login-form"),Ge=document.getElementById("login-form-err"),We=document.getElementById("login-email-err"),Qe=document.getElementById("login-password-err"),Xe=document.getElementById("register-link"),Ye=document.getElementById("create-chat-form"),Je=document.getElementById("create-chatroom-name-err"),Ze=(document.getElementById("create-chatroom-description-err"),document.getElementById("create-chatroom-theme-err")),tn=document.getElementById("message-form"),en=document.getElementById("chatrooms-list"),nn=document.getElementById("messages-list"),rn=(document.getElementsByTagName("body"),t=>{null==t||t.classList.remove("page--hidden"),Ve.map((e=>{e!==t&&(null==e||e.classList.add("page--hidden"))}))}),sn=t=>!(!t||t.length<4),on=t=>!!t,an=t=>!!t,un=t=>!!t;var cn,hn="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t.g?t.g:"undefined"!=typeof self?self:{},ln={},dn=dn||{},fn=hn||self;function pn(){}function mn(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function gn(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var yn="closure_uid_"+(1e9*Math.random()>>>0),vn=0;function _n(t,e,n){return t.call.apply(t.bind,arguments)}function wn(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function bn(t,e,n){return(bn=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?_n:wn).apply(null,arguments)}function Tn(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function In(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Wb=function(t,n,i){for(var r=Array(arguments.length-2),s=2;s<arguments.length;s++)r[s-2]=arguments[s];return e.prototype[n].apply(t,r)}}function En(){this.s=this.s,this.o=this.o}En.prototype.s=!1,En.prototype.na=function(){var t;!this.s&&(this.s=!0,this.M(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,yn)&&t[yn]||(t[yn]=++vn))},En.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Sn=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function kn(t){const e=t.length;if(0<e){const n=Array(e);for(let i=0;i<e;i++)n[i]=t[i];return n}return[]}function Cn(t,e){for(let e=1;e<arguments.length;e++){const n=arguments[e];if(mn(n)){const e=t.length||0,i=n.length||0;t.length=e+i;for(let r=0;r<i;r++)t[e+r]=n[r]}else t.push(n)}}function An(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}An.prototype.h=function(){this.defaultPrevented=!0};var Dn=function(){if(!fn.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{fn.addEventListener("test",pn,e),fn.removeEventListener("test",pn,e)}catch(t){}return t}();function Nn(t){return/^[\s\xa0]*$/.test(t)}var Rn=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function On(t,e){return t<e?-1:t>e?1:0}function xn(){var t=fn.navigator;return t&&(t=t.userAgent)?t:""}function Mn(t){return-1!=xn().indexOf(t)}function Ln(t){return Ln[" "](t),t}Ln[" "]=pn;var Pn,Un,Fn=Mn("Opera"),Vn=Mn("Trident")||Mn("MSIE"),Bn=Mn("Edge"),jn=Bn||Vn,qn=Mn("Gecko")&&!(-1!=xn().toLowerCase().indexOf("webkit")&&!Mn("Edge"))&&!(Mn("Trident")||Mn("MSIE"))&&!Mn("Edge"),zn=-1!=xn().toLowerCase().indexOf("webkit")&&!Mn("Edge");function $n(){var t=fn.document;return t?t.documentMode:void 0}t:{var Hn="",Kn=(Un=xn(),qn?/rv:([^\);]+)(\)|;)/.exec(Un):Bn?/Edge\/([\d\.]+)/.exec(Un):Vn?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Un):zn?/WebKit\/(\S+)/.exec(Un):Fn?/(?:Version)[ \/]?(\S+)/.exec(Un):void 0);if(Kn&&(Hn=Kn?Kn[1]:""),Vn){var Gn=$n();if(null!=Gn&&Gn>parseFloat(Hn)){Pn=String(Gn);break t}}Pn=Hn}var Wn,Qn={};function Xn(){return function(t){var e=Qn;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=function(){let t=0;const e=Rn(String(Pn)).split("."),n=Rn("9").split("."),i=Math.max(e.length,n.length);for(let o=0;0==t&&o<i;o++){var r=e[o]||"",s=n[o]||"";do{if(r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==r[0].length&&0==s[0].length)break;t=On(0==r[1].length?0:parseInt(r[1],10),0==s[1].length?0:parseInt(s[1],10))||On(0==r[2].length,0==s[2].length)||On(r[2],s[2]),r=r[3],s=s[3]}while(0==t)}return 0<=t}()}()}fn.document&&Vn?Wn=$n()||parseInt(Pn,10)||void 0:Wn=void 0;var Yn=Wn;function Jn(t,e){if(An.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(qn){t:{try{Ln(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Zn[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Jn.X.h.call(this)}}In(Jn,An);var Zn={2:"touch",3:"pen",4:"mouse"};Jn.prototype.h=function(){Jn.X.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var ti="closure_listenable_"+(1e6*Math.random()|0),ei=0;function ni(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.ha=r,this.key=++ei,this.ba=this.ea=!1}function ii(t){t.ba=!0,t.listener=null,t.proxy=null,t.src=null,t.ha=null}function ri(t,e,n){for(const i in t)e.call(n,t[i],i,t)}function si(t){const e={};for(const n in t)e[n]=t[n];return e}const oi="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ai(t,e){let n,i;for(let e=1;e<arguments.length;e++){for(n in i=arguments[e],i)t[n]=i[n];for(let e=0;e<oi.length;e++)n=oi[e],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function ui(t){this.src=t,this.g={},this.h=0}function ci(t,e){var n=e.type;if(n in t.g){var i,r=t.g[n],s=Sn(r,e);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(ii(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function hi(t,e,n,i){for(var r=0;r<t.length;++r){var s=t[r];if(!s.ba&&s.listener==e&&s.capture==!!n&&s.ha==i)return r}return-1}ui.prototype.add=function(t,e,n,i,r){var s=t.toString();(t=this.g[s])||(t=this.g[s]=[],this.h++);var o=hi(t,e,i,r);return-1<o?(e=t[o],n||(e.ea=!1)):((e=new ni(e,this.src,s,!!i,r)).ea=n,t.push(e)),e};var li="closure_lm_"+(1e6*Math.random()|0),di={};function fi(t,e,n,i,r){if(i&&i.once)return mi(t,e,n,i,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)fi(t,e[s],n,i,r);return null}return n=Ti(n),t&&t[ti]?t.N(e,n,gn(i)?!!i.capture:!!i,r):pi(t,e,n,!1,i,r)}function pi(t,e,n,i,r,s){if(!e)throw Error("Invalid event type");var o=gn(r)?!!r.capture:!!r,a=wi(t);if(a||(t[li]=a=new ui(t)),(n=a.add(e,n,i,o,s)).proxy)return n;if(i=function(){const t=_i;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)Dn||(r=o),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(vi(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function mi(t,e,n,i,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)mi(t,e[s],n,i,r);return null}return n=Ti(n),t&&t[ti]?t.O(e,n,gn(i)?!!i.capture:!!i,r):pi(t,e,n,!0,i,r)}function gi(t,e,n,i,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)gi(t,e[s],n,i,r);else i=gn(i)?!!i.capture:!!i,n=Ti(n),t&&t[ti]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=hi(s=t.g[e],n,i,r))&&(ii(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete t.g[e],t.h--))):t&&(t=wi(t))&&(e=t.g[e.toString()],t=-1,e&&(t=hi(e,n,i,r)),(n=-1<t?e[t]:null)&&yi(n))}function yi(t){if("number"!=typeof t&&t&&!t.ba){var e=t.src;if(e&&e[ti])ci(e.i,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(vi(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=wi(e))?(ci(n,t),0==n.h&&(n.src=null,e[li]=null)):ii(t)}}}function vi(t){return t in di?di[t]:di[t]="on"+t}function _i(t,e){if(t.ba)t=!0;else{e=new Jn(e,this);var n=t.listener,i=t.ha||t.src;t.ea&&yi(t),t=n.call(i,e)}return t}function wi(t){return(t=t[li])instanceof ui?t:null}var bi="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ti(t){return"function"==typeof t?t:(t[bi]||(t[bi]=function(e){return t.handleEvent(e)}),t[bi])}function Ii(){En.call(this),this.i=new ui(this),this.P=this,this.I=null}function Ei(t,e){var n,i=t.I;if(i)for(n=[];i;i=i.I)n.push(i);if(t=t.P,i=e.type||e,"string"==typeof e)e=new An(e,t);else if(e instanceof An)e.target=e.target||t;else{var r=e;ai(e=new An(i,t),r)}if(r=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];r=Si(o,i,!0,e)&&r}if(r=Si(o=e.g=t,i,!0,e)&&r,r=Si(o,i,!1,e)&&r,n)for(s=0;s<n.length;s++)r=Si(o=e.g=n[s],i,!1,e)&&r}function Si(t,e,n,i){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.ba&&o.capture==n){var a=o.listener,u=o.ha||o.src;o.ea&&ci(t.i,o),r=!1!==a.call(u,i)&&r}}return r&&!i.defaultPrevented}In(Ii,En),Ii.prototype[ti]=!0,Ii.prototype.removeEventListener=function(t,e,n,i){gi(this,t,e,n,i)},Ii.prototype.M=function(){if(Ii.X.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],i=0;i<n.length;i++)ii(n[i]);delete e.g[t],e.h--}}this.I=null},Ii.prototype.N=function(t,e,n,i){return this.i.add(String(t),e,!1,n,i)},Ii.prototype.O=function(t,e,n,i){return this.i.add(String(t),e,!0,n,i)};var ki=fn.JSON.stringify;function Ci(){var t=Mi;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Ai,Di=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}((()=>new Ni),(t=>t.reset()));class Ni{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function Ri(t){fn.setTimeout((()=>{throw t}),0)}function Oi(t,e){Ai||function(){var t=fn.Promise.resolve(void 0);Ai=function(){t.then(Li)}}(),xi||(Ai(),xi=!0),Mi.add(t,e)}var xi=!1,Mi=new class{constructor(){this.h=this.g=null}add(t,e){const n=Di.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}};function Li(){for(var t;t=Ci();){try{t.h.call(t.g)}catch(t){Ri(t)}var e=Di;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}xi=!1}function Pi(t,e){Ii.call(this),this.h=t||1,this.g=e||fn,this.j=bn(this.lb,this),this.l=Date.now()}function Ui(t){t.ca=!1,t.R&&(t.g.clearTimeout(t.R),t.R=null)}function Fi(t,e,n){if("function"==typeof t)n&&(t=bn(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=bn(t.handleEvent,t)}return 2147483647<Number(e)?-1:fn.setTimeout(t,e||0)}function Vi(t){t.g=Fi((()=>{t.g=null,t.i&&(t.i=!1,Vi(t))}),t.j);const e=t.h;t.h=null,t.m.apply(null,e)}In(Pi,Ii),(cn=Pi.prototype).ca=!1,cn.R=null,cn.lb=function(){if(this.ca){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-t):(this.R&&(this.g.clearTimeout(this.R),this.R=null),Ei(this,"tick"),this.ca&&(Ui(this),this.start()))}},cn.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},cn.M=function(){Pi.X.M.call(this),Ui(this),delete this.g};class Bi extends En{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:Vi(this)}M(){super.M(),this.g&&(fn.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ji(t){En.call(this),this.h=t,this.g={}}In(ji,En);var qi=[];function zi(t,e,n,i){Array.isArray(n)||(n&&(qi[0]=n.toString()),n=qi);for(var r=0;r<n.length;r++){var s=fi(e,n[r],i||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function $i(t){ri(t.g,(function(t,e){this.g.hasOwnProperty(e)&&yi(t)}),t),t.g={}}function Hi(){this.g=!0}function Ki(t,e,n,i){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<r.length;o++)r[o]=""}}}return ki(n)}catch(t){return e}}(t,n)+(i?" "+i:"")}))}ji.prototype.M=function(){ji.X.M.call(this),$i(this)},ji.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Hi.prototype.Aa=function(){this.g=!1},Hi.prototype.info=function(){};var Gi={},Wi=null;function Qi(){return Wi=Wi||new Ii}function Xi(t){An.call(this,Gi.Pa,t)}function Yi(t){const e=Qi();Ei(e,new Xi(e))}function Ji(t,e){An.call(this,Gi.STAT_EVENT,t),this.stat=e}function Zi(t){const e=Qi();Ei(e,new Ji(e,t))}function tr(t,e){An.call(this,Gi.Qa,t),this.size=e}function er(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return fn.setTimeout((function(){t()}),e)}Gi.Pa="serverreachability",In(Xi,An),Gi.STAT_EVENT="statevent",In(Ji,An),Gi.Qa="timingevent",In(tr,An);var nr={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},ir={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function rr(){}function sr(t){return t.h||(t.h=t.i())}function or(){}rr.prototype.h=null;var ar,ur={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function cr(){An.call(this,"d")}function hr(){An.call(this,"c")}function lr(){}function dr(t,e,n,i){this.l=t,this.j=e,this.m=n,this.U=i||1,this.S=new ji(this),this.O=pr,t=jn?125:void 0,this.T=new Pi(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new fr}function fr(){this.i=null,this.g="",this.h=!1}In(cr,An),In(hr,An),In(lr,rr),lr.prototype.g=function(){return new XMLHttpRequest},lr.prototype.i=function(){return{}},ar=new lr;var pr=45e3,mr={},gr={};function yr(t,e,n){t.K=1,t.v=Pr(Rr(e)),t.s=n,t.P=!0,vr(t,null)}function vr(t,e){t.F=Date.now(),Tr(t),t.A=Rr(t.v);var n=t.A,i=t.U;Array.isArray(i)||(i=[String(i)]),Qr(n.i,"t",i),t.C=0,n=t.l.H,t.h=new fr,t.g=Ws(t.l,n?e:null,!t.s),0<t.N&&(t.L=new Bi(bn(t.La,t,t.g),t.N)),zi(t.S,t.g,"readystatechange",t.ib),e=t.H?si(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.da(t.A,t.u,t.s,e)):(t.u="GET",t.g.da(t.A,t.u,null,e)),Yi(),function(t,e,n,i,r,s){t.info((function(){if(t.g)if(s)for(var o="",a=s.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var h=c[0];c=c[1];var l=h.split("_");o=2<=l.length&&"type"==l[1]?o+(h+"=")+c+"&":o+(h+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+e+"\n"+n+"\n"+o}))}(t.j,t.u,t.A,t.m,t.U,t.s)}function _r(t){return!!t.g&&"GET"==t.u&&2!=t.K&&t.l.Da}function wr(t,e,n){let i,r=!0;for(;!t.I&&t.C<n.length;){if(i=br(t,n),i==gr){4==e&&(t.o=4,Zi(14),r=!1),Ki(t.j,t.m,null,"[Incomplete Response]");break}if(i==mr){t.o=4,Zi(15),Ki(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}Ki(t.j,t.m,i,null),Cr(t,i)}_r(t)&&i!=gr&&i!=mr&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,Zi(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.$&&(t.$=!0,(e=t.l).g==t&&e.$&&!e.K&&(e.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),Bs(e),e.K=!0,Zi(11))):(Ki(t.j,t.m,n,"[Invalid Chunked Response]"),kr(t),Sr(t))}function br(t,e){var n=t.C,i=e.indexOf("\n",n);return-1==i?gr:(n=Number(e.substring(n,i)),isNaN(n)?mr:(i+=1)+n>e.length?gr:(e=e.substr(i,n),t.C=i+n,e))}function Tr(t){t.V=Date.now()+t.O,Ir(t,t.O)}function Ir(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=er(bn(t.gb,t),e)}function Er(t){t.B&&(fn.clearTimeout(t.B),t.B=null)}function Sr(t){0==t.l.G||t.I||zs(t.l,t)}function kr(t){Er(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,Ui(t.T),$i(t.S),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Cr(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||es(n.h,t)))if(!t.J&&es(n.h,t)&&3==n.G){try{var i=n.Fa.g.parse(e)}catch(t){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;qs(n),Os(n)}Vs(n),Zi(18)}}else n.Ba=r[1],0<n.Ba-n.T&&37500>r[2]&&n.L&&0==n.A&&!n.v&&(n.v=er(bn(n.cb,n),6e3));if(1>=ts(n.h)&&n.ja){try{n.ja()}catch(t){}n.ja=void 0}}else Hs(n,11)}else if((t.J||n.g==t)&&qs(n),!Nn(e))for(r=n.Fa.g.parse(e),e=0;e<r.length;e++){let c=r[e];if(n.T=c[0],c=c[1],2==n.G)if("c"==c[0]){n.I=c[1],n.ka=c[2];const e=c[3];null!=e&&(n.ma=e,n.j.info("VER="+n.ma));const r=c[4];null!=r&&(n.Ca=r,n.j.info("SVER="+n.Ca));const h=c[5];null!=h&&"number"==typeof h&&0<h&&(i=1.5*h,n.J=i,n.j.info("backChannelRequestTimeoutMs_="+i)),i=n;const l=t.g;if(l){const t=l.g?l.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var s=i.h;s.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(ns(s,s.h),s.h=null))}if(i.D){const t=l.g?l.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(i.za=t,Lr(i.F,i.D,t))}}n.G=3,n.l&&n.l.xa(),n.$&&(n.P=Date.now()-t.F,n.j.info("Handshake RTT: "+n.P+"ms"));var o=t;if((i=n).sa=Gs(i,i.H?i.ka:null,i.V),o.J){is(i.h,o);var a=o,u=i.J;u&&a.setTimeout(u),a.B&&(Er(a),Tr(a)),i.g=o}else Fs(i);0<n.i.length&&Ms(n)}else"stop"!=c[0]&&"close"!=c[0]||Hs(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?Hs(n,7):Rs(n):"noop"!=c[0]&&n.l&&n.l.wa(c),n.A=0)}Yi()}catch(t){}}function Ar(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(mn(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function(t){if(t.oa&&"function"==typeof t.oa)return t.oa();if(!t.W||"function"!=typeof t.W){if("undefined"!=typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!=typeof Set&&t instanceof Set)){if(mn(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const i in t)e[n++]=i;return e}}}(t),i=function(t){if(t.W&&"function"==typeof t.W)return t.W();if("undefined"!=typeof Map&&t instanceof Map||"undefined"!=typeof Set&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(mn(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t),r=i.length,s=0;s<r;s++)e.call(void 0,i[s],n&&n[s],t)}(cn=dr.prototype).setTimeout=function(t){this.O=t},cn.ib=function(t){t=t.target;const e=this.L;e&&3==Ss(t)?e.l():this.La(t)},cn.La=function(t){try{if(t==this.g)t:{const h=Ss(this.g);var e=this.g.Ea();if(this.g.aa(),!(3>h)&&(3!=h||jn||this.g&&(this.h.h||this.g.fa()||ks(this.g)))){this.I||4!=h||7==e||Yi(),Er(this);var n=this.g.aa();this.Y=n;e:if(_r(this)){var i=ks(this.g);t="";var r=i.length,s=4==Ss(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){kr(this),Sr(this);var o="";break e}this.h.i=new fn.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,t+=this.h.i.decode(i[e],{stream:s&&e==r-1});i.splice(0,r),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.fa();if(this.i=200==n,function(t,e,n,i,r,s,o){t.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+e+"\n"+n+"\n"+s+" "+o}))}(this.j,this.u,this.A,this.m,this.U,h,n),this.i){if(this.Z&&!this.J){e:{if(this.g){var a,u=this.g;if((a=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Nn(a)){var c=a;break e}}c=null}if(!(n=c)){this.i=!1,this.o=3,Zi(12),kr(this),Sr(this);break t}Ki(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Cr(this,n)}this.P?(wr(this,h,o),jn&&this.i&&3==h&&(zi(this.S,this.T,"tick",this.hb),this.T.start())):(Ki(this.j,this.m,o,null),Cr(this,o)),4==h&&kr(this),this.i&&!this.I&&(4==h?zs(this.l,this):(this.i=!1,Tr(this)))}else 400==n&&0<o.indexOf("Unknown SID")?(this.o=3,Zi(12)):(this.o=0,Zi(13)),kr(this),Sr(this)}}}catch(t){}},cn.hb=function(){if(this.g){var t=Ss(this.g),e=this.g.fa();this.C<e.length&&(Er(this),wr(this,t,e),this.i&&4!=t&&Tr(this))}},cn.cancel=function(){this.I=!0,kr(this)},cn.gb=function(){this.B=null;const t=Date.now();0<=t-this.V?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.K&&(Yi(),Zi(17)),kr(this),this.o=2,Sr(this)):Ir(this,this.V-t)};var Dr=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Nr(t,e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Nr){this.h=void 0!==e?e:t.h,Or(this,t.j),this.s=t.s,this.g=t.g,xr(this,t.m),this.l=t.l,e=t.i;var n=new Hr;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),Mr(this,n),this.o=t.o}else t&&(n=String(t).match(Dr))?(this.h=!!e,Or(this,n[1]||"",!0),this.s=Ur(n[2]||""),this.g=Ur(n[3]||"",!0),xr(this,n[4]),this.l=Ur(n[5]||"",!0),Mr(this,n[6]||"",!0),this.o=Ur(n[7]||"")):(this.h=!!e,this.i=new Hr(null,this.h))}function Rr(t){return new Nr(t)}function Or(t,e,n){t.j=n?Ur(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function xr(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Mr(t,e,n){e instanceof Hr?(t.i=e,function(t,e){e&&!t.j&&(Kr(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Gr(this,e),Qr(this,n,t))}),t)),t.j=e}(t.i,t.h)):(n||(e=Fr(e,zr)),t.i=new Hr(e,t.h))}function Lr(t,e,n){t.i.set(e,n)}function Pr(t){return Lr(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Ur(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Fr(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Vr),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Vr(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Nr.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Fr(e,Br,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(Fr(e,Br,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(Fr(n,"/"==n.charAt(0)?qr:jr,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Fr(n,$r)),t.join("")};var Br=/[#\/\?@]/g,jr=/[#\?:]/g,qr=/[#\?]/g,zr=/[#\?@]/g,$r=/#/g;function Hr(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Kr(t){t.g||(t.g=new Map,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var s=t[n].substring(0,i);r=t[n].substring(i+1)}else s=t[n];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Gr(t,e){Kr(t),e=Xr(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function Wr(t,e){return Kr(t),e=Xr(t,e),t.g.has(e)}function Qr(t,e,n){Gr(t,e),0<n.length&&(t.i=null,t.g.set(Xr(t,e),kn(n)),t.h+=n.length)}function Xr(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function Yr(t){this.l=t||Jr,t=fn.PerformanceNavigationTiming?0<(t=fn.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(fn.g&&fn.g.Ga&&fn.g.Ga()&&fn.g.Ga().$b),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(cn=Hr.prototype).add=function(t,e){Kr(this),this.i=null,t=Xr(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},cn.forEach=function(t,e){Kr(this),this.g.forEach((function(n,i){n.forEach((function(n){t.call(e,n,i,this)}),this)}),this)},cn.oa=function(){Kr(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let i=0;i<e.length;i++){const r=t[i];for(let t=0;t<r.length;t++)n.push(e[i])}return n},cn.W=function(t){Kr(this);let e=[];if("string"==typeof t)Wr(this,t)&&(e=e.concat(this.g.get(Xr(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},cn.set=function(t,e){return Kr(this),this.i=null,Wr(this,t=Xr(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},cn.get=function(t,e){return t&&0<(t=this.W(t)).length?String(t[0]):e},cn.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var i=e[n];const s=encodeURIComponent(String(i)),o=this.W(i);for(i=0;i<o.length;i++){var r=s;""!==o[i]&&(r+="="+encodeURIComponent(String(o[i]))),t.push(r)}}return this.i=t.join("&")};var Jr=10;function Zr(t){return!!t.h||!!t.g&&t.g.size>=t.j}function ts(t){return t.h?1:t.g?t.g.size:0}function es(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function ns(t,e){t.g?t.g.add(e):t.h=e}function is(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function rs(t){if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return kn(t.i)}function ss(){}function os(){this.g=new ss}function as(t,e,n){const i=n||"";try{Ar(t,(function(t,n){let r=t;gn(t)&&(r=ki(t)),e.push(i+n+"="+encodeURIComponent(r))}))}catch(t){throw e.push(i+"type="+encodeURIComponent("_badmap")),t}}function us(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}function cs(t){this.l=t.ac||null,this.j=t.jb||!1}function hs(t,e){Ii.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=ls,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Yr.prototype.cancel=function(){if(this.i=rs(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}},ss.prototype.stringify=function(t){return fn.JSON.stringify(t,void 0)},ss.prototype.parse=function(t){return fn.JSON.parse(t,void 0)},In(cs,rr),cs.prototype.g=function(){return new hs(this.l,this.j)},cs.prototype.i=function(t){return function(){return t}}({}),In(hs,Ii);var ls=0;function ds(t){t.j.read().then(t.Ta.bind(t)).catch(t.ga.bind(t))}function fs(t){t.readyState=4,t.l=null,t.j=null,t.A=null,ps(t)}function ps(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(cn=hs.prototype).open=function(t,e){if(this.readyState!=ls)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,ps(this)},cn.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||fn).fetch(new Request(this.B,e)).then(this.Wa.bind(this),this.ga.bind(this))},cn.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,fs(this)),this.readyState=ls},cn.Wa=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,ps(this)),this.g&&(this.readyState=3,ps(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(void 0!==fn.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;ds(this)}else t.text().then(this.Va.bind(this),this.ga.bind(this))},cn.Ta=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?fs(this):ps(this),3==this.readyState&&ds(this)}},cn.Va=function(t){this.g&&(this.response=this.responseText=t,fs(this))},cn.Ua=function(t){this.g&&(this.response=t,fs(this))},cn.ga=function(){this.g&&fs(this)},cn.setRequestHeader=function(t,e){this.v.append(t,e)},cn.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},cn.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(hs.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var ms=fn.JSON.parse;function gs(t){Ii.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=ys,this.K=this.L=!1}In(gs,Ii);var ys="",vs=/^https?$/i,_s=["POST","PUT"];function ws(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,bs(t),Is(t)}function bs(t){t.D||(t.D=!0,Ei(t,"complete"),Ei(t,"error"))}function Ts(t){if(t.h&&void 0!==dn&&(!t.C[1]||4!=Ss(t)||2!=t.aa()))if(t.v&&4==Ss(t))Fi(t.Ha,0,t);else if(Ei(t,"readystatechange"),4==Ss(t)){t.h=!1;try{const a=t.aa();t:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var i;if(i=0===a){var r=String(t.H).match(Dr)[1]||null;if(!r&&fn.self&&fn.self.location){var s=fn.self.location.protocol;r=s.substr(0,s.length-1)}i=!vs.test(r?r.toLowerCase():"")}n=i}if(n)Ei(t,"complete"),Ei(t,"success");else{t.m=6;try{var o=2<Ss(t)?t.g.statusText:""}catch(t){o=""}t.j=o+" ["+t.aa()+"]",bs(t)}}finally{Is(t)}}}function Is(t,e){if(t.g){Es(t);const n=t.g,i=t.C[0]?pn:null;t.g=null,t.C=null,e||Ei(t,"ready");try{n.onreadystatechange=i}catch(t){}}}function Es(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(fn.clearTimeout(t.A),t.A=null)}function Ss(t){return t.g?t.g.readyState:0}function ks(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case ys:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Cs(t){let e="";return ri(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}function As(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}i||(n=Cs(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Lr(t,e,n))}function Ds(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Ns(t){this.Ca=0,this.i=[],this.j=new Hi,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=Ds("failFast",!1,t),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=Ds("baseRetryDelayMs",5e3,t),this.bb=Ds("retryDelaySeedMs",1e4,t),this.$a=Ds("forwardChannelMaxRetries",2,t),this.ta=Ds("forwardChannelRequestTimeoutMs",2e4,t),this.ra=t&&t.xmlHttpFactory||void 0,this.Da=t&&t.Zb||!1,this.J=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.I="",this.h=new Yr(t&&t.concurrentRequestLimit),this.Fa=new os,this.O=t&&t.fastHandshake||!1,this.N=t&&t.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=t&&t.Xb||!1,t&&t.Aa&&this.j.Aa(),t&&t.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&t&&t.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function Rs(t){if(xs(t),3==t.G){var e=t.U++,n=Rr(t.F);Lr(n,"SID",t.I),Lr(n,"RID",e),Lr(n,"TYPE","terminate"),Ps(t,n),(e=new dr(t,t.j,e,void 0)).K=2,e.v=Pr(Rr(n)),n=!1,fn.navigator&&fn.navigator.sendBeacon&&(n=fn.navigator.sendBeacon(e.v.toString(),"")),!n&&fn.Image&&((new Image).src=e.v,n=!0),n||(e.g=Ws(e.l,null),e.g.da(e.v)),e.F=Date.now(),Tr(e)}Ks(t)}function Os(t){t.g&&(Bs(t),t.g.cancel(),t.g=null)}function xs(t){Os(t),t.u&&(fn.clearTimeout(t.u),t.u=null),qs(t),t.h.cancel(),t.m&&("number"==typeof t.m&&fn.clearTimeout(t.m),t.m=null)}function Ms(t){Zr(t.h)||t.m||(t.m=!0,Oi(t.Ja,t),t.C=0)}function Ls(t,e){var n;n=e?e.m:t.U++;const i=Rr(t.F);Lr(i,"SID",t.I),Lr(i,"RID",n),Lr(i,"AID",t.T),Ps(t,i),t.o&&t.s&&As(i,t.o,t.s),n=new dr(t,t.j,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.i=e.D.concat(t.i)),e=Us(t,n,1e3),n.setTimeout(Math.round(.5*t.ta)+Math.round(.5*t.ta*Math.random())),ns(t.h,n),yr(n,i,e)}function Ps(t,e){t.ia&&ri(t.ia,(function(t,n){Lr(e,n,t)})),t.l&&Ar({},(function(t,n){Lr(e,n,t)}))}function Us(t,e,n){n=Math.min(t.i.length,n);var i=t.l?bn(t.l.Ra,t.l,t):null;t:{var r=t.i;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=r[0].h,t.push("ofs="+e)):e=0:t.push("ofs="+e);let s=!0;for(let o=0;o<n;o++){let n=r[o].h;const a=r[o].g;if(n-=e,0>n)e=Math.max(0,r[o].h-100),s=!1;else try{as(a,t,"req"+n+"_")}catch(t){i&&i(a)}}if(s){i=t.join("&");break t}}}return t=t.i.splice(0,n),e.D=t,i}function Fs(t){t.g||t.u||(t.Z=1,Oi(t.Ia,t),t.A=0)}function Vs(t){return!(t.g||t.u||3<=t.A||(t.Z++,t.u=er(bn(t.Ia,t),$s(t,t.A)),t.A++,0))}function Bs(t){null!=t.B&&(fn.clearTimeout(t.B),t.B=null)}function js(t){t.g=new dr(t,t.j,"rpc",t.Z),null===t.o&&(t.g.H=t.s),t.g.N=0;var e=Rr(t.sa);Lr(e,"RID","rpc"),Lr(e,"SID",t.I),Lr(e,"CI",t.L?"0":"1"),Lr(e,"AID",t.T),Lr(e,"TYPE","xmlhttp"),Ps(t,e),t.o&&t.s&&As(e,t.o,t.s),t.J&&t.g.setTimeout(t.J);var n=t.g;t=t.ka,n.K=1,n.v=Pr(Rr(e)),n.s=null,n.P=!0,vr(n,t)}function qs(t){null!=t.v&&(fn.clearTimeout(t.v),t.v=null)}function zs(t,e){var n=null;if(t.g==e){qs(t),Bs(t),t.g=null;var i=2}else{if(!es(t.h,e))return;n=e.D,is(t.h,e),i=1}if(0!=t.G)if(t.pa=e.Y,e.i)if(1==i){n=e.s?e.s.length:0,e=Date.now()-e.F;var r=t.C;Ei(i=Qi(),new tr(i,n)),Ms(t)}else Fs(t);else if(3==(r=e.o)||0==r&&0<t.pa||!(1==i&&function(t,e){return!(ts(t.h)>=t.h.j-(t.m?1:0)||(t.m?(t.i=e.D.concat(t.i),0):1==t.G||2==t.G||t.C>=(t.Za?0:t.$a)||(t.m=er(bn(t.Ja,t,e),$s(t,t.C)),t.C++,0)))}(t,e)||2==i&&Vs(t)))switch(n&&0<n.length&&(e=t.h,e.i=e.i.concat(n)),r){case 1:Hs(t,5);break;case 4:Hs(t,10);break;case 3:Hs(t,6);break;default:Hs(t,2)}}function $s(t,e){let n=t.Xa+Math.floor(Math.random()*t.bb);return t.l||(n*=2),n*e}function Hs(t,e){if(t.j.info("Error code "+e),2==e){var n=null;t.l&&(n=null);var i=bn(t.kb,t);n||(n=new Nr("//www.google.com/images/cleardot.gif"),fn.location&&"http"==fn.location.protocol||Or(n,"https"),Pr(n)),function(t,e){const n=new Hi;if(fn.Image){const i=new Image;i.onload=Tn(us,n,i,"TestLoadImage: loaded",!0,e),i.onerror=Tn(us,n,i,"TestLoadImage: error",!1,e),i.onabort=Tn(us,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=Tn(us,n,i,"TestLoadImage: timeout",!1,e),fn.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=t}else e(!1)}(n.toString(),i)}else Zi(2);t.G=0,t.l&&t.l.va(e),Ks(t),xs(t)}function Ks(t){if(t.G=0,t.la=[],t.l){const e=rs(t.h);0==e.length&&0==t.i.length||(Cn(t.la,e),Cn(t.la,t.i),t.h.i.length=0,kn(t.i),t.i.length=0),t.l.ua()}}function Gs(t,e,n){var i=n instanceof Nr?Rr(n):new Nr(n,void 0);if(""!=i.g)e&&(i.g=e+"."+i.g),xr(i,i.m);else{var r=fn.location;i=r.protocol,e=e?e+"."+r.hostname:r.hostname,r=+r.port;var s=new Nr(null,void 0);i&&Or(s,i),e&&(s.g=e),r&&xr(s,r),n&&(s.l=n),i=s}return n=t.D,e=t.za,n&&e&&Lr(i,n,e),Lr(i,"VER",t.ma),Ps(t,i),i}function Ws(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Da&&!t.ra?new gs(new cs({jb:!0})):new gs(t.ra)).Ka(t.H),e}function Qs(){}function Xs(){if(Vn&&!(10<=Number(Yn)))throw Error("Environmental error: no available transport.")}function Ys(t,e){Ii.call(this),this.g=new Ns(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.S=t,(t=e&&e.Yb)&&!Nn(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Nn(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new to(this)}function Js(t){cr.call(this);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function Zs(){hr.call(this),this.status=1}function to(t){this.g=t}(cn=gs.prototype).Ka=function(t){this.L=t},cn.da=function(t,e,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():ar.g(),this.C=this.u?sr(this.u):sr(ar),this.g.onreadystatechange=bn(this.Ha,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(t){return void ws(this,t)}if(t=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var r in i)n.set(r,i[r]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const t of i.keys())n.set(t,i.get(t))}i=Array.from(n.keys()).find((t=>"content-type"==t.toLowerCase())),r=fn.FormData&&t instanceof fn.FormData,!(0<=Sn(_s,e))||i||r||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[t,e]of n)this.g.setRequestHeader(t,e);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Es(this),0<this.B&&((this.K=function(t){return Vn&&Xn()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=bn(this.qa,this)):this.A=Fi(this.qa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){ws(this,t)}},cn.qa=function(){void 0!==dn&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Ei(this,"timeout"),this.abort(8))},cn.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Ei(this,"complete"),Ei(this,"abort"),Is(this))},cn.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Is(this,!0)),gs.X.M.call(this)},cn.Ha=function(){this.s||(this.F||this.v||this.l?Ts(this):this.fb())},cn.fb=function(){Ts(this)},cn.aa=function(){try{return 2<Ss(this)?this.g.status:-1}catch(t){return-1}},cn.fa=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},cn.Sa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),ms(e)}},cn.Ea=function(){return this.m},cn.Oa=function(){return"string"==typeof this.j?this.j:String(this.j)},(cn=Ns.prototype).ma=8,cn.G=1,cn.Ja=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.U=Math.floor(1e5*Math.random()),t=this.U++;const r=new dr(this,this.j,t,void 0);let s=this.s;if(this.S&&(s?(s=si(s),ai(s,this.S)):s=this.S),null!==this.o||this.N||(r.H=s,s=null),this.O)t:{for(var e=0,n=0;n<this.i.length;n++){var i=this.i[n];if(void 0===(i="__data__"in i.g&&"string"==typeof(i=i.g.__data__)?i.length:void 0))break;if(4096<(e+=i)){e=n;break t}if(4096===e||n===this.i.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=Us(this,r,e),Lr(n=Rr(this.F),"RID",t),Lr(n,"CVER",22),this.D&&Lr(n,"X-HTTP-Session-Id",this.D),Ps(this,n),s&&(this.N?e="headers="+encodeURIComponent(String(Cs(s)))+"&"+e:this.o&&As(n,this.o,s)),ns(this.h,r),this.Ya&&Lr(n,"TYPE","init"),this.O?(Lr(n,"$req",e),Lr(n,"SID","null"),r.Z=!0,yr(r,n,null)):yr(r,n,e),this.G=2}}else 3==this.G&&(t?Ls(this,t):0==this.i.length||Zr(this.h)||Ls(this))},cn.Ia=function(){if(this.u=null,js(this),this.$&&!(this.K||null==this.g||0>=this.P)){var t=2*this.P;this.j.info("BP detection timer enabled: "+t),this.B=er(bn(this.eb,this),t)}},cn.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,Zi(10),Os(this),js(this))},cn.cb=function(){null!=this.v&&(this.v=null,Os(this),Vs(this),Zi(19))},cn.kb=function(t){t?(this.j.info("Successfully pinged google.com"),Zi(2)):(this.j.info("Failed to ping google.com"),Zi(1))},(cn=Qs.prototype).xa=function(){},cn.wa=function(){},cn.va=function(){},cn.ua=function(){},cn.Ra=function(){},Xs.prototype.g=function(t,e){return new Ys(t,e)},In(Ys,Ii),Ys.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;Zi(0),t.V=e,t.ia=n||{},t.L=t.Y,t.F=Gs(t,null,t.V),Ms(t)},Ys.prototype.close=function(){Rs(this.g)},Ys.prototype.u=function(t){var e=this.g;if("string"==typeof t){var n={};n.__data__=t,t=n}else this.v&&((n={}).__data__=ki(t),t=n);e.i.push(new class{constructor(t,e){this.h=t,this.g=e}}(e.ab++,t)),3==e.G&&Ms(e)},Ys.prototype.M=function(){this.g.l=null,delete this.j,Rs(this.g),delete this.g,Ys.X.M.call(this)},In(Js,cr),In(Zs,hr),In(to,Qs),to.prototype.xa=function(){Ei(this.g,"a")},to.prototype.wa=function(t){Ei(this.g,new Js(t))},to.prototype.va=function(t){Ei(this.g,new Zs)},to.prototype.ua=function(){Ei(this.g,"b")},Xs.prototype.createWebChannel=Xs.prototype.g,Ys.prototype.send=Ys.prototype.u,Ys.prototype.open=Ys.prototype.m,Ys.prototype.close=Ys.prototype.close,nr.NO_ERROR=0,nr.TIMEOUT=8,nr.HTTP_ERROR=6,ir.COMPLETE="complete",or.EventType=ur,ur.OPEN="a",ur.CLOSE="b",ur.ERROR="c",ur.MESSAGE="d",Ii.prototype.listen=Ii.prototype.N,gs.prototype.listenOnce=gs.prototype.O,gs.prototype.getLastError=gs.prototype.Oa,gs.prototype.getLastErrorCode=gs.prototype.Ea,gs.prototype.getStatus=gs.prototype.aa,gs.prototype.getResponseJson=gs.prototype.Sa,gs.prototype.getResponseText=gs.prototype.fa,gs.prototype.send=gs.prototype.da,gs.prototype.setWithCredentials=gs.prototype.Ka;var eo=ln.createWebChannelTransport=function(){return new Xs},no=ln.getStatEventTarget=function(){return Qi()},io=ln.ErrorCode=nr,ro=ln.EventType=ir,so=ln.Event=Gi,oo=ln.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},ao=ln.FetchXmlHttpFactory=cs,uo=ln.WebChannel=or,co=ln.XhrIo=gs;const ho="@firebase/firestore";class lo{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}lo.UNAUTHENTICATED=new lo(null),lo.GOOGLE_CREDENTIALS=new lo("google-credentials-uid"),lo.FIRST_PARTY=new lo("first-party-uid"),lo.MOCK_USER=new lo("mock-user");let fo="9.14.0";const po=new P("@firebase/firestore");function mo(){return po.logLevel}function go(t,...e){if(po.logLevel<=N.DEBUG){const n=e.map(_o);po.debug(`Firestore (${fo}): ${t}`,...n)}}function yo(t,...e){if(po.logLevel<=N.ERROR){const n=e.map(_o);po.error(`Firestore (${fo}): ${t}`,...n)}}function vo(t,...e){if(po.logLevel<=N.WARN){const n=e.map(_o);po.warn(`Firestore (${fo}): ${t}`,...n)}}function _o(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function wo(t="Unexpected state"){const e=`FIRESTORE (${fo}) INTERNAL ASSERTION FAILED: `+t;throw yo(e),new Error(e)}function bo(t,e){t||wo()}function To(t,e){return t}const Io={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Eo extends f{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class So{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class ko{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class Co{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(lo.UNAUTHENTICATED)))}shutdown(){}}class Ao{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class Do{constructor(t){this.t=t,this.currentUser=lo.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let n=this.i;const i=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let r=new So;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new So,t.enqueueRetryable((()=>i(this.currentUser)))};const s=()=>{const e=r;t.enqueueRetryable((async()=>{await e.promise,await i(this.currentUser)}))},o=t=>{go("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((t=>o(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?o(t):(go("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new So)}}),0),s()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?(go("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(bo("string"==typeof e.accessToken),new ko(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return bo(null===t||"string"==typeof t),new lo(t)}}class No{constructor(t,e,n,i){this.h=t,this.l=e,this.m=n,this.g=i,this.type="FirstParty",this.user=lo.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(bo(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const t=this.I();return t&&this.p.set("Authorization",t),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class Ro{constructor(t,e,n,i){this.h=t,this.l=e,this.m=n,this.g=i}getToken(){return Promise.resolve(new No(this.h,this.l,this.m,this.g))}start(t,e){t.enqueueRetryable((()=>e(lo.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Oo{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class xo{constructor(t){this.T=t,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(t,e){const n=t=>{null!=t.error&&go("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${t.error.message}`);const n=t.token!==this.A;return this.A=t.token,go("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable((()=>n(e)))};const i=t=>{go("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.appCheck.addTokenListener(this.o)};this.T.onInit((t=>i(t))),setTimeout((()=>{if(!this.appCheck){const t=this.T.getImmediate({optional:!0});t?i(t):go("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((t=>t?(bo("string"==typeof t.token),this.A=t.token,new Oo(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Mo(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}class Lo{static R(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const i=Mo(40);for(let r=0;r<i.length;++r)n.length<20&&i[r]<e&&(n+=t.charAt(i[r]%t.length))}return n}}function Po(t,e){return t<e?-1:t>e?1:0}function Uo(t,e,n){return t.length===e.length&&t.every(((t,i)=>n(t,e[i])))}class Fo{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Eo(Io.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Eo(Io.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Eo(Io.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Eo(Io.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return Fo.fromMillis(Date.now())}static fromDate(t){return Fo.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new Fo(e,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?Po(this.nanoseconds,t.nanoseconds):Po(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Vo{constructor(t){this.timestamp=t}static fromTimestamp(t){return new Vo(t)}static min(){return new Vo(new Fo(0,0))}static max(){return new Vo(new Fo(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Bo{constructor(t,e,n){void 0===e?e=0:e>t.length&&wo(),void 0===n?n=t.length-e:n>t.length-e&&wo(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===Bo.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Bo?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const n=t.get(i),r=e.get(i);if(n<r)return-1;if(n>r)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class jo extends Bo{construct(t,e,n){return new jo(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new Eo(Io.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((t=>t.length>0)))}return new jo(e)}static emptyPath(){return new jo([])}}const qo=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class zo extends Bo{construct(t,e,n){return new zo(t,e,n)}static isValidIdentifier(t){return qo.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),zo.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new zo(["__name__"])}static fromServerFormat(t){const e=[];let n="",i=0;const r=()=>{if(0===n.length)throw new Eo(Io.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let s=!1;for(;i<t.length;){const e=t[i];if("\\"===e){if(i+1===t.length)throw new Eo(Io.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[i+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new Eo(Io.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,i+=2}else"`"===e?(s=!s,i++):"."!==e||s?(n+=e,i++):(r(),i++)}if(r(),s)throw new Eo(Io.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new zo(e)}static emptyPath(){return new zo([])}}class $o{constructor(t){this.path=t}static fromPath(t){return new $o(jo.fromString(t))}static fromName(t){return new $o(jo.fromString(t).popFirst(5))}static empty(){return new $o(jo.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===jo.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return jo.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new $o(new jo(t.slice()))}}function Ho(t){return new Ko(t.readTime,t.key,-1)}class Ko{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new Ko(Vo.min(),$o.empty(),-1)}static max(){return new Ko(Vo.max(),$o.empty(),-1)}}function Go(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=$o.comparator(t.documentKey,e.documentKey),0!==n?n:Po(t.largestBatchId,e.largestBatchId))}class Wo{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function Qo(t){if(t.code!==Io.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==t.message)throw t;go("LocalStore","Unexpectedly lost primary lease")}class Xo{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&wo(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new Xo(((n,i)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,i)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,i)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof Xo?e:Xo.resolve(e)}catch(t){return Xo.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):Xo.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):Xo.reject(e)}static resolve(t){return new Xo(((e,n)=>{e(t)}))}static reject(t){return new Xo(((e,n)=>{n(t)}))}static waitFor(t){return new Xo(((e,n)=>{let i=0,r=0,s=!1;t.forEach((t=>{++i,t.next((()=>{++r,s&&r===i&&e()}),(t=>n(t)))})),s=!0,r===i&&e()}))}static or(t){let e=Xo.resolve(!1);for(const n of t)e=e.next((t=>t?Xo.resolve(t):n()));return e}static forEach(t,e){const n=[];return t.forEach(((t,i)=>{n.push(e.call(this,t,i))})),this.waitFor(n)}static mapArray(t,e){return new Xo(((n,i)=>{const r=t.length,s=new Array(r);let o=0;for(let a=0;a<r;a++){const u=a;e(t[u]).next((t=>{s[u]=t,++o,o===r&&n(s)}),(t=>i(t)))}}))}static doWhile(t,e){return new Xo(((n,i)=>{const r=()=>{!0===t()?e().next((()=>{r()}),i):n()};r()}))}}function Yo(t){return"IndexedDbTransactionError"===t.name}class Jo{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.ut(t),this.ct=t=>e.writeSequenceNumber(t))}ut(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ct&&this.ct(t),t}}function Zo(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ta(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ea(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}Jo.at=-1;class na{constructor(t,e){this.comparator=t,this.root=e||ra.EMPTY}insert(t,e){return new na(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,ra.BLACK,null,null))}remove(t){return new na(this.comparator,this.root.remove(t,this.comparator).copy(null,null,ra.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(0===i)return e+n.left.size;i<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new ia(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new ia(this.root,t,this.comparator,!1)}getReverseIterator(){return new ia(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new ia(this.root,t,this.comparator,!0)}}class ia{constructor(t,e,n,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!t.isEmpty();)if(r=e?n(t.key,e):1,e&&i&&(r*=-1),r<0)t=this.isReverse?t.left:t.right;else{if(0===r){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class ra{constructor(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:ra.RED,this.left=null!=i?i:ra.EMPTY,this.right=null!=r?r:ra.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,i,r){return new ra(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const r=n(t,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return ra.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===e(t,i.key)){if(i.right.isEmpty())return ra.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,ra.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,ra.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw wo();if(this.right.isRed())throw wo();const t=this.left.check();if(t!==this.right.check())throw wo();return t+(this.isRed()?0:1)}}ra.EMPTY=null,ra.RED=!0,ra.BLACK=!1,ra.EMPTY=new class{constructor(){this.size=0}get key(){throw wo()}get value(){throw wo()}get color(){throw wo()}get left(){throw wo()}get right(){throw wo()}copy(t,e,n,i,r){return this}insert(t,e,n){return new ra(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class sa{constructor(t){this.comparator=t,this.data=new na(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new oa(this.data.getIterator())}getIteratorFrom(t){return new oa(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof sa))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(0!==this.comparator(t,i))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new sa(this.comparator);return e.data=t,e}}class oa{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class aa{constructor(t){this.fields=t,t.sort(zo.comparator)}static empty(){return new aa([])}unionWith(t){let e=new sa(zo.comparator);for(const t of this.fields)e=e.add(t);for(const n of t)e=e.add(n);return new aa(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Uo(this.fields,t.fields,((t,e)=>t.isEqual(e)))}}class ua{constructor(t){this.binaryString=t}static fromBase64String(t){const e=atob(t);return new ua(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new ua(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Po(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}ua.EMPTY_BYTE_STRING=new ua("");const ca=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ha(t){if(bo(!!t),"string"==typeof t){let e=0;const n=ca.exec(t);if(bo(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:la(t.seconds),nanos:la(t.nanos)}}function la(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function da(t){return"string"==typeof t?ua.fromBase64String(t):ua.fromUint8Array(t)}function fa(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function pa(t){const e=t.mapValue.fields.__previous_value__;return fa(e)?pa(e):e}function ma(t){const e=ha(t.mapValue.fields.__local_write_time__.timestampValue);return new Fo(e.seconds,e.nanos)}class ga{constructor(t,e,n,i,r,s,o,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=i,this.ssl=r,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.useFetchStreams=a}}class ya{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new ya("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof ya&&t.projectId===this.projectId&&t.database===this.database}}function va(t){return null==t}function _a(t){return 0===t&&1/t==-1/0}const wa={fields:{__type__:{stringValue:"__max__"}}};function ba(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?fa(t)?4:La(t)?9007199254740991:10:wo()}function Ta(t,e){if(t===e)return!0;const n=ba(t);if(n!==ba(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ma(t).isEqual(ma(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=ha(t.timestampValue),i=ha(e.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return da(t.bytesValue).isEqual(da(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return la(t.geoPointValue.latitude)===la(e.geoPointValue.latitude)&&la(t.geoPointValue.longitude)===la(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return la(t.integerValue)===la(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=la(t.doubleValue),i=la(e.doubleValue);return n===i?_a(n)===_a(i):isNaN(n)&&isNaN(i)}return!1}(t,e);case 9:return Uo(t.arrayValue.values||[],e.arrayValue.values||[],Ta);case 10:return function(t,e){const n=t.mapValue.fields||{},i=e.mapValue.fields||{};if(Zo(n)!==Zo(i))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===i[t]||!Ta(n[t],i[t])))return!1;return!0}(t,e);default:return wo()}}function Ia(t,e){return void 0!==(t.values||[]).find((t=>Ta(t,e)))}function Ea(t,e){if(t===e)return 0;const n=ba(t),i=ba(e);if(n!==i)return Po(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return Po(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=la(t.integerValue||t.doubleValue),i=la(e.integerValue||e.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(t,e);case 3:return Sa(t.timestampValue,e.timestampValue);case 4:return Sa(ma(t),ma(e));case 5:return Po(t.stringValue,e.stringValue);case 6:return function(t,e){const n=da(t),i=da(e);return n.compareTo(i)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),i=e.split("/");for(let t=0;t<n.length&&t<i.length;t++){const e=Po(n[t],i[t]);if(0!==e)return e}return Po(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=Po(la(t.latitude),la(e.latitude));return 0!==n?n:Po(la(t.longitude),la(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],i=e.values||[];for(let t=0;t<n.length&&t<i.length;++t){const e=Ea(n[t],i[t]);if(e)return e}return Po(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){if(t===wa&&e===wa)return 0;if(t===wa)return 1;if(e===wa)return-1;const n=t.fields||{},i=Object.keys(n),r=e.fields||{},s=Object.keys(r);i.sort(),s.sort();for(let t=0;t<i.length&&t<s.length;++t){const e=Po(i[t],s[t]);if(0!==e)return e;const o=Ea(n[i[t]],r[s[t]]);if(0!==o)return o}return Po(i.length,s.length)}(t.mapValue,e.mapValue);default:throw wo()}}function Sa(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Po(t,e);const n=ha(t),i=ha(e),r=Po(n.seconds,i.seconds);return 0!==r?r:Po(n.nanos,i.nanos)}function ka(t){return Ca(t)}function Ca(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=ha(t);return`time(${e.seconds},${e.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?da(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,$o.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(t){let e="[",n=!0;for(const i of t.values||[])n?n=!1:e+=",",e+=Ca(i);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",i=!0;for(const r of e)i?i=!1:n+=",",n+=`${r}:${Ca(t.fields[r])}`;return n+"}"}(t.mapValue):wo();var e,n}function Aa(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Da(t){return!!t&&"integerValue"in t}function Na(t){return!!t&&"arrayValue"in t}function Ra(t){return!!t&&"nullValue"in t}function Oa(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function xa(t){return!!t&&"mapValue"in t}function Ma(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ta(t.mapValue.fields,((t,n)=>e.mapValue.fields[t]=Ma(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Ma(t.arrayValue.values[n]);return e}return Object.assign({},t)}function La(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}class Pa{constructor(t){this.value=t}static empty(){return new Pa({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!xa(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Ma(e)}setAll(t){let e=zo.emptyPath(),n={},i=[];t.forEach(((t,r)=>{if(!e.isImmediateParentOf(r)){const t=this.getFieldsMap(e);this.applyChanges(t,n,i),n={},i=[],e=r.popLast()}t?n[r.lastSegment()]=Ma(t):i.push(r.lastSegment())}));const r=this.getFieldsMap(e);this.applyChanges(r,n,i)}delete(t){const e=this.field(t.popLast());xa(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Ta(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=e.mapValue.fields[t.get(n)];xa(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,n){ta(e,((e,n)=>t[e]=n));for(const e of n)delete t[e]}clone(){return new Pa(Ma(this.value))}}function Ua(t){const e=[];return ta(t.fields,((t,n)=>{const i=new zo([t]);if(xa(n)){const t=Ua(n.mapValue).fields;if(0===t.length)e.push(i);else for(const n of t)e.push(i.child(n))}else e.push(i)})),new aa(e)}class Fa{constructor(t,e,n,i,r,s){this.key=t,this.documentType=e,this.version=n,this.readTime=i,this.data=r,this.documentState=s}static newInvalidDocument(t){return new Fa(t,0,Vo.min(),Vo.min(),Pa.empty(),0)}static newFoundDocument(t,e,n){return new Fa(t,1,e,Vo.min(),n,0)}static newNoDocument(t,e){return new Fa(t,2,e,Vo.min(),Pa.empty(),0)}static newUnknownDocument(t,e){return new Fa(t,3,e,Vo.min(),Pa.empty(),2)}convertToFoundDocument(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Pa.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Pa.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Vo.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof Fa&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Fa(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Va{constructor(t,e=null,n=[],i=[],r=null,s=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=s,this.endAt=o,this.ht=null}}function Ba(t,e=null,n=[],i=[],r=null,s=null,o=null){return new Va(t,e,n,i,r,s,o)}function ja(t){const e=To(t);if(null===e.ht){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((t=>{return(e=t).field.canonicalString()+e.op.toString()+ka(e.value);var e})).join(","),t+="|ob:",t+=e.orderBy.map((t=>function(t){return t.field.canonicalString()+t.dir}(t))).join(","),va(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((t=>ka(t))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((t=>ka(t))).join(",")),e.ht=t}return e.ht}function qa(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!eu(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(n=t.filters[r],i=e.filters[r],n.op!==i.op||!n.field.isEqual(i.field)||!Ta(n.value,i.value))return!1;var n,i;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!iu(t.startAt,e.startAt)&&iu(t.endAt,e.endAt)}function za(t){return $o.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}class $a extends class{}{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.lt(t,e,n):new Ha(t,e,n):"array-contains"===e?new Qa(t,n):"in"===e?new Xa(t,n):"not-in"===e?new Ya(t,n):"array-contains-any"===e?new Ja(t,n):new $a(t,e,n)}static lt(t,e,n){return"in"===e?new Ka(t,n):new Ga(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.ft(Ea(e,this.value)):null!==e&&ba(this.value)===ba(e)&&this.ft(Ea(e,this.value))}ft(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return wo()}}dt(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class Ha extends $a{constructor(t,e,n){super(t,e,n),this.key=$o.fromName(n.referenceValue)}matches(t){const e=$o.comparator(t.key,this.key);return this.ft(e)}}class Ka extends $a{constructor(t,e){super(t,"in",e),this.keys=Wa(0,e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class Ga extends $a{constructor(t,e){super(t,"not-in",e),this.keys=Wa(0,e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function Wa(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((t=>$o.fromName(t.referenceValue)))}class Qa extends $a{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Na(e)&&Ia(e.arrayValue,this.value)}}class Xa extends $a{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&Ia(this.value.arrayValue,e)}}class Ya extends $a{constructor(t,e){super(t,"not-in",e)}matches(t){if(Ia(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!Ia(this.value.arrayValue,e)}}class Ja extends $a{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Na(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>Ia(this.value.arrayValue,t)))}}class Za{constructor(t,e){this.position=t,this.inclusive=e}}class tu{constructor(t,e="asc"){this.field=t,this.dir=e}}function eu(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function nu(t,e,n){let i=0;for(let r=0;r<t.position.length;r++){const s=e[r],o=t.position[r];if(i=s.field.isKeyField()?$o.comparator($o.fromName(o.referenceValue),n.key):Ea(o,n.data.field(s.field)),"desc"===s.dir&&(i*=-1),0!==i)break}return i}function iu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Ta(t.position[n],e.position[n]))return!1;return!0}class ru{constructor(t,e=null,n=[],i=[],r=null,s="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=i,this.limit=r,this.limitType=s,this.startAt=o,this.endAt=a,this._t=null,this.wt=null,this.startAt,this.endAt}}function su(t){return new ru(t)}function ou(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function au(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function uu(t){for(const e of t.filters)if(e.dt())return e.field;return null}function cu(t){return null!==t.collectionGroup}function hu(t){const e=To(t);if(null===e._t){e._t=[];const t=uu(e),n=au(e);if(null!==t&&null===n)t.isKeyField()||e._t.push(new tu(t)),e._t.push(new tu(zo.keyField(),"asc"));else{let t=!1;for(const n of e.explicitOrderBy)e._t.push(n),n.field.isKeyField()&&(t=!0);if(!t){const t=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e._t.push(new tu(zo.keyField(),t))}}}return e._t}function lu(t){const e=To(t);if(!e.wt)if("F"===e.limitType)e.wt=Ba(e.path,e.collectionGroup,hu(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const n of hu(e)){const e="desc"===n.dir?"asc":"desc";t.push(new tu(n.field,e))}const n=e.endAt?new Za(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new Za(e.startAt.position,e.startAt.inclusive):null;e.wt=Ba(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}return e.wt}function du(t,e,n){return new ru(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function fu(t,e){return qa(lu(t),lu(e))&&t.limitType===e.limitType}function pu(t){return`${ja(lu(t))}|lt:${t.limitType}`}function mu(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map((t=>{return`${(e=t).field.canonicalString()} ${e.op} ${ka(e.value)}`;var e})).join(", ")}]`),va(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map((t=>function(t){return`${t.field.canonicalString()} (${t.dir})`}(t))).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((t=>ka(t))).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((t=>ka(t))).join(",")),`Target(${e})`}(lu(t))}; limitType=${t.limitType})`}function gu(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):$o.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of t.explicitOrderBy)if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,n){const i=nu(t,e,n);return t.inclusive?i<=0:i<0}(t.startAt,hu(t),e)||t.endAt&&!function(t,e,n){const i=nu(t,e,n);return t.inclusive?i>=0:i>0}(t.endAt,hu(t),e))}(t,e)}function yu(t){return(e,n)=>{let i=!1;for(const r of hu(t)){const t=vu(r,e,n);if(0!==t)return t;i=i||r.field.isKeyField()}return 0}}function vu(t,e,n){const i=t.field.isKeyField()?$o.comparator(e.key,n.key):function(t,e,n){const i=e.data.field(t),r=n.data.field(t);return null!==i&&null!==r?Ea(i,r):wo()}(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return wo()}}function _u(t,e){if(t.gt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_a(e)?"-0":e}}function wu(t){return{integerValue:""+t}}function bu(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!_a(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?wu(e):_u(t,e)}class Tu{constructor(){this._=void 0}}function Iu(t,e,n){return t instanceof ku?function(t,e){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Cu?Au(t,e):t instanceof Du?Nu(t,e):function(t,e){const n=Su(t,e),i=Ou(n)+Ou(t.yt);return Da(n)&&Da(t.yt)?wu(i):_u(t.It,i)}(t,e)}function Eu(t,e,n){return t instanceof Cu?Au(t,e):t instanceof Du?Nu(t,e):n}function Su(t,e){return t instanceof Ru?Da(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}class ku extends Tu{}class Cu extends Tu{constructor(t){super(),this.elements=t}}function Au(t,e){const n=xu(e);for(const e of t.elements)n.some((t=>Ta(t,e)))||n.push(e);return{arrayValue:{values:n}}}class Du extends Tu{constructor(t){super(),this.elements=t}}function Nu(t,e){let n=xu(e);for(const e of t.elements)n=n.filter((t=>!Ta(t,e)));return{arrayValue:{values:n}}}class Ru extends Tu{constructor(t,e){super(),this.It=t,this.yt=e}}function Ou(t){return la(t.integerValue||t.doubleValue)}function xu(t){return Na(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Mu{constructor(t,e){this.version=t,this.transformResults=e}}class Lu{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Lu}static exists(t){return new Lu(void 0,t)}static updateTime(t){return new Lu(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Pu(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class Uu{}function Fu(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new Wu(t.key,Lu.none()):new zu(t.key,t.data,Lu.none());{const n=t.data,i=Pa.empty();let r=new sa(zo.comparator);for(let t of e.fields)if(!r.has(t)){let e=n.field(t);null===e&&t.length>1&&(t=t.popLast(),e=n.field(t)),null===e?i.delete(t):i.set(t,e),r=r.add(t)}return new $u(t.key,i,new aa(r.toArray()),Lu.none())}}function Vu(t,e,n){t instanceof zu?function(t,e,n){const i=t.value.clone(),r=Ku(t.fieldTransforms,e,n.transformResults);i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):t instanceof $u?function(t,e,n){if(!Pu(t.precondition,e))return void e.convertToUnknownDocument(n.version);const i=Ku(t.fieldTransforms,e,n.transformResults),r=e.data;r.setAll(Hu(t)),r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Bu(t,e,n,i){return t instanceof zu?function(t,e,n,i){if(!Pu(t.precondition,e))return n;const r=t.value.clone(),s=Gu(t.fieldTransforms,i,e);return r.setAll(s),e.convertToFoundDocument(e.version,r).setHasLocalMutations(),null}(t,e,n,i):t instanceof $u?function(t,e,n,i){if(!Pu(t.precondition,e))return n;const r=Gu(t.fieldTransforms,i,e),s=e.data;return s.setAll(Hu(t)),s.setAll(r),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),null===n?null:n.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map((t=>t.field)))}(t,e,n,i):function(t,e,n){return Pu(t.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):n}(t,e,n)}function ju(t,e){let n=null;for(const i of t.fieldTransforms){const t=e.data.field(i.field),r=Su(i.transform,t||null);null!=r&&(null===n&&(n=Pa.empty()),n.set(i.field,r))}return n||null}function qu(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Uo(t,e,((t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Cu&&e instanceof Cu||t instanceof Du&&e instanceof Du?Uo(t.elements,e.elements,Ta):t instanceof Ru&&e instanceof Ru?Ta(t.yt,e.yt):t instanceof ku&&e instanceof ku}(t.transform,e.transform)}(t,e)))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class zu extends Uu{constructor(t,e,n,i=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class $u extends Uu{constructor(t,e,n,i,r=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=i,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function Hu(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}})),e}function Ku(t,e,n){const i=new Map;bo(t.length===n.length);for(let r=0;r<n.length;r++){const s=t[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,Eu(o,a,n[r]))}return i}function Gu(t,e,n){const i=new Map;for(const r of t){const t=r.transform,s=n.data.field(r.field);i.set(r.field,Iu(t,s,e))}return i}class Wu extends Uu{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Qu extends Uu{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Xu{constructor(t){this.count=t}}var Yu,Ju;function Zu(t){if(void 0===t)return yo("GRPC error has no .code"),Io.UNKNOWN;switch(t){case Yu.OK:return Io.OK;case Yu.CANCELLED:return Io.CANCELLED;case Yu.UNKNOWN:return Io.UNKNOWN;case Yu.DEADLINE_EXCEEDED:return Io.DEADLINE_EXCEEDED;case Yu.RESOURCE_EXHAUSTED:return Io.RESOURCE_EXHAUSTED;case Yu.INTERNAL:return Io.INTERNAL;case Yu.UNAVAILABLE:return Io.UNAVAILABLE;case Yu.UNAUTHENTICATED:return Io.UNAUTHENTICATED;case Yu.INVALID_ARGUMENT:return Io.INVALID_ARGUMENT;case Yu.NOT_FOUND:return Io.NOT_FOUND;case Yu.ALREADY_EXISTS:return Io.ALREADY_EXISTS;case Yu.PERMISSION_DENIED:return Io.PERMISSION_DENIED;case Yu.FAILED_PRECONDITION:return Io.FAILED_PRECONDITION;case Yu.ABORTED:return Io.ABORTED;case Yu.OUT_OF_RANGE:return Io.OUT_OF_RANGE;case Yu.UNIMPLEMENTED:return Io.UNIMPLEMENTED;case Yu.DATA_LOSS:return Io.DATA_LOSS;default:return wo()}}(Ju=Yu||(Yu={}))[Ju.OK=0]="OK",Ju[Ju.CANCELLED=1]="CANCELLED",Ju[Ju.UNKNOWN=2]="UNKNOWN",Ju[Ju.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ju[Ju.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ju[Ju.NOT_FOUND=5]="NOT_FOUND",Ju[Ju.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ju[Ju.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ju[Ju.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ju[Ju.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ju[Ju.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ju[Ju.ABORTED=10]="ABORTED",Ju[Ju.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ju[Ju.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ju[Ju.INTERNAL=13]="INTERNAL",Ju[Ju.UNAVAILABLE=14]="UNAVAILABLE",Ju[Ju.DATA_LOSS=15]="DATA_LOSS";class tc{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[e,i]of n)if(this.equalsFn(e,t))return i}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),i=this.inner[n];if(void 0===i)return this.inner[n]=[[t,e]],void this.innerSize++;for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],t))return void(i[n]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return 1===n.length?delete this.inner[e]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(t){ta(this.inner,((e,n)=>{for(const[e,i]of n)t(e,i)}))}isEmpty(){return ea(this.inner)}size(){return this.innerSize}}const ec=new na($o.comparator);function nc(){return ec}const ic=new na($o.comparator);function rc(...t){let e=ic;for(const n of t)e=e.insert(n.key,n);return e}function sc(t){let e=ic;return t.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function oc(){return uc()}function ac(){return uc()}function uc(){return new tc((t=>t.toString()),((t,e)=>t.isEqual(e)))}const cc=new na($o.comparator),hc=new sa($o.comparator);function lc(...t){let e=hc;for(const n of t)e=e.add(n);return e}const dc=new sa(Po);function fc(){return dc}class pc{constructor(t,e,n,i,r){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(t,e,n){const i=new Map;return i.set(t,mc.createSynthesizedTargetChangeForCurrentChange(t,e,n)),new pc(Vo.min(),i,fc(),nc(),lc())}}class mc{constructor(t,e,n,i,r){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(t,e,n){return new mc(n,e,lc(),lc(),lc())}}class gc{constructor(t,e,n,i){this.Tt=t,this.removedTargetIds=e,this.key=n,this.Et=i}}class yc{constructor(t,e){this.targetId=t,this.At=e}}class vc{constructor(t,e,n=ua.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}}class _c{constructor(){this.Rt=0,this.bt=Tc(),this.Pt=ua.EMPTY_BYTE_STRING,this.vt=!1,this.Vt=!0}get current(){return this.vt}get resumeToken(){return this.Pt}get St(){return 0!==this.Rt}get Dt(){return this.Vt}Ct(t){t.approximateByteSize()>0&&(this.Vt=!0,this.Pt=t)}xt(){let t=lc(),e=lc(),n=lc();return this.bt.forEach(((i,r)=>{switch(r){case 0:t=t.add(i);break;case 2:e=e.add(i);break;case 1:n=n.add(i);break;default:wo()}})),new mc(this.Pt,this.vt,t,e,n)}Nt(){this.Vt=!1,this.bt=Tc()}kt(t,e){this.Vt=!0,this.bt=this.bt.insert(t,e)}Ot(t){this.Vt=!0,this.bt=this.bt.remove(t)}Mt(){this.Rt+=1}Ft(){this.Rt-=1}$t(){this.Vt=!0,this.vt=!0}}class wc{constructor(t){this.Bt=t,this.Lt=new Map,this.Ut=nc(),this.qt=bc(),this.Kt=new sa(Po)}Gt(t){for(const e of t.Tt)t.Et&&t.Et.isFoundDocument()?this.Qt(e,t.Et):this.jt(e,t.key,t.Et);for(const e of t.removedTargetIds)this.jt(e,t.key,t.Et)}Wt(t){this.forEachTarget(t,(e=>{const n=this.zt(e);switch(t.state){case 0:this.Ht(e)&&n.Ct(t.resumeToken);break;case 1:n.Ft(),n.St||n.Nt(),n.Ct(t.resumeToken);break;case 2:n.Ft(),n.St||this.removeTarget(e);break;case 3:this.Ht(e)&&(n.$t(),n.Ct(t.resumeToken));break;case 4:this.Ht(e)&&(this.Jt(e),n.Ct(t.resumeToken));break;default:wo()}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.Lt.forEach(((t,n)=>{this.Ht(n)&&e(n)}))}Yt(t){const e=t.targetId,n=t.At.count,i=this.Xt(e);if(i){const t=i.target;if(za(t))if(0===n){const n=new $o(t.path);this.jt(e,n,Fa.newNoDocument(n,Vo.min()))}else bo(1===n);else this.Zt(e)!==n&&(this.Jt(e),this.Kt=this.Kt.add(e))}}te(t){const e=new Map;this.Lt.forEach(((n,i)=>{const r=this.Xt(i);if(r){if(n.current&&za(r.target)){const e=new $o(r.target.path);null!==this.Ut.get(e)||this.ee(i,e)||this.jt(i,e,Fa.newNoDocument(e,t))}n.Dt&&(e.set(i,n.xt()),n.Nt())}}));let n=lc();this.qt.forEach(((t,e)=>{let i=!0;e.forEachWhile((t=>{const e=this.Xt(t);return!e||2===e.purpose||(i=!1,!1)})),i&&(n=n.add(t))})),this.Ut.forEach(((e,n)=>n.setReadTime(t)));const i=new pc(t,e,this.Kt,this.Ut,n);return this.Ut=nc(),this.qt=bc(),this.Kt=new sa(Po),i}Qt(t,e){if(!this.Ht(t))return;const n=this.ee(t,e.key)?2:0;this.zt(t).kt(e.key,n),this.Ut=this.Ut.insert(e.key,e),this.qt=this.qt.insert(e.key,this.ne(e.key).add(t))}jt(t,e,n){if(!this.Ht(t))return;const i=this.zt(t);this.ee(t,e)?i.kt(e,1):i.Ot(e),this.qt=this.qt.insert(e,this.ne(e).delete(t)),n&&(this.Ut=this.Ut.insert(e,n))}removeTarget(t){this.Lt.delete(t)}Zt(t){const e=this.zt(t).xt();return this.Bt.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Mt(t){this.zt(t).Mt()}zt(t){let e=this.Lt.get(t);return e||(e=new _c,this.Lt.set(t,e)),e}ne(t){let e=this.qt.get(t);return e||(e=new sa(Po),this.qt=this.qt.insert(t,e)),e}Ht(t){const e=null!==this.Xt(t);return e||go("WatchChangeAggregator","Detected inactive target",t),e}Xt(t){const e=this.Lt.get(t);return e&&e.St?null:this.Bt.se(t)}Jt(t){this.Lt.set(t,new _c),this.Bt.getRemoteKeysForTarget(t).forEach((e=>{this.jt(t,e,null)}))}ee(t,e){return this.Bt.getRemoteKeysForTarget(t).has(e)}}function bc(){return new na($o.comparator)}function Tc(){return new na($o.comparator)}const Ic={asc:"ASCENDING",desc:"DESCENDING"},Ec={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class Sc{constructor(t,e){this.databaseId=t,this.gt=e}}function kc(t,e){return t.gt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Cc(t,e){return t.gt?e.toBase64():e.toUint8Array()}function Ac(t,e){return kc(t,e.toTimestamp())}function Dc(t){return bo(!!t),Vo.fromTimestamp(function(t){const e=ha(t);return new Fo(e.seconds,e.nanos)}(t))}function Nc(t,e){return function(t){return new jo(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function Rc(t){const e=jo.fromString(t);return bo(Qc(e)),e}function Oc(t,e){return Nc(t.databaseId,e.path)}function xc(t,e){const n=Rc(e);if(n.get(1)!==t.databaseId.projectId)throw new Eo(Io.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Eo(Io.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new $o(Pc(n))}function Mc(t,e){return Nc(t.databaseId,e)}function Lc(t){return new jo(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Pc(t){return bo(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function Uc(t,e,n){return{name:Oc(t,e),fields:n.value.mapValue.fields}}function Fc(t,e){return{documents:[Mc(t,e.path)]}}function Vc(t,e){const n={structuredQuery:{}},i=e.path;null!==e.collectionGroup?(n.parent=Mc(t,i),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Mc(t,i.popLast()),n.structuredQuery.from=[{collectionId:i.lastSegment()}]);const r=function(t){if(0===t.length)return;const e=t.map((t=>function(t){if("=="===t.op){if(Oa(t.value))return{unaryFilter:{field:$c(t.field),op:"IS_NAN"}};if(Ra(t.value))return{unaryFilter:{field:$c(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Oa(t.value))return{unaryFilter:{field:$c(t.field),op:"IS_NOT_NAN"}};if(Ra(t.value))return{unaryFilter:{field:$c(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:$c(t.field),op:zc(t.op),value:t.value}}}(t)));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}(e.filters);r&&(n.structuredQuery.where=r);const s=function(t){if(0!==t.length)return t.map((t=>function(t){return{field:$c(t.field),direction:qc(t.dir)}}(t)))}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const o=function(t,e){return t.gt||va(e)?e:{value:e}}(t,e.limit);var a;return null!==o&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(n.structuredQuery.endAt=function(t){return{before:!t.inclusive,values:t.position}}(e.endAt)),n}function Bc(t){let e=function(t){const e=Rc(t);return 4===e.length?jo.emptyPath():Pc(e)}(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){bo(1===i);const t=n.from[0];t.allDescendants?r=t.collectionId:e=e.child(t.collectionId)}let s=[];n.where&&(s=jc(n.where));let o=[];n.orderBy&&(o=n.orderBy.map((t=>function(t){return new tu(Hc(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t))));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,va(e)?null:e}(n.limit));let u=null;n.startAt&&(u=function(t){const e=!!t.before,n=t.values||[];return new Za(n,e)}(n.startAt));let c=null;return n.endAt&&(c=function(t){const e=!t.before,n=t.values||[];return new Za(n,e)}(n.endAt)),function(t,e,n,i,r,s,o,a){return new ru(t,e,n,i,r,s,o,a)}(e,r,o,s,a,"F",u,c)}function jc(t){return t?void 0!==t.unaryFilter?[Gc(t)]:void 0!==t.fieldFilter?[Kc(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((t=>jc(t))).reduce(((t,e)=>t.concat(e))):wo():[]}function qc(t){return Ic[t]}function zc(t){return Ec[t]}function $c(t){return{fieldPath:t.canonicalString()}}function Hc(t){return zo.fromServerFormat(t.fieldPath)}function Kc(t){return $a.create(Hc(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return wo()}}(t.fieldFilter.op),t.fieldFilter.value)}function Gc(t){switch(t.unaryFilter.op){case"IS_NAN":const e=Hc(t.unaryFilter.field);return $a.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=Hc(t.unaryFilter.field);return $a.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Hc(t.unaryFilter.field);return $a.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=Hc(t.unaryFilter.field);return $a.create(r,"!=",{nullValue:"NULL_VALUE"});default:return wo()}}function Wc(t){const e=[];return t.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Qc(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}class Xc{constructor(t,e,n,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let e=0;e<this.mutations.length;e++){const i=this.mutations[e];i.key.isEqual(t.key)&&Vu(i,t,n[e])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=Bu(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=Bu(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=ac();return this.mutations.forEach((i=>{const r=t.get(i.key),s=r.overlayedDocument;let o=this.applyToLocalView(s,r.mutatedFields);o=e.has(i.key)?null:o;const a=Fu(s,o);null!==a&&n.set(i.key,a),s.isValidDocument()||s.convertToNoDocument(Vo.min())})),n}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),lc())}isEqual(t){return this.batchId===t.batchId&&Uo(this.mutations,t.mutations,((t,e)=>qu(t,e)))&&Uo(this.baseMutations,t.baseMutations,((t,e)=>qu(t,e)))}}class Yc{constructor(t,e,n,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=i}static from(t,e,n){bo(t.mutations.length===n.length);let i=cc;const r=t.mutations;for(let t=0;t<r.length;t++)i=i.insert(r[t].key,n[t].version);return new Yc(t,e,n,i)}}class Jc{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Zc{constructor(t,e,n,i,r=Vo.min(),s=Vo.min(),o=ua.EMPTY_BYTE_STRING){this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o}withSequenceNumber(t){return new Zc(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(t,e){return new Zc(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)}withLastLimboFreeSnapshotVersion(t){return new Zc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}class th{constructor(t){this.re=t}}function eh(t){const e=Bc({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?du(e,e.limit,"L"):e}class nh{constructor(){}ce(t,e){this.ae(t,e),e.he()}ae(t,e){if("nullValue"in t)this.le(e,5);else if("booleanValue"in t)this.le(e,10),e.fe(t.booleanValue?1:0);else if("integerValue"in t)this.le(e,15),e.fe(la(t.integerValue));else if("doubleValue"in t){const n=la(t.doubleValue);isNaN(n)?this.le(e,13):(this.le(e,15),_a(n)?e.fe(0):e.fe(n))}else if("timestampValue"in t){const n=t.timestampValue;this.le(e,20),"string"==typeof n?e.de(n):(e.de(`${n.seconds||""}`),e.fe(n.nanos||0))}else if("stringValue"in t)this._e(t.stringValue,e),this.we(e);else if("bytesValue"in t)this.le(e,30),e.me(da(t.bytesValue)),this.we(e);else if("referenceValue"in t)this.ge(t.referenceValue,e);else if("geoPointValue"in t){const n=t.geoPointValue;this.le(e,45),e.fe(n.latitude||0),e.fe(n.longitude||0)}else"mapValue"in t?La(t)?this.le(e,Number.MAX_SAFE_INTEGER):(this.ye(t.mapValue,e),this.we(e)):"arrayValue"in t?(this.pe(t.arrayValue,e),this.we(e)):wo()}_e(t,e){this.le(e,25),this.Ie(t,e)}Ie(t,e){e.de(t)}ye(t,e){const n=t.fields||{};this.le(e,55);for(const t of Object.keys(n))this._e(t,e),this.ae(n[t],e)}pe(t,e){const n=t.values||[];this.le(e,50);for(const t of n)this.ae(t,e)}ge(t,e){this.le(e,37),$o.fromName(t).path.forEach((t=>{this.le(e,60),this.Ie(t,e)}))}le(t,e){t.fe(e)}we(t){t.fe(2)}}nh.Te=new nh;class ih{constructor(){this.Ye=new rh}addToCollectionParentIndex(t,e){return this.Ye.add(e),Xo.resolve()}getCollectionParents(t,e){return Xo.resolve(this.Ye.getEntries(e))}addFieldIndex(t,e){return Xo.resolve()}deleteFieldIndex(t,e){return Xo.resolve()}getDocumentsMatchingTarget(t,e){return Xo.resolve(null)}getIndexType(t,e){return Xo.resolve(0)}getFieldIndexes(t,e){return Xo.resolve([])}getNextCollectionGroupToUpdate(t){return Xo.resolve(null)}getMinOffset(t,e){return Xo.resolve(Ko.min())}getMinOffsetFromCollectionGroup(t,e){return Xo.resolve(Ko.min())}updateCollectionGroup(t,e,n){return Xo.resolve()}updateIndexEntries(t,e){return Xo.resolve()}}class rh{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e]||new sa(jo.comparator),r=!i.has(n);return this.index[e]=i.add(n),r}has(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e];return i&&i.has(n)}getEntries(t){return(this.index[t]||new sa(jo.comparator)).toArray()}}new Uint8Array(0);class sh{constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}static withCacheSize(t){return new sh(t,sh.DEFAULT_COLLECTION_PERCENTILE,sh.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}sh.DEFAULT_COLLECTION_PERCENTILE=10,sh.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,sh.DEFAULT=new sh(41943040,sh.DEFAULT_COLLECTION_PERCENTILE,sh.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),sh.DISABLED=new sh(-1,0,0);class oh{constructor(t){this.bn=t}next(){return this.bn+=2,this.bn}static Pn(){return new oh(0)}static vn(){return new oh(-1)}}class ah{constructor(){this.changes=new tc((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Fa.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?Xo.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class uh{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class ch{constructor(t,e,n,i){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=i}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next((i=>(n=i,this.getBaseDocument(t,e,n)))).next((t=>(null!==n&&Bu(n.mutation,t,aa.empty(),Fo.now()),t)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.getLocalViewOfDocuments(t,e,lc()).next((()=>e))))}getLocalViewOfDocuments(t,e,n=lc()){const i=oc();return this.populateOverlays(t,i,e).next((()=>this.computeViews(t,e,i,n).next((t=>{let e=rc();return t.forEach(((t,n)=>{e=e.insert(t,n.overlayedDocument)})),e}))))}getOverlayedDocuments(t,e){const n=oc();return this.populateOverlays(t,n,e).next((()=>this.computeViews(t,e,n,lc())))}populateOverlays(t,e,n){const i=[];return n.forEach((t=>{e.has(t)||i.push(t)})),this.documentOverlayCache.getOverlays(t,i).next((t=>{t.forEach(((t,n)=>{e.set(t,n)}))}))}computeViews(t,e,n,i){let r=nc();const s=uc(),o=uc();return e.forEach(((t,e)=>{const o=n.get(e.key);i.has(e.key)&&(void 0===o||o.mutation instanceof $u)?r=r.insert(e.key,e):void 0!==o&&(s.set(e.key,o.mutation.getFieldMask()),Bu(o.mutation,e,o.mutation.getFieldMask(),Fo.now()))})),this.recalculateAndSaveOverlays(t,r).next((t=>(t.forEach(((t,e)=>s.set(t,e))),e.forEach(((t,e)=>{var n;return o.set(t,new uh(e,null!==(n=s.get(t))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(t,e){const n=uc();let i=new na(((t,e)=>t-e)),r=lc();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((t=>{for(const r of t)r.keys().forEach((t=>{const s=e.get(t);if(null===s)return;let o=n.get(t)||aa.empty();o=r.applyToLocalView(s,o),n.set(t,o);const a=(i.get(r.batchId)||lc()).add(t);i=i.insert(r.batchId,a)}))})).next((()=>{const s=[],o=i.getReverseIterator();for(;o.hasNext();){const i=o.getNext(),a=i.key,u=i.value,c=ac();u.forEach((t=>{if(!r.has(t)){const i=Fu(e.get(t),n.get(t));null!==i&&c.set(t,i),r=r.add(t)}})),s.push(this.documentOverlayCache.saveOverlays(t,a,c))}return Xo.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.recalculateAndSaveOverlays(t,e)))}getDocumentsMatchingQuery(t,e,n){return function(t){return $o.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):cu(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n):this.getDocumentsMatchingCollectionQuery(t,e,n)}getNextDocuments(t,e,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,i).next((r=>{const s=i-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,i-r.size):Xo.resolve(oc());let o=-1,a=r;return s.next((e=>Xo.forEach(e,((e,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),r.get(e)?Xo.resolve():this.getBaseDocument(t,e,n).next((t=>{a=a.insert(e,t)}))))).next((()=>this.populateOverlays(t,e,r))).next((()=>this.computeViews(t,a,e,lc()))).next((t=>({batchId:o,changes:sc(t)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new $o(e)).next((t=>{let e=rc();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}getDocumentsMatchingCollectionGroupQuery(t,e,n){const i=e.collectionGroup;let r=rc();return this.indexManager.getCollectionParents(t,i).next((s=>Xo.forEach(s,(s=>{const o=function(t,e){return new ru(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return this.getDocumentsMatchingCollectionQuery(t,o,n).next((t=>{t.forEach(((t,e)=>{r=r.insert(t,e)}))}))})).next((()=>r))))}getDocumentsMatchingCollectionQuery(t,e,n){let i;return this.remoteDocumentCache.getAllFromCollection(t,e.path,n).next((r=>(i=r,this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId)))).next((t=>{t.forEach(((t,e)=>{const n=e.getKey();null===i.get(n)&&(i=i.insert(n,Fa.newInvalidDocument(n)))}));let n=rc();return i.forEach(((i,r)=>{const s=t.get(i);void 0!==s&&Bu(s.mutation,r,aa.empty(),Fo.now()),gu(e,r)&&(n=n.insert(i,r))})),n}))}getBaseDocument(t,e,n){return null===n||1===n.mutation.type?this.remoteDocumentCache.getEntry(t,e):Xo.resolve(Fa.newInvalidDocument(e))}}class hh{constructor(t){this.It=t,this.Zn=new Map,this.ts=new Map}getBundleMetadata(t,e){return Xo.resolve(this.Zn.get(e))}saveBundleMetadata(t,e){var n;return this.Zn.set(e.id,{id:(n=e).id,version:n.version,createTime:Dc(n.createTime)}),Xo.resolve()}getNamedQuery(t,e){return Xo.resolve(this.ts.get(e))}saveNamedQuery(t,e){return this.ts.set(e.name,function(t){return{name:t.name,query:eh(t.bundledQuery),readTime:Dc(t.readTime)}}(e)),Xo.resolve()}}class lh{constructor(){this.overlays=new na($o.comparator),this.es=new Map}getOverlay(t,e){return Xo.resolve(this.overlays.get(e))}getOverlays(t,e){const n=oc();return Xo.forEach(e,(e=>this.getOverlay(t,e).next((t=>{null!==t&&n.set(e,t)})))).next((()=>n))}saveOverlays(t,e,n){return n.forEach(((n,i)=>{this.ue(t,e,i)})),Xo.resolve()}removeOverlaysForBatchId(t,e,n){const i=this.es.get(n);return void 0!==i&&(i.forEach((t=>this.overlays=this.overlays.remove(t))),this.es.delete(n)),Xo.resolve()}getOverlaysForCollection(t,e,n){const i=oc(),r=e.length+1,s=new $o(e.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const t=o.getNext().value,s=t.getKey();if(!e.isPrefixOf(s.path))break;s.path.length===r&&t.largestBatchId>n&&i.set(t.getKey(),t)}return Xo.resolve(i)}getOverlaysForCollectionGroup(t,e,n,i){let r=new na(((t,e)=>t-e));const s=this.overlays.getIterator();for(;s.hasNext();){const t=s.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=r.get(t.largestBatchId);null===e&&(e=oc(),r=r.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const o=oc(),a=r.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((t,e)=>o.set(t,e))),!(o.size()>=i)););return Xo.resolve(o)}ue(t,e,n){const i=this.overlays.get(n.key);if(null!==i){const t=this.es.get(i.largestBatchId).delete(n.key);this.es.set(i.largestBatchId,t)}this.overlays=this.overlays.insert(n.key,new Jc(e,n));let r=this.es.get(e);void 0===r&&(r=lc(),this.es.set(e,r)),this.es.set(e,r.add(n.key))}}class dh{constructor(){this.ns=new sa(fh.ss),this.rs=new sa(fh.os)}isEmpty(){return this.ns.isEmpty()}addReference(t,e){const n=new fh(t,e);this.ns=this.ns.add(n),this.rs=this.rs.add(n)}us(t,e){t.forEach((t=>this.addReference(t,e)))}removeReference(t,e){this.cs(new fh(t,e))}hs(t,e){t.forEach((t=>this.removeReference(t,e)))}ls(t){const e=new $o(new jo([])),n=new fh(e,t),i=new fh(e,t+1),r=[];return this.rs.forEachInRange([n,i],(t=>{this.cs(t),r.push(t.key)})),r}fs(){this.ns.forEach((t=>this.cs(t)))}cs(t){this.ns=this.ns.delete(t),this.rs=this.rs.delete(t)}ds(t){const e=new $o(new jo([])),n=new fh(e,t),i=new fh(e,t+1);let r=lc();return this.rs.forEachInRange([n,i],(t=>{r=r.add(t.key)})),r}containsKey(t){const e=new fh(t,0),n=this.ns.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class fh{constructor(t,e){this.key=t,this._s=e}static ss(t,e){return $o.comparator(t.key,e.key)||Po(t._s,e._s)}static os(t,e){return Po(t._s,e._s)||$o.comparator(t.key,e.key)}}class ph{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.ws=1,this.gs=new sa(fh.ss)}checkEmpty(t){return Xo.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,n,i){const r=this.ws;this.ws++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new Xc(r,e,n,i);this.mutationQueue.push(s);for(const e of i)this.gs=this.gs.add(new fh(e.key,r)),this.indexManager.addToCollectionParentIndex(t,e.key.path.popLast());return Xo.resolve(s)}lookupMutationBatch(t,e){return Xo.resolve(this.ys(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,i=this.ps(n),r=i<0?0:i;return Xo.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return Xo.resolve(0===this.mutationQueue.length?-1:this.ws-1)}getAllMutationBatches(t){return Xo.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new fh(e,0),i=new fh(e,Number.POSITIVE_INFINITY),r=[];return this.gs.forEachInRange([n,i],(t=>{const e=this.ys(t._s);r.push(e)})),Xo.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new sa(Po);return e.forEach((t=>{const e=new fh(t,0),i=new fh(t,Number.POSITIVE_INFINITY);this.gs.forEachInRange([e,i],(t=>{n=n.add(t._s)}))})),Xo.resolve(this.Is(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,i=n.length+1;let r=n;$o.isDocumentKey(r)||(r=r.child(""));const s=new fh(new $o(r),0);let o=new sa(Po);return this.gs.forEachWhile((t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===i&&(o=o.add(t._s)),!0)}),s),Xo.resolve(this.Is(o))}Is(t){const e=[];return t.forEach((t=>{const n=this.ys(t);null!==n&&e.push(n)})),e}removeMutationBatch(t,e){bo(0===this.Ts(e.batchId,"removed")),this.mutationQueue.shift();let n=this.gs;return Xo.forEach(e.mutations,(i=>{const r=new fh(i.key,e.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((()=>{this.gs=n}))}An(t){}containsKey(t,e){const n=new fh(e,0),i=this.gs.firstAfterOrEqual(n);return Xo.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,Xo.resolve()}Ts(t,e){return this.ps(t)}ps(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}ys(t){const e=this.ps(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class mh{constructor(t){this.Es=t,this.docs=new na($o.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,i=this.docs.get(n),r=i?i.size:0,s=this.Es(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:s}),this.size+=s-r,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return Xo.resolve(n?n.document.mutableCopy():Fa.newInvalidDocument(e))}getEntries(t,e){let n=nc();return e.forEach((t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():Fa.newInvalidDocument(t))})),Xo.resolve(n)}getAllFromCollection(t,e,n){let i=nc();const r=new $o(e.child("")),s=this.docs.getIteratorFrom(r);for(;s.hasNext();){const{key:t,value:{document:r}}=s.getNext();if(!e.isPrefixOf(t.path))break;t.path.length>e.length+1||Go(Ho(r),n)<=0||(i=i.insert(r.key,r.mutableCopy()))}return Xo.resolve(i)}getAllFromCollectionGroup(t,e,n,i){wo()}As(t,e){return Xo.forEach(this.docs,(t=>e(t)))}newChangeBuffer(t){return new gh(this)}getSize(t){return Xo.resolve(this.size)}}class gh extends ah{constructor(t){super(),this.Yn=t}applyChanges(t){const e=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?e.push(this.Yn.addEntry(t,i)):this.Yn.removeEntry(n)})),Xo.waitFor(e)}getFromCache(t,e){return this.Yn.getEntry(t,e)}getAllFromCache(t,e){return this.Yn.getEntries(t,e)}}class yh{constructor(t){this.persistence=t,this.Rs=new tc((t=>ja(t)),qa),this.lastRemoteSnapshotVersion=Vo.min(),this.highestTargetId=0,this.bs=0,this.Ps=new dh,this.targetCount=0,this.vs=oh.Pn()}forEachTarget(t,e){return this.Rs.forEach(((t,n)=>e(n))),Xo.resolve()}getLastRemoteSnapshotVersion(t){return Xo.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return Xo.resolve(this.bs)}allocateTargetId(t){return this.highestTargetId=this.vs.next(),Xo.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.bs&&(this.bs=e),Xo.resolve()}Dn(t){this.Rs.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.vs=new oh(e),this.highestTargetId=e),t.sequenceNumber>this.bs&&(this.bs=t.sequenceNumber)}addTargetData(t,e){return this.Dn(e),this.targetCount+=1,Xo.resolve()}updateTargetData(t,e){return this.Dn(e),Xo.resolve()}removeTargetData(t,e){return this.Rs.delete(e.target),this.Ps.ls(e.targetId),this.targetCount-=1,Xo.resolve()}removeTargets(t,e,n){let i=0;const r=[];return this.Rs.forEach(((s,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.Rs.delete(s),r.push(this.removeMatchingKeysForTargetId(t,o.targetId)),i++)})),Xo.waitFor(r).next((()=>i))}getTargetCount(t){return Xo.resolve(this.targetCount)}getTargetData(t,e){const n=this.Rs.get(e)||null;return Xo.resolve(n)}addMatchingKeys(t,e,n){return this.Ps.us(e,n),Xo.resolve()}removeMatchingKeys(t,e,n){this.Ps.hs(e,n);const i=this.persistence.referenceDelegate,r=[];return i&&e.forEach((e=>{r.push(i.markPotentiallyOrphaned(t,e))})),Xo.waitFor(r)}removeMatchingKeysForTargetId(t,e){return this.Ps.ls(e),Xo.resolve()}getMatchingKeysForTargetId(t,e){const n=this.Ps.ds(e);return Xo.resolve(n)}containsKey(t,e){return Xo.resolve(this.Ps.containsKey(e))}}class vh{constructor(t,e){this.Vs={},this.overlays={},this.Ss=new Jo(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=t(this),this.Cs=new yh(this),this.indexManager=new ih,this.remoteDocumentCache=function(t){return new mh(t)}((t=>this.referenceDelegate.xs(t))),this.It=new th(e),this.Ns=new hh(this.It)}start(){return Promise.resolve()}shutdown(){return this.Ds=!1,Promise.resolve()}get started(){return this.Ds}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new lh,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.Vs[t.toKey()];return n||(n=new ph(e,this.referenceDelegate),this.Vs[t.toKey()]=n),n}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ns}runTransaction(t,e,n){go("MemoryPersistence","Starting transaction:",t);const i=new _h(this.Ss.next());return this.referenceDelegate.ks(),n(i).next((t=>this.referenceDelegate.Os(i).next((()=>t)))).toPromise().then((t=>(i.raiseOnCommittedEvent(),t)))}Ms(t,e){return Xo.or(Object.values(this.Vs).map((n=>()=>n.containsKey(t,e))))}}class _h extends Wo{constructor(t){super(),this.currentSequenceNumber=t}}class wh{constructor(t){this.persistence=t,this.Fs=new dh,this.$s=null}static Bs(t){return new wh(t)}get Ls(){if(this.$s)return this.$s;throw wo()}addReference(t,e,n){return this.Fs.addReference(n,e),this.Ls.delete(n.toString()),Xo.resolve()}removeReference(t,e,n){return this.Fs.removeReference(n,e),this.Ls.add(n.toString()),Xo.resolve()}markPotentiallyOrphaned(t,e){return this.Ls.add(e.toString()),Xo.resolve()}removeTarget(t,e){this.Fs.ls(e.targetId).forEach((t=>this.Ls.add(t.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((t=>{t.forEach((t=>this.Ls.add(t.toString())))})).next((()=>n.removeTargetData(t,e)))}ks(){this.$s=new Set}Os(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Xo.forEach(this.Ls,(n=>{const i=$o.fromPath(n);return this.Us(t,i).next((t=>{t||e.removeEntry(i,Vo.min())}))})).next((()=>(this.$s=null,e.apply(t))))}updateLimboDocument(t,e){return this.Us(t,e).next((t=>{t?this.Ls.delete(e.toString()):this.Ls.add(e.toString())}))}xs(t){return 0}Us(t,e){return Xo.or([()=>Xo.resolve(this.Fs.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ms(t,e)])}}class bh{constructor(t,e,n,i){this.targetId=t,this.fromCache=e,this.Si=n,this.Di=i}static Ci(t,e){let n=lc(),i=lc();for(const t of e.docChanges)switch(t.type){case 0:n=n.add(t.doc.key);break;case 1:i=i.add(t.doc.key)}return new bh(t,e.fromCache,n,i)}}class Th{constructor(){this.xi=!1}initialize(t,e){this.Ni=t,this.indexManager=e,this.xi=!0}getDocumentsMatchingQuery(t,e,n,i){return this.ki(t,e).next((r=>r||this.Oi(t,e,i,n))).next((n=>n||this.Mi(t,e)))}ki(t,e){if(ou(e))return Xo.resolve(null);let n=lu(e);return this.indexManager.getIndexType(t,n).next((i=>0===i?null:(null!==e.limit&&1===i&&(e=du(e,null,"F"),n=lu(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next((i=>{const r=lc(...i);return this.Ni.getDocuments(t,r).next((i=>this.indexManager.getMinOffset(t,n).next((n=>{const s=this.Fi(e,i);return this.$i(e,s,r,n.readTime)?this.ki(t,du(e,null,"F")):this.Bi(t,s,e,n)}))))})))))}Oi(t,e,n,i){return ou(e)||i.isEqual(Vo.min())?this.Mi(t,e):this.Ni.getDocuments(t,n).next((r=>{const s=this.Fi(e,r);return this.$i(e,s,n,i)?this.Mi(t,e):(mo()<=N.DEBUG&&go("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),mu(e)),this.Bi(t,s,e,function(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,r=Vo.fromTimestamp(1e9===i?new Fo(n+1,0):new Fo(n,i));return new Ko(r,$o.empty(),e)}(i,-1)))}))}Fi(t,e){let n=new sa(yu(t));return e.forEach(((e,i)=>{gu(t,i)&&(n=n.add(i))})),n}$i(t,e,n,i){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const r="F"===t.limitType?e.last():e.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}Mi(t,e){return mo()<=N.DEBUG&&go("QueryEngine","Using full collection scan to execute query:",mu(e)),this.Ni.getDocumentsMatchingQuery(t,e,Ko.min())}Bi(t,e,n,i){return this.Ni.getDocumentsMatchingQuery(t,n,i).next((t=>(e.forEach((e=>{t=t.insert(e.key,e)})),t)))}}class Ih{constructor(t,e,n,i){this.persistence=t,this.Li=e,this.It=i,this.Ui=new na(Po),this.qi=new tc((t=>ja(t)),qa),this.Ki=new Map,this.Gi=t.getRemoteDocumentCache(),this.Cs=t.getTargetCache(),this.Ns=t.getBundleCache(),this.Qi(n)}Qi(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new ch(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.Ui)))}}async function Eh(t,e){const n=To(t);return await n.persistence.runTransaction("Handle user change","readonly",(t=>{let i;return n.mutationQueue.getAllMutationBatches(t).next((r=>(i=r,n.Qi(e),n.mutationQueue.getAllMutationBatches(t)))).next((e=>{const r=[],s=[];let o=lc();for(const t of i){r.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){s.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return n.localDocuments.getDocuments(t,o).next((t=>({ji:t,removedBatchIds:r,addedBatchIds:s})))}))}))}function Sh(t){const e=To(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Cs.getLastRemoteSnapshotVersion(t)))}function kh(t,e){const n=To(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(t=>(void 0===e&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(t,e))))}async function Ch(t,e,n){const i=To(t),r=i.Ui.get(e),s=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",s,(t=>i.persistence.referenceDelegate.removeTarget(t,r)))}catch(t){if(!Yo(t))throw t;go("LocalStore",`Failed to update sequence numbers for target ${e}: ${t}`)}i.Ui=i.Ui.remove(e),i.qi.delete(r.target)}function Ah(t,e,n){const i=To(t);let r=Vo.min(),s=lc();return i.persistence.runTransaction("Execute query","readonly",(t=>function(t,e,n){const i=To(t),r=i.qi.get(n);return void 0!==r?Xo.resolve(i.Ui.get(r)):i.Cs.getTargetData(e,n)}(i,t,lu(e)).next((e=>{if(e)return r=e.lastLimboFreeSnapshotVersion,i.Cs.getMatchingKeysForTargetId(t,e.targetId).next((t=>{s=t}))})).next((()=>i.Li.getDocumentsMatchingQuery(t,e,n?r:Vo.min(),n?s:lc()))).next((t=>(function(t,e,n){let i=t.Ki.get(e)||Vo.min();n.forEach(((t,e)=>{e.readTime.compareTo(i)>0&&(i=e.readTime)})),t.Ki.set(e,i)}(i,function(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}(e),t),{documents:t,Hi:s})))))}class Dh{constructor(){this.activeTargetIds=fc()}er(t){this.activeTargetIds=this.activeTargetIds.add(t)}nr(t){this.activeTargetIds=this.activeTargetIds.delete(t)}tr(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Nh{constructor(){this.Lr=new Dh,this.Ur={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return this.Lr.er(t),this.Ur[t]||"not-current"}updateQueryState(t,e,n){this.Ur[t]=e}removeLocalQueryTarget(t){this.Lr.nr(t)}isLocalQueryTarget(t){return this.Lr.activeTargetIds.has(t)}clearQueryState(t){delete this.Ur[t]}getAllActiveQueryTargets(){return this.Lr.activeTargetIds}isActiveQueryTarget(t){return this.Lr.activeTargetIds.has(t)}start(){return this.Lr=new Dh,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class Rh{qr(t){}shutdown(){}}class Oh{constructor(){this.Kr=()=>this.Gr(),this.Qr=()=>this.jr(),this.Wr=[],this.zr()}qr(t){this.Wr.push(t)}shutdown(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}zr(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}Gr(){go("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.Wr)t(0)}jr(){go("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.Wr)t(1)}static C(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const xh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Mh{constructor(t){this.Hr=t.Hr,this.Jr=t.Jr}Yr(t){this.Xr=t}Zr(t){this.eo=t}onMessage(t){this.no=t}close(){this.Jr()}send(t){this.Hr(t)}so(){this.Xr()}io(t){this.eo(t)}ro(t){this.no(t)}}class Lh extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http";this.oo=e+"://"+t.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get co(){return!1}ao(t,e,n,i,r){const s=this.ho(t,e);go("RestConnection","Sending: ",s,n);const o={};return this.lo(o,i,r),this.fo(t,s,o,n).then((t=>(go("RestConnection","Received: ",t),t)),(e=>{throw vo("RestConnection",`${t} failed with error: `,e,"url: ",s,"request:",n),e}))}_o(t,e,n,i,r,s){return this.ao(t,e,n,i,r)}lo(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+fo,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((e,n)=>t[n]=e)),n&&n.headers.forEach(((e,n)=>t[n]=e))}ho(t,e){const n=xh[t];return`${this.oo}/v1/${e}:${n}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams}fo(t,e,n,i){return new Promise(((r,s)=>{const o=new co;o.setWithCredentials(!0),o.listenOnce(ro.COMPLETE,(()=>{var e;try{switch(o.getLastErrorCode()){case io.NO_ERROR:const n=o.getResponseJson();go("Connection","XHR received:",JSON.stringify(n)),r(n);break;case io.TIMEOUT:go("Connection",'RPC "'+t+'" timed out'),s(new Eo(Io.DEADLINE_EXCEEDED,"Request time out"));break;case io.HTTP_ERROR:const i=o.getStatus();if(go("Connection",'RPC "'+t+'" failed with status:',i,"response text:",o.getResponseText()),i>0){let t=o.getResponseJson();Array.isArray(t)&&(t=t[0]);const n=null===(e=t)||void 0===e?void 0:e.error;if(n&&n.status&&n.message){const t=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(Io).indexOf(e)>=0?e:Io.UNKNOWN}(n.status);s(new Eo(t,n.message))}else s(new Eo(Io.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new Eo(Io.UNAVAILABLE,"Connection failed."));break;default:wo()}}finally{go("Connection",'RPC "'+t+'" completed.')}}));const a=JSON.stringify(i);o.send(e,"POST",a,n,15)}))}wo(t,e,n){const i=[this.oo,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=eo(),s=no(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new ao({})),this.lo(o.initMessageHeaders,e,n),o.encodeInitMessageHeaders=!0;const a=i.join("");go("Connection","Creating WebChannel: "+a,o);const u=r.createWebChannel(a,o);let c=!1,h=!1;const l=new Mh({Hr:t=>{h?go("Connection","Not sending because WebChannel is closed:",t):(c||(go("Connection","Opening WebChannel transport."),u.open(),c=!0),go("Connection","WebChannel sending:",t),u.send(t))},Jr:()=>u.close()}),d=(t,e,n)=>{t.listen(e,(t=>{try{n(t)}catch(t){setTimeout((()=>{throw t}),0)}}))};return d(u,uo.EventType.OPEN,(()=>{h||go("Connection","WebChannel transport opened.")})),d(u,uo.EventType.CLOSE,(()=>{h||(h=!0,go("Connection","WebChannel transport closed"),l.io())})),d(u,uo.EventType.ERROR,(t=>{h||(h=!0,vo("Connection","WebChannel transport errored:",t),l.io(new Eo(Io.UNAVAILABLE,"The operation could not be completed")))})),d(u,uo.EventType.MESSAGE,(t=>{var e;if(!h){const n=t.data[0];bo(!!n);const i=n,r=i.error||(null===(e=i[0])||void 0===e?void 0:e.error);if(r){go("Connection","WebChannel received error:",r);const t=r.status;let e=function(t){const e=Yu[t];if(void 0!==e)return Zu(e)}(t),n=r.message;void 0===e&&(e=Io.INTERNAL,n="Unknown error status: "+t+" with message "+r.message),h=!0,l.io(new Eo(e,n)),u.close()}else go("Connection","WebChannel received:",n),l.ro(n)}})),d(s,so.STAT_EVENT,(t=>{t.stat===oo.PROXY?go("Connection","Detected buffering proxy"):t.stat===oo.NOPROXY&&go("Connection","Detected no buffering proxy")})),setTimeout((()=>{l.so()}),0),l}}function Ph(){return"undefined"!=typeof document?document:null}function Uh(t){return new Sc(t,!0)}class Fh{constructor(t,e,n=1e3,i=1.5,r=6e4){this.Hs=t,this.timerId=e,this.mo=n,this.yo=i,this.po=r,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}reset(){this.Io=0}Ao(){this.Io=this.po}Ro(t){this.cancel();const e=Math.floor(this.Io+this.bo()),n=Math.max(0,Date.now()-this.Eo),i=Math.max(0,e-n);i>0&&go("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Io} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.To=this.Hs.enqueueAfterDelay(this.timerId,i,(()=>(this.Eo=Date.now(),t()))),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}Po(){null!==this.To&&(this.To.skipDelay(),this.To=null)}cancel(){null!==this.To&&(this.To.cancel(),this.To=null)}bo(){return(Math.random()-.5)*this.Io}}class Vh{constructor(t,e,n,i,r,s,o,a){this.Hs=t,this.vo=n,this.Vo=i,this.connection=r,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new Fh(t,e)}No(){return 1===this.state||5===this.state||this.ko()}ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Oo()}async stop(){this.No()&&await this.close(0)}Mo(){this.state=0,this.xo.reset()}Fo(){this.ko()&&null===this.Do&&(this.Do=this.Hs.enqueueAfterDelay(this.vo,6e4,(()=>this.$o())))}Bo(t){this.Lo(),this.stream.send(t)}async $o(){if(this.ko())return this.close(0)}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}Uo(){this.Co&&(this.Co.cancel(),this.Co=null)}async close(t,e){this.Lo(),this.Uo(),this.xo.cancel(),this.So++,4!==t?this.xo.reset():e&&e.code===Io.RESOURCE_EXHAUSTED?(yo(e.toString()),yo("Using maximum backoff delay to prevent overloading the backend."),this.xo.Ao()):e&&e.code===Io.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.qo(),this.stream.close(),this.stream=null),this.state=t,await this.listener.Zr(e)}qo(){}auth(){this.state=1;const t=this.Ko(this.So),e=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([t,n])=>{this.So===e&&this.Go(t,n)}),(e=>{t((()=>{const t=new Eo(Io.UNKNOWN,"Fetching auth token failed: "+e.message);return this.Qo(t)}))}))}Go(t,e){const n=this.Ko(this.So);this.stream=this.jo(t,e),this.stream.Yr((()=>{n((()=>(this.state=2,this.Co=this.Hs.enqueueAfterDelay(this.Vo,1e4,(()=>(this.ko()&&(this.state=3),Promise.resolve()))),this.listener.Yr())))})),this.stream.Zr((t=>{n((()=>this.Qo(t)))})),this.stream.onMessage((t=>{n((()=>this.onMessage(t)))}))}Oo(){this.state=5,this.xo.Ro((async()=>{this.state=0,this.start()}))}Qo(t){return go("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}Ko(t){return e=>{this.Hs.enqueueAndForget((()=>this.So===t?e():(go("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Bh extends Vh{constructor(t,e,n,i,r,s){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,n,i,s),this.It=r}jo(t,e){return this.connection.wo("Listen",t,e)}onMessage(t){this.xo.reset();const e=function(t,e){let n;if("targetChange"in e){e.targetChange;const i=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:wo()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=function(t,e){return t.gt?(bo(void 0===e||"string"==typeof e),ua.fromBase64String(e||"")):(bo(void 0===e||e instanceof Uint8Array),ua.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(t){const e=void 0===t.code?Io.UNKNOWN:Zu(t.code);return new Eo(e,t.message||"")}(o);n=new vc(i,r,s,a||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=xc(t,i.document.name),s=Dc(i.document.updateTime),o=new Pa({mapValue:{fields:i.document.fields}}),a=Fa.newFoundDocument(r,s,o),u=i.targetIds||[],c=i.removedTargetIds||[];n=new gc(u,c,a.key,a)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=xc(t,i.document),s=i.readTime?Dc(i.readTime):Vo.min(),o=Fa.newNoDocument(r,s),a=i.removedTargetIds||[];n=new gc([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=xc(t,i.document),s=i.removedTargetIds||[];n=new gc([],s,r,null)}else{if(!("filter"in e))return wo();{e.filter;const t=e.filter;t.targetId;const i=t.count||0,r=new Xu(i),s=t.targetId;n=new yc(s,r)}}return n}(this.It,t),n=function(t){if(!("targetChange"in t))return Vo.min();const e=t.targetChange;return e.targetIds&&e.targetIds.length?Vo.min():e.readTime?Dc(e.readTime):Vo.min()}(t);return this.listener.Wo(e,n)}zo(t){const e={};e.database=Lc(this.It),e.addTarget=function(t,e){let n;const i=e.target;return n=za(i)?{documents:Fc(t,i)}:{query:Vc(t,i)},n.targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=Cc(t,e.resumeToken):e.snapshotVersion.compareTo(Vo.min())>0&&(n.readTime=kc(t,e.snapshotVersion.toTimestamp())),n}(this.It,t);const n=function(t,e){const n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return wo()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.It,t);n&&(e.labels=n),this.Bo(e)}Ho(t){const e={};e.database=Lc(this.It),e.removeTarget=t,this.Bo(e)}}class jh extends Vh{constructor(t,e,n,i,r,s){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,i,s),this.It=r,this.Jo=!1}get Yo(){return this.Jo}start(){this.Jo=!1,this.lastStreamToken=void 0,super.start()}qo(){this.Jo&&this.Xo([])}jo(t,e){return this.connection.wo("Write",t,e)}onMessage(t){if(bo(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Jo){this.xo.reset();const e=function(t,e){return t&&t.length>0?(bo(void 0!==e),t.map((t=>function(t,e){let n=t.updateTime?Dc(t.updateTime):Dc(e);return n.isEqual(Vo.min())&&(n=Dc(e)),new Mu(n,t.transformResults||[])}(t,e)))):[]}(t.writeResults,t.commitTime),n=Dc(t.commitTime);return this.listener.Zo(n,e)}return bo(!t.writeResults||0===t.writeResults.length),this.Jo=!0,this.listener.tu()}eu(){const t={};t.database=Lc(this.It),this.Bo(t)}Xo(t){const e={streamToken:this.lastStreamToken,writes:t.map((t=>function(t,e){let n;if(e instanceof zu)n={update:Uc(t,e.key,e.value)};else if(e instanceof Wu)n={delete:Oc(t,e.key)};else if(e instanceof $u)n={update:Uc(t,e.key,e.data),updateMask:Wc(e.fieldMask)};else{if(!(e instanceof Qu))return wo();n={verify:Oc(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((t=>function(t,e){const n=e.transform;if(n instanceof ku)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Cu)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Du)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Ru)return{fieldPath:e.field.canonicalString(),increment:n.yt};throw wo()}(0,t)))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Ac(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:wo()}(t,e.precondition)),n}(this.It,t)))};this.Bo(e)}}class qh extends class{}{constructor(t,e,n,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.It=i,this.nu=!1}su(){if(this.nu)throw new Eo(Io.FAILED_PRECONDITION,"The client has already been terminated.")}ao(t,e,n){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,r])=>this.connection.ao(t,e,n,i,r))).catch((t=>{throw"FirebaseError"===t.name?(t.code===Io.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new Eo(Io.UNKNOWN,t.toString())}))}_o(t,e,n,i){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([r,s])=>this.connection._o(t,e,n,r,s,i))).catch((t=>{throw"FirebaseError"===t.name?(t.code===Io.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new Eo(Io.UNKNOWN,t.toString())}))}terminate(){this.nu=!0}}class zh{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}uu(){0===this.iu&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.ru=null,this.au("Backend didn't respond within 10 seconds."),this.cu("Offline"),Promise.resolve()))))}hu(t){"Online"===this.state?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.cu("Offline")))}set(t){this.lu(),this.iu=0,"Online"===t&&(this.ou=!1),this.cu(t)}cu(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}au(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ou?(yo(e),this.ou=!1):go("OnlineStateTracker",e)}lu(){null!==this.ru&&(this.ru.cancel(),this.ru=null)}}class $h{constructor(t,e,n,i,r){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=r,this.mu.qr((t=>{n.enqueueAndForget((async()=>{Zh(this)&&(go("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=To(t);e._u.add(4),await Kh(e),e.gu.set("Unknown"),e._u.delete(4),await Hh(e)}(this))}))})),this.gu=new zh(n,i)}}async function Hh(t){if(Zh(t))for(const e of t.wu)await e(!0)}async function Kh(t){for(const e of t.wu)await e(!1)}function Gh(t,e){const n=To(t);n.du.has(e.targetId)||(n.du.set(e.targetId,e),Jh(n)?Yh(n):gl(n).ko()&&Qh(n,e))}function Wh(t,e){const n=To(t),i=gl(n);n.du.delete(e),i.ko()&&Xh(n,e),0===n.du.size&&(i.ko()?i.Fo():Zh(n)&&n.gu.set("Unknown"))}function Qh(t,e){t.yu.Mt(e.targetId),gl(t).zo(e)}function Xh(t,e){t.yu.Mt(e),gl(t).Ho(e)}function Yh(t){t.yu=new wc({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),se:e=>t.du.get(e)||null}),gl(t).start(),t.gu.uu()}function Jh(t){return Zh(t)&&!gl(t).No()&&t.du.size>0}function Zh(t){return 0===To(t)._u.size}function tl(t){t.yu=void 0}async function el(t){t.du.forEach(((e,n)=>{Qh(t,e)}))}async function nl(t,e){tl(t),Jh(t)?(t.gu.hu(e),Yh(t)):t.gu.set("Unknown")}async function il(t,e,n){if(t.gu.set("Online"),e instanceof vc&&2===e.state&&e.cause)try{await async function(t,e){const n=e.cause;for(const i of e.targetIds)t.du.has(i)&&(await t.remoteSyncer.rejectListen(i,n),t.du.delete(i),t.yu.removeTarget(i))}(t,e)}catch(n){go("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await rl(t,n)}else if(e instanceof gc?t.yu.Gt(e):e instanceof yc?t.yu.Yt(e):t.yu.Wt(e),!n.isEqual(Vo.min()))try{const e=await Sh(t.localStore);n.compareTo(e)>=0&&await function(t,e){const n=t.yu.te(e);return n.targetChanges.forEach(((n,i)=>{if(n.resumeToken.approximateByteSize()>0){const r=t.du.get(i);r&&t.du.set(i,r.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((e=>{const n=t.du.get(e);if(!n)return;t.du.set(e,n.withResumeToken(ua.EMPTY_BYTE_STRING,n.snapshotVersion)),Xh(t,e);const i=new Zc(n.target,e,1,n.sequenceNumber);Qh(t,i)})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)}catch(e){go("RemoteStore","Failed to raise snapshot:",e),await rl(t,e)}}async function rl(t,e,n){if(!Yo(e))throw e;t._u.add(1),await Kh(t),t.gu.set("Offline"),n||(n=()=>Sh(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{go("RemoteStore","Retrying IndexedDB access"),await n(),t._u.delete(1),await Hh(t)}))}function sl(t,e){return e().catch((n=>rl(t,n,e)))}async function ol(t){const e=To(t),n=yl(e);let i=e.fu.length>0?e.fu[e.fu.length-1].batchId:-1;for(;al(e);)try{const t=await kh(e.localStore,i);if(null===t){0===e.fu.length&&n.Fo();break}i=t.batchId,ul(e,t)}catch(t){await rl(e,t)}cl(e)&&hl(e)}function al(t){return Zh(t)&&t.fu.length<10}function ul(t,e){t.fu.push(e);const n=yl(t);n.ko()&&n.Yo&&n.Xo(e.mutations)}function cl(t){return Zh(t)&&!yl(t).No()&&t.fu.length>0}function hl(t){yl(t).start()}async function ll(t){yl(t).eu()}async function dl(t){const e=yl(t);for(const n of t.fu)e.Xo(n.mutations)}async function fl(t,e,n){const i=t.fu.shift(),r=Yc.from(i,e,n);await sl(t,(()=>t.remoteSyncer.applySuccessfulWrite(r))),await ol(t)}async function pl(t,e){e&&yl(t).Yo&&await async function(t,e){if(function(t){switch(t){default:return wo();case Io.CANCELLED:case Io.UNKNOWN:case Io.DEADLINE_EXCEEDED:case Io.RESOURCE_EXHAUSTED:case Io.INTERNAL:case Io.UNAVAILABLE:case Io.UNAUTHENTICATED:return!1;case Io.INVALID_ARGUMENT:case Io.NOT_FOUND:case Io.ALREADY_EXISTS:case Io.PERMISSION_DENIED:case Io.FAILED_PRECONDITION:case Io.ABORTED:case Io.OUT_OF_RANGE:case Io.UNIMPLEMENTED:case Io.DATA_LOSS:return!0}}(n=e.code)&&n!==Io.ABORTED){const n=t.fu.shift();yl(t).Mo(),await sl(t,(()=>t.remoteSyncer.rejectFailedWrite(n.batchId,e))),await ol(t)}var n}(t,e),cl(t)&&hl(t)}async function ml(t,e){const n=To(t);n.asyncQueue.verifyOperationInProgress(),go("RemoteStore","RemoteStore received new credentials");const i=Zh(n);n._u.add(3),await Kh(n),i&&n.gu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n._u.delete(3),await Hh(n)}function gl(t){return t.pu||(t.pu=function(t,e,n){const i=To(t);return i.su(),new Bh(e,i.connection,i.authCredentials,i.appCheckCredentials,i.It,n)}(t.datastore,t.asyncQueue,{Yr:el.bind(null,t),Zr:nl.bind(null,t),Wo:il.bind(null,t)}),t.wu.push((async e=>{e?(t.pu.Mo(),Jh(t)?Yh(t):t.gu.set("Unknown")):(await t.pu.stop(),tl(t))}))),t.pu}function yl(t){return t.Iu||(t.Iu=function(t,e,n){const i=To(t);return i.su(),new jh(e,i.connection,i.authCredentials,i.appCheckCredentials,i.It,n)}(t.datastore,t.asyncQueue,{Yr:ll.bind(null,t),Zr:pl.bind(null,t),tu:dl.bind(null,t),Zo:fl.bind(null,t)}),t.wu.push((async e=>{e?(t.Iu.Mo(),await ol(t)):(await t.Iu.stop(),t.fu.length>0&&(go("RemoteStore",`Stopping write stream with ${t.fu.length} pending writes`),t.fu=[]))}))),t.Iu}class vl{constructor(t,e,n,i,r){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=i,this.removalCallback=r,this.deferred=new So,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}static createAndSchedule(t,e,n,i,r){const s=Date.now()+n,o=new vl(t,e,s,i,r);return o.start(n),o}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Eo(Io.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function _l(t,e){if(yo("AsyncQueue",`${e}: ${t}`),Yo(t))return new Eo(Io.UNAVAILABLE,`${e}: ${t}`);throw t}class wl{constructor(t){this.comparator=t?(e,n)=>t(e,n)||$o.comparator(e.key,n.key):(t,e)=>$o.comparator(t.key,e.key),this.keyedMap=rc(),this.sortedSet=new na(this.comparator)}static emptySet(t){return new wl(t.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,n)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof wl))return!1;if(this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(!t.isEqual(i))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const n=new wl;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n}}class bl{constructor(){this.Tu=new na($o.comparator)}track(t){const e=t.doc.key,n=this.Tu.get(e);n?0!==t.type&&3===n.type?this.Tu=this.Tu.insert(e,t):3===t.type&&1!==n.type?this.Tu=this.Tu.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Tu=this.Tu.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Tu=this.Tu.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Tu=this.Tu.remove(e):1===t.type&&2===n.type?this.Tu=this.Tu.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Tu=this.Tu.insert(e,{type:2,doc:t.doc}):wo():this.Tu=this.Tu.insert(e,t)}Eu(){const t=[];return this.Tu.inorderTraversal(((e,n)=>{t.push(n)})),t}}class Tl{constructor(t,e,n,i,r,s,o,a,u){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=r,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=u}static fromInitialDocuments(t,e,n,i,r){const s=[];return e.forEach((t=>{s.push({type:0,doc:t})})),new Tl(t,e,wl.emptySet(e),s,n,i,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&fu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let t=0;t<e.length;t++)if(e[t].type!==n[t].type||!e[t].doc.isEqual(n[t].doc))return!1;return!0}}class Il{constructor(){this.Au=void 0,this.listeners=[]}}class El{constructor(){this.queries=new tc((t=>pu(t)),fu),this.onlineState="Unknown",this.Ru=new Set}}function Sl(t,e){const n=To(t);let i=!1;for(const t of e){const e=t.query,r=n.queries.get(e);if(r){for(const e of r.listeners)e.Pu(t)&&(i=!0);r.Au=t}}i&&Cl(n)}function kl(t,e,n){const i=To(t),r=i.queries.get(e);if(r)for(const t of r.listeners)t.onError(n);i.queries.delete(e)}function Cl(t){t.Ru.forEach((t=>{t.next()}))}class Al{constructor(t,e,n){this.query=t,this.vu=e,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=n||{}}Pu(t){if(!this.options.includeMetadataChanges){const e=[];for(const n of t.docChanges)3!==n.type&&e.push(n);t=new Tl(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Vu?this.Du(t)&&(this.vu.next(t),e=!0):this.Cu(t,this.onlineState)&&(this.xu(t),e=!0),this.Su=t,e}onError(t){this.vu.error(t)}bu(t){this.onlineState=t;let e=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,t)&&(this.xu(this.Su),e=!0),e}Cu(t,e){if(!t.fromCache)return!0;const n="Offline"!==e;return(!this.options.Nu||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||"Offline"===e)}Du(t){if(t.docChanges.length>0)return!0;const e=this.Su&&this.Su.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges}xu(t){t=Tl.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Vu=!0,this.vu.next(t)}}class Dl{constructor(t){this.key=t}}class Nl{constructor(t){this.key=t}}class Rl{constructor(t,e){this.query=t,this.Uu=e,this.qu=null,this.hasCachedResults=!1,this.current=!1,this.Ku=lc(),this.mutatedKeys=lc(),this.Gu=yu(t),this.Qu=new wl(this.Gu)}get ju(){return this.Uu}Wu(t,e){const n=e?e.zu:new bl,i=e?e.Qu:this.Qu;let r=e?e.mutatedKeys:this.mutatedKeys,s=i,o=!1;const a="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,u="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal(((t,e)=>{const c=i.get(t),h=gu(this.query,e)?e:null,l=!!c&&this.mutatedKeys.has(c.key),d=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations);let f=!1;c&&h?c.data.isEqual(h.data)?l!==d&&(n.track({type:3,doc:h}),f=!0):this.Hu(c,h)||(n.track({type:2,doc:h}),f=!0,(a&&this.Gu(h,a)>0||u&&this.Gu(h,u)<0)&&(o=!0)):!c&&h?(n.track({type:0,doc:h}),f=!0):c&&!h&&(n.track({type:1,doc:c}),f=!0,(a||u)&&(o=!0)),f&&(h?(s=s.add(h),r=d?r.add(t):r.delete(t)):(s=s.delete(t),r=r.delete(t)))})),null!==this.query.limit)for(;s.size>this.query.limit;){const t="F"===this.query.limitType?s.last():s.first();s=s.delete(t.key),r=r.delete(t.key),n.track({type:1,doc:t})}return{Qu:s,zu:n,$i:o,mutatedKeys:r}}Hu(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,n){const i=this.Qu;this.Qu=t.Qu,this.mutatedKeys=t.mutatedKeys;const r=t.zu.Eu();r.sort(((t,e)=>function(t,e){const n=t=>{switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return wo()}};return n(t)-n(e)}(t.type,e.type)||this.Gu(t.doc,e.doc))),this.Ju(n);const s=e?this.Yu():[],o=0===this.Ku.size&&this.current?1:0,a=o!==this.qu;return this.qu=o,0!==r.length||a?{snapshot:new Tl(this.query,t.Qu,i,r,t.mutatedKeys,0===o,a,!1,!!n&&n.resumeToken.approximateByteSize()>0),Xu:s}:{Xu:s}}bu(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new bl,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Xu:[]}}Zu(t){return!this.Uu.has(t)&&!!this.Qu.has(t)&&!this.Qu.get(t).hasLocalMutations}Ju(t){t&&(t.addedDocuments.forEach((t=>this.Uu=this.Uu.add(t))),t.modifiedDocuments.forEach((t=>{})),t.removedDocuments.forEach((t=>this.Uu=this.Uu.delete(t))),this.current=t.current)}Yu(){if(!this.current)return[];const t=this.Ku;this.Ku=lc(),this.Qu.forEach((t=>{this.Zu(t.key)&&(this.Ku=this.Ku.add(t.key))}));const e=[];return t.forEach((t=>{this.Ku.has(t)||e.push(new Nl(t))})),this.Ku.forEach((n=>{t.has(n)||e.push(new Dl(n))})),e}tc(t){this.Uu=t.Hi,this.Ku=lc();const e=this.Wu(t.documents);return this.applyChanges(e,!0)}ec(){return Tl.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,0===this.qu,this.hasCachedResults)}}class Ol{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class xl{constructor(t){this.key=t,this.nc=!1}}class Ml{constructor(t,e,n,i,r,s){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=s,this.sc={},this.ic=new tc((t=>pu(t)),fu),this.rc=new Map,this.oc=new Set,this.uc=new na($o.comparator),this.cc=new Map,this.ac=new dh,this.hc={},this.lc=new Map,this.fc=oh.vn(),this.onlineState="Unknown",this.dc=void 0}get isPrimaryClient(){return!0===this.dc}}async function Ll(t,e){const n=function(t){const e=To(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Ul.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Yl.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Vl.bind(null,e),e.sc.Wo=Sl.bind(null,e.eventManager),e.sc.wc=kl.bind(null,e.eventManager),e}(t);let i,r;const s=n.ic.get(e);if(s)i=s.targetId,n.sharedClientState.addLocalQueryTarget(i),r=s.view.ec();else{const t=await function(t,e){const n=To(t);return n.persistence.runTransaction("Allocate target","readwrite",(t=>{let i;return n.Cs.getTargetData(t,e).next((r=>r?(i=r,Xo.resolve(i)):n.Cs.allocateTargetId(t).next((r=>(i=new Zc(e,r,0,t.currentSequenceNumber),n.Cs.addTargetData(t,i).next((()=>i)))))))})).then((t=>{const i=n.Ui.get(t.targetId);return(null===i||t.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ui=n.Ui.insert(t.targetId,t),n.qi.set(e,t.targetId)),t}))}(n.localStore,lu(e));n.isPrimaryClient&&Gh(n.remoteStore,t);const s=n.sharedClientState.addLocalQueryTarget(t.targetId);i=t.targetId,r=await async function(t,e,n,i,r){t._c=(e,n,i)=>async function(t,e,n,i){let r=e.view.Wu(n);r.$i&&(r=await Ah(t.localStore,e.query,!1).then((({documents:t})=>e.view.Wu(t,r))));const s=i&&i.targetChanges.get(e.targetId),o=e.view.applyChanges(r,t.isPrimaryClient,s);return Kl(t,e.targetId,o.Xu),o.snapshot}(t,e,n,i);const s=await Ah(t.localStore,e,!0),o=new Rl(e,s.Hi),a=o.Wu(s.documents),u=mc.createSynthesizedTargetChangeForCurrentChange(n,i&&"Offline"!==t.onlineState,r),c=o.applyChanges(a,t.isPrimaryClient,u);Kl(t,n,c.Xu);const h=new Ol(e,n,o);return t.ic.set(e,h),t.rc.has(n)?t.rc.get(n).push(e):t.rc.set(n,[e]),c.snapshot}(n,e,i,"current"===s,t.resumeToken)}return r}async function Pl(t,e){const n=To(t),i=n.ic.get(e),r=n.rc.get(i.targetId);if(r.length>1)return n.rc.set(i.targetId,r.filter((t=>!fu(t,e)))),void n.ic.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Ch(n.localStore,i.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(i.targetId),Wh(n.remoteStore,i.targetId),$l(n,i.targetId)})).catch(Qo)):($l(n,i.targetId),await Ch(n.localStore,i.targetId,!0))}async function Ul(t,e){const n=To(t);try{const t=await function(t,e){const n=To(t),i=e.snapshotVersion;let r=n.Ui;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(t=>{const s=n.Gi.newChangeBuffer({trackRemovals:!0});r=n.Ui;const o=[];e.targetChanges.forEach(((s,a)=>{const u=r.get(a);if(!u)return;o.push(n.Cs.removeMatchingKeys(t,s.removedDocuments,a).next((()=>n.Cs.addMatchingKeys(t,s.addedDocuments,a))));let c=u.withSequenceNumber(t.currentSequenceNumber);e.targetMismatches.has(a)?c=c.withResumeToken(ua.EMPTY_BYTE_STRING,Vo.min()).withLastLimboFreeSnapshotVersion(Vo.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,i)),r=r.insert(a,c),function(t,e,n){return 0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(u,c,s)&&o.push(n.Cs.updateTargetData(t,c))}));let a=nc(),u=lc();if(e.documentUpdates.forEach((i=>{e.resolvedLimboDocuments.has(i)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(t,i))})),o.push(function(t,e,n){let i=lc(),r=lc();return n.forEach((t=>i=i.add(t))),e.getEntries(t,i).next((t=>{let i=nc();return n.forEach(((n,s)=>{const o=t.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(r=r.add(n)),s.isNoDocument()&&s.version.isEqual(Vo.min())?(e.removeEntry(n,s.readTime),i=i.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(e.addEntry(s),i=i.insert(n,s)):go("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)})),{Wi:i,zi:r}}))}(t,s,e.documentUpdates).next((t=>{a=t.Wi,u=t.zi}))),!i.isEqual(Vo.min())){const e=n.Cs.getLastRemoteSnapshotVersion(t).next((e=>n.Cs.setTargetsMetadata(t,t.currentSequenceNumber,i)));o.push(e)}return Xo.waitFor(o).next((()=>s.apply(t))).next((()=>n.localDocuments.getLocalViewOfDocuments(t,a,u))).next((()=>a))})).then((t=>(n.Ui=r,t)))}(n.localStore,e);e.targetChanges.forEach(((t,e)=>{const i=n.cc.get(e);i&&(bo(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?i.nc=!0:t.modifiedDocuments.size>0?bo(i.nc):t.removedDocuments.size>0&&(bo(i.nc),i.nc=!1))})),await Ql(n,t,e)}catch(t){await Qo(t)}}function Fl(t,e,n){const i=To(t);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const t=[];i.ic.forEach(((n,i)=>{const r=i.view.bu(e);r.snapshot&&t.push(r.snapshot)})),function(t,e){const n=To(t);n.onlineState=e;let i=!1;n.queries.forEach(((t,n)=>{for(const t of n.listeners)t.bu(e)&&(i=!0)})),i&&Cl(n)}(i.eventManager,e),t.length&&i.sc.Wo(t),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function Vl(t,e,n){const i=To(t);i.sharedClientState.updateQueryState(e,"rejected",n);const r=i.cc.get(e),s=r&&r.key;if(s){let t=new na($o.comparator);t=t.insert(s,Fa.newNoDocument(s,Vo.min()));const n=lc().add(s),r=new pc(Vo.min(),new Map,new sa(Po),t,n);await Ul(i,r),i.uc=i.uc.remove(s),i.cc.delete(e),Wl(i)}else await Ch(i.localStore,e,!1).then((()=>$l(i,e,n))).catch(Qo)}async function Bl(t,e){const n=To(t),i=e.batch.batchId;try{const t=await function(t,e){const n=To(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(t=>{const i=e.batch.keys(),r=n.Gi.newChangeBuffer({trackRemovals:!0});return function(t,e,n,i){const r=n.batch,s=r.keys();let o=Xo.resolve();return s.forEach((t=>{o=o.next((()=>i.getEntry(e,t))).next((e=>{const s=n.docVersions.get(t);bo(null!==s),e.version.compareTo(s)<0&&(r.applyToRemoteDocument(e,n),e.isValidDocument()&&(e.setReadTime(n.commitVersion),i.addEntry(e)))}))})),o.next((()=>t.mutationQueue.removeMutationBatch(e,r)))}(n,t,e,r).next((()=>r.apply(t))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,function(t){let e=lc();for(let n=0;n<t.mutationResults.length;++n)t.mutationResults[n].transformResults.length>0&&(e=e.add(t.batch.mutations[n].key));return e}(e)))).next((()=>n.localDocuments.getDocuments(t,i)))}))}(n.localStore,e);zl(n,i,null),ql(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await Ql(n,t)}catch(t){await Qo(t)}}async function jl(t,e,n){const i=To(t);try{const t=await function(t,e){const n=To(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(t=>{let i;return n.mutationQueue.lookupMutationBatch(t,e).next((e=>(bo(null!==e),i=e.keys(),n.mutationQueue.removeMutationBatch(t,e)))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,i))).next((()=>n.localDocuments.getDocuments(t,i)))}))}(i.localStore,e);zl(i,e,n),ql(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await Ql(i,t)}catch(n){await Qo(n)}}function ql(t,e){(t.lc.get(e)||[]).forEach((t=>{t.resolve()})),t.lc.delete(e)}function zl(t,e,n){const i=To(t);let r=i.hc[i.currentUser.toKey()];if(r){const t=r.get(e);t&&(n?t.reject(n):t.resolve(),r=r.remove(e)),i.hc[i.currentUser.toKey()]=r}}function $l(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const i of t.rc.get(e))t.ic.delete(i),n&&t.sc.wc(i,n);t.rc.delete(e),t.isPrimaryClient&&t.ac.ls(e).forEach((e=>{t.ac.containsKey(e)||Hl(t,e)}))}function Hl(t,e){t.oc.delete(e.path.canonicalString());const n=t.uc.get(e);null!==n&&(Wh(t.remoteStore,n),t.uc=t.uc.remove(e),t.cc.delete(n),Wl(t))}function Kl(t,e,n){for(const i of n)i instanceof Dl?(t.ac.addReference(i.key,e),Gl(t,i)):i instanceof Nl?(go("SyncEngine","Document no longer in limbo: "+i.key),t.ac.removeReference(i.key,e),t.ac.containsKey(i.key)||Hl(t,i.key)):wo()}function Gl(t,e){const n=e.key,i=n.path.canonicalString();t.uc.get(n)||t.oc.has(i)||(go("SyncEngine","New document in limbo: "+n),t.oc.add(i),Wl(t))}function Wl(t){for(;t.oc.size>0&&t.uc.size<t.maxConcurrentLimboResolutions;){const e=t.oc.values().next().value;t.oc.delete(e);const n=new $o(jo.fromString(e)),i=t.fc.next();t.cc.set(i,new xl(n)),t.uc=t.uc.insert(n,i),Gh(t.remoteStore,new Zc(lu(su(n.path)),i,2,Jo.at))}}async function Ql(t,e,n){const i=To(t),r=[],s=[],o=[];i.ic.isEmpty()||(i.ic.forEach(((t,a)=>{o.push(i._c(a,e,n).then((t=>{if((t||n)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(a.targetId,(null==t?void 0:t.fromCache)?"not-current":"current"),t){r.push(t);const e=bh.Ci(a.targetId,t);s.push(e)}})))})),await Promise.all(o),i.sc.Wo(r),await async function(t,e){const n=To(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>Xo.forEach(e,(e=>Xo.forEach(e.Si,(i=>n.persistence.referenceDelegate.addReference(t,e.targetId,i))).next((()=>Xo.forEach(e.Di,(i=>n.persistence.referenceDelegate.removeReference(t,e.targetId,i)))))))))}catch(t){if(!Yo(t))throw t;go("LocalStore","Failed to update sequence numbers: "+t)}for(const t of e){const e=t.targetId;if(!t.fromCache){const t=n.Ui.get(e),i=t.snapshotVersion,r=t.withLastLimboFreeSnapshotVersion(i);n.Ui=n.Ui.insert(e,r)}}}(i.localStore,s))}async function Xl(t,e){const n=To(t);if(!n.currentUser.isEqual(e)){go("SyncEngine","User change. New user:",e.toKey());const t=await Eh(n.localStore,e);n.currentUser=e,function(t,e){t.lc.forEach((t=>{t.forEach((t=>{t.reject(new Eo(Io.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.lc.clear()}(n),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await Ql(n,t.ji)}}function Yl(t,e){const n=To(t),i=n.cc.get(e);if(i&&i.nc)return lc().add(i.key);{let t=lc();const i=n.rc.get(e);if(!i)return t;for(const e of i){const i=n.ic.get(e);t=t.unionWith(i.view.ju)}return t}}function Jl(t){const e=To(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Bl.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=jl.bind(null,e),e}class Zl{constructor(){this.synchronizeTabs=!1}async initialize(t){this.It=Uh(t.databaseInfo.databaseId),this.sharedClientState=this.gc(t),this.persistence=this.yc(t),await this.persistence.start(),this.localStore=this.Ic(t),this.gcScheduler=this.Tc(t,this.localStore),this.indexBackfillerScheduler=this.Ec(t,this.localStore)}Tc(t,e){return null}Ec(t,e){return null}Ic(t){return function(t,e,n,i){return new Ih(t,e,n,i)}(this.persistence,new Th,t.initialUser,this.It)}yc(t){return new vh(wh.Bs,this.It)}gc(t){return new Nh}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class td{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>Fl(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=Xl.bind(null,this.syncEngine),await async function(t,e){const n=To(t);e?(n._u.delete(2),await Hh(n)):e||(n._u.add(2),await Kh(n),n.gu.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new El}createDatastore(t){const e=Uh(t.databaseInfo.databaseId),n=(i=t.databaseInfo,new Lh(i));var i;return function(t,e,n,i){return new qh(t,e,n,i)}(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return e=this.localStore,n=this.datastore,i=t.asyncQueue,r=t=>Fl(this.syncEngine,t,0),s=Oh.C()?new Oh:new Rh,new $h(e,n,i,r,s);var e,n,i,r,s}createSyncEngine(t,e){return function(t,e,n,i,r,s,o){const a=new Ml(t,e,n,i,r,s);return o&&(a.dc=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return async function(t){const e=To(t);go("RemoteStore","RemoteStore shutting down."),e._u.add(5),await Kh(e),e.mu.shutdown(),e.gu.set("Unknown")}(this.remoteStore)}}function ed(t,e,n){if(!n)throw new Eo(Io.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function nd(t){if(!$o.isDocumentKey(t))throw new Eo(Io.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function id(t){if($o.isDocumentKey(t))throw new Eo(Io.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function rd(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":wo()}function sd(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Eo(Io.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=rd(t);throw new Eo(Io.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}const od=new Map;class ad{constructor(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Eo(Io.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Eo(Io.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function(t,e,n,i){if(!0===e&&!0===i)throw new Eo(Io.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling)}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class ud{constructor(t,e,n,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ad({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Eo(Io.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new Eo(Io.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ad(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new Co;switch(t.type){case"gapi":const e=t.client;return new Ro(e,t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new Eo(Io.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=od.get(t);e&&(go("ComponentProvider","Removing Datastore"),od.delete(t),e.terminate())}(this),Promise.resolve()}}class cd{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ld(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new cd(this.firestore,t,this._key)}}class hd{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new hd(this.firestore,t,this._query)}}class ld extends hd{constructor(t,e,n){super(t,e,su(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new cd(this.firestore,null,new $o(t))}withConverter(t){return new ld(this.firestore,t,this._path)}}function dd(t,e,...n){if(t=E(t),ed("collection","path",e),t instanceof ud){const i=jo.fromString(e,...n);return id(i),new ld(t,null,i)}{if(!(t instanceof cd||t instanceof ld))throw new Eo(Io.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(jo.fromString(e,...n));return id(i),new ld(t.firestore,null,i)}}function fd(t,e,...n){if(t=E(t),1===arguments.length&&(e=Lo.R()),ed("doc","path",e),t instanceof ud){const i=jo.fromString(e,...n);return nd(i),new cd(t,null,new $o(i))}{if(!(t instanceof cd||t instanceof ld))throw new Eo(Io.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(jo.fromString(e,...n));return nd(i),new cd(t.firestore,t instanceof ld?t.converter:null,new $o(i))}}class pd{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Rc(this.observer.next,t)}error(t){this.observer.error?this.Rc(this.observer.error,t):yo("Uncaught Error in snapshot listener:",t.toString())}bc(){this.muted=!0}Rc(t,e){this.muted||setTimeout((()=>{this.muted||t(e)}),0)}}class md{constructor(t,e,n,i){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=i,this.user=lo.UNAUTHENTICATED,this.clientId=Lo.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async t=>{go("FirestoreClient","Received user=",t.uid),await this.authCredentialListener(t),this.user=t})),this.appCheckCredentials.start(n,(t=>(go("FirestoreClient","Received new app check token=",t),this.appCheckCredentialListener(t,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Eo(Io.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new So;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=_l(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function gd(t,e){t.asyncQueue.verifyOperationInProgress();const n=await async function(t){return t.offlineComponents||(go("FirestoreClient","Using default OfflineComponentProvider"),await async function(t,e){t.asyncQueue.verifyOperationInProgress(),go("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener((async t=>{i.isEqual(t)||(await Eh(e.localStore,t),i=t)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t.offlineComponents=e}(t,new Zl)),t.offlineComponents}(t);go("FirestoreClient","Initializing OnlineComponentProvider");const i=await t.getConfiguration();await e.initialize(n,i),t.setCredentialChangeListener((t=>ml(e.remoteStore,t))),t.setAppCheckTokenChangeListener(((t,n)=>ml(e.remoteStore,n))),t.onlineComponents=e}async function yd(t){return t.onlineComponents||(go("FirestoreClient","Using default OnlineComponentProvider"),await gd(t,new td)),t.onlineComponents}async function vd(t){const e=await yd(t),n=e.eventManager;return n.onListen=Ll.bind(null,e.syncEngine),n.onUnlisten=Pl.bind(null,e.syncEngine),n}class _d{constructor(){this.Bc=Promise.resolve(),this.Lc=[],this.Uc=!1,this.qc=[],this.Kc=null,this.Gc=!1,this.Qc=!1,this.jc=[],this.xo=new Fh(this,"async_queue_retry"),this.Wc=()=>{const t=Ph();t&&go("AsyncQueue","Visibility state changed to "+t.visibilityState),this.xo.Po()};const t=Ph();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Wc)}get isShuttingDown(){return this.Uc}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.zc(),this.Hc(t)}enterRestrictedMode(t){if(!this.Uc){this.Uc=!0,this.Qc=t||!1;const e=Ph();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Wc)}}enqueue(t){if(this.zc(),this.Uc)return new Promise((()=>{}));const e=new So;return this.Hc((()=>this.Uc&&this.Qc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Lc.push(t),this.Jc())))}async Jc(){if(0!==this.Lc.length){try{await this.Lc[0](),this.Lc.shift(),this.xo.reset()}catch(t){if(!Yo(t))throw t;go("AsyncQueue","Operation failed with retryable error: "+t)}this.Lc.length>0&&this.xo.Ro((()=>this.Jc()))}}Hc(t){const e=this.Bc.then((()=>(this.Gc=!0,t().catch((t=>{this.Kc=t,this.Gc=!1;const e=function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t);throw yo("INTERNAL UNHANDLED ERROR: ",e),t})).then((t=>(this.Gc=!1,t))))));return this.Bc=e,e}enqueueAfterDelay(t,e,n){this.zc(),this.jc.indexOf(t)>-1&&(e=0);const i=vl.createAndSchedule(this,t,e,n,(t=>this.Yc(t)));return this.qc.push(i),i}zc(){this.Kc&&wo()}verifyOperationInProgress(){}async Xc(){let t;do{t=this.Bc,await t}while(t!==this.Bc)}Zc(t){for(const e of this.qc)if(e.timerId===t)return!0;return!1}ta(t){return this.Xc().then((()=>{this.qc.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this.qc)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.Xc()}))}ea(t){this.jc.push(t)}Yc(t){const e=this.qc.indexOf(t);this.qc.splice(e,1)}}function wd(t){return function(t,e){if("object"!=typeof t||null===t)return!1;const n=t;for(const t of["next","error","complete"])if(t in n&&"function"==typeof n[t])return!0;return!1}(t)}class bd extends ud{constructor(t,e,n,i){super(t,e,n,i),this.type="firestore",this._queue=new _d,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Id(this),this._firestoreClient.terminate()}}function Td(t){return t._firestoreClient||Id(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Id(t){var e;const n=t._freezeSettings(),i=function(t,e,n,i){return new ga(t,e,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,i.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new md(t._authCredentials,t._appCheckCredentials,t._queue,i)}class Ed{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Ed(ua.fromBase64String(t))}catch(t){throw new Eo(Io.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new Ed(ua.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class Sd{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new Eo(Io.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new zo(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class kd{constructor(t){this._methodName=t}}class Cd{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new Eo(Io.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Eo(Io.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return Po(this._lat,t._lat)||Po(this._long,t._long)}}const Ad=/^__.*__$/;class Dd{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return null!==this.fieldMask?new $u(t,this.data,this.fieldMask,e,this.fieldTransforms):new zu(t,this.data,e,this.fieldTransforms)}}class Nd{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return new $u(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function Rd(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw wo()}}class Od{constructor(t,e,n,i,r,s){this.settings=t,this.databaseId=e,this.It=n,this.ignoreUndefinedProperties=i,void 0===r&&this.na(),this.fieldTransforms=r||[],this.fieldMask=s||[]}get path(){return this.settings.path}get sa(){return this.settings.sa}ia(t){return new Od(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.It,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ra(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.ia({path:n,oa:!1});return i.ua(t),i}ca(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.ia({path:n,oa:!1});return i.na(),i}aa(t){return this.ia({path:void 0,oa:!0})}ha(t){return $d(t,this.settings.methodName,this.settings.la||!1,this.path,this.settings.fa)}contains(t){return void 0!==this.fieldMask.find((e=>t.isPrefixOf(e)))||void 0!==this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))}na(){if(this.path)for(let t=0;t<this.path.length;t++)this.ua(this.path.get(t))}ua(t){if(0===t.length)throw this.ha("Document fields must not be empty");if(Rd(this.sa)&&Ad.test(t))throw this.ha('Document fields cannot begin and end with "__"')}}class xd{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.It=n||Uh(t)}da(t,e,n,i=!1){return new Od({sa:t,methodName:e,fa:n,path:zo.emptyPath(),oa:!1,la:i},this.databaseId,this.It,this.ignoreUndefinedProperties)}}function Md(t){const e=t._freezeSettings(),n=Uh(t._databaseId);return new xd(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Ld(t,e,n,i,r,s={}){const o=t.da(s.merge||s.mergeFields?2:0,e,n,r);Bd("Data must be an object, but it was:",o,i);const a=Fd(i,o);let u,c;if(s.merge)u=new aa(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const t=[];for(const i of s.mergeFields){const r=jd(e,i,n);if(!o.contains(r))throw new Eo(Io.INVALID_ARGUMENT,`Field '${r}' is specified in your field mask but missing from your input data.`);Hd(t,r)||t.push(r)}u=new aa(t),c=o.fieldTransforms.filter((t=>u.covers(t.field)))}else u=null,c=o.fieldTransforms;return new Dd(new Pa(a),u,c)}class Pd extends kd{_toFieldTransform(t){if(2!==t.sa)throw 1===t.sa?t.ha(`${this._methodName}() can only appear at the top level of your update data`):t.ha(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof Pd}}function Ud(t,e){if(Vd(t=E(t)))return Bd("Unsupported field value:",e,t),Fd(t,e);if(t instanceof kd)return function(t,e){if(!Rd(e.sa))throw e.ha(`${t._methodName}() can only be used with update() and set()`);if(!e.path)throw e.ha(`${t._methodName}() is not currently supported inside arrays`);const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.oa&&4!==e.sa)throw e.ha("Nested arrays are not supported");return function(t,e){const n=[];let i=0;for(const r of t){let t=Ud(r,e.aa(i));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),i++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=E(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return bu(e.It,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=Fo.fromDate(t);return{timestampValue:kc(e.It,n)}}if(t instanceof Fo){const n=new Fo(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:kc(e.It,n)}}if(t instanceof Cd)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Ed)return{bytesValue:Cc(e.It,t._byteString)};if(t instanceof cd){const n=e.databaseId,i=t.firestore._databaseId;if(!i.isEqual(n))throw e.ha(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Nc(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.ha(`Unsupported field value: ${rd(t)}`)}(t,e)}function Fd(t,e){const n={};return ea(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ta(t,((t,i)=>{const r=Ud(i,e.ra(t));null!=r&&(n[t]=r)})),{mapValue:{fields:n}}}function Vd(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Fo||t instanceof Cd||t instanceof Ed||t instanceof cd||t instanceof kd)}function Bd(t,e,n){if(!Vd(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const i=rd(n);throw"an object"===i?e.ha(t+" a custom object"):e.ha(t+" "+i)}}function jd(t,e,n){if((e=E(e))instanceof Sd)return e._internalPath;if("string"==typeof e)return zd(t,e);throw $d("Field path arguments must be of type string or ",t,!1,void 0,n)}const qd=new RegExp("[~\\*/\\[\\]]");function zd(t,e,n){if(e.search(qd)>=0)throw $d(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Sd(...e.split("."))._internalPath}catch(i){throw $d(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function $d(t,e,n,i,r){const s=i&&!i.isEmpty(),o=void 0!==r;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${i}`),o&&(u+=` in document ${r}`),u+=")"),new Eo(Io.INVALID_ARGUMENT,a+t+u)}function Hd(t,e){return t.some((t=>t.isEqual(e)))}class Kd{constructor(t,e,n,i,r){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=i,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new cd(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new Gd(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(Wd("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class Gd extends Kd{data(){return super.data()}}function Wd(t,e){return"string"==typeof e?zd(t,e):e instanceof Sd?e._internalPath:e._delegate._internalPath}class Qd{}class Xd extends Qd{constructor(t,e,n){super(),this.ma=t,this.ga=e,this.ya=n,this.type="where"}_apply(t){const e=Md(t.firestore),n=function(t,e,n,i,r,s,o){let a;if(r.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new Eo(Io.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){Zd(o,s);const e=[];for(const n of o)e.push(Jd(i,t,n));a={arrayValue:{values:e}}}else a=Jd(i,t,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||Zd(o,s),a=function(t,e,n,i=!1){return Ud(n,t.da(i?4:3,e))}(n,"where",o,"in"===s||"not-in"===s);const u=$a.create(r,s,a);return function(t,e){if(e.dt()){const n=uu(t);if(null!==n&&!n.isEqual(e.field))throw new Eo(Io.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${e.field.toString()}'`);const i=au(t);null!==i&&tf(0,e.field,i)}const n=function(t,e){for(const n of t.filters)if(e.indexOf(n.op)>=0)return n.op;return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==n)throw n===e.op?new Eo(Io.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Eo(Io.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}(t,u),u}(t._query,0,e,t.firestore._databaseId,this.ma,this.ga,this.ya);return new hd(t.firestore,t.converter,function(t,e){const n=t.filters.concat([e]);return new ru(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))}}class Yd extends Qd{constructor(t,e){super(),this.ma=t,this.pa=e,this.type="orderBy"}_apply(t){const e=function(t,e,n){if(null!==t.startAt)throw new Eo(Io.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Eo(Io.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const i=new tu(e,n);return function(t,e){if(null===au(t)){const n=uu(t);null!==n&&tf(0,n,e.field)}}(t,i),i}(t._query,this.ma,this.pa);return new hd(t.firestore,t.converter,function(t,e){const n=t.explicitOrderBy.concat([e]);return new ru(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))}}function Jd(t,e,n){if("string"==typeof(n=E(n))){if(""===n)throw new Eo(Io.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!cu(e)&&-1!==n.indexOf("/"))throw new Eo(Io.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=e.path.child(jo.fromString(n));if(!$o.isDocumentKey(i))throw new Eo(Io.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Aa(t,new $o(i))}if(n instanceof cd)return Aa(t,n._key);throw new Eo(Io.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${rd(n)}.`)}function Zd(t,e){if(!Array.isArray(t)||0===t.length)throw new Eo(Io.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(t.length>10)throw new Eo(Io.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function tf(t,e,n){if(!n.isEqual(e))throw new Eo(Io.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}class ef{convertValue(t,e="none"){switch(ba(t)){case 0:return null;case 1:return t.booleanValue;case 2:return la(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(da(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw wo()}}convertObject(t,e){const n={};return ta(t.fields,((t,i)=>{n[t]=this.convertValue(i,e)})),n}convertGeoPoint(t){return new Cd(la(t.latitude),la(t.longitude))}convertArray(t,e){return(t.values||[]).map((t=>this.convertValue(t,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const n=pa(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(ma(t));default:return null}}convertTimestamp(t){const e=ha(t);return new Fo(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=jo.fromString(t);bo(Qc(n));const i=new ya(n.get(1),n.get(3)),r=new $o(n.popFirst(5));return i.isEqual(e)||yo(`Document ${r} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),r}}class nf{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class rf extends Kd{constructor(t,e,n,i,r,s){super(t,e,n,i,s),this._firestore=t,this._firestoreImpl=t,this.metadata=r}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new sf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const n=this._document.data.field(Wd("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}}class sf extends rf{data(t={}){return super.data(t)}}class of{constructor(t,e,n,i){this._firestore=t,this._userDataWriter=e,this._snapshot=i,this.metadata=new nf(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach((n=>{t.call(e,new sf(this._firestore,this._userDataWriter,n.key,n,new nf(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Eo(Io.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){let e=0;return t._snapshot.docChanges.map((n=>{const i=new sf(t._firestore,t._userDataWriter,n.doc.key,n.doc,new nf(t._snapshot.mutatedKeys.has(n.doc.key),t._snapshot.fromCache),t.query.converter);return n.doc,{type:"added",doc:i,oldIndex:-1,newIndex:e++}}))}{let n=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((t=>e||3!==t.type)).map((e=>{const i=new sf(t._firestore,t._userDataWriter,e.doc.key,e.doc,new nf(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter);let r=-1,s=-1;return 0!==e.type&&(r=n.indexOf(e.doc.key),n=n.delete(e.doc.key)),1!==e.type&&(n=n.add(e.doc),s=n.indexOf(e.doc.key)),{type:af(e.type),doc:i,oldIndex:r,newIndex:s}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function af(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return wo()}}class uf extends ef{constructor(t){super(),this.firestore=t}convertBytes(t){return new Ed(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new cd(this.firestore,null,e)}}function cf(t,e){const n=sd(t.firestore,bd),i=fd(t),r=function(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}(t.converter,e);return lf(n,[Ld(Md(t.firestore),"addDoc",i._key,r,null!==t.converter,{}).toMutation(i._key,Lu.exists(!1))]).then((()=>i))}function hf(t,...e){var n,i,r;t=E(t);let s={includeMetadataChanges:!1},o=0;"object"!=typeof e[o]||wd(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(wd(e[o])){const t=e[o];e[o]=null===(n=t.next)||void 0===n?void 0:n.bind(t),e[o+1]=null===(i=t.error)||void 0===i?void 0:i.bind(t),e[o+2]=null===(r=t.complete)||void 0===r?void 0:r.bind(t)}let u,c,h;if(t instanceof cd)c=sd(t.firestore,bd),h=su(t._key.path),u={next:n=>{e[o]&&e[o](function(t,e,n){const i=n.docs.get(e._key),r=new uf(t);return new rf(t,r,e._key,i,new nf(n.hasPendingWrites,n.fromCache),e.converter)}(c,t,n))},error:e[o+1],complete:e[o+2]};else{const n=sd(t,hd);c=sd(n.firestore,bd),h=n._query;const i=new uf(c);u={next:t=>{e[o]&&e[o](new of(c,i,n,t))},error:e[o+1],complete:e[o+2]},function(t){if("L"===t.limitType&&0===t.explicitOrderBy.length)throw new Eo(Io.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(t._query)}return function(t,e,n,i){const r=new pd(i),s=new Al(e,r,n);return t.asyncQueue.enqueueAndForget((async()=>async function(t,e){const n=To(t),i=e.query;let r=!1,s=n.queries.get(i);if(s||(r=!0,s=new Il),r)try{s.Au=await n.onListen(i)}catch(t){const n=_l(t,`Initialization of query '${mu(e.query)}' failed`);return void e.onError(n)}n.queries.set(i,s),s.listeners.push(e),e.bu(n.onlineState),s.Au&&e.Pu(s.Au)&&Cl(n)}(await vd(t),s))),()=>{r.bc(),t.asyncQueue.enqueueAndForget((async()=>async function(t,e){const n=To(t),i=e.query;let r=!1;const s=n.queries.get(i);if(s){const t=s.listeners.indexOf(e);t>=0&&(s.listeners.splice(t,1),r=0===s.listeners.length)}if(r)return n.queries.delete(i),n.onUnlisten(i)}(await vd(t),s)))}}(Td(c),h,a,u)}function lf(t,e){return function(t,e){const n=new So;return t.asyncQueue.enqueueAndForget((async()=>async function(t,e,n){const i=Jl(t);try{const t=await function(t,e){const n=To(t),i=Fo.now(),r=e.reduce(((t,e)=>t.add(e.key)),lc());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(t=>{let a=nc(),u=lc();return n.Gi.getEntries(t,r).next((t=>{a=t,a.forEach(((t,e)=>{e.isValidDocument()||(u=u.add(t))}))})).next((()=>n.localDocuments.getOverlayedDocuments(t,a))).next((r=>{s=r;const o=[];for(const t of e){const e=ju(t,s.get(t.key).overlayedDocument);null!=e&&o.push(new $u(t.key,e,Ua(e.value.mapValue),Lu.exists(!0)))}return n.mutationQueue.addMutationBatch(t,i,o,e)})).next((e=>{o=e;const i=e.applyToLocalDocumentSet(s,u);return n.documentOverlayCache.saveOverlays(t,e.batchId,i)}))})).then((()=>({batchId:o.batchId,changes:sc(s)})))}(i.localStore,e);i.sharedClientState.addPendingMutation(t.batchId),function(t,e,n){let i=t.hc[t.currentUser.toKey()];i||(i=new na(Po)),i=i.insert(e,n),t.hc[t.currentUser.toKey()]=i}(i,t.batchId,n),await Ql(i,t.changes),await ol(i.remoteStore)}catch(t){const e=_l(t,"Failed to persist write");n.reject(e)}}(await function(t){return yd(t).then((t=>t.syncEngine))}(t),e,n))),n.promise}(Td(t),e)}!function(t,e=!0){fo="9.14.0",ct(new S("firestore",((t,{instanceIdentifier:n,options:i})=>{const r=t.getProvider("app").getImmediate(),s=new bd(new Do(t.getProvider("auth-internal")),new xo(t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Eo(Io.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ya(t.options.projectId,e)}(r,n),r);return i=Object.assign({useFetchStreams:e},i),s._setSettings(i),s}),"PUBLIC").setMultipleInstances(!0)),gt(ho,"3.7.3",t),gt(ho,"3.7.3","esm2017")}();const df=t=>{let e=t.toDate().getHours(),n=t.toDate().getMinutes();return parseInt(e)<10&&(e=`0${e}`),parseInt(n)<10&&(n=`0${n}`),`${e}h ${n}`};var ff=function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{u(i.next(t))}catch(t){s(t)}}function a(t){try{u(i.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}u((i=i.apply(t,e||[])).next())}))};const pf=function(t,e){const n="string"==typeof t?t:"(default)",r=ht("object"==typeof t?t:mt(),"firestore").getImmediate({identifier:n});if(!r._initialized){const t=(t=>{const e=h("firestore");if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return"["===e[0]?[e.substring(1,n-1),i]:[e.substring(0,n),i]})();t&&function(t,e,n,r={}){var s;const o=(t=sd(t,ud))._getSettings();if("firestore.googleapis.com"!==o.host&&o.host!==e&&vo("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},o),{host:`${e}:${n}`,ssl:!1})),r.mockUserToken){let e,n;if("string"==typeof r.mockUserToken)e=r.mockUserToken,n=lo.MOCK_USER;else{e=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",r=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[i(JSON.stringify({alg:"none",type:"JWT"})),i(JSON.stringify(o)),""].join(".")}(r.mockUserToken,null===(s=t._app)||void 0===s?void 0:s.options.projectId);const o=r.mockUserToken.sub||r.mockUserToken.user_id;if(!o)throw new Eo(Io.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new lo(o)}t._authCredentials=new Ao(new ko(e,n))}}(r,...t)}return r}(Ne);let mf=dd(pf,"chatrooms"),gf=dd(pf,"messages");const yf=(t,e)=>ff(void 0,void 0,void 0,(function*(){const n=fd(pf,"chatrooms",t);yield function(t,e,n,...i){t=sd(t,cd);const r=sd(t.firestore,bd),s=Md(r);let o;return o="string"==typeof(e=E(e))||e instanceof Sd?function(t,e,n,i,r,s){const o=t.da(1,e,n),a=[jd(e,i,n)],u=[r];if(s.length%2!=0)throw new Eo(Io.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let t=0;t<s.length;t+=2)a.push(jd(e,s[t])),u.push(s[t+1]);const c=[],h=Pa.empty();for(let t=a.length-1;t>=0;--t)if(!Hd(c,a[t])){const e=a[t];let n=u[t];n=E(n);const i=o.ca(e);if(n instanceof Pd)c.push(e);else{const t=Ud(n,i);null!=t&&(c.push(e),h.set(e,t))}}const l=new aa(c);return new Nd(h,l,o.fieldTransforms)}(s,"updateDoc",t._key,e,n,i):function(t,e,n,i){const r=t.da(1,e,n);Bd("Data must be an object, but it was:",r,i);const s=[],o=Pa.empty();ta(i,((t,i)=>{const a=zd(e,t,n);i=E(i);const u=r.ca(a);if(i instanceof Pd)s.push(a);else{const t=Ud(i,u);null!=t&&(s.push(a),o.set(a,t))}}));const a=new aa(s);return new Nd(o,a,r.fieldTransforms)}(s,"updateDoc",t._key,e),lf(r,[o.toMutation(t._key,Lu.exists(!0))])}(n,{lastMessage:e.message,timeOfLastMessage:df(e.timestamp)})})),vf=t=>ff(void 0,void 0,void 0,(function*(){let e=function(t,...e){for(const n of e)t=n._apply(t);return t}(gf,function(t,e,n){const i=Wd("where","chatroomId");return new Xd(i,"==",n)}(0,0,t),function(t,e="asc"){const n=e,i=Wd("orderBy","timestamp");return new Yd(i,n)}());hf(e,(t=>{nn.innerHTML="",t.forEach((t=>{(t=>{let e=document.createElement("li");t.user==sessionStorage.getItem("userId")?e.classList.add("chat__message--owned"):e.classList.add("chat__message"),e.innerHTML=`\n        <p class="chat__message-content">${t.message}</p>\n        <p class="chat__message-timestamp extra-subtle">${df(t.timestamp)}</p>\n    `,nn.appendChild(e),yf(sessionStorage.getItem("currentChatroomId"),t)})(t.data())}))}))}));function _f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function wf(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var bf,Tf,If,Ef,Sf,kf,Cf,Af,Df,Nf,Rf,Of,xf,Mf,Lf,Pf={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Uf={duration:.5,overwrite:!1,delay:0},Ff=1e8,Vf=1e-8,Bf=2*Math.PI,jf=Bf/4,qf=0,zf=Math.sqrt,$f=Math.cos,Hf=Math.sin,Kf=function(t){return"string"==typeof t},Gf=function(t){return"function"==typeof t},Wf=function(t){return"number"==typeof t},Qf=function(t){return void 0===t},Xf=function(t){return"object"==typeof t},Yf=function(t){return!1!==t},Jf=function(){return"undefined"!=typeof window},Zf=function(t){return Gf(t)||Kf(t)},tp="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},ep=Array.isArray,np=/(?:-?\.?\d|\.)+/gi,ip=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,rp=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,sp=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,op=/[+-]=-?[.\d]+/,ap=/[^,'"\[\]\s]+/gi,up=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,cp={},hp={},lp=function(t){return(hp=Bp(t,cp))&&Vg},dp=function(t,e){return console.warn("Invalid property",t,"set to",e,"Missing plugin? gsap.registerPlugin()")},fp=function(t,e){return!e&&console.warn(t)},pp=function(t,e){return t&&(cp[t]=e)&&hp&&(hp[t]=e)||cp},mp=function(){return 0},gp={suppressEvents:!0,isStart:!0,kill:!1},yp={suppressEvents:!0,kill:!1},vp={suppressEvents:!0},_p={},wp=[],bp={},Tp={},Ip={},Ep=30,Sp=[],kp="",Cp=function(t){var e,n,i=t[0];if(Xf(i)||Gf(i)||(t=[t]),!(e=(i._gsap||{}).harness)){for(n=Sp.length;n--&&!Sp[n].targetTest(i););e=Sp[n]}for(n=t.length;n--;)t[n]&&(t[n]._gsap||(t[n]._gsap=new tg(t[n],e)))||t.splice(n,1);return t},Ap=function(t){return t._gsap||Cp(vm(t))[0]._gsap},Dp=function(t,e,n){return(n=t[e])&&Gf(n)?t[e]():Qf(n)&&t.getAttribute&&t.getAttribute(e)||n},Np=function(t,e){return(t=t.split(",")).forEach(e)||t},Rp=function(t){return Math.round(1e5*t)/1e5||0},Op=function(t){return Math.round(1e7*t)/1e7||0},xp=function(t,e){var n=e.charAt(0),i=parseFloat(e.substr(2));return t=parseFloat(t),"+"===n?t+i:"-"===n?t-i:"*"===n?t*i:t/i},Mp=function(t,e){for(var n=e.length,i=0;t.indexOf(e[i])<0&&++i<n;);return i<n},Lp=function(){var t,e,n=wp.length,i=wp.slice(0);for(bp={},wp.length=0,t=0;t<n;t++)(e=i[t])&&e._lazy&&(e.render(e._lazy[0],e._lazy[1],!0)._lazy=0)},Pp=function(t,e,n,i){wp.length&&Lp(),t.render(e,n,i||Tf&&e<0&&(t._initted||t._startAt)),wp.length&&Lp()},Up=function(t){var e=parseFloat(t);return(e||0===e)&&(t+"").match(ap).length<2?e:Kf(t)?t.trim():t},Fp=function(t){return t},Vp=function(t,e){for(var n in e)n in t||(t[n]=e[n]);return t},Bp=function(t,e){for(var n in e)t[n]=e[n];return t},jp=function t(e,n){for(var i in n)"__proto__"!==i&&"constructor"!==i&&"prototype"!==i&&(e[i]=Xf(n[i])?t(e[i]||(e[i]={}),n[i]):n[i]);return e},qp=function(t,e){var n,i={};for(n in t)n in e||(i[n]=t[n]);return i},zp=function(t){var e,n=t.parent||Ef,i=t.keyframes?(e=ep(t.keyframes),function(t,n){for(var i in n)i in t||"duration"===i&&e||"ease"===i||(t[i]=n[i])}):Vp;if(Yf(t.inherit))for(;n;)i(t,n.vars.defaults),n=n.parent||n._dp;return t},$p=function(t,e,n,i,r){void 0===n&&(n="_first"),void 0===i&&(i="_last");var s,o=t[i];if(r)for(s=e[r];o&&o[r]>s;)o=o._prev;return o?(e._next=o._next,o._next=e):(e._next=t[n],t[n]=e),e._next?e._next._prev=e:t[i]=e,e._prev=o,e.parent=e._dp=t,e},Hp=function(t,e,n,i){void 0===n&&(n="_first"),void 0===i&&(i="_last");var r=e._prev,s=e._next;r?r._next=s:t[n]===e&&(t[n]=s),s?s._prev=r:t[i]===e&&(t[i]=r),e._next=e._prev=e.parent=null},Kp=function(t,e){t.parent&&(!e||t.parent.autoRemoveChildren)&&t.parent.remove(t),t._act=0},Gp=function(t,e){if(t&&(!e||e._end>t._dur||e._start<0))for(var n=t;n;)n._dirty=1,n=n.parent;return t},Wp=function(t){for(var e=t.parent;e&&e.parent;)e._dirty=1,e.totalDuration(),e=e.parent;return t},Qp=function(t,e,n,i){return t._startAt&&(Tf?t._startAt.revert(yp):t.vars.immediateRender&&!t.vars.autoRevert||t._startAt.render(e,!0,i))},Xp=function t(e){return!e||e._ts&&t(e.parent)},Yp=function(t){return t._repeat?Jp(t._tTime,t=t.duration()+t._rDelay)*t:0},Jp=function(t,e){var n=Math.floor(t/=e);return t&&n===t?n-1:n},Zp=function(t,e){return(t-e._start)*e._ts+(e._ts>=0?0:e._dirty?e.totalDuration():e._tDur)},tm=function(t){return t._end=Op(t._start+(t._tDur/Math.abs(t._ts||t._rts||Vf)||0))},em=function(t,e){var n=t._dp;return n&&n.smoothChildTiming&&t._ts&&(t._start=Op(n._time-(t._ts>0?e/t._ts:((t._dirty?t.totalDuration():t._tDur)-e)/-t._ts)),tm(t),n._dirty||Gp(n,t)),t},nm=function(t,e){var n;if((e._time||e._initted&&!e._dur)&&(n=Zp(t.rawTime(),e),(!e._dur||pm(0,e.totalDuration(),n)-e._tTime>Vf)&&e.render(n,!0)),Gp(t,e)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(n=t;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;t._zTime=-1e-8}},im=function(t,e,n,i){return e.parent&&Kp(e),e._start=Op((Wf(n)?n:n||t!==Ef?lm(t,n,e):t._time)+e._delay),e._end=Op(e._start+(e.totalDuration()/Math.abs(e.timeScale())||0)),$p(t,e,"_first","_last",t._sort?"_start":0),am(e)||(t._recent=e),i||nm(t,e),t._ts<0&&em(t,t._tTime),t},rm=function(t,e){return(cp.ScrollTrigger||dp("scrollTrigger",e))&&cp.ScrollTrigger.create(e,t)},sm=function(t,e,n,i,r){return ug(t,e,r),t._initted?!n&&t._pt&&!Tf&&(t._dur&&!1!==t.vars.lazy||!t._dur&&t.vars.lazy)&&Df!==jm.frame?(wp.push(t),t._lazy=[r,i],1):void 0:1},om=function t(e){var n=e.parent;return n&&n._ts&&n._initted&&!n._lock&&(n.rawTime()<0||t(n))},am=function(t){var e=t.data;return"isFromStart"===e||"isStart"===e},um=function(t,e,n,i){var r=t._repeat,s=Op(e)||0,o=t._tTime/t._tDur;return o&&!i&&(t._time*=s/t._dur),t._dur=s,t._tDur=r?r<0?1e10:Op(s*(r+1)+t._rDelay*r):s,o>0&&!i&&em(t,t._tTime=t._tDur*o),t.parent&&tm(t),n||Gp(t.parent,t),t},cm=function(t){return t instanceof ng?Gp(t):um(t,t._dur)},hm={_start:0,endTime:mp,totalDuration:mp},lm=function t(e,n,i){var r,s,o,a=e.labels,u=e._recent||hm,c=e.duration()>=Ff?u.endTime(!1):e._dur;return Kf(n)&&(isNaN(n)||n in a)?(s=n.charAt(0),o="%"===n.substr(-1),r=n.indexOf("="),"<"===s||">"===s?(r>=0&&(n=n.replace(/=/,"")),("<"===s?u._start:u.endTime(u._repeat>=0))+(parseFloat(n.substr(1))||0)*(o?(r<0?u:i).totalDuration()/100:1)):r<0?(n in a||(a[n]=c),a[n]):(s=parseFloat(n.charAt(r-1)+n.substr(r+1)),o&&i&&(s=s/100*(ep(i)?i[0]:i).totalDuration()),r>1?t(e,n.substr(0,r-1),i)+s:c+s)):null==n?c:+n},dm=function(t,e,n){var i,r,s=Wf(e[1]),o=(s?2:1)+(t<2?0:1),a=e[o];if(s&&(a.duration=e[1]),a.parent=n,t){for(i=a,r=n;r&&!("immediateRender"in i);)i=r.vars.defaults||{},r=Yf(r.vars.inherit)&&r.parent;a.immediateRender=Yf(i.immediateRender),t<2?a.runBackwards=1:a.startAt=e[o-1]}return new fg(e[0],a,e[o+1])},fm=function(t,e){return t||0===t?e(t):e},pm=function(t,e,n){return n<t?t:n>e?e:n},mm=function(t,e){return Kf(t)&&(e=up.exec(t))?e[1]:""},gm=[].slice,ym=function(t,e){return t&&Xf(t)&&"length"in t&&(!e&&!t.length||t.length-1 in t&&Xf(t[0]))&&!t.nodeType&&t!==Sf},vm=function(t,e,n){return If&&!e&&If.selector?If.selector(t):!Kf(t)||n||!kf&&qm()?ep(t)?function(t,e,n){return void 0===n&&(n=[]),t.forEach((function(t){var i;return Kf(t)&&!e||ym(t,1)?(i=n).push.apply(i,vm(t)):n.push(t)}))||n}(t,n):ym(t)?gm.call(t,0):t?[t]:[]:gm.call((e||Cf).querySelectorAll(t),0)},_m=function(t){return t=vm(t)[0]||fp("Invalid scope")||{},function(e){var n=t.current||t.nativeElement||t;return vm(e,n.querySelectorAll?n:n===t?fp("Invalid scope")||Cf.createElement("div"):t)}},wm=function(t){return t.sort((function(){return.5-Math.random()}))},bm=function(t){if(Gf(t))return t;var e=Xf(t)?t:{each:t},n=Qm(e.ease),i=e.from||0,r=parseFloat(e.base)||0,s={},o=i>0&&i<1,a=isNaN(i)||o,u=e.axis,c=i,h=i;return Kf(i)?c=h={center:.5,edges:.5,end:1}[i]||0:!o&&a&&(c=i[0],h=i[1]),function(t,o,l){var d,f,p,m,g,y,v,_,w,b=(l||e).length,T=s[b];if(!T){if(!(w="auto"===e.grid?0:(e.grid||[1,Ff])[1])){for(v=-Ff;v<(v=l[w++].getBoundingClientRect().left)&&w<b;);w--}for(T=s[b]=[],d=a?Math.min(w,b)*c-.5:i%w,f=w===Ff?0:a?b*h/w-.5:i/w|0,v=0,_=Ff,y=0;y<b;y++)p=y%w-d,m=f-(y/w|0),T[y]=g=u?Math.abs("y"===u?m:p):zf(p*p+m*m),g>v&&(v=g),g<_&&(_=g);"random"===i&&wm(T),T.max=v-_,T.min=_,T.v=b=(parseFloat(e.amount)||parseFloat(e.each)*(w>b?b-1:u?"y"===u?b/w:w:Math.max(w,b/w))||0)*("edges"===i?-1:1),T.b=b<0?r-b:r,T.u=mm(e.amount||e.each)||0,n=n&&b<0?Gm(n):n}return b=(T[t]-T.min)/T.max||0,Op(T.b+(n?n(b):b)*T.v)+T.u}},Tm=function(t){var e=Math.pow(10,((t+"").split(".")[1]||"").length);return function(n){var i=Op(Math.round(parseFloat(n)/t)*t*e);return(i-i%1)/e+(Wf(n)?0:mm(n))}},Im=function(t,e){var n,i,r=ep(t);return!r&&Xf(t)&&(n=r=t.radius||Ff,t.values?(t=vm(t.values),(i=!Wf(t[0]))&&(n*=n)):t=Tm(t.increment)),fm(e,r?Gf(t)?function(e){return i=t(e),Math.abs(i-e)<=n?i:e}:function(e){for(var r,s,o=parseFloat(i?e.x:e),a=parseFloat(i?e.y:0),u=Ff,c=0,h=t.length;h--;)(r=i?(r=t[h].x-o)*r+(s=t[h].y-a)*s:Math.abs(t[h]-o))<u&&(u=r,c=h);return c=!n||u<=n?t[c]:e,i||c===e||Wf(e)?c:c+mm(e)}:Tm(t))},Em=function(t,e,n,i){return fm(ep(t)?!e:!0===n?!!(n=0):!i,(function(){return ep(t)?t[~~(Math.random()*t.length)]:(n=n||1e-5)&&(i=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((t-n/2+Math.random()*(e-t+.99*n))/n)*n*i)/i}))},Sm=function(t,e,n){return fm(n,(function(n){return t[~~e(n)]}))},km=function(t){for(var e,n,i,r,s=0,o="";~(e=t.indexOf("random(",s));)i=t.indexOf(")",e),r="["===t.charAt(e+7),n=t.substr(e+7,i-e-7).match(r?ap:np),o+=t.substr(s,e-s)+Em(r?n:+n[0],r?0:+n[1],+n[2]||1e-5),s=i+1;return o+t.substr(s,t.length-s)},Cm=function(t,e,n,i,r){var s=e-t,o=i-n;return fm(r,(function(e){return n+((e-t)/s*o||0)}))},Am=function(t,e,n){var i,r,s,o=t.labels,a=Ff;for(i in o)(r=o[i]-e)<0==!!n&&r&&a>(r=Math.abs(r))&&(s=i,a=r);return s},Dm=function(t,e,n){var i,r,s,o=t.vars,a=o[e],u=If,c=t._ctx;if(a)return i=o[e+"Params"],r=o.callbackScope||t,n&&wp.length&&Lp(),c&&(If=c),s=i?a.apply(r,i):a.call(r),If=u,s},Nm=function(t){return Kp(t),t.scrollTrigger&&t.scrollTrigger.kill(!!Tf),t.progress()<1&&Dm(t,"onInterrupt"),t},Rm=function(t){var e=(t=!t.name&&t.default||t).name,n=Gf(t),i=e&&!n&&t.init?function(){this._props=[]}:t,r={init:mp,render:Tg,add:og,kill:Eg,modifier:Ig,rawVars:0},s={targetTest:0,get:0,getSetter:vg,aliases:{},register:0};if(qm(),t!==i){if(Tp[e])return;Vp(i,Vp(qp(t,r),s)),Bp(i.prototype,Bp(r,qp(t,s))),Tp[i.prop=e]=i,t.targetTest&&(Sp.push(i),_p[e]=1),e=("css"===e?"CSS":e.charAt(0).toUpperCase()+e.substr(1))+"Plugin"}pp(e,i),t.register&&t.register(Vg,i,Cg)},Om=255,xm={aqua:[0,Om,Om],lime:[0,Om,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,Om],navy:[0,0,128],white:[Om,Om,Om],olive:[128,128,0],yellow:[Om,Om,0],orange:[Om,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[Om,0,0],pink:[Om,192,203],cyan:[0,Om,Om],transparent:[Om,Om,Om,0]},Mm=function(t,e,n){return(6*(t+=t<0?1:t>1?-1:0)<1?e+(n-e)*t*6:t<.5?n:3*t<2?e+(n-e)*(2/3-t)*6:e)*Om+.5|0},Lm=function(t,e,n){var i,r,s,o,a,u,c,h,l,d,f=t?Wf(t)?[t>>16,t>>8&Om,t&Om]:0:xm.black;if(!f){if(","===t.substr(-1)&&(t=t.substr(0,t.length-1)),xm[t])f=xm[t];else if("#"===t.charAt(0)){if(t.length<6&&(i=t.charAt(1),r=t.charAt(2),s=t.charAt(3),t="#"+i+i+r+r+s+s+(5===t.length?t.charAt(4)+t.charAt(4):"")),9===t.length)return[(f=parseInt(t.substr(1,6),16))>>16,f>>8&Om,f&Om,parseInt(t.substr(7),16)/255];f=[(t=parseInt(t.substr(1),16))>>16,t>>8&Om,t&Om]}else if("hsl"===t.substr(0,3))if(f=d=t.match(np),e){if(~t.indexOf("="))return f=t.match(ip),n&&f.length<4&&(f[3]=1),f}else o=+f[0]%360/360,a=+f[1]/100,i=2*(u=+f[2]/100)-(r=u<=.5?u*(a+1):u+a-u*a),f.length>3&&(f[3]*=1),f[0]=Mm(o+1/3,i,r),f[1]=Mm(o,i,r),f[2]=Mm(o-1/3,i,r);else f=t.match(np)||xm.transparent;f=f.map(Number)}return e&&!d&&(i=f[0]/Om,r=f[1]/Om,s=f[2]/Om,u=((c=Math.max(i,r,s))+(h=Math.min(i,r,s)))/2,c===h?o=a=0:(l=c-h,a=u>.5?l/(2-c-h):l/(c+h),o=c===i?(r-s)/l+(r<s?6:0):c===r?(s-i)/l+2:(i-r)/l+4,o*=60),f[0]=~~(o+.5),f[1]=~~(100*a+.5),f[2]=~~(100*u+.5)),n&&f.length<4&&(f[3]=1),f},Pm=function(t){var e=[],n=[],i=-1;return t.split(Fm).forEach((function(t){var r=t.match(rp)||[];e.push.apply(e,r),n.push(i+=r.length+1)})),e.c=n,e},Um=function(t,e,n){var i,r,s,o,a="",u=(t+a).match(Fm),c=e?"hsla(":"rgba(",h=0;if(!u)return t;if(u=u.map((function(t){return(t=Lm(t,e,1))&&c+(e?t[0]+","+t[1]+"%,"+t[2]+"%,"+t[3]:t.join(","))+")"})),n&&(s=Pm(t),(i=n.c).join(a)!==s.c.join(a)))for(o=(r=t.replace(Fm,"1").split(rp)).length-1;h<o;h++)a+=r[h]+(~i.indexOf(h)?u.shift()||c+"0,0,0,0)":(s.length?s:u.length?u:n).shift());if(!r)for(o=(r=t.split(Fm)).length-1;h<o;h++)a+=r[h]+u[h];return a+r[o]},Fm=function(){var t,e="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(t in xm)e+="|"+t+"\\b";return new RegExp(e+")","gi")}(),Vm=/hsl[a]?\(/,Bm=function(t){var e,n=t.join(" ");if(Fm.lastIndex=0,Fm.test(n))return e=Vm.test(n),t[1]=Um(t[1],e),t[0]=Um(t[0],e,Pm(t[1])),!0},jm=function(){var t,e,n,i,r,s,o=Date.now,a=500,u=33,c=o(),h=c,l=1e3/240,d=l,f=[],p=function n(p){var m,g,y,v,_=o()-h,w=!0===p;if(_>a&&(c+=_-u),((m=(y=(h+=_)-c)-d)>0||w)&&(v=++i.frame,r=y-1e3*i.time,i.time=y/=1e3,d+=m+(m>=l?4:l-m),g=1),w||(t=e(n)),g)for(s=0;s<f.length;s++)f[s](y,r,v,p)};return i={time:0,frame:0,tick:function(){p(!0)},deltaRatio:function(t){return r/(1e3/(t||60))},wake:function(){Af&&(!kf&&Jf()&&(Sf=kf=window,Cf=Sf.document||{},cp.gsap=Vg,(Sf.gsapVersions||(Sf.gsapVersions=[])).push(Vg.version),lp(hp||Sf.GreenSockGlobals||!Sf.gsap&&Sf||{}),n=Sf.requestAnimationFrame),t&&i.sleep(),e=n||function(t){return setTimeout(t,d-1e3*i.time+1|0)},Rf=1,p(2))},sleep:function(){(n?Sf.cancelAnimationFrame:clearTimeout)(t),Rf=0,e=mp},lagSmoothing:function(t,e){a=t||1e8,u=Math.min(e,a,0)},fps:function(t){l=1e3/(t||240),d=1e3*i.time+l},add:function(t,e,n){var r=e?function(e,n,s,o){t(e,n,s,o),i.remove(r)}:t;return i.remove(t),f[n?"unshift":"push"](r),qm(),r},remove:function(t,e){~(e=f.indexOf(t))&&f.splice(e,1)&&s>=e&&s--},_listeners:f},i}(),qm=function(){return!Rf&&jm.wake()},zm={},$m=/^[\d.\-M][\d.\-,\s]/,Hm=/["']/g,Km=function(t){for(var e,n,i,r={},s=t.substr(1,t.length-3).split(":"),o=s[0],a=1,u=s.length;a<u;a++)n=s[a],e=a!==u-1?n.lastIndexOf(","):n.length,i=n.substr(0,e),r[o]=isNaN(i)?i.replace(Hm,"").trim():+i,o=n.substr(e+1).trim();return r},Gm=function(t){return function(e){return 1-t(1-e)}},Wm=function t(e,n){for(var i,r=e._first;r;)r instanceof ng?t(r,n):!r.vars.yoyoEase||r._yoyo&&r._repeat||r._yoyo===n||(r.timeline?t(r.timeline,n):(i=r._ease,r._ease=r._yEase,r._yEase=i,r._yoyo=n)),r=r._next},Qm=function(t,e){return t&&(Gf(t)?t:zm[t]||function(t){var e,n,i,r,s=(t+"").split("("),o=zm[s[0]];return o&&s.length>1&&o.config?o.config.apply(null,~t.indexOf("{")?[Km(s[1])]:(e=t,n=e.indexOf("(")+1,i=e.indexOf(")"),r=e.indexOf("(",n),e.substring(n,~r&&r<i?e.indexOf(")",i+1):i)).split(",").map(Up)):zm._CE&&$m.test(t)?zm._CE("",t):o}(t))||e},Xm=function(t,e,n,i){void 0===n&&(n=function(t){return 1-e(1-t)}),void 0===i&&(i=function(t){return t<.5?e(2*t)/2:1-e(2*(1-t))/2});var r,s={easeIn:e,easeOut:n,easeInOut:i};return Np(t,(function(t){for(var e in zm[t]=cp[t]=s,zm[r=t.toLowerCase()]=n,s)zm[r+("easeIn"===e?".in":"easeOut"===e?".out":".inOut")]=zm[t+"."+e]=s[e]})),s},Ym=function(t){return function(e){return e<.5?(1-t(1-2*e))/2:.5+t(2*(e-.5))/2}},Jm=function t(e,n,i){var r=n>=1?n:1,s=(i||(e?.3:.45))/(n<1?n:1),o=s/Bf*(Math.asin(1/r)||0),a=function(t){return 1===t?1:r*Math.pow(2,-10*t)*Hf((t-o)*s)+1},u="out"===e?a:"in"===e?function(t){return 1-a(1-t)}:Ym(a);return s=Bf/s,u.config=function(n,i){return t(e,n,i)},u},Zm=function t(e,n){void 0===n&&(n=1.70158);var i=function(t){return t?--t*t*((n+1)*t+n)+1:0},r="out"===e?i:"in"===e?function(t){return 1-i(1-t)}:Ym(i);return r.config=function(n){return t(e,n)},r};Np("Linear,Quad,Cubic,Quart,Quint,Strong",(function(t,e){var n=e<5?e+1:e;Xm(t+",Power"+(n-1),e?function(t){return Math.pow(t,n)}:function(t){return t},(function(t){return 1-Math.pow(1-t,n)}),(function(t){return t<.5?Math.pow(2*t,n)/2:1-Math.pow(2*(1-t),n)/2}))})),zm.Linear.easeNone=zm.none=zm.Linear.easeIn,Xm("Elastic",Jm("in"),Jm("out"),Jm()),Of=7.5625,Mf=1/(xf=2.75),Lf=function(t){return t<Mf?Of*t*t:t<.7272727272727273?Of*Math.pow(t-1.5/xf,2)+.75:t<.9090909090909092?Of*(t-=2.25/xf)*t+.9375:Of*Math.pow(t-2.625/xf,2)+.984375},Xm("Bounce",(function(t){return 1-Lf(1-t)}),Lf),Xm("Expo",(function(t){return t?Math.pow(2,10*(t-1)):0})),Xm("Circ",(function(t){return-(zf(1-t*t)-1)})),Xm("Sine",(function(t){return 1===t?1:1-$f(t*jf)})),Xm("Back",Zm("in"),Zm("out"),Zm()),zm.SteppedEase=zm.steps=cp.SteppedEase={config:function(t,e){void 0===t&&(t=1);var n=1/t,i=t+(e?0:1),r=e?1:0;return function(t){return((i*pm(0,.99999999,t)|0)+r)*n}}},Uf.ease=zm["quad.out"],Np("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",(function(t){return kp+=t+","+t+"Params,"}));var tg=function(t,e){this.id=qf++,t._gsap=this,this.target=t,this.harness=e,this.get=e?e.get:Dp,this.set=e?e.getSetter:vg},eg=function(){function t(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,um(this,+t.duration,1,1),this.data=t.data,If&&(this._ctx=If,If.data.push(this)),Rf||jm.wake()}var e=t.prototype;return e.delay=function(t){return t||0===t?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+t-this._delay),this._delay=t,this):this._delay},e.duration=function(t){return arguments.length?this.totalDuration(this._repeat>0?t+(t+this._rDelay)*this._repeat:t):this.totalDuration()&&this._dur},e.totalDuration=function(t){return arguments.length?(this._dirty=0,um(this,this._repeat<0?t:(t-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(t,e){if(qm(),!arguments.length)return this._tTime;var n=this._dp;if(n&&n.smoothChildTiming&&this._ts){for(em(this,t),!n._dp||n.parent||nm(n,this);n&&n.parent;)n.parent._time!==n._start+(n._ts>=0?n._tTime/n._ts:(n.totalDuration()-n._tTime)/-n._ts)&&n.totalTime(n._tTime,!0),n=n.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&t<this._tDur||this._ts<0&&t>0||!this._tDur&&!t)&&im(this._dp,this,this._start-this._delay)}return(this._tTime!==t||!this._dur&&!e||this._initted&&Math.abs(this._zTime)===Vf||!t&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=t),Pp(this,t,e)),this},e.time=function(t,e){return arguments.length?this.totalTime(Math.min(this.totalDuration(),t+Yp(this))%(this._dur+this._rDelay)||(t?this._dur:0),e):this._time},e.totalProgress=function(t,e){return arguments.length?this.totalTime(this.totalDuration()*t,e):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},e.progress=function(t,e){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?t:1-t)+Yp(this),e):this.duration()?Math.min(1,this._time/this._dur):this.ratio},e.iteration=function(t,e){var n=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(t-1)*n,e):this._repeat?Jp(this._tTime,n)+1:1},e.timeScale=function(t){if(!arguments.length)return-1e-8===this._rts?0:this._rts;if(this._rts===t)return this;var e=this.parent&&this._ts?Zp(this.parent._time,this):this._tTime;return this._rts=+t||0,this._ts=this._ps||-1e-8===t?0:this._rts,this.totalTime(pm(-this._delay,this._tDur,e),!0),tm(this),Wp(this)},e.paused=function(t){return arguments.length?(this._ps!==t&&(this._ps=t,t?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(qm(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&Math.abs(this._zTime)!==Vf&&(this._tTime-=Vf)))),this):this._ps},e.startTime=function(t){if(arguments.length){this._start=t;var e=this.parent||this._dp;return e&&(e._sort||!this.parent)&&im(e,this,t-this._delay),this}return this._start},e.endTime=function(t){return this._start+(Yf(t)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(t){var e=this.parent||this._dp;return e?t&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Zp(e.rawTime(t),this):this._tTime:this._tTime},e.revert=function(t){void 0===t&&(t=vp);var e=Tf;return Tf=t,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(t),this.totalTime(-.01,t.suppressEvents)),"nested"!==this.data&&!1!==t.kill&&this.kill(),Tf=e,this},e.globalTime=function(t){for(var e=this,n=arguments.length?t:e.rawTime();e;)n=e._start+n/(e._ts||1),e=e._dp;return!this.parent&&this.vars.immediateRender?-1:n},e.repeat=function(t){return arguments.length?(this._repeat=t===1/0?-2:t,cm(this)):-2===this._repeat?1/0:this._repeat},e.repeatDelay=function(t){if(arguments.length){var e=this._time;return this._rDelay=t,cm(this),e?this.time(e):this}return this._rDelay},e.yoyo=function(t){return arguments.length?(this._yoyo=t,this):this._yoyo},e.seek=function(t,e){return this.totalTime(lm(this,t),Yf(e))},e.restart=function(t,e){return this.play().totalTime(t?-this._delay:0,Yf(e))},e.play=function(t,e){return null!=t&&this.seek(t,e),this.reversed(!1).paused(!1)},e.reverse=function(t,e){return null!=t&&this.seek(t||this.totalDuration(),e),this.reversed(!0).paused(!1)},e.pause=function(t,e){return null!=t&&this.seek(t,e),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(t){return arguments.length?(!!t!==this.reversed()&&this.timeScale(-this._rts||(t?-1e-8:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-1e-8,this},e.isActive=function(){var t,e=this.parent||this._dp,n=this._start;return!(e&&!(this._ts&&this._initted&&e.isActive()&&(t=e.rawTime(!0))>=n&&t<this.endTime(!0)-Vf))},e.eventCallback=function(t,e,n){var i=this.vars;return arguments.length>1?(e?(i[t]=e,n&&(i[t+"Params"]=n),"onUpdate"===t&&(this._onUpdate=e)):delete i[t],this):i[t]},e.then=function(t){var e=this;return new Promise((function(n){var i=Gf(t)?t:Fp,r=function(){var t=e.then;e.then=null,Gf(i)&&(i=i(e))&&(i.then||i===e)&&(e.then=t),n(i),e.then=t};e._initted&&1===e.totalProgress()&&e._ts>=0||!e._tTime&&e._ts<0?r():e._prom=r}))},e.kill=function(){Nm(this)},t}();Vp(eg.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-1e-8,_prom:0,_ps:!1,_rts:1});var ng=function(t){function e(e,n){var i;return void 0===e&&(e={}),(i=t.call(this,e)||this).labels={},i.smoothChildTiming=!!e.smoothChildTiming,i.autoRemoveChildren=!!e.autoRemoveChildren,i._sort=Yf(e.sortChildren),Ef&&im(e.parent||Ef,_f(i),n),e.reversed&&i.reverse(),e.paused&&i.paused(!0),e.scrollTrigger&&rm(_f(i),e.scrollTrigger),i}wf(e,t);var n=e.prototype;return n.to=function(t,e,n){return dm(0,arguments,this),this},n.from=function(t,e,n){return dm(1,arguments,this),this},n.fromTo=function(t,e,n,i){return dm(2,arguments,this),this},n.set=function(t,e,n){return e.duration=0,e.parent=this,zp(e).repeatDelay||(e.repeat=0),e.immediateRender=!!e.immediateRender,new fg(t,e,lm(this,n),1),this},n.call=function(t,e,n){return im(this,fg.delayedCall(0,t,e),n)},n.staggerTo=function(t,e,n,i,r,s,o){return n.duration=e,n.stagger=n.stagger||i,n.onComplete=s,n.onCompleteParams=o,n.parent=this,new fg(t,n,lm(this,r)),this},n.staggerFrom=function(t,e,n,i,r,s,o){return n.runBackwards=1,zp(n).immediateRender=Yf(n.immediateRender),this.staggerTo(t,e,n,i,r,s,o)},n.staggerFromTo=function(t,e,n,i,r,s,o,a){return i.startAt=n,zp(i).immediateRender=Yf(i.immediateRender),this.staggerTo(t,e,i,r,s,o,a)},n.render=function(t,e,n){var i,r,s,o,a,u,c,h,l,d,f,p,m=this._time,g=this._dirty?this.totalDuration():this._tDur,y=this._dur,v=t<=0?0:Op(t),_=this._zTime<0!=t<0&&(this._initted||!y);if(this!==Ef&&v>g&&t>=0&&(v=g),v!==this._tTime||n||_){if(m!==this._time&&y&&(v+=this._time-m,t+=this._time-m),i=v,l=this._start,u=!(h=this._ts),_&&(y||(m=this._zTime),(t||!e)&&(this._zTime=t)),this._repeat){if(f=this._yoyo,a=y+this._rDelay,this._repeat<-1&&t<0)return this.totalTime(100*a+t,e,n);if(i=Op(v%a),v===g?(o=this._repeat,i=y):((o=~~(v/a))&&o===v/a&&(i=y,o--),i>y&&(i=y)),d=Jp(this._tTime,a),!m&&this._tTime&&d!==o&&(d=o),f&&1&o&&(i=y-i,p=1),o!==d&&!this._lock){var w=f&&1&d,b=w===(f&&1&o);if(o<d&&(w=!w),m=w?0:y,this._lock=1,this.render(m||(p?0:Op(o*a)),e,!y)._lock=0,this._tTime=v,!e&&this.parent&&Dm(this,"onRepeat"),this.vars.repeatRefresh&&!p&&(this.invalidate()._lock=1),m&&m!==this._time||u!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(y=this._dur,g=this._tDur,b&&(this._lock=2,m=w?y:-1e-4,this.render(m,!0),this.vars.repeatRefresh&&!p&&this.invalidate()),this._lock=0,!this._ts&&!u)return this;Wm(this,p)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(c=function(t,e,n){var i;if(n>e)for(i=t._first;i&&i._start<=n;){if("isPause"===i.data&&i._start>e)return i;i=i._next}else for(i=t._last;i&&i._start>=n;){if("isPause"===i.data&&i._start<e)return i;i=i._prev}}(this,Op(m),Op(i)),c&&(v-=i-(i=c._start))),this._tTime=v,this._time=i,this._act=!h,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=t,m=0),!m&&i&&!e&&(Dm(this,"onStart"),this._tTime!==v))return this;if(i>=m&&t>=0)for(r=this._first;r;){if(s=r._next,(r._act||i>=r._start)&&r._ts&&c!==r){if(r.parent!==this)return this.render(t,e,n);if(r.render(r._ts>0?(i-r._start)*r._ts:(r._dirty?r.totalDuration():r._tDur)+(i-r._start)*r._ts,e,n),i!==this._time||!this._ts&&!u){c=0,s&&(v+=this._zTime=-1e-8);break}}r=s}else{r=this._last;for(var T=t<0?t:i;r;){if(s=r._prev,(r._act||T<=r._end)&&r._ts&&c!==r){if(r.parent!==this)return this.render(t,e,n);if(r.render(r._ts>0?(T-r._start)*r._ts:(r._dirty?r.totalDuration():r._tDur)+(T-r._start)*r._ts,e,n||Tf&&(r._initted||r._startAt)),i!==this._time||!this._ts&&!u){c=0,s&&(v+=this._zTime=T?-1e-8:Vf);break}}r=s}}if(c&&!e&&(this.pause(),c.render(i>=m?0:-1e-8)._zTime=i>=m?1:-1,this._ts))return this._start=l,tm(this),this.render(t,e,n);this._onUpdate&&!e&&Dm(this,"onUpdate",!0),(v===g&&this._tTime>=this.totalDuration()||!v&&m)&&(l!==this._start&&Math.abs(h)===Math.abs(this._ts)||this._lock||((t||!y)&&(v===g&&this._ts>0||!v&&this._ts<0)&&Kp(this,1),e||t<0&&!m||!v&&!m&&g||(Dm(this,v===g&&t>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(v<g&&this.timeScale()>0)&&this._prom())))}return this},n.add=function(t,e){var n=this;if(Wf(e)||(e=lm(this,e,t)),!(t instanceof eg)){if(ep(t))return t.forEach((function(t){return n.add(t,e)})),this;if(Kf(t))return this.addLabel(t,e);if(!Gf(t))return this;t=fg.delayedCall(0,t)}return this!==t?im(this,t,e):this},n.getChildren=function(t,e,n,i){void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===n&&(n=!0),void 0===i&&(i=-Ff);for(var r=[],s=this._first;s;)s._start>=i&&(s instanceof fg?e&&r.push(s):(n&&r.push(s),t&&r.push.apply(r,s.getChildren(!0,e,n)))),s=s._next;return r},n.getById=function(t){for(var e=this.getChildren(1,1,1),n=e.length;n--;)if(e[n].vars.id===t)return e[n]},n.remove=function(t){return Kf(t)?this.removeLabel(t):Gf(t)?this.killTweensOf(t):(Hp(this,t),t===this._recent&&(this._recent=this._last),Gp(this))},n.totalTime=function(e,n){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Op(jm.time-(this._ts>0?e/this._ts:(this.totalDuration()-e)/-this._ts))),t.prototype.totalTime.call(this,e,n),this._forcing=0,this):this._tTime},n.addLabel=function(t,e){return this.labels[t]=lm(this,e),this},n.removeLabel=function(t){return delete this.labels[t],this},n.addPause=function(t,e,n){var i=fg.delayedCall(0,e||mp,n);return i.data="isPause",this._hasPause=1,im(this,i,lm(this,t))},n.removePause=function(t){var e=this._first;for(t=lm(this,t);e;)e._start===t&&"isPause"===e.data&&Kp(e),e=e._next},n.killTweensOf=function(t,e,n){for(var i=this.getTweensOf(t,n),r=i.length;r--;)ig!==i[r]&&i[r].kill(t,e);return this},n.getTweensOf=function(t,e){for(var n,i=[],r=vm(t),s=this._first,o=Wf(e);s;)s instanceof fg?Mp(s._targets,r)&&(o?(!ig||s._initted&&s._ts)&&s.globalTime(0)<=e&&s.globalTime(s.totalDuration())>e:!e||s.isActive())&&i.push(s):(n=s.getTweensOf(r,e)).length&&i.push.apply(i,n),s=s._next;return i},n.tweenTo=function(t,e){e=e||{};var n,i=this,r=lm(i,t),s=e,o=s.startAt,a=s.onStart,u=s.onStartParams,c=s.immediateRender,h=fg.to(i,Vp({ease:e.ease||"none",lazy:!1,immediateRender:!1,time:r,overwrite:"auto",duration:e.duration||Math.abs((r-(o&&"time"in o?o.time:i._time))/i.timeScale())||Vf,onStart:function(){if(i.pause(),!n){var t=e.duration||Math.abs((r-(o&&"time"in o?o.time:i._time))/i.timeScale());h._dur!==t&&um(h,t,0,1).render(h._time,!0,!0),n=1}a&&a.apply(h,u||[])}},e));return c?h.render(0):h},n.tweenFromTo=function(t,e,n){return this.tweenTo(e,Vp({startAt:{time:lm(this,t)}},n))},n.recent=function(){return this._recent},n.nextLabel=function(t){return void 0===t&&(t=this._time),Am(this,lm(this,t))},n.previousLabel=function(t){return void 0===t&&(t=this._time),Am(this,lm(this,t),1)},n.currentLabel=function(t){return arguments.length?this.seek(t,!0):this.previousLabel(this._time+Vf)},n.shiftChildren=function(t,e,n){void 0===n&&(n=0);for(var i,r=this._first,s=this.labels;r;)r._start>=n&&(r._start+=t,r._end+=t),r=r._next;if(e)for(i in s)s[i]>=n&&(s[i]+=t);return Gp(this)},n.invalidate=function(e){var n=this._first;for(this._lock=0;n;)n.invalidate(e),n=n._next;return t.prototype.invalidate.call(this,e)},n.clear=function(t){void 0===t&&(t=!0);for(var e,n=this._first;n;)e=n._next,this.remove(n),n=e;return this._dp&&(this._time=this._tTime=this._pTime=0),t&&(this.labels={}),Gp(this)},n.totalDuration=function(t){var e,n,i,r=0,s=this,o=s._last,a=Ff;if(arguments.length)return s.timeScale((s._repeat<0?s.duration():s.totalDuration())/(s.reversed()?-t:t));if(s._dirty){for(i=s.parent;o;)e=o._prev,o._dirty&&o.totalDuration(),(n=o._start)>a&&s._sort&&o._ts&&!s._lock?(s._lock=1,im(s,o,n-o._delay,1)._lock=0):a=n,n<0&&o._ts&&(r-=n,(!i&&!s._dp||i&&i.smoothChildTiming)&&(s._start+=n/s._ts,s._time-=n,s._tTime-=n),s.shiftChildren(-n,!1,-Infinity),a=0),o._end>r&&o._ts&&(r=o._end),o=e;um(s,s===Ef&&s._time>r?s._time:r,1,1),s._dirty=0}return s._tDur},e.updateRoot=function(t){if(Ef._ts&&(Pp(Ef,Zp(t,Ef)),Df=jm.frame),jm.frame>=Ep){Ep+=Pf.autoSleep||120;var e=Ef._first;if((!e||!e._ts)&&Pf.autoSleep&&jm._listeners.length<2){for(;e&&!e._ts;)e=e._next;e||jm.sleep()}}},e}(eg);Vp(ng.prototype,{_lock:0,_hasPause:0,_forcing:0});var ig,rg,sg=function(t,e,n,i,r,s,o){var a,u,c,h,l,d,f,p,m=new Cg(this._pt,t,e,0,1,bg,null,r),g=0,y=0;for(m.b=n,m.e=i,n+="",(f=~(i+="").indexOf("random("))&&(i=km(i)),s&&(s(p=[n,i],t,e),n=p[0],i=p[1]),u=n.match(sp)||[];a=sp.exec(i);)h=a[0],l=i.substring(g,a.index),c?c=(c+1)%5:"rgba("===l.substr(-5)&&(c=1),h!==u[y++]&&(d=parseFloat(u[y-1])||0,m._pt={_next:m._pt,p:l||1===y?l:",",s:d,c:"="===h.charAt(1)?xp(d,h)-d:parseFloat(h)-d,m:c&&c<4?Math.round:0},g=sp.lastIndex);return m.c=g<i.length?i.substring(g,i.length):"",m.fp=o,(op.test(i)||f)&&(m.e=0),this._pt=m,m},og=function(t,e,n,i,r,s,o,a,u,c){Gf(i)&&(i=i(r||0,t,s));var h,l=t[e],d="get"!==n?n:Gf(l)?u?t[e.indexOf("set")||!Gf(t["get"+e.substr(3)])?e:"get"+e.substr(3)](u):t[e]():l,f=Gf(l)?u?gg:mg:pg;if(Kf(i)&&(~i.indexOf("random(")&&(i=km(i)),"="===i.charAt(1)&&((h=xp(d,i)+(mm(d)||0))||0===h)&&(i=h)),!c||d!==i||rg)return isNaN(d*i)||""===i?(!l&&!(e in t)&&dp(e,i),sg.call(this,t,e,d,i,f,a||Pf.stringFilter,u)):(h=new Cg(this._pt,t,e,+d||0,i-(d||0),"boolean"==typeof l?wg:_g,0,f),u&&(h.fp=u),o&&h.modifier(o,this,t),this._pt=h)},ag=function(t,e,n,i,r,s){var o,a,u,c;if(Tp[t]&&!1!==(o=new Tp[t]).init(r,o.rawVars?e[t]:function(t,e,n,i,r){if(Gf(t)&&(t=hg(t,r,e,n,i)),!Xf(t)||t.style&&t.nodeType||ep(t)||tp(t))return Kf(t)?hg(t,r,e,n,i):t;var s,o={};for(s in t)o[s]=hg(t[s],r,e,n,i);return o}(e[t],i,r,s,n),n,i,s)&&(n._pt=a=new Cg(n._pt,r,t,0,1,o.render,o,0,o.priority),n!==Nf))for(u=n._ptLookup[n._targets.indexOf(r)],c=o._props.length;c--;)u[o._props[c]]=a;return o},ug=function t(e,n,i){var r,s,o,a,u,c,h,l,d,f,p,m,g,y=e.vars,v=y.ease,_=y.startAt,w=y.immediateRender,b=y.lazy,T=y.onUpdate,I=y.onUpdateParams,E=y.callbackScope,S=y.runBackwards,k=y.yoyoEase,C=y.keyframes,A=y.autoRevert,D=e._dur,N=e._startAt,R=e._targets,O=e.parent,x=O&&"nested"===O.data?O.vars.targets:R,M="auto"===e._overwrite&&!bf,L=e.timeline;if(L&&(!C||!v)&&(v="none"),e._ease=Qm(v,Uf.ease),e._yEase=k?Gm(Qm(!0===k?v:k,Uf.ease)):0,k&&e._yoyo&&!e._repeat&&(k=e._yEase,e._yEase=e._ease,e._ease=k),e._from=!L&&!!y.runBackwards,!L||C&&!y.stagger){if(m=(l=R[0]?Ap(R[0]).harness:0)&&y[l.prop],r=qp(y,_p),N&&(N._zTime<0&&N.progress(1),n<0&&S&&w&&!A?N.render(-1,!0):N.revert(S&&D?yp:gp),N._lazy=0),_){if(Kp(e._startAt=fg.set(R,Vp({data:"isStart",overwrite:!1,parent:O,immediateRender:!0,lazy:Yf(b),startAt:null,delay:0,onUpdate:T,onUpdateParams:I,callbackScope:E,stagger:0},_))),e._startAt._dp=0,n<0&&(Tf||!w&&!A)&&e._startAt.revert(yp),w&&D&&n<=0&&i<=0)return void(n&&(e._zTime=n))}else if(S&&D&&!N)if(n&&(w=!1),o=Vp({overwrite:!1,data:"isFromStart",lazy:w&&Yf(b),immediateRender:w,stagger:0,parent:O},r),m&&(o[l.prop]=m),Kp(e._startAt=fg.set(R,o)),e._startAt._dp=0,n<0&&(Tf?e._startAt.revert(yp):e._startAt.render(-1,!0)),e._zTime=n,w){if(!n)return}else t(e._startAt,Vf,Vf);for(e._pt=e._ptCache=0,b=D&&Yf(b)||b&&!D,s=0;s<R.length;s++){if(h=(u=R[s])._gsap||Cp(R)[s]._gsap,e._ptLookup[s]=f={},bp[h.id]&&wp.length&&Lp(),p=x===R?s:x.indexOf(u),l&&!1!==(d=new l).init(u,m||r,e,p,x)&&(e._pt=a=new Cg(e._pt,u,d.name,0,1,d.render,d,0,d.priority),d._props.forEach((function(t){f[t]=a})),d.priority&&(c=1)),!l||m)for(o in r)Tp[o]&&(d=ag(o,r,e,p,u,x))?d.priority&&(c=1):f[o]=a=og.call(e,u,o,"get",r[o],p,x,0,y.stringFilter);e._op&&e._op[s]&&e.kill(u,e._op[s]),M&&e._pt&&(ig=e,Ef.killTweensOf(u,f,e.globalTime(n)),g=!e.parent,ig=0),e._pt&&b&&(bp[h.id]=1)}c&&kg(e),e._onInit&&e._onInit(e)}e._onUpdate=T,e._initted=(!e._op||e._pt)&&!g,C&&n<=0&&L.render(Ff,!0,!0)},cg=function(t,e,n,i){var r,s,o=e.ease||i||"power1.inOut";if(ep(e))s=n[t]||(n[t]=[]),e.forEach((function(t,n){return s.push({t:n/(e.length-1)*100,v:t,e:o})}));else for(r in e)s=n[r]||(n[r]=[]),"ease"===r||s.push({t:parseFloat(t),v:e[r],e:o})},hg=function(t,e,n,i,r){return Gf(t)?t.call(e,n,i,r):Kf(t)&&~t.indexOf("random(")?km(t):t},lg=kp+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",dg={};Np(lg+",id,stagger,delay,duration,paused,scrollTrigger",(function(t){return dg[t]=1}));var fg=function(t){function e(e,n,i,r){var s;"number"==typeof n&&(i.duration=n,n=i,i=null);var o,a,u,c,h,l,d,f,p=(s=t.call(this,r?n:zp(n))||this).vars,m=p.duration,g=p.delay,y=p.immediateRender,v=p.stagger,_=p.overwrite,w=p.keyframes,b=p.defaults,T=p.scrollTrigger,I=p.yoyoEase,E=n.parent||Ef,S=(ep(e)||tp(e)?Wf(e[0]):"length"in n)?[e]:vm(e);if(s._targets=S.length?Cp(S):fp("GSAP target "+e+" not found. https://greensock.com",!Pf.nullTargetWarn)||[],s._ptLookup=[],s._overwrite=_,w||v||Zf(m)||Zf(g)){if(n=s.vars,(o=s.timeline=new ng({data:"nested",defaults:b||{},targets:E&&"nested"===E.data?E.vars.targets:S})).kill(),o.parent=o._dp=_f(s),o._start=0,v||Zf(m)||Zf(g)){if(c=S.length,d=v&&bm(v),Xf(v))for(h in v)~lg.indexOf(h)&&(f||(f={}),f[h]=v[h]);for(a=0;a<c;a++)(u=qp(n,dg)).stagger=0,I&&(u.yoyoEase=I),f&&Bp(u,f),l=S[a],u.duration=+hg(m,_f(s),a,l,S),u.delay=(+hg(g,_f(s),a,l,S)||0)-s._delay,!v&&1===c&&u.delay&&(s._delay=g=u.delay,s._start+=g,u.delay=0),o.to(l,u,d?d(a,l,S):0),o._ease=zm.none;o.duration()?m=g=0:s.timeline=0}else if(w){zp(Vp(o.vars.defaults,{ease:"none"})),o._ease=Qm(w.ease||n.ease||"none");var k,C,A,D=0;if(ep(w))w.forEach((function(t){return o.to(S,t,">")})),o.duration();else{for(h in u={},w)"ease"===h||"easeEach"===h||cg(h,w[h],u,w.easeEach);for(h in u)for(k=u[h].sort((function(t,e){return t.t-e.t})),D=0,a=0;a<k.length;a++)(A={ease:(C=k[a]).e,duration:(C.t-(a?k[a-1].t:0))/100*m})[h]=C.v,o.to(S,A,D),D+=A.duration;o.duration()<m&&o.to({},{duration:m-o.duration()})}}m||s.duration(m=o.duration())}else s.timeline=0;return!0!==_||bf||(ig=_f(s),Ef.killTweensOf(S),ig=0),im(E,_f(s),i),n.reversed&&s.reverse(),n.paused&&s.paused(!0),(y||!m&&!w&&s._start===Op(E._time)&&Yf(y)&&Xp(_f(s))&&"nested"!==E.data)&&(s._tTime=-1e-8,s.render(Math.max(0,-g)||0)),T&&rm(_f(s),T),s}wf(e,t);var n=e.prototype;return n.render=function(t,e,n){var i,r,s,o,a,u,c,h,l,d=this._time,f=this._tDur,p=this._dur,m=t<0,g=t>f-Vf&&!m?f:t<Vf?0:t;if(p){if(g!==this._tTime||!t||n||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==m){if(i=g,h=this.timeline,this._repeat){if(o=p+this._rDelay,this._repeat<-1&&m)return this.totalTime(100*o+t,e,n);if(i=Op(g%o),g===f?(s=this._repeat,i=p):((s=~~(g/o))&&s===g/o&&(i=p,s--),i>p&&(i=p)),(u=this._yoyo&&1&s)&&(l=this._yEase,i=p-i),a=Jp(this._tTime,o),i===d&&!n&&this._initted)return this._tTime=g,this;s!==a&&(h&&this._yEase&&Wm(h,u),!this.vars.repeatRefresh||u||this._lock||(this._lock=n=1,this.render(Op(o*s),!0).invalidate()._lock=0))}if(!this._initted){if(sm(this,m?t:i,n,e,g))return this._tTime=0,this;if(d!==this._time)return this;if(p!==this._dur)return this.render(t,e,n)}if(this._tTime=g,this._time=i,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=c=(l||this._ease)(i/p),this._from&&(this.ratio=c=1-c),i&&!d&&!e&&(Dm(this,"onStart"),this._tTime!==g))return this;for(r=this._pt;r;)r.r(c,r.d),r=r._next;h&&h.render(t<0?t:!i&&u?-1e-8:h._dur*h._ease(i/this._dur),e,n)||this._startAt&&(this._zTime=t),this._onUpdate&&!e&&(m&&Qp(this,t,0,n),Dm(this,"onUpdate")),this._repeat&&s!==a&&this.vars.onRepeat&&!e&&this.parent&&Dm(this,"onRepeat"),g!==this._tDur&&g||this._tTime!==g||(m&&!this._onUpdate&&Qp(this,t,0,!0),(t||!p)&&(g===this._tDur&&this._ts>0||!g&&this._ts<0)&&Kp(this,1),e||m&&!d||!(g||d||u)||(Dm(this,g===f?"onComplete":"onReverseComplete",!0),this._prom&&!(g<f&&this.timeScale()>0)&&this._prom()))}}else!function(t,e,n,i){var r,s,o,a=t.ratio,u=e<0||!e&&(!t._start&&om(t)&&(t._initted||!am(t))||(t._ts<0||t._dp._ts<0)&&!am(t))?0:1,c=t._rDelay,h=0;if(c&&t._repeat&&(h=pm(0,t._tDur,e),s=Jp(h,c),t._yoyo&&1&s&&(u=1-u),s!==Jp(t._tTime,c)&&(a=1-u,t.vars.repeatRefresh&&t._initted&&t.invalidate())),u!==a||Tf||i||t._zTime===Vf||!e&&t._zTime){if(!t._initted&&sm(t,e,i,n,h))return;for(o=t._zTime,t._zTime=e||(n?Vf:0),n||(n=e&&!o),t.ratio=u,t._from&&(u=1-u),t._time=0,t._tTime=h,r=t._pt;r;)r.r(u,r.d),r=r._next;e<0&&Qp(t,e,0,!0),t._onUpdate&&!n&&Dm(t,"onUpdate"),h&&t._repeat&&!n&&t.parent&&Dm(t,"onRepeat"),(e>=t._tDur||e<0)&&t.ratio===u&&(u&&Kp(t,1),n||Tf||(Dm(t,u?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=e)}(this,t,e,n);return this},n.targets=function(){return this._targets},n.invalidate=function(e){return(!e||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(e),t.prototype.invalidate.call(this,e)},n.resetTo=function(t,e,n,i){Rf||jm.wake(),this._ts||this.play();var r=Math.min(this._dur,(this._dp._time-this._start)*this._ts);return this._initted||ug(this,r),function(t,e,n,i,r,s,o){var a,u,c,h,l=(t._pt&&t._ptCache||(t._ptCache={}))[e];if(!l)for(l=t._ptCache[e]=[],c=t._ptLookup,h=t._targets.length;h--;){if((a=c[h][e])&&a.d&&a.d._pt)for(a=a.d._pt;a&&a.p!==e&&a.fp!==e;)a=a._next;if(!a)return rg=1,t.vars[e]="+=0",ug(t,o),rg=0,1;l.push(a)}for(h=l.length;h--;)(a=(u=l[h])._pt||u).s=!i&&0!==i||r?a.s+(i||0)+s*a.c:i,a.c=n-a.s,u.e&&(u.e=Rp(n)+mm(u.e)),u.b&&(u.b=a.s+mm(u.b))}(this,t,e,n,i,this._ease(r/this._dur),r)?this.resetTo(t,e,n,i):(em(this,0),this.parent||$p(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},n.kill=function(t,e){if(void 0===e&&(e="all"),!(t||e&&"all"!==e))return this._lazy=this._pt=0,this.parent?Nm(this):this;if(this.timeline){var n=this.timeline.totalDuration();return this.timeline.killTweensOf(t,e,ig&&!0!==ig.vars.overwrite)._first||Nm(this),this.parent&&n!==this.timeline.totalDuration()&&um(this,this._dur*this.timeline._tDur/n,0,1),this}var i,r,s,o,a,u,c,h=this._targets,l=t?vm(t):h,d=this._ptLookup,f=this._pt;if((!e||"all"===e)&&function(t,e){for(var n=t.length,i=n===e.length;i&&n--&&t[n]===e[n];);return n<0}(h,l))return"all"===e&&(this._pt=0),Nm(this);for(i=this._op=this._op||[],"all"!==e&&(Kf(e)&&(a={},Np(e,(function(t){return a[t]=1})),e=a),e=function(t,e){var n,i,r,s,o=t[0]?Ap(t[0]).harness:0,a=o&&o.aliases;if(!a)return e;for(i in n=Bp({},e),a)if(i in n)for(r=(s=a[i].split(",")).length;r--;)n[s[r]]=n[i];return n}(h,e)),c=h.length;c--;)if(~l.indexOf(h[c]))for(a in r=d[c],"all"===e?(i[c]=e,o=r,s={}):(s=i[c]=i[c]||{},o=e),o)(u=r&&r[a])&&("kill"in u.d&&!0!==u.d.kill(a)||Hp(this,u,"_pt"),delete r[a]),"all"!==s&&(s[a]=1);return this._initted&&!this._pt&&f&&Nm(this),this},e.to=function(t,n){return new e(t,n,arguments[2])},e.from=function(t,e){return dm(1,arguments)},e.delayedCall=function(t,n,i,r){return new e(n,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:t,onComplete:n,onReverseComplete:n,onCompleteParams:i,onReverseCompleteParams:i,callbackScope:r})},e.fromTo=function(t,e,n){return dm(2,arguments)},e.set=function(t,n){return n.duration=0,n.repeatDelay||(n.repeat=0),new e(t,n)},e.killTweensOf=function(t,e,n){return Ef.killTweensOf(t,e,n)},e}(eg);Vp(fg.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),Np("staggerTo,staggerFrom,staggerFromTo",(function(t){fg[t]=function(){var e=new ng,n=gm.call(arguments,0);return n.splice("staggerFromTo"===t?5:4,0,0),e[t].apply(e,n)}}));var pg=function(t,e,n){return t[e]=n},mg=function(t,e,n){return t[e](n)},gg=function(t,e,n,i){return t[e](i.fp,n)},yg=function(t,e,n){return t.setAttribute(e,n)},vg=function(t,e){return Gf(t[e])?mg:Qf(t[e])&&t.setAttribute?yg:pg},_g=function(t,e){return e.set(e.t,e.p,Math.round(1e6*(e.s+e.c*t))/1e6,e)},wg=function(t,e){return e.set(e.t,e.p,!!(e.s+e.c*t),e)},bg=function(t,e){var n=e._pt,i="";if(!t&&e.b)i=e.b;else if(1===t&&e.e)i=e.e;else{for(;n;)i=n.p+(n.m?n.m(n.s+n.c*t):Math.round(1e4*(n.s+n.c*t))/1e4)+i,n=n._next;i+=e.c}e.set(e.t,e.p,i,e)},Tg=function(t,e){for(var n=e._pt;n;)n.r(t,n.d),n=n._next},Ig=function(t,e,n,i){for(var r,s=this._pt;s;)r=s._next,s.p===i&&s.modifier(t,e,n),s=r},Eg=function(t){for(var e,n,i=this._pt;i;)n=i._next,i.p===t&&!i.op||i.op===t?Hp(this,i,"_pt"):i.dep||(e=1),i=n;return!e},Sg=function(t,e,n,i){i.mSet(t,e,i.m.call(i.tween,n,i.mt),i)},kg=function(t){for(var e,n,i,r,s=t._pt;s;){for(e=s._next,n=i;n&&n.pr>s.pr;)n=n._next;(s._prev=n?n._prev:r)?s._prev._next=s:i=s,(s._next=n)?n._prev=s:r=s,s=e}t._pt=i},Cg=function(){function t(t,e,n,i,r,s,o,a,u){this.t=e,this.s=i,this.c=r,this.p=n,this.r=s||_g,this.d=o||this,this.set=a||pg,this.pr=u||0,this._next=t,t&&(t._prev=this)}return t.prototype.modifier=function(t,e,n){this.mSet=this.mSet||this.set,this.set=Sg,this.m=t,this.mt=n,this.tween=e},t}();Np(kp+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",(function(t){return _p[t]=1})),cp.TweenMax=cp.TweenLite=fg,cp.TimelineLite=cp.TimelineMax=ng,Ef=new ng({sortChildren:!1,defaults:Uf,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),Pf.stringFilter=Bm;var Ag=[],Dg={},Ng=[],Rg=0,Og=function(t){return(Dg[t]||Ng).map((function(t){return t()}))},xg=function(){var t=Date.now(),e=[];t-Rg>2&&(Og("matchMediaInit"),Ag.forEach((function(t){var n,i,r,s,o=t.queries,a=t.conditions;for(i in o)(n=Sf.matchMedia(o[i]).matches)&&(r=1),n!==a[i]&&(a[i]=n,s=1);s&&(t.revert(),r&&e.push(t))})),Og("matchMediaRevert"),e.forEach((function(t){return t.onMatch(t)})),Rg=t,Og("matchMedia"))},Mg=function(){function t(t,e){this.selector=e&&_m(e),this.data=[],this._r=[],this.isReverted=!1,t&&this.add(t)}var e=t.prototype;return e.add=function(t,e,n){Gf(t)&&(n=e,e=t,t=Gf);var i=this,r=function(){var t,r=If,s=i.selector;return r&&r!==i&&r.data.push(i),n&&(i.selector=_m(n)),If=i,t=e.apply(i,arguments),Gf(t)&&i._r.push(t),If=r,i.selector=s,i.isReverted=!1,t};return i.last=r,t===Gf?r(i):t?i[t]=r:r},e.ignore=function(t){var e=If;If=null,t(this),If=e},e.getTweens=function(){var e=[];return this.data.forEach((function(n){return n instanceof t?e.push.apply(e,n.getTweens()):n instanceof fg&&!(n.parent&&"nested"===n.parent.data)&&e.push(n)})),e},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(t,e){var n=this;if(t){var i=this.getTweens();this.data.forEach((function(t){"isFlip"===t.data&&(t.revert(),t.getChildren(!0,!0,!1).forEach((function(t){return i.splice(i.indexOf(t),1)})))})),i.map((function(t){return{g:t.globalTime(0),t}})).sort((function(t,e){return e.g-t.g||-1})).forEach((function(e){return e.t.revert(t)})),this.data.forEach((function(e){return!(e instanceof eg)&&e.revert&&e.revert(t)})),this._r.forEach((function(e){return e(t,n)})),this.isReverted=!0}else this.data.forEach((function(t){return t.kill&&t.kill()}));if(this.clear(),e){var r=Ag.indexOf(this);~r&&Ag.splice(r,1)}},e.revert=function(t){this.kill(t||{})},t}(),Lg=function(){function t(t){this.contexts=[],this.scope=t}var e=t.prototype;return e.add=function(t,e,n){Xf(t)||(t={matches:t});var i,r,s,o=new Mg(0,n||this.scope),a=o.conditions={};for(r in this.contexts.push(o),e=o.add("onMatch",e),o.queries=t,t)"all"===r?s=1:(i=Sf.matchMedia(t[r]))&&(Ag.indexOf(o)<0&&Ag.push(o),(a[r]=i.matches)&&(s=1),i.addListener?i.addListener(xg):i.addEventListener("change",xg));return s&&e(o),this},e.revert=function(t){this.kill(t||{})},e.kill=function(t){this.contexts.forEach((function(e){return e.kill(t,!0)}))},t}(),Pg={registerPlugin:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e.forEach((function(t){return Rm(t)}))},timeline:function(t){return new ng(t)},getTweensOf:function(t,e){return Ef.getTweensOf(t,e)},getProperty:function(t,e,n,i){Kf(t)&&(t=vm(t)[0]);var r=Ap(t||{}).get,s=n?Fp:Up;return"native"===n&&(n=""),t?e?s((Tp[e]&&Tp[e].get||r)(t,e,n,i)):function(e,n,i){return s((Tp[e]&&Tp[e].get||r)(t,e,n,i))}:t},quickSetter:function(t,e,n){if((t=vm(t)).length>1){var i=t.map((function(t){return Vg.quickSetter(t,e,n)})),r=i.length;return function(t){for(var e=r;e--;)i[e](t)}}t=t[0]||{};var s=Tp[e],o=Ap(t),a=o.harness&&(o.harness.aliases||{})[e]||e,u=s?function(e){var i=new s;Nf._pt=0,i.init(t,n?e+n:e,Nf,0,[t]),i.render(1,i),Nf._pt&&Tg(1,Nf)}:o.set(t,a);return s?u:function(e){return u(t,a,n?e+n:e,o,1)}},quickTo:function(t,e,n){var i,r=Vg.to(t,Bp(((i={})[e]="+=0.1",i.paused=!0,i),n||{})),s=function(t,n,i){return r.resetTo(e,t,n,i)};return s.tween=r,s},isTweening:function(t){return Ef.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=Qm(t.ease,Uf.ease)),jp(Uf,t||{})},config:function(t){return jp(Pf,t||{})},registerEffect:function(t){var e=t.name,n=t.effect,i=t.plugins,r=t.defaults,s=t.extendTimeline;(i||"").split(",").forEach((function(t){return t&&!Tp[t]&&!cp[t]&&fp(e+" effect requires "+t+" plugin.")})),Ip[e]=function(t,e,i){return n(vm(t),Vp(e||{},r),i)},s&&(ng.prototype[e]=function(t,n,i){return this.add(Ip[e](t,Xf(n)?n:(i=n)&&{},this),i)})},registerEase:function(t,e){zm[t]=Qm(e)},parseEase:function(t,e){return arguments.length?Qm(t,e):zm},getById:function(t){return Ef.getById(t)},exportRoot:function(t,e){void 0===t&&(t={});var n,i,r=new ng(t);for(r.smoothChildTiming=Yf(t.smoothChildTiming),Ef.remove(r),r._dp=0,r._time=r._tTime=Ef._time,n=Ef._first;n;)i=n._next,!e&&!n._dur&&n instanceof fg&&n.vars.onComplete===n._targets[0]||im(r,n,n._start-n._delay),n=i;return im(Ef,r,0),r},context:function(t,e){return t?new Mg(t,e):If},matchMedia:function(t){return new Lg(t)},matchMediaRefresh:function(){return Ag.forEach((function(t){var e,n,i=t.conditions;for(n in i)i[n]&&(i[n]=!1,e=1);e&&t.revert()}))||xg()},addEventListener:function(t,e){var n=Dg[t]||(Dg[t]=[]);~n.indexOf(e)||n.push(e)},removeEventListener:function(t,e){var n=Dg[t],i=n&&n.indexOf(e);i>=0&&n.splice(i,1)},utils:{wrap:function t(e,n,i){var r=n-e;return ep(e)?Sm(e,t(0,e.length),n):fm(i,(function(t){return(r+(t-e)%r)%r+e}))},wrapYoyo:function t(e,n,i){var r=n-e,s=2*r;return ep(e)?Sm(e,t(0,e.length-1),n):fm(i,(function(t){return e+((t=(s+(t-e)%s)%s||0)>r?s-t:t)}))},distribute:bm,random:Em,snap:Im,normalize:function(t,e,n){return Cm(t,e,0,1,n)},getUnit:mm,clamp:function(t,e,n){return fm(n,(function(n){return pm(t,e,n)}))},splitColor:Lm,toArray:vm,selector:_m,mapRange:Cm,pipe:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t){return e.reduce((function(t,e){return e(t)}),t)}},unitize:function(t,e){return function(n){return t(parseFloat(n))+(e||mm(n))}},interpolate:function t(e,n,i,r){var s=isNaN(e+n)?0:function(t){return(1-t)*e+t*n};if(!s){var o,a,u,c,h,l=Kf(e),d={};if(!0===i&&(r=1)&&(i=null),l)e={p:e},n={p:n};else if(ep(e)&&!ep(n)){for(u=[],c=e.length,h=c-2,a=1;a<c;a++)u.push(t(e[a-1],e[a]));c--,s=function(t){t*=c;var e=Math.min(h,~~t);return u[e](t-e)},i=n}else r||(e=Bp(ep(e)?[]:{},e));if(!u){for(o in n)og.call(d,e,o,"get",n[o]);s=function(t){return Tg(t,d)||(l?e.p:e)}}}return fm(i,s)},shuffle:wm},install:lp,effects:Ip,ticker:jm,updateRoot:ng.updateRoot,plugins:Tp,globalTimeline:Ef,core:{PropTween:Cg,globals:pp,Tween:fg,Timeline:ng,Animation:eg,getCache:Ap,_removeLinkedListItem:Hp,reverting:function(){return Tf},context:function(t){return t&&If&&(If.data.push(t),t._ctx=If),If},suppressOverwrites:function(t){return bf=t}}};Np("to,from,fromTo,delayedCall,set,killTweensOf",(function(t){return Pg[t]=fg[t]})),jm.add(ng.updateRoot),Nf=Pg.to({},{duration:0});var Ug=function(t,e){for(var n=t._pt;n&&n.p!==e&&n.op!==e&&n.fp!==e;)n=n._next;return n},Fg=function(t,e){return{name:t,rawVars:1,init:function(t,n,i){i._onInit=function(t){var i,r;if(Kf(n)&&(i={},Np(n,(function(t){return i[t]=1})),n=i),e){for(r in i={},n)i[r]=e(n[r]);n=i}!function(t,e){var n,i,r,s=t._targets;for(n in e)for(i=s.length;i--;)(r=t._ptLookup[i][n])&&(r=r.d)&&(r._pt&&(r=Ug(r,n)),r&&r.modifier&&r.modifier(e[n],t,s[i],n))}(t,n)}}}},Vg=Pg.registerPlugin({name:"attr",init:function(t,e,n,i,r){var s,o,a;for(s in this.tween=n,e)a=t.getAttribute(s)||"",(o=this.add(t,"setAttribute",(a||0)+"",e[s],i,r,0,0,s)).op=s,o.b=a,this._props.push(s)},render:function(t,e){for(var n=e._pt;n;)Tf?n.set(n.t,n.p,n.b,n):n.r(t,n.d),n=n._next}},{name:"endArray",init:function(t,e){for(var n=e.length;n--;)this.add(t,n,t[n]||0,e[n],0,0,0,0,0,1)}},Fg("roundProps",Tm),Fg("modifiers"),Fg("snap",Im))||Pg;fg.version=ng.version=Vg.version="3.11.3",Af=1,Jf()&&qm(),zm.Power0,zm.Power1,zm.Power2,zm.Power3,zm.Power4,zm.Linear,zm.Quad,zm.Cubic,zm.Quart,zm.Quint,zm.Strong,zm.Elastic,zm.Back,zm.SteppedEase,zm.Bounce,zm.Sine,zm.Expo,zm.Circ;var Bg,jg,qg,zg,$g,Hg,Kg,Gg,Wg={},Qg=180/Math.PI,Xg=Math.PI/180,Yg=Math.atan2,Jg=/([A-Z])/g,Zg=/(left|right|width|margin|padding|x)/i,ty=/[\s,\(]\S/,ey={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},ny=function(t,e){return e.set(e.t,e.p,Math.round(1e4*(e.s+e.c*t))/1e4+e.u,e)},iy=function(t,e){return e.set(e.t,e.p,1===t?e.e:Math.round(1e4*(e.s+e.c*t))/1e4+e.u,e)},ry=function(t,e){return e.set(e.t,e.p,t?Math.round(1e4*(e.s+e.c*t))/1e4+e.u:e.b,e)},sy=function(t,e){var n=e.s+e.c*t;e.set(e.t,e.p,~~(n+(n<0?-.5:.5))+e.u,e)},oy=function(t,e){return e.set(e.t,e.p,t?e.e:e.b,e)},ay=function(t,e){return e.set(e.t,e.p,1!==t?e.b:e.e,e)},uy=function(t,e,n){return t.style[e]=n},cy=function(t,e,n){return t.style.setProperty(e,n)},hy=function(t,e,n){return t._gsap[e]=n},ly=function(t,e,n){return t._gsap.scaleX=t._gsap.scaleY=n},dy=function(t,e,n,i,r){var s=t._gsap;s.scaleX=s.scaleY=n,s.renderTransform(r,s)},fy=function(t,e,n,i,r){var s=t._gsap;s[e]=n,s.renderTransform(r,s)},py="transform",my=py+"Origin",gy=function(t,e){var n=this,i=this.target,r=i.style;if(t in Wg){if(this.tfm=this.tfm||{},"transform"!==t&&(~(t=ey[t]||t).indexOf(",")?t.split(",").forEach((function(t){return n.tfm[t]=My(i,t)})):this.tfm[t]=i._gsap.x?i._gsap[t]:My(i,t)),this.props.indexOf(py)>=0)return;i._gsap.svg&&(this.svgo=i.getAttribute("data-svg-origin"),this.props.push(my,e,"")),t=py}(r||e)&&this.props.push(t,e,r[t])},yy=function(t){t.translate&&(t.removeProperty("translate"),t.removeProperty("scale"),t.removeProperty("rotate"))},vy=function(){var t,e,n=this.props,i=this.target,r=i.style,s=i._gsap;for(t=0;t<n.length;t+=3)n[t+1]?i[n[t]]=n[t+2]:n[t+2]?r[n[t]]=n[t+2]:r.removeProperty(n[t].replace(Jg,"-$1").toLowerCase());if(this.tfm){for(e in this.tfm)s[e]=this.tfm[e];s.svg&&(s.renderTransform(),i.setAttribute("data-svg-origin",this.svgo||"")),!(t=Kg())||t.isStart||r[py]||(yy(r),s.uncache=1)}},_y=function(t,e){var n={target:t,props:[],revert:vy,save:gy};return e&&e.split(",").forEach((function(t){return n.save(t)})),n},wy=function(t,e){var n=jg.createElementNS?jg.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):jg.createElement(t);return n.style?n:jg.createElement(t)},by=function t(e,n,i){var r=getComputedStyle(e);return r[n]||r.getPropertyValue(n.replace(Jg,"-$1").toLowerCase())||r.getPropertyValue(n)||!i&&t(e,Iy(n)||n,1)||""},Ty="O,Moz,ms,Ms,Webkit".split(","),Iy=function(t,e,n){var i=(e||$g).style,r=5;if(t in i&&!n)return t;for(t=t.charAt(0).toUpperCase()+t.substr(1);r--&&!(Ty[r]+t in i););return r<0?null:(3===r?"ms":r>=0?Ty[r]:"")+t},Ey=function(){"undefined"!=typeof window&&window.document&&(Bg=window,jg=Bg.document,qg=jg.documentElement,$g=wy("div")||{style:{}},wy("div"),py=Iy(py),my=py+"Origin",$g.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",Gg=!!Iy("perspective"),Kg=Vg.core.reverting,zg=1)},Sy=function t(e){var n,i=wy("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),r=this.parentNode,s=this.nextSibling,o=this.style.cssText;if(qg.appendChild(i),i.appendChild(this),this.style.display="block",e)try{n=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=t}catch(t){}else this._gsapBBox&&(n=this._gsapBBox());return r&&(s?r.insertBefore(this,s):r.appendChild(this)),qg.removeChild(i),this.style.cssText=o,n},ky=function(t,e){for(var n=e.length;n--;)if(t.hasAttribute(e[n]))return t.getAttribute(e[n])},Cy=function(t){var e;try{e=t.getBBox()}catch(n){e=Sy.call(t,!0)}return e&&(e.width||e.height)||t.getBBox===Sy||(e=Sy.call(t,!0)),!e||e.width||e.x||e.y?e:{x:+ky(t,["x","cx","x1"])||0,y:+ky(t,["y","cy","y1"])||0,width:0,height:0}},Ay=function(t){return!(!t.getCTM||t.parentNode&&!t.ownerSVGElement||!Cy(t))},Dy=function(t,e){if(e){var n=t.style;e in Wg&&e!==my&&(e=py),n.removeProperty?("ms"!==e.substr(0,2)&&"webkit"!==e.substr(0,6)||(e="-"+e),n.removeProperty(e.replace(Jg,"-$1").toLowerCase())):n.removeAttribute(e)}},Ny=function(t,e,n,i,r,s){var o=new Cg(t._pt,e,n,0,1,s?ay:oy);return t._pt=o,o.b=i,o.e=r,t._props.push(n),o},Ry={deg:1,rad:1,turn:1},Oy={grid:1,flex:1},xy=function t(e,n,i,r){var s,o,a,u,c=parseFloat(i)||0,h=(i+"").trim().substr((c+"").length)||"px",l=$g.style,d=Zg.test(n),f="svg"===e.tagName.toLowerCase(),p=(f?"client":"offset")+(d?"Width":"Height"),m=100,g="px"===r,y="%"===r;return r===h||!c||Ry[r]||Ry[h]?c:("px"!==h&&!g&&(c=t(e,n,i,"px")),u=e.getCTM&&Ay(e),!y&&"%"!==h||!Wg[n]&&!~n.indexOf("adius")?(l[d?"width":"height"]=m+(g?h:r),o=~n.indexOf("adius")||"em"===r&&e.appendChild&&!f?e:e.parentNode,u&&(o=(e.ownerSVGElement||{}).parentNode),o&&o!==jg&&o.appendChild||(o=jg.body),(a=o._gsap)&&y&&a.width&&d&&a.time===jm.time&&!a.uncache?Rp(c/a.width*m):((y||"%"===h)&&!Oy[by(o,"display")]&&(l.position=by(e,"position")),o===e&&(l.position="static"),o.appendChild($g),s=$g[p],o.removeChild($g),l.position="absolute",d&&y&&((a=Ap(o)).time=jm.time,a.width=o[p]),Rp(g?s*c/m:s&&c?m/s*c:0))):(s=u?e.getBBox()[d?"width":"height"]:e[p],Rp(y?c/s*m:c/100*s)))},My=function(t,e,n,i){var r;return zg||Ey(),e in ey&&"transform"!==e&&~(e=ey[e]).indexOf(",")&&(e=e.split(",")[0]),Wg[e]&&"transform"!==e?(r=Ky(t,i),r="transformOrigin"!==e?r[e]:r.svg?r.origin:Gy(by(t,my))+" "+r.zOrigin+"px"):(!(r=t.style[e])||"auto"===r||i||~(r+"").indexOf("calc("))&&(r=Vy[e]&&Vy[e](t,e,n)||by(t,e)||Dp(t,e)||("opacity"===e?1:0)),n&&!~(r+"").trim().indexOf(" ")?xy(t,e,r,n)+n:r},Ly=function(t,e,n,i){if(!n||"none"===n){var r=Iy(e,t,1),s=r&&by(t,r,1);s&&s!==n?(e=r,n=s):"borderColor"===e&&(n=by(t,"borderTopColor"))}var o,a,u,c,h,l,d,f,p,m,g,y=new Cg(this._pt,t.style,e,0,1,bg),v=0,_=0;if(y.b=n,y.e=i,n+="","auto"==(i+="")&&(t.style[e]=i,i=by(t,e)||i,t.style[e]=n),Bm(o=[n,i]),i=o[1],u=(n=o[0]).match(rp)||[],(i.match(rp)||[]).length){for(;a=rp.exec(i);)d=a[0],p=i.substring(v,a.index),h?h=(h+1)%5:"rgba("!==p.substr(-5)&&"hsla("!==p.substr(-5)||(h=1),d!==(l=u[_++]||"")&&(c=parseFloat(l)||0,g=l.substr((c+"").length),"="===d.charAt(1)&&(d=xp(c,d)+g),f=parseFloat(d),m=d.substr((f+"").length),v=rp.lastIndex-m.length,m||(m=m||Pf.units[e]||g,v===i.length&&(i+=m,y.e+=m)),g!==m&&(c=xy(t,e,l,m)||0),y._pt={_next:y._pt,p:p||1===_?p:",",s:c,c:f-c,m:h&&h<4||"zIndex"===e?Math.round:0});y.c=v<i.length?i.substring(v,i.length):""}else y.r="display"===e&&"none"===i?ay:oy;return op.test(i)&&(y.e=0),this._pt=y,y},Py={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Uy=function(t){var e=t.split(" "),n=e[0],i=e[1]||"50%";return"top"!==n&&"bottom"!==n&&"left"!==i&&"right"!==i||(t=n,n=i,i=t),e[0]=Py[n]||n,e[1]=Py[i]||i,e.join(" ")},Fy=function(t,e){if(e.tween&&e.tween._time===e.tween._dur){var n,i,r,s=e.t,o=s.style,a=e.u,u=s._gsap;if("all"===a||!0===a)o.cssText="",i=1;else for(r=(a=a.split(",")).length;--r>-1;)n=a[r],Wg[n]&&(i=1,n="transformOrigin"===n?my:py),Dy(s,n);i&&(Dy(s,py),u&&(u.svg&&s.removeAttribute("transform"),Ky(s,1),u.uncache=1,yy(o)))}},Vy={clearProps:function(t,e,n,i,r){if("isFromStart"!==r.data){var s=t._pt=new Cg(t._pt,e,n,0,0,Fy);return s.u=i,s.pr=-10,s.tween=r,t._props.push(n),1}}},By=[1,0,0,1,0,0],jy={},qy=function(t){return"matrix(1, 0, 0, 1, 0, 0)"===t||"none"===t||!t},zy=function(t){var e=by(t,py);return qy(e)?By:e.substr(7).match(ip).map(Rp)},$y=function(t,e){var n,i,r,s,o=t._gsap||Ap(t),a=t.style,u=zy(t);return o.svg&&t.getAttribute("transform")?"1,0,0,1,0,0"===(u=[(r=t.transform.baseVal.consolidate().matrix).a,r.b,r.c,r.d,r.e,r.f]).join(",")?By:u:(u!==By||t.offsetParent||t===qg||o.svg||(r=a.display,a.display="block",(n=t.parentNode)&&t.offsetParent||(s=1,i=t.nextElementSibling,qg.appendChild(t)),u=zy(t),r?a.display=r:Dy(t,"display"),s&&(i?n.insertBefore(t,i):n?n.appendChild(t):qg.removeChild(t))),e&&u.length>6?[u[0],u[1],u[4],u[5],u[12],u[13]]:u)},Hy=function(t,e,n,i,r,s){var o,a,u,c=t._gsap,h=r||$y(t,!0),l=c.xOrigin||0,d=c.yOrigin||0,f=c.xOffset||0,p=c.yOffset||0,m=h[0],g=h[1],y=h[2],v=h[3],_=h[4],w=h[5],b=e.split(" "),T=parseFloat(b[0])||0,I=parseFloat(b[1])||0;n?h!==By&&(a=m*v-g*y)&&(u=T*(-g/a)+I*(m/a)-(m*w-g*_)/a,T=T*(v/a)+I*(-y/a)+(y*w-v*_)/a,I=u):(T=(o=Cy(t)).x+(~b[0].indexOf("%")?T/100*o.width:T),I=o.y+(~(b[1]||b[0]).indexOf("%")?I/100*o.height:I)),i||!1!==i&&c.smooth?(_=T-l,w=I-d,c.xOffset=f+(_*m+w*y)-_,c.yOffset=p+(_*g+w*v)-w):c.xOffset=c.yOffset=0,c.xOrigin=T,c.yOrigin=I,c.smooth=!!i,c.origin=e,c.originIsAbsolute=!!n,t.style[my]="0px 0px",s&&(Ny(s,c,"xOrigin",l,T),Ny(s,c,"yOrigin",d,I),Ny(s,c,"xOffset",f,c.xOffset),Ny(s,c,"yOffset",p,c.yOffset)),t.setAttribute("data-svg-origin",T+" "+I)},Ky=function(t,e){var n=t._gsap||new tg(t);if("x"in n&&!e&&!n.uncache)return n;var i,r,s,o,a,u,c,h,l,d,f,p,m,g,y,v,_,w,b,T,I,E,S,k,C,A,D,N,R,O,x,M,L=t.style,P=n.scaleX<0,U="px",F="deg",V=getComputedStyle(t),B=by(t,my)||"0";return i=r=s=u=c=h=l=d=f=0,o=a=1,n.svg=!(!t.getCTM||!Ay(t)),V.translate&&("none"===V.translate&&"none"===V.scale&&"none"===V.rotate||(L[py]=("none"!==V.translate?"translate3d("+(V.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+("none"!==V.rotate?"rotate("+V.rotate+") ":"")+("none"!==V.scale?"scale("+V.scale.split(" ").join(",")+") ":"")+("none"!==V[py]?V[py]:"")),L.scale=L.rotate=L.translate="none"),g=$y(t,n.svg),n.svg&&(n.uncache?(C=t.getBBox(),B=n.xOrigin-C.x+"px "+(n.yOrigin-C.y)+"px",k=""):k=!e&&t.getAttribute("data-svg-origin"),Hy(t,k||B,!!k||n.originIsAbsolute,!1!==n.smooth,g)),p=n.xOrigin||0,m=n.yOrigin||0,g!==By&&(w=g[0],b=g[1],T=g[2],I=g[3],i=E=g[4],r=S=g[5],6===g.length?(o=Math.sqrt(w*w+b*b),a=Math.sqrt(I*I+T*T),u=w||b?Yg(b,w)*Qg:0,(l=T||I?Yg(T,I)*Qg+u:0)&&(a*=Math.abs(Math.cos(l*Xg))),n.svg&&(i-=p-(p*w+m*T),r-=m-(p*b+m*I))):(M=g[6],O=g[7],D=g[8],N=g[9],R=g[10],x=g[11],i=g[12],r=g[13],s=g[14],c=(y=Yg(M,R))*Qg,y&&(k=E*(v=Math.cos(-y))+D*(_=Math.sin(-y)),C=S*v+N*_,A=M*v+R*_,D=E*-_+D*v,N=S*-_+N*v,R=M*-_+R*v,x=O*-_+x*v,E=k,S=C,M=A),h=(y=Yg(-T,R))*Qg,y&&(v=Math.cos(-y),x=I*(_=Math.sin(-y))+x*v,w=k=w*v-D*_,b=C=b*v-N*_,T=A=T*v-R*_),u=(y=Yg(b,w))*Qg,y&&(k=w*(v=Math.cos(y))+b*(_=Math.sin(y)),C=E*v+S*_,b=b*v-w*_,S=S*v-E*_,w=k,E=C),c&&Math.abs(c)+Math.abs(u)>359.9&&(c=u=0,h=180-h),o=Rp(Math.sqrt(w*w+b*b+T*T)),a=Rp(Math.sqrt(S*S+M*M)),y=Yg(E,S),l=Math.abs(y)>2e-4?y*Qg:0,f=x?1/(x<0?-x:x):0),n.svg&&(k=t.getAttribute("transform"),n.forceCSS=t.setAttribute("transform","")||!qy(by(t,py)),k&&t.setAttribute("transform",k))),Math.abs(l)>90&&Math.abs(l)<270&&(P?(o*=-1,l+=u<=0?180:-180,u+=u<=0?180:-180):(a*=-1,l+=l<=0?180:-180)),e=e||n.uncache,n.x=i-((n.xPercent=i&&(!e&&n.xPercent||(Math.round(t.offsetWidth/2)===Math.round(-i)?-50:0)))?t.offsetWidth*n.xPercent/100:0)+U,n.y=r-((n.yPercent=r&&(!e&&n.yPercent||(Math.round(t.offsetHeight/2)===Math.round(-r)?-50:0)))?t.offsetHeight*n.yPercent/100:0)+U,n.z=s+U,n.scaleX=Rp(o),n.scaleY=Rp(a),n.rotation=Rp(u)+F,n.rotationX=Rp(c)+F,n.rotationY=Rp(h)+F,n.skewX=l+F,n.skewY=d+F,n.transformPerspective=f+U,(n.zOrigin=parseFloat(B.split(" ")[2])||0)&&(L[my]=Gy(B)),n.xOffset=n.yOffset=0,n.force3D=Pf.force3D,n.renderTransform=n.svg?tv:Gg?Zy:Qy,n.uncache=0,n},Gy=function(t){return(t=t.split(" "))[0]+" "+t[1]},Wy=function(t,e,n){var i=mm(e);return Rp(parseFloat(e)+parseFloat(xy(t,"x",n+"px",i)))+i},Qy=function(t,e){e.z="0px",e.rotationY=e.rotationX="0deg",e.force3D=0,Zy(t,e)},Xy="0deg",Yy="0px",Jy=") ",Zy=function(t,e){var n=e||this,i=n.xPercent,r=n.yPercent,s=n.x,o=n.y,a=n.z,u=n.rotation,c=n.rotationY,h=n.rotationX,l=n.skewX,d=n.skewY,f=n.scaleX,p=n.scaleY,m=n.transformPerspective,g=n.force3D,y=n.target,v=n.zOrigin,_="",w="auto"===g&&t&&1!==t||!0===g;if(v&&(h!==Xy||c!==Xy)){var b,T=parseFloat(c)*Xg,I=Math.sin(T),E=Math.cos(T);T=parseFloat(h)*Xg,b=Math.cos(T),s=Wy(y,s,I*b*-v),o=Wy(y,o,-Math.sin(T)*-v),a=Wy(y,a,E*b*-v+v)}m!==Yy&&(_+="perspective("+m+Jy),(i||r)&&(_+="translate("+i+"%, "+r+"%) "),(w||s!==Yy||o!==Yy||a!==Yy)&&(_+=a!==Yy||w?"translate3d("+s+", "+o+", "+a+") ":"translate("+s+", "+o+Jy),u!==Xy&&(_+="rotate("+u+Jy),c!==Xy&&(_+="rotateY("+c+Jy),h!==Xy&&(_+="rotateX("+h+Jy),l===Xy&&d===Xy||(_+="skew("+l+", "+d+Jy),1===f&&1===p||(_+="scale("+f+", "+p+Jy),y.style[py]=_||"translate(0, 0)"},tv=function(t,e){var n,i,r,s,o,a=e||this,u=a.xPercent,c=a.yPercent,h=a.x,l=a.y,d=a.rotation,f=a.skewX,p=a.skewY,m=a.scaleX,g=a.scaleY,y=a.target,v=a.xOrigin,_=a.yOrigin,w=a.xOffset,b=a.yOffset,T=a.forceCSS,I=parseFloat(h),E=parseFloat(l);d=parseFloat(d),f=parseFloat(f),(p=parseFloat(p))&&(f+=p=parseFloat(p),d+=p),d||f?(d*=Xg,f*=Xg,n=Math.cos(d)*m,i=Math.sin(d)*m,r=Math.sin(d-f)*-g,s=Math.cos(d-f)*g,f&&(p*=Xg,o=Math.tan(f-p),r*=o=Math.sqrt(1+o*o),s*=o,p&&(o=Math.tan(p),n*=o=Math.sqrt(1+o*o),i*=o)),n=Rp(n),i=Rp(i),r=Rp(r),s=Rp(s)):(n=m,s=g,i=r=0),(I&&!~(h+"").indexOf("px")||E&&!~(l+"").indexOf("px"))&&(I=xy(y,"x",h,"px"),E=xy(y,"y",l,"px")),(v||_||w||b)&&(I=Rp(I+v-(v*n+_*r)+w),E=Rp(E+_-(v*i+_*s)+b)),(u||c)&&(o=y.getBBox(),I=Rp(I+u/100*o.width),E=Rp(E+c/100*o.height)),o="matrix("+n+","+i+","+r+","+s+","+I+","+E+")",y.setAttribute("transform",o),T&&(y.style[py]=o)},ev=function(t,e,n,i,r){var s,o,a=360,u=Kf(r),c=parseFloat(r)*(u&&~r.indexOf("rad")?Qg:1)-i,h=i+c+"deg";return u&&("short"===(s=r.split("_")[1])&&(c%=a)!=c%180&&(c+=c<0?a:-360),"cw"===s&&c<0?c=(c+36e9)%a-~~(c/a)*a:"ccw"===s&&c>0&&(c=(c-36e9)%a-~~(c/a)*a)),t._pt=o=new Cg(t._pt,e,n,i,c,iy),o.e=h,o.u="deg",t._props.push(n),o},nv=function(t,e){for(var n in e)t[n]=e[n];return t},iv=function(t,e,n){var i,r,s,o,a,u,c,h=nv({},n._gsap),l=n.style;for(r in h.svg?(s=n.getAttribute("transform"),n.setAttribute("transform",""),l[py]=e,i=Ky(n,1),Dy(n,py),n.setAttribute("transform",s)):(s=getComputedStyle(n)[py],l[py]=e,i=Ky(n,1),l[py]=s),Wg)(s=h[r])!==(o=i[r])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(r)<0&&(a=mm(s)!==(c=mm(o))?xy(n,r,s,c):parseFloat(s),u=parseFloat(o),t._pt=new Cg(t._pt,i,r,a,u-a,ny),t._pt.u=c||0,t._props.push(r));nv(i,h)};Np("padding,margin,Width,Radius",(function(t,e){var n="Top",i="Right",r="Bottom",s="Left",o=(e<3?[n,i,r,s]:[n+s,n+i,r+i,r+s]).map((function(n){return e<2?t+n:"border"+n+t}));Vy[e>1?"border"+t:t]=function(t,e,n,i,r){var s,a;if(arguments.length<4)return s=o.map((function(e){return My(t,e,n)})),5===(a=s.join(" ")).split(s[0]).length?s[0]:a;s=(i+"").split(" "),a={},o.forEach((function(t,e){return a[t]=s[e]=s[e]||s[(e-1)/2|0]})),t.init(e,a,r)}}));var rv,sv,ov={name:"css",register:Ey,targetTest:function(t){return t.style&&t.nodeType},init:function(t,e,n,i,r){var s,o,a,u,c,h,l,d,f,p,m,g,y,v,_,w,b=this._props,T=t.style,I=n.vars.startAt;for(l in zg||Ey(),this.styles=this.styles||_y(t),w=this.styles.props,this.tween=n,e)if("autoRound"!==l&&(o=e[l],!Tp[l]||!ag(l,e,n,i,t,r)))if(c=typeof o,h=Vy[l],"function"===c&&(c=typeof(o=o.call(n,i,t,r))),"string"===c&&~o.indexOf("random(")&&(o=km(o)),h)h(this,t,l,o,n)&&(_=1);else if("--"===l.substr(0,2))s=(getComputedStyle(t).getPropertyValue(l)+"").trim(),o+="",Fm.lastIndex=0,Fm.test(s)||(d=mm(s),f=mm(o)),f?d!==f&&(s=xy(t,l,s,f)+f):d&&(o+=d),this.add(T,"setProperty",s,o,i,r,0,0,l),b.push(l),w.push(l,0,T[l]);else if("undefined"!==c){if(I&&l in I?(s="function"==typeof I[l]?I[l].call(n,i,t,r):I[l],Kf(s)&&~s.indexOf("random(")&&(s=km(s)),mm(s+"")||(s+=Pf.units[l]||mm(My(t,l))||""),"="===(s+"").charAt(1)&&(s=My(t,l))):s=My(t,l),u=parseFloat(s),(p="string"===c&&"="===o.charAt(1)&&o.substr(0,2))&&(o=o.substr(2)),a=parseFloat(o),l in ey&&("autoAlpha"===l&&(1===u&&"hidden"===My(t,"visibility")&&a&&(u=0),w.push("visibility",0,T.visibility),Ny(this,T,"visibility",u?"inherit":"hidden",a?"inherit":"hidden",!a)),"scale"!==l&&"transform"!==l&&~(l=ey[l]).indexOf(",")&&(l=l.split(",")[0])),m=l in Wg)if(this.styles.save(l),g||((y=t._gsap).renderTransform&&!e.parseTransform||Ky(t,e.parseTransform),v=!1!==e.smoothOrigin&&y.smooth,(g=this._pt=new Cg(this._pt,T,py,0,1,y.renderTransform,y,0,-1)).dep=1),"scale"===l)this._pt=new Cg(this._pt,y,"scaleY",u,(p?xp(u,p+a):a)-u||0,ny),this._pt.u=0,b.push("scaleY",l),l+="X";else{if("transformOrigin"===l){w.push(my,0,T[my]),o=Uy(o),y.svg?Hy(t,o,0,v,0,this):((f=parseFloat(o.split(" ")[2])||0)!==y.zOrigin&&Ny(this,y,"zOrigin",y.zOrigin,f),Ny(this,T,l,Gy(s),Gy(o)));continue}if("svgOrigin"===l){Hy(t,o,1,v,0,this);continue}if(l in jy){ev(this,y,l,u,p?xp(u,p+o):o);continue}if("smoothOrigin"===l){Ny(this,y,"smooth",y.smooth,o);continue}if("force3D"===l){y[l]=o;continue}if("transform"===l){iv(this,o,t);continue}}else l in T||(l=Iy(l)||l);if(m||(a||0===a)&&(u||0===u)&&!ty.test(o)&&l in T)a||(a=0),(d=(s+"").substr((u+"").length))!==(f=mm(o)||(l in Pf.units?Pf.units[l]:d))&&(u=xy(t,l,s,f)),this._pt=new Cg(this._pt,m?y:T,l,u,(p?xp(u,p+a):a)-u,m||"px"!==f&&"zIndex"!==l||!1===e.autoRound?ny:sy),this._pt.u=f||0,d!==f&&"%"!==f&&(this._pt.b=s,this._pt.r=ry);else if(l in T)Ly.call(this,t,l,s,p?p+o:o);else{if(!(l in t)){dp(l,o);continue}this.add(t,l,s||t[l],p?p+o:o,i,r)}m||(l in T?w.push(l,0,T[l]):w.push(l,1,s||t[l])),b.push(l)}_&&kg(this)},render:function(t,e){if(e.tween._time||!Kg())for(var n=e._pt;n;)n.r(t,n.d),n=n._next;else e.styles.revert()},get:My,aliases:ey,getSetter:function(t,e,n){var i=ey[e];return i&&i.indexOf(",")<0&&(e=i),e in Wg&&e!==my&&(t._gsap.x||My(t,"x"))?n&&Hg===n?"scale"===e?ly:hy:(Hg=n||{})&&("scale"===e?dy:fy):t.style&&!Qf(t.style[e])?uy:~e.indexOf("-")?cy:vg(t,e)},core:{_removeProperty:Dy,_getMatrix:$y}};Vg.utils.checkPrefix=Iy,Vg.core.getStyleSaver=_y,sv=Np("x,y,z,scale,scaleX,scaleY,xPercent,yPercent"+","+(rv="rotation,rotationX,rotationY,skewX,skewY")+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",(function(t){Wg[t]=1})),Np(rv,(function(t){Pf.units[t]="deg",jy[t]=1})),ey[sv[13]]="x,y,z,scale,scaleX,scaleY,xPercent,yPercent,"+rv,Np("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",(function(t){var e=t.split(":");ey[e[1]]=sv[e[0]]})),Np("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",(function(t){Pf.units[t]="px"})),Vg.registerPlugin(ov);var av=Vg.registerPlugin(ov)||Vg;function uv(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}av.core.Tween,av.timeline({paused:!0}),Object.create,Object.create;const cv=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},hv=new p("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),lv=new P("@firebase/auth");function dv(t,...e){lv.logLevel<=N.ERROR&&lv.error(`Auth (9.14.0): ${t}`,...e)}function fv(t,...e){throw mv(t,...e)}function pv(t,...e){return mv(t,...e)}function mv(t,...e){if("string"!=typeof t){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return hv.create(t,...e)}function gv(t,e,...n){if(!t)throw mv(e,...n)}function yv(t){const e="INTERNAL ASSERTION FAILED: "+t;throw dv(e),new Error(e)}function vv(t,e){t||yv(e)}const _v=new Map;function wv(t){vv(t instanceof Function,"Expected a class definition");let e=_v.get(t);return e?(vv(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,_v.set(t,e),e)}function bv(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.href)||""}function Tv(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.protocol)||null}class Iv{constructor(t,e){this.shortDelay=t,this.longDelay=e,vv(e>t,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(s())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===Tv()||"https:"===Tv()||o()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function Ev(t,e){vv(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class Sv{static initialize(t,e,n){this.fetchImpl=t,e&&(this.headersImpl=e),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void yv("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void yv("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void yv("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const kv={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},Cv=new Iv(3e4,6e4);function Av(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Dv(t,e,n,i,r={}){return Nv(t,r,(async()=>{let r={},s={};i&&("GET"===e?s=i:r={body:JSON.stringify(i)});const o=v(Object.assign({key:t.config.apiKey},s)).slice(1),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/json",t.languageCode&&(a["X-Firebase-Locale"]=t.languageCode),Sv.fetch()(Ov(t,t.config.apiHost,n,o),Object.assign({method:e,headers:a,referrerPolicy:"no-referrer"},r))}))}async function Nv(t,e,n){t._canInitEmulator=!1;const i=Object.assign(Object.assign({},kv),e);try{const e=new xv(t),r=await Promise.race([n(),e.promise]);e.clearNetworkTimeout();const s=await r.json();if("needConfirmation"in s)throw Mv(t,"account-exists-with-different-credential",s);if(r.ok&&!("errorMessage"in s))return s;{const e=r.ok?s.errorMessage:s.error.message,[n,o]=e.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Mv(t,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw Mv(t,"email-already-in-use",s);if("USER_DISABLED"===n)throw Mv(t,"user-disabled",s);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw function(t,e,n){const i=Object.assign(Object.assign({},cv()),{[e]:n});return new p("auth","Firebase",i).create(e,{appName:t.name})}(t,a,o);fv(t,a)}}catch(e){if(e instanceof f)throw e;fv(t,"network-request-failed")}}async function Rv(t,e,n,i,r={}){const s=await Dv(t,e,n,i,r);return"mfaPendingCredential"in s&&fv(t,"multi-factor-auth-required",{_serverResponse:s}),s}function Ov(t,e,n,i){const r=`${e}${n}?${i}`;return t.config.emulator?Ev(t.config,r):`${t.config.apiScheme}://${r}`}class xv{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise(((t,e)=>{this.timer=setTimeout((()=>e(pv(this.auth,"network-request-failed"))),Cv.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function Mv(t,e,n){const i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=pv(t,e,i);return r.customData._tokenResponse=n,r}function Lv(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch(t){}}function Pv(t){return 1e3*Number(t)}function Uv(t){var e;const[n,i,s]=t.split(".");if(void 0===n||void 0===i||void 0===s)return dv("JWT malformed, contained fewer than 3 sections"),null;try{const t=r(i);return t?JSON.parse(t):(dv("Failed to decode base64 JWT payload"),null)}catch(t){return dv("Caught error parsing JWT payload as JSON",null===(e=t)||void 0===e?void 0:e.toString()),null}}async function Fv(t,e,n=!1){if(n)return e;try{return await e}catch(e){throw e instanceof f&&function({code:t}){return"auth/user-disabled"===t||"auth/user-token-expired"===t}(e)&&t.auth.currentUser===t&&await t.auth.signOut(),e}}class Vv{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const t=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),t}{this.errorBackoff=3e4;const t=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,t)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout((async()=>{await this.iteration()}),e)}async iteration(){var t;try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null===(t=e)||void 0===t?void 0:t.code)&&this.schedule(!0))}this.schedule()}}class Bv{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=Lv(this.lastLoginAt),this.creationTime=Lv(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function jv(t){var e;const n=t.auth,i=await t.getIdToken(),r=await Fv(t,async function(t,e){return Dv(t,"POST","/v1/accounts:lookup",e)}(n,{idToken:i}));gv(null==r?void 0:r.users.length,n,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const o=(null===(e=s.providerUserInfo)||void 0===e?void 0:e.length)?s.providerUserInfo.map((t=>{var{providerId:e}=t,n=uv(t,["providerId"]);return{providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],a=function(t,e){const n=t.filter((t=>!e.some((e=>e.providerId===t.providerId))));return[...n,...e]}(t.providerData,o),u=t.isAnonymous,c=!(t.email&&s.passwordHash||(null==a?void 0:a.length)),h=!!u&&c,l={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Bv(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(t,l)}class qv{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){gv(t.idToken,"internal-error"),gv(void 0!==t.idToken,"internal-error"),gv(void 0!==t.refreshToken,"internal-error");const e="expiresIn"in t&&void 0!==t.expiresIn?Number(t.expiresIn):function(t){const e=Uv(t);return gv(e,"internal-error"),gv(void 0!==e.exp,"internal-error"),gv(void 0!==e.iat,"internal-error"),Number(e.exp)-Number(e.iat)}(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}async getToken(t,e=!1){return gv(!this.accessToken||this.refreshToken,t,"user-token-expired"),e||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:n,refreshToken:i,expiresIn:r}=await async function(t,e){const n=await Nv(t,{},(async()=>{const n=v({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:r}=t.config,s=Ov(t,i,"/v1/token",`key=${r}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",Sv.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(t,e);this.updateTokensAndExpiration(n,i,Number(r))}updateTokensAndExpiration(t,e,n){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(t,e){const{refreshToken:n,accessToken:i,expirationTime:r}=e,s=new qv;return n&&(gv("string"==typeof n,"internal-error",{appName:t}),s.refreshToken=n),i&&(gv("string"==typeof i,"internal-error",{appName:t}),s.accessToken=i),r&&(gv("number"==typeof r,"internal-error",{appName:t}),s.expirationTime=r),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new qv,this.toJSON())}_performRefresh(){return yv("not implemented")}}function zv(t,e){gv("string"==typeof t||void 0===t,"internal-error",{appName:e})}class $v{constructor(t){var{uid:e,auth:n,stsTokenManager:i}=t,r=uv(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Vv(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Bv(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(t){const e=await Fv(this,this.stsTokenManager.getToken(this.auth,t));return gv(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return async function(t,e=!1){const n=E(t),i=await n.getIdToken(e),r=Uv(i);gv(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const s="object"==typeof r.firebase?r.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:r,token:i,authTime:Lv(Pv(r.auth_time)),issuedAtTime:Lv(Pv(r.iat)),expirationTime:Lv(Pv(r.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,t)}reload(){return async function(t){const e=E(t);await jv(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}(this)}_assign(t){this!==t&&(gv(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map((t=>Object.assign({},t))),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){return new $v(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(t){gv(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),e&&await jv(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const t=await this.getIdToken();return await Fv(this,async function(t,e){return Dv(t,"POST","/v1/accounts:delete",e)}(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((t=>Object.assign({},t))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var n,i,r,s,o,a,u,c;const h=null!==(n=e.displayName)&&void 0!==n?n:void 0,l=null!==(i=e.email)&&void 0!==i?i:void 0,d=null!==(r=e.phoneNumber)&&void 0!==r?r:void 0,f=null!==(s=e.photoURL)&&void 0!==s?s:void 0,p=null!==(o=e.tenantId)&&void 0!==o?o:void 0,m=null!==(a=e._redirectEventId)&&void 0!==a?a:void 0,g=null!==(u=e.createdAt)&&void 0!==u?u:void 0,y=null!==(c=e.lastLoginAt)&&void 0!==c?c:void 0,{uid:v,emailVerified:_,isAnonymous:w,providerData:b,stsTokenManager:T}=e;gv(v&&T,t,"internal-error");const I=qv.fromJSON(this.name,T);gv("string"==typeof v,t,"internal-error"),zv(h,t.name),zv(l,t.name),gv("boolean"==typeof _,t,"internal-error"),gv("boolean"==typeof w,t,"internal-error"),zv(d,t.name),zv(f,t.name),zv(p,t.name),zv(m,t.name),zv(g,t.name),zv(y,t.name);const E=new $v({uid:v,auth:t,email:l,emailVerified:_,displayName:h,isAnonymous:w,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:I,createdAt:g,lastLoginAt:y});return b&&Array.isArray(b)&&(E.providerData=b.map((t=>Object.assign({},t)))),m&&(E._redirectEventId=m),E}static async _fromIdTokenResponse(t,e,n=!1){const i=new qv;i.updateFromServerResponse(e);const r=new $v({uid:e.localId,auth:t,stsTokenManager:i,isAnonymous:n});return await jv(r),r}}class Hv{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return void 0===e?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}Hv.type="NONE";const Kv=Hv;function Gv(t,e,n){return`firebase:${t}:${e}:${n}`}class Wv{constructor(t,e,n){this.persistence=t,this.auth=e,this.userKey=n;const{config:i,name:r}=this.auth;this.fullUserKey=Gv(this.userKey,i.apiKey,r),this.fullPersistenceKey=Gv("persistence",i.apiKey,r),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?$v._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=t,e?this.setCurrentUser(e):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,n="authUser"){if(!e.length)return new Wv(wv(Kv),t,n);const i=(await Promise.all(e.map((async t=>{if(await t._isAvailable())return t})))).filter((t=>t));let r=i[0]||wv(Kv);const s=Gv(n,t.config.apiKey,t.name);let o=null;for(const n of e)try{const e=await n._get(s);if(e){const i=$v._fromJSON(t,e);n!==r&&(o=i),r=n;break}}catch(t){}const a=i.filter((t=>t._shouldAllowMigration));return r._shouldAllowMigration&&a.length?(r=a[0],o&&await r._set(s,o.toJSON()),await Promise.all(e.map((async t=>{if(t!==r)try{await t._remove(s)}catch(t){}}))),new Wv(r,t,n)):new Wv(r,t,n)}}function Qv(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Zv(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Xv(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(e_(e))return"Blackberry";if(n_(e))return"Webos";if(Yv(e))return"Safari";if((e.includes("chrome/")||Jv(e))&&!e.includes("edge/"))return"Chrome";if(t_(e))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(e);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function Xv(t=s()){return/firefox\//i.test(t)}function Yv(t=s()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Jv(t=s()){return/crios\//i.test(t)}function Zv(t=s()){return/iemobile/i.test(t)}function t_(t=s()){return/android/i.test(t)}function e_(t=s()){return/blackberry/i.test(t)}function n_(t=s()){return/webos/i.test(t)}function i_(t=s()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function r_(t=s()){return i_(t)||t_(t)||n_(t)||e_(t)||/windows phone/i.test(t)||Zv(t)}function s_(t,e=[]){let n;switch(t){case"Browser":n=Qv(s());break;case"Worker":n=`${Qv(s())}-${t}`;break;default:n=t}return`${n}/JsCore/9.14.0/${e.length?e.join(","):"FirebaseCore-web"}`}class o_{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const n=e=>new Promise(((n,i)=>{try{n(t(e))}catch(t){i(t)}}));n.onAbort=e,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(t){var e;if(this.auth.currentUser===t)return;const n=[];try{for(const e of this.queue)await e(t),e.onAbort&&n.push(e.onAbort)}catch(t){n.reverse();for(const t of n)try{t()}catch(t){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===(e=t)||void 0===e?void 0:e.message})}}}class a_{constructor(t,e,n){this.app=t,this.heartbeatServiceProvider=e,this.config=n,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new c_(this),this.idTokenSubscription=new c_(this),this.beforeStateQueue=new o_(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=hv,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=n.sdkClientVersion}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=wv(e)),this._initializationPromise=this.queue((async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await Wv.create(this,t),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(t){}await this.initializeCurrentUser(e),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();return this.currentUser||t?this.currentUser&&t&&this.currentUser.uid===t.uid?(this._currentUser._assign(t),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(t,!0):void 0}async initializeCurrentUser(t){var e;const n=await this.assertedPersistence.getCurrentUser();let i=n,r=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(e=this.redirectUser)||void 0===e?void 0:e._redirectEventId,s=null==i?void 0:i._redirectEventId,o=await this.tryRedirectSignIn(t);n&&n!==s||!(null==o?void 0:o.user)||(i=o.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(t){i=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(t)))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return gv(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch(t){await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){var e;try{await jv(t)}catch(t){if("auth/network-request-failed"!==(null===(e=t)||void 0===e?void 0:e.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(t){const e=t?E(t):null;return e&&gv(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t,e=!1){if(!this._deleted)return t&&gv(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue((async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()}))}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(t){return this.queue((async()=>{await this.assertedPersistence.setPersistence(wv(t))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new p("auth","Firebase",t())}onAuthStateChanged(t,e,n){return this.registerStateListener(this.authStateSubscription,t,e,n)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,n){return this.registerStateListener(this.idTokenSubscription,t,e,n)}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}async _setRedirectUser(t,e){const n=await this.getOrInitRedirectPersistenceManager(e);return null===t?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&wv(t)||this._popupRedirectResolver;gv(e,this,"argument-error"),this.redirectPersistenceManager=await Wv.create(this,[wv(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var e,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(e=this._currentUser)||void 0===e?void 0:e._redirectEventId)===t?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(t)))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,n,i){if(this._deleted)return()=>{};const r="function"==typeof e?e:e.next.bind(e),s=this._isInitialized?Promise.resolve():this._initializationPromise;return gv(s,this,"internal-error"),s.then((()=>r(this.currentUser))),"function"==typeof e?t.addObserver(e,n,i):t.addObserver(e)}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return gv(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){t&&!this.frameworks.includes(t)&&(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=s_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(t=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader());return n&&(e["X-Firebase-Client"]=n),e}}function u_(t){return E(t)}class c_{constructor(t){this.auth=t,this.observer=null,this.addObserver=function(t,e){const n=new b(t,void 0);return n.subscribe.bind(n)}((t=>this.observer=t))}get next(){return gv(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function h_(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function l_(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}class d_{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return yv("not implemented")}_getIdTokenResponse(t){return yv("not implemented")}_linkToIdToken(t,e){return yv("not implemented")}_getReauthenticationResolver(t){return yv("not implemented")}}class f_ extends d_{constructor(t,e,n,i=null){super("password",n),this._email=t,this._password=e,this._tenantId=i}static _fromEmailAndPassword(t,e){return new f_(t,e,"password")}static _fromEmailAndCode(t,e,n=null){return new f_(t,e,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t;if((null==e?void 0:e.email)&&(null==e?void 0:e.password)){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":return async function(t,e){return Rv(t,"POST","/v1/accounts:signInWithPassword",Av(t,e))}(t,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(t,e){return Rv(t,"POST","/v1/accounts:signInWithEmailLink",Av(t,e))}(t,{email:this._email,oobCode:this._password});default:fv(t,"internal-error")}}async _linkToIdToken(t,e){switch(this.signInMethod){case"password":return async function(t,e){return Dv(t,"POST","/v1/accounts:update",e)}(t,{idToken:e,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(t,e){return Rv(t,"POST","/v1/accounts:signInWithEmailLink",Av(t,e))}(t,{idToken:e,email:this._email,oobCode:this._password});default:fv(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}async function p_(t,e){return Rv(t,"POST","/v1/accounts:signInWithIdp",Av(t,e))}class m_ extends d_{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new m_(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):fv("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t,{providerId:n,signInMethod:i}=e,r=uv(e,["providerId","signInMethod"]);if(!n||!i)return null;const s=new m_(n,i);return s.idToken=r.idToken||void 0,s.accessToken=r.accessToken||void 0,s.secret=r.secret,s.nonce=r.nonce,s.pendingToken=r.pendingToken||null,s}_getIdTokenResponse(t){return p_(t,this.buildRequest())}_linkToIdToken(t,e){const n=this.buildRequest();return n.idToken=e,p_(t,n)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,p_(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=v(e)}return t}}const g_={USER_NOT_FOUND:"user-not-found"};class y_ extends d_{constructor(t){super("phone","phone"),this.params=t}static _fromVerification(t,e){return new y_({verificationId:t,verificationCode:e})}static _fromTokenResponse(t,e){return new y_({phoneNumber:t,temporaryProof:e})}_getIdTokenResponse(t){return async function(t,e){return Rv(t,"POST","/v1/accounts:signInWithPhoneNumber",Av(t,e))}(t,this._makeVerificationRequest())}_linkToIdToken(t,e){return async function(t,e){const n=await Rv(t,"POST","/v1/accounts:signInWithPhoneNumber",Av(t,e));if(n.temporaryProof)throw Mv(t,"account-exists-with-different-credential",n);return n}(t,Object.assign({idToken:e},this._makeVerificationRequest()))}_getReauthenticationResolver(t){return async function(t,e){return Rv(t,"POST","/v1/accounts:signInWithPhoneNumber",Av(t,Object.assign(Object.assign({},e),{operation:"REAUTH"})),g_)}(t,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:t,phoneNumber:e,verificationId:n,verificationCode:i}=this.params;return t&&e?{temporaryProof:t,phoneNumber:e}:{sessionInfo:n,code:i}}toJSON(){const t={providerId:this.providerId};return this.params.phoneNumber&&(t.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(t.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(t.verificationCode=this.params.verificationCode),this.params.verificationId&&(t.verificationId=this.params.verificationId),t}static fromJSON(t){"string"==typeof t&&(t=JSON.parse(t));const{verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:r}=t;return n||e||i||r?new y_({verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:r}):null}}class v_{constructor(t){var e,n,i,r,s,o;const a=_(w(t)),u=null!==(e=a.apiKey)&&void 0!==e?e:null,c=null!==(n=a.oobCode)&&void 0!==n?n:null,h=function(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=a.mode)&&void 0!==i?i:null);gv(u&&c&&h,"argument-error"),this.apiKey=u,this.operation=h,this.code=c,this.continueUrl=null!==(r=a.continueUrl)&&void 0!==r?r:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(t){const e=function(t){const e=_(w(t)).link,n=e?_(w(e)).deep_link_id:null,i=_(w(t)).deep_link_id;return(i?_(w(i)).link:null)||i||n||e||t}(t);try{return new v_(e)}catch(t){return null}}}class __{constructor(){this.providerId=__.PROVIDER_ID}static credential(t,e){return f_._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const n=v_.parseLink(e);return gv(n,"argument-error"),f_._fromEmailAndCode(t,n.code,n.tenantId)}}__.PROVIDER_ID="password",__.EMAIL_PASSWORD_SIGN_IN_METHOD="password",__.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class w_{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class b_ extends w_{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class T_ extends b_{constructor(){super("facebook.com")}static credential(t){return m_._fromParams({providerId:T_.PROVIDER_ID,signInMethod:T_.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return T_.credentialFromTaggedObject(t)}static credentialFromError(t){return T_.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return T_.credential(t.oauthAccessToken)}catch(t){return null}}}T_.FACEBOOK_SIGN_IN_METHOD="facebook.com",T_.PROVIDER_ID="facebook.com";class I_ extends b_{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return m_._fromParams({providerId:I_.PROVIDER_ID,signInMethod:I_.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return I_.credentialFromTaggedObject(t)}static credentialFromError(t){return I_.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:n}=t;if(!e&&!n)return null;try{return I_.credential(e,n)}catch(t){return null}}}I_.GOOGLE_SIGN_IN_METHOD="google.com",I_.PROVIDER_ID="google.com";class E_ extends b_{constructor(){super("github.com")}static credential(t){return m_._fromParams({providerId:E_.PROVIDER_ID,signInMethod:E_.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return E_.credentialFromTaggedObject(t)}static credentialFromError(t){return E_.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return E_.credential(t.oauthAccessToken)}catch(t){return null}}}E_.GITHUB_SIGN_IN_METHOD="github.com",E_.PROVIDER_ID="github.com";class S_ extends b_{constructor(){super("twitter.com")}static credential(t,e){return m_._fromParams({providerId:S_.PROVIDER_ID,signInMethod:S_.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return S_.credentialFromTaggedObject(t)}static credentialFromError(t){return S_.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:n}=t;if(!e||!n)return null;try{return S_.credential(e,n)}catch(t){return null}}}S_.TWITTER_SIGN_IN_METHOD="twitter.com",S_.PROVIDER_ID="twitter.com";class k_{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,n,i=!1){const r=await $v._fromIdTokenResponse(t,n,i),s=C_(n);return new k_({user:r,providerId:s,_tokenResponse:n,operationType:e})}static async _forOperation(t,e,n){await t._updateTokensIfNecessary(n,!0);const i=C_(n);return new k_({user:t,providerId:i,_tokenResponse:n,operationType:e})}}function C_(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class A_ extends f{constructor(t,e,n,i){var r;super(e.code,e.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,A_.prototype),this.customData={appName:t.name,tenantId:null!==(r=t.tenantId)&&void 0!==r?r:void 0,_serverResponse:e.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,e,n,i){return new A_(t,e,n,i)}}function D_(t,e,n,i){return("reauthenticate"===e?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw A_._fromErrorAndOperation(t,n,e,i);throw n}))}async function N_(t,e,n=!1){const i="signIn",r=await D_(t,i,e),s=await k_._fromIdTokenResponse(t,i,r);return n||await t._updateCurrentUser(s.user),s}new WeakMap;const R_="__sak";class O_{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(R_,"1"),this.storage.removeItem(R_),Promise.resolve(!0)):Promise.resolve(!1)}catch(t){return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}class x_ extends O_{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const t=s();return Yv(t)||i_(t)}()&&function(){try{return!(!window||window===window.top)}catch(t){return!1}}(),this.fallbackToPolling=r_(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const n=this.storage.getItem(e),i=this.localCache[e];n!==i&&t(e,i,n)}}onStorageEvent(t,e=!1){if(!t.key)return void this.forAllChangedKeys(((t,e,n)=>{this.notifyListeners(t,n)}));const n=t.key;if(e?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(t.newValue!==i)null!==t.newValue?this.storage.setItem(n,t.newValue):this.storage.removeItem(n);else if(this.localCache[n]===t.newValue&&!e)return}const i=()=>{const t=this.storage.getItem(n);(e||this.localCache[n]!==t)&&this.notifyListeners(n,t)},r=this.storage.getItem(n);!function(){const t=s();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}()||10!==document.documentMode||r===t.newValue||t.newValue===t.oldValue?i():setTimeout(i,10)}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e?JSON.parse(e):e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((t,e,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}x_.type="LOCAL";const M_=x_;class L_ extends O_{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(t,e){}_removeListener(t,e){}}L_.type="SESSION";const P_=L_;class U_{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find((e=>e.isListeningto(t)));if(e)return e;const n=new U_(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:n,eventType:i,data:r}=e.data,s=this.handlersMap[i];if(!(null==s?void 0:s.size))return;e.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(s).map((async t=>t(e.origin,r))),a=await function(t){return Promise.all(t.map((async t=>{try{return{fulfilled:!0,value:await t}}catch(t){return{fulfilled:!1,reason:t}}})))}(o);e.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(t,e){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),e&&0!==this.handlersMap[t].size||delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function F_(t="",e=10){let n="";for(let t=0;t<e;t++)n+=Math.floor(10*Math.random());return t+n}U_.receivers=[];class V_{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,n=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,s;return new Promise(((o,a)=>{const u=F_("",20);i.port1.start();const c=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:i,onMessage(t){const e=t;if(e.data.eventId===u)switch(e.data.status){case"ack":clearTimeout(c),r=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(r),o(e.data.response);break;default:clearTimeout(c),clearTimeout(r),a(new Error("invalid_response"))}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:t,eventId:u,data:e},[i.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function B_(){return window}function j_(){return void 0!==B_().WorkerGlobalScope&&"function"==typeof B_().importScripts}const q_="firebaseLocalStorageDb",z_="firebaseLocalStorage",$_="fbase_key";class H_{constructor(t){this.request=t}toPromise(){return new Promise(((t,e)=>{this.request.addEventListener("success",(()=>{t(this.request.result)})),this.request.addEventListener("error",(()=>{e(this.request.error)}))}))}}function K_(t,e){return t.transaction([z_],e?"readwrite":"readonly").objectStore(z_)}function G_(){const t=indexedDB.open(q_,1);return new Promise(((e,n)=>{t.addEventListener("error",(()=>{n(t.error)})),t.addEventListener("upgradeneeded",(()=>{const e=t.result;try{e.createObjectStore(z_,{keyPath:$_})}catch(t){n(t)}})),t.addEventListener("success",(async()=>{const n=t.result;n.objectStoreNames.contains(z_)?e(n):(n.close(),await function(){const t=indexedDB.deleteDatabase(q_);return new H_(t).toPromise()}(),e(await G_()))}))}))}async function W_(t,e,n){const i=K_(t,!0).put({[$_]:e,value:n});return new H_(i).toPromise()}function Q_(t,e){const n=K_(t,!0).delete(e);return new H_(n).toPromise()}class X_{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await G_()),this.db}async _withRetries(t){let e=0;for(;;)try{const e=await this._openDb();return await t(e)}catch(t){if(e++>3)throw t;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return j_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=U_._getInstance(j_()?self:null),this.receiver._subscribe("keyChanged",(async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)}))),this.receiver._subscribe("ping",(async(t,e)=>["keyChanged"]))}async initializeSender(){var t,e;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(t){return null}}(),!this.activeServiceWorker)return;this.sender=new V_(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(t=n[0])||void 0===t?void 0:t.fulfilled)&&(null===(e=n[0])||void 0===e?void 0:e.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(this.sender&&this.activeServiceWorker&&function(){var t;return(null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await G_();return await W_(t,R_,"1"),await Q_(t,R_),!0}catch(t){}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite((async()=>(await this._withRetries((n=>W_(n,t,e))),this.localCache[t]=e,this.notifyServiceWorker(t))))}async _get(t){const e=await this._withRetries((e=>async function(t,e){const n=K_(t,!1).get(e),i=await new H_(n).toPromise();return void 0===i?null:i.value}(e,t)));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite((async()=>(await this._withRetries((e=>Q_(e,t))),delete this.localCache[t],this.notifyServiceWorker(t))))}async _poll(){const t=await this._withRetries((t=>{const e=K_(t,!1).getAll();return new H_(e).toPromise()}));if(!t)return[];if(0!==this.pendingWrites)return[];const e=[],n=new Set;for(const{fbase_key:i,value:r}of t)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),e.push(i));for(const t of Object.keys(this.localCache))this.localCache[t]&&!n.has(t)&&(this.notifyListeners(t,null),e.push(t));return e}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}X_.type="LOCAL";const Y_=X_;function J_(t){return`__${t}${Math.floor(1e6*Math.random())}`}J_("rcb"),new Iv(3e4,6e4);class Z_{constructor(t){this.providerId=Z_.PROVIDER_ID,this.auth=u_(t)}verifyPhoneNumber(t,e){return async function(t,e,n){var i;const r=await n.verify();try{let s;if(gv("string"==typeof r,t,"argument-error"),gv("recaptcha"===n.type,t,"argument-error"),s="string"==typeof e?{phoneNumber:e}:e,"session"in s){const e=s.session;if("phoneNumber"in s){gv("enroll"===e.type,t,"internal-error");const n=await function(t,e){return Dv(t,"POST","/v2/accounts/mfaEnrollment:start",Av(t,e))}(t,{idToken:e.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:r}});return n.phoneSessionInfo.sessionInfo}{gv("signin"===e.type,t,"internal-error");const n=(null===(i=s.multiFactorHint)||void 0===i?void 0:i.uid)||s.multiFactorUid;gv(n,t,"missing-multi-factor-info");const o=await function(t,e){return Dv(t,"POST","/v2/accounts/mfaSignIn:start",Av(t,e))}(t,{mfaPendingCredential:e.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:r}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:e}=await async function(t,e){return Dv(t,"POST","/v1/accounts:sendVerificationCode",Av(t,e))}(t,{phoneNumber:s.phoneNumber,recaptchaToken:r});return e}}finally{n._reset()}}(this.auth,t,E(e))}static credential(t,e){return y_._fromVerification(t,e)}static credentialFromResult(t){const e=t;return Z_.credentialFromTaggedObject(e)}static credentialFromError(t){return Z_.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{phoneNumber:e,temporaryProof:n}=t;return e&&n?y_._fromTokenResponse(e,n):null}}Z_.PROVIDER_ID="phone",Z_.PHONE_SIGN_IN_METHOD="phone";class tw extends d_{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return p_(t,this._buildIdpRequest())}_linkToIdToken(t,e){return p_(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return p_(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function ew(t){return N_(t.auth,new tw(t),t.bypassAuthState)}function nw(t){const{auth:e,user:n}=t;return gv(n,e,"internal-error"),async function(t,e,n=!1){var i;const{auth:r}=t,s="reauthenticate";try{const i=await Fv(t,D_(r,s,e,t),n);gv(i.idToken,r,"internal-error");const o=Uv(i.idToken);gv(o,r,"internal-error");const{sub:a}=o;return gv(t.uid===a,r,"user-mismatch"),k_._forOperation(t,s,i)}catch(t){throw"auth/user-not-found"===(null===(i=t)||void 0===i?void 0:i.code)&&fv(r,"user-mismatch"),t}}(n,new tw(t),t.bypassAuthState)}async function iw(t){const{auth:e,user:n}=t;return gv(n,e,"internal-error"),async function(t,e,n=!1){const i=await Fv(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return k_._forOperation(t,"link",i)}(n,new tw(t),t.bypassAuthState)}class rw{constructor(t,e,n,i,r=!1){this.auth=t,this.resolver=n,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise((async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(t){this.reject(t)}}))}async onAuthEvent(t){const{urlResponse:e,sessionId:n,postBody:i,tenantId:r,error:s,type:o}=t;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:e,sessionId:n,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(t){this.reject(t)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return ew;case"linkViaPopup":case"linkViaRedirect":return iw;case"reauthViaPopup":case"reauthViaRedirect":return nw;default:fv(this.auth,"internal-error")}}resolve(t){vv(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){vv(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const sw=new Iv(2e3,1e4);class ow extends rw{constructor(t,e,n,i,r){super(t,e,i,r),this.provider=n,this.authWindow=null,this.pollId=null,ow.currentPopupAction&&ow.currentPopupAction.cancel(),ow.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return gv(t,this.auth,"internal-error"),t}async onExecution(){vv(1===this.filter.length,"Popup operations only handle one event");const t=F_();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch((t=>{this.reject(t)})),this.resolver._isIframeWebStorageSupported(this.auth,(t=>{t||this.reject(pv(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(pv(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ow.currentPopupAction=null}pollUserCancellation(){const t=()=>{var e,n;(null===(n=null===(e=this.authWindow)||void 0===e?void 0:e.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(pv(this.auth,"popup-closed-by-user"))}),2e3):this.pollId=window.setTimeout(t,sw.get())};t()}}ow.currentPopupAction=null;const aw=new Map;class uw extends rw{constructor(t,e,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,n),this.eventId=null}async execute(){let t=aw.get(this.auth._key());if(!t){try{const e=await async function(t,e){const n=function(t){return Gv("pendingRedirect",t.config.apiKey,t.name)}(e),i=function(t){return wv(t._redirectPersistence)}(t);if(!await i._isAvailable())return!1;const r="true"===await i._get(n);return await i._remove(n),r}(this.resolver,this.auth),n=e?await super.execute():null;t=()=>Promise.resolve(n)}catch(e){t=()=>Promise.reject(e)}aw.set(this.auth._key(),t)}return this.bypassAuthState||aw.set(this.auth._key(),(()=>Promise.resolve(null))),t()}async onAuthEvent(t){if("signInViaRedirect"===t.type)return super.onAuthEvent(t);if("unknown"!==t.type){if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function cw(t,e){aw.set(t._key(),e)}async function hw(t,e,n=!1){const i=u_(t),r=function(t,e){return e?wv(e):(gv(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}(i,e),s=new uw(i,r,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}class lw{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(t,n)&&(e=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))})),this.hasHandledPotentialRedirect||!function(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return fw(t);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var n;if(t.error&&!fw(t)){const i=(null===(n=t.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";e.onError(pv(this.auth,i))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const n=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(dw(t))}saveEventToCache(t){this.cachedEventUids.add(dw(t)),this.lastProcessedEventTime=Date.now()}}function dw(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter((t=>t)).join("-")}function fw({type:t,error:e}){return"unknown"===t&&"auth/no-auth-event"===(null==e?void 0:e.code)}const pw=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,mw=/^https?/;function gw(t){const e=bv(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const r=new URL(t);return""===r.hostname&&""===i?"chrome-extension:"===n&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===i}if(!mw.test(n))return!1;if(pw.test(t))return i===t;const r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const yw=new Iv(3e4,6e4);function vw(){const t=B_().___jsl;if(null==t?void 0:t.H)for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let e=0;e<t.CP.length;e++)t.CP[e]=null}let _w=null;function ww(t){return _w=_w||function(t){return new Promise(((e,n)=>{var i,r,s,o;function a(){vw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{vw(),n(pv(t,"network-request-failed"))},timeout:yw.get()})}if(null===(r=null===(i=B_().gapi)||void 0===i?void 0:i.iframes)||void 0===r?void 0:r.Iframe)e(gapi.iframes.getContext());else{if(!(null===(s=B_().gapi)||void 0===s?void 0:s.load)){const e=J_("iframefcb");return B_()[e]=()=>{gapi.load?a():n(pv(t,"network-request-failed"))},(o=`https://apis.google.com/js/api.js?onload=${e}`,new Promise(((t,e)=>{const n=document.createElement("script");n.setAttribute("src",o),n.onload=t,n.onerror=t=>{const n=pv("internal-error");n.customData=t,e(n)},n.type="text/javascript",n.charset="UTF-8",function(){var t,e;return null!==(e=null===(t=document.getElementsByTagName("head"))||void 0===t?void 0:t[0])&&void 0!==e?e:document}().appendChild(n)}))).catch((t=>n(t)))}a()}})).catch((t=>{throw _w=null,t}))}(t),_w}const bw=new Iv(5e3,15e3),Tw={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Iw=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Ew(t){const e=t.config;gv(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Ev(e,"emulator/auth/iframe"):`https://${t.config.authDomain}/__/auth/iframe`,i={apiKey:e.apiKey,appName:t.name,v:ft},r=Iw.get(t.config.apiHost);r&&(i.eid=r);const s=t._getFrameworks();return s.length&&(i.fw=s.join(",")),`${n}?${v(i).slice(1)}`}const Sw={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class kw{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(t){}}}function Cw(t,e,n,i,r,s){gv(t.config.authDomain,t,"auth-domain-config-required"),gv(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:i,v:ft,eventId:r};if(e instanceof w_){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",function(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[t,e]of Object.entries(s||{}))o[t]=e}if(e instanceof b_){const t=e.getScopes().filter((t=>""!==t));t.length>0&&(o.scopes=t.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const t of Object.keys(a))void 0===a[t]&&delete a[t];return`${function({config:t}){return t.emulator?Ev(t,"emulator/auth/handler"):`https://${t.authDomain}/__/auth/handler`}(t)}?${v(a).slice(1)}`}const Aw="webStorageSupport",Dw=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=P_,this._completeRedirectFn=hw,this._overrideRedirectResult=cw}async _openPopup(t,e,n,i){var r;return vv(null===(r=this.eventManagers[t._key()])||void 0===r?void 0:r.manager,"_initialize() not called before _openPopup()"),function(t,e,n,i=500,r=600){const o=Math.max((window.screen.availHeight-r)/2,0).toString(),a=Math.max((window.screen.availWidth-i)/2,0).toString();let u="";const c=Object.assign(Object.assign({},Sw),{width:i.toString(),height:r.toString(),top:o,left:a}),h=s().toLowerCase();n&&(u=Jv(h)?"_blank":n),Xv(h)&&(e=e||"http://localhost",c.scrollbars="yes");const l=Object.entries(c).reduce(((t,[e,n])=>`${t}${e}=${n},`),"");if(function(t=s()){var e;return i_(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(h)&&"_self"!==u)return function(t,e){const n=document.createElement("a");n.href=t,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(e||"",u),new kw(null);const d=window.open(e||"",u,l);gv(d,t,"popup-blocked");try{d.focus()}catch(t){}return new kw(d)}(t,Cw(t,e,n,bv(),i),F_())}async _openRedirect(t,e,n,i){var r;return await this._originValidation(t),r=Cw(t,e,n,bv(),i),B_().location.href=r,new Promise((()=>{}))}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:t,promise:n}=this.eventManagers[e];return t?Promise.resolve(t):(vv(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(t);return this.eventManagers[e]={promise:n},n.catch((()=>{delete this.eventManagers[e]})),n}async initAndGetManager(t){const e=await async function(t){const e=await ww(t),n=B_().gapi;return gv(n,t,"internal-error"),e.open({where:document.body,url:Ew(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Tw,dontclear:!0},(e=>new Promise((async(n,i)=>{await e.restyle({setHideOnLeave:!1});const r=pv(t,"network-request-failed"),s=B_().setTimeout((()=>{i(r)}),bw.get());function o(){B_().clearTimeout(s),n(e)}e.ping(o).then(o,(()=>{i(r)}))}))))}(t),n=new lw(t);return e.register("authEvent",(e=>(gv(null==e?void 0:e.authEvent,t,"invalid-auth-event"),{status:n.onEvent(e.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=e,n}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(Aw,{type:Aw},(n=>{var i;const r=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i.webStorageSupport;void 0!==r&&e(!!r),fv(t,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=async function(t){if(t.config.emulator)return;const{authorizedDomains:e}=await async function(t,e={}){return Dv(t,"GET","/v1/projects",e)}(t);for(const t of e)try{if(gw(t))return}catch(t){}fv(t,"unauthorized-domain")}(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return r_()||Yv()||i_()}};var Nw="@firebase/auth",Rw="0.20.11";class Ow{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged((e=>{var n;t((null===(n=e)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)}));this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){gv(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const xw=l("authIdTokenMaxAge")||300;let Mw=null;var Lw;Lw="Browser",ct(new S("auth",((t,{options:e})=>{const n=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),{apiKey:r,authDomain:s}=n.options;return((t,n)=>{gv(r&&!r.includes(":"),"invalid-api-key",{appName:t.name}),gv(!(null==s?void 0:s.includes(":")),"argument-error",{appName:t.name});const i={apiKey:r,authDomain:s,clientPlatform:Lw,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:s_(Lw)},o=new a_(t,n,i);return function(t,e){const n=(null==e?void 0:e.persistence)||[],i=(Array.isArray(n)?n:[n]).map(wv);(null==e?void 0:e.errorMap)&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,null==e?void 0:e.popupRedirectResolver)}(o,e),o})(n,i)}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((t,e,n)=>{t.getProvider("auth-internal").initialize()}))),ct(new S("auth-internal",(t=>(t=>new Ow(t))(u_(t.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),gt(Nw,Rw,void 0),gt(Nw,Rw,"esm2017");var Pw=function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{u(i.next(t))}catch(t){s(t)}}function a(t){try{u(i.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}u((i=i.apply(t,e||[])).next())}))};const Uw=function(t=mt()){const e=ht(t,"auth");if(e.isInitialized())return e.getImmediate();const n=function(t,e){const n=ht(t,"auth");if(n.isInitialized()){const t=n.getImmediate();if(g(n.getOptions(),null!=e?e:{}))return t;fv(t,"already-initialized")}return n.initialize({options:e})}(t,{popupRedirectResolver:Dw,persistence:[Y_,M_,P_]}),i=l("authTokenSyncURL");if(i){const t=(r=i,async t=>{const e=t&&await t.getIdTokenResult(),n=e&&((new Date).getTime()-Date.parse(e.issuedAtTime))/1e3;if(n&&n>xw)return;const i=null==e?void 0:e.token;Mw!==i&&(Mw=i,await fetch(r,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});!function(t,e,n){E(t).beforeAuthStateChanged(e,n)}(n,t,(()=>t(n.currentUser))),function(e,n,i,r){E(e).onIdTokenChanged((e=>t(e)),void 0,void 0)}(n)}var r;const s=h("auth");return s&&function(t,e,n){const i=u_(t);gv(i._canInitEmulator,i,"emulator-config-failed"),gv(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!!(null==n?void 0:n.disableWarnings),s=h_(e),{host:o,port:a}=function(t){const e=h_(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const t=r[1];return{host:t,port:l_(i.substr(t.length+1))}}{const[t,e]=i.split(":");return{host:t,port:l_(e)}}}(e),u=null===a?"":`:${a}`;i.config.emulator={url:`${s}//${o}${u}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||function(){function t(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",t):t())}()}(n,`http://${s}`),n}();Uw.onAuthStateChanged((t=>{t?(sessionStorage.setItem("userId",t.uid),rn(Pe)):(sessionStorage.removeItem("userId"),rn(Le))}));const Fw=t=>Pw(void 0,void 0,void 0,(function*(){t.preventDefault();let e=Be.username.value,n=Be.email.value,i=Be.password.value;if(sn(e)||(qe.innerHTML="please fill in a username"),on(n)||(ze.innerHTML="please fill in your email"),an(i)||($e.innerHTML="password can't be empty"),sn(e)&&on(n)&&an(i))try{let t=yield async function(t,e,n){const i=u_(t),r=await async function(t,e){return Rv(t,"POST","/v1/accounts:signUp",Av(t,e))}(i,{returnSecureToken:!0,email:e,password:n}),s=await k_._fromIdTokenResponse(i,"signIn",r);return await i._updateCurrentUser(s.user),s}(Uw,n,i);console.log(t),t&&(Be.reset(),rn(Le))}catch(t){je.innerHTML="An account with this email already exists"}})),Vw=t=>Pw(void 0,void 0,void 0,(function*(){t.preventDefault();let e=Ke.email.value,n=Ke.password.value;if(on(e)||(We.innerHTML="email can't be empty"),an(n)||(Qe.innerHTML="password can't be empty"),on(e)&&an(n))try{let t=yield function(t,e,n){return async function(t,e){return N_(u_(t),e)}(E(t),__.credential(e,n))}(Uw,e,n);console.log(t),t&&(Ke.reset(),rn(Pe))}catch(t){Ge.innerHTML="Wrong email password combination"}}));Be.addEventListener("submit",(t=>{Fw(t)})),Ke.addEventListener("submit",(t=>{Vw(t)})),Re.addEventListener("click",(()=>{Uw.signOut()})),He.addEventListener("click",(()=>{rn(Le)})),Xe.addEventListener("click",(()=>{rn(Me)})),Oe.addEventListener("click",(()=>{rn(Fe)})),Ye.addEventListener("submit",(t=>{(t=>{!function(t,e,n,i){new(n||(n=Promise))((function(r,s){function o(t){try{u(i.next(t))}catch(t){s(t)}}function a(t){try{u(i.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}u((i=i.apply(t,e||[])).next())}))}(void 0,void 0,void 0,(function*(){t.preventDefault();let e=Ye.groupname.value,n=Ye.description.value,i=Ye.theme.value;un(e)||(Je.innerHTML="please fill in a name"),un(i)||(Ze.innerHTML="please choose a theme");let r={name:e,description:n,theme:i,lastMessage:"",timeOfLastMessage:""};un(e)&&un(i)&&(Ye.reset(),(t=>{ff(void 0,void 0,void 0,(function*(){yield cf(mf,t)}))})(r),rn(Pe))}))})(t)})),tn.addEventListener("submit",(t=>{(t=>{!function(t,e,n,i){new(n||(n=Promise))((function(r,s){function o(t){try{u(i.next(t))}catch(t){s(t)}}function a(t){try{u(i.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}u((i=i.apply(t,e||[])).next())}))}(void 0,void 0,void 0,(function*(){t.preventDefault();let e=tn.message.value,n={chatroomId:sessionStorage.getItem("currentChatroomId"),message:e,timestamp:Fo.now(),user:sessionStorage.getItem("userId")};un(e)&&(tn.reset(),(t=>{ff(void 0,void 0,void 0,(function*(){yield cf(gf,t)}))})(n))}))})(t)})),xe.forEach((t=>{t.addEventListener("click",(()=>{rn(Pe)}))})),window.addEventListener("load",(()=>{ff(void 0,void 0,void 0,(function*(){hf(mf,(t=>{en.innerHTML="",t.forEach((t=>{((t,e)=>{let n=document.createElement("li");n.classList.add("chatrooms__chat"),n.innerHTML=`\n        <span class="chatrooms__chatroom-id">${t}</span>\n        <div class="chatrooms__chat-icon">\n            <div class="chatrooms__icon-placeholder"></div>\n        </div>\n        <div class="chatrooms__chat-info">\n            <h4 class="primary-font text-inverted">${e.name}</h4>\n            <p class="extra-subtle bold text-xs">${e.lastMessage}</p>\n        </div>\n        <div class="chatrooms__chat-status">\n            <p class="extra-subtle bold text-xs">${e.timeOfLastMessage}</p>\n            <img src="./images/icons/check.svg" alt="status icon" />\n        </div>\n    `,null==n||n.addEventListener("click",(t=>{let e=t.target;vf(e.innerText),sessionStorage.setItem("currentChatroomId",e.innerText),rn(Ue)})),null==en||en.appendChild(n)})(t.id,t.data())}))}))}))}))})();
//# sourceMappingURL=bundle.js.map