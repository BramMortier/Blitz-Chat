/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";var t={};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}();const e=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=63&r|128):55296==(64512&r)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&t.charCodeAt(++i)),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=63&r|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=63&r|128)}return e},n={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let e=0;e<t.length;e+=3){const r=t[e],s=e+1<t.length,o=s?t[e+1]:0,a=e+2<t.length,c=a?t[e+2]:0,u=r>>2,h=(3&r)<<4|o>>4;let l=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(l=64)),i.push(n[u],n[h],n[l],n[d])}return i.join("")},encodeString(t,n){return this.HAS_NATIVE_SUPPORT&&!n?btoa(t):this.encodeByteArray(e(t),n)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,i=0;for(;n<t.length;){const r=t[n++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=t[n++];e[i++]=String.fromCharCode((31&r)<<6|63&s)}else if(r>239&&r<365){const s=((7&r)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[i++]=String.fromCharCode(55296+(s>>10)),e[i++]=String.fromCharCode(56320+(1023&s))}else{const s=t[n++],o=t[n++];e[i++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let e=0;e<t.length;){const r=n[t.charAt(e++)],s=e<t.length?n[t.charAt(e)]:0;++e;const o=e<t.length?n[t.charAt(e)]:64;++e;const a=e<t.length?n[t.charAt(e)]:64;if(++e,null==r||null==s||null==o||null==a)throw Error();const c=r<<2|s>>4;if(i.push(c),64!==o){const t=s<<4&240|o>>2;if(i.push(t),64!==a){const t=o<<6&192|a;i.push(t)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},i=function(t){return function(t){const i=e(t);return n.encodeByteArray(i,!0)}(t).replace(/\./g,"")},r=function(t){try{return n.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function s(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function o(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function a(){return"object"==typeof indexedDB}function c(){return new Promise(((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var t;e((null===(t=r.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}}))}const u=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==t.g)return t.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const t=process.env.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if("undefined"==typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(t){return}const e=t&&r(t[1]);return e&&JSON.parse(e)})()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}},h=t=>{var e,n;return null===(n=null===(e=u())||void 0===e?void 0:e.emulatorHosts)||void 0===n?void 0:n[t]},l=t=>{var e;return null===(e=u())||void 0===e?void 0:e[`_${t}`]};class d{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}class f extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,f.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,p.prototype.create)}}class p{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},i=`${this.service}/${t}`,r=this.errors[t],s=r?function(t,e){return t.replace(m,((t,n)=>{const i=e[n];return null!=i?String(i):`<${n}?>`}))}(r,n):"Error",o=`${this.serviceName}: ${s} (${i}).`;return new f(i,o,n)}}const m=/\{\$([^}]+)}/g;function g(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const r of n){if(!i.includes(r))return!1;const n=t[r],s=e[r];if(y(n)&&y(s)){if(!g(n,s))return!1}else if(n!==s)return!1}for(const t of i)if(!n.includes(t))return!1;return!0}function y(t){return null!==t&&"object"==typeof t}function v(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach((t=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(t))})):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function _(t){const e={};return t.replace(/^\?/,"").split("&").forEach((t=>{if(t){const[n,i]=t.split("=");e[decodeURIComponent(n)]=decodeURIComponent(i)}})),e}function w(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}class b{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((()=>{t(this)})).catch((t=>{this.error(t)}))}next(t){this.forEachObserver((e=>{e.next(t)}))}error(t){this.forEachObserver((e=>{e.error(t)})),this.close(t)}complete(){this.forEachObserver((t=>{t.complete()})),this.close()}subscribe(t,e,n){let i;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");i=function(t,e){if("object"!=typeof t||null===t)return!1;for(const e of["next","error","complete"])if(e in t&&"function"==typeof t[e])return!0;return!1}(t)?t:{next:t,error:e,complete:n},void 0===i.next&&(i.next=T),void 0===i.error&&(i.error=T),void 0===i.complete&&(i.complete=T);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(t){}})),this.observers.push(i),r}unsubscribeOne(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function T(){}function I(t,e=1e3,n=2){const i=e*Math.pow(n,t),r=Math.round(.5*i*(Math.random()-.5)*2);return Math.min(144e5,i+r)}function E(t){return t&&t._delegate?t._delegate:t}class S{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const k="[DEFAULT]";class C{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new d;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(t){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(i)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:k})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(t){}}}}clearInstance(t="[DEFAULT]"){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t="[DEFAULT]"){return this.instances.has(t)}getOptions(t="[DEFAULT]"){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[t,e]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(t)&&e.resolve(i);return i}onInit(t,e){var n;const i=this.normalizeInstanceIdentifier(e),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(t),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&t(s,i),()=>{r.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const i of n)try{i(t,e)}catch(t){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===k?void 0:i),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(t){}var i;return n||null}normalizeInstanceIdentifier(t="[DEFAULT]"){return this.component?this.component.multipleInstances?t:k:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class A{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new C(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const D=[];var N,R;(R=N||(N={}))[R.DEBUG=0]="DEBUG",R[R.VERBOSE=1]="VERBOSE",R[R.INFO=2]="INFO",R[R.WARN=3]="WARN",R[R.ERROR=4]="ERROR",R[R.SILENT=5]="SILENT";const O={debug:N.DEBUG,verbose:N.VERBOSE,info:N.INFO,warn:N.WARN,error:N.ERROR,silent:N.SILENT},x=N.INFO,M={[N.DEBUG]:"log",[N.VERBOSE]:"log",[N.INFO]:"info",[N.WARN]:"warn",[N.ERROR]:"error"},L=(t,e,...n)=>{if(e<t.logLevel)return;const i=(new Date).toISOString(),r=M[e];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[r](`[${i}]  ${t.name}:`,...n)};class P{constructor(t){this.name=t,this._logLevel=x,this._logHandler=L,this._userLogHandler=null,D.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in N))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?O[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,N.DEBUG,...t),this._logHandler(this,N.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,N.VERBOSE,...t),this._logHandler(this,N.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,N.INFO,...t),this._logHandler(this,N.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,N.WARN,...t),this._logHandler(this,N.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,N.ERROR,...t),this._logHandler(this,N.ERROR,...t)}}let U,F;const V=new WeakMap,B=new WeakMap,j=new WeakMap,q=new WeakMap,z=new WeakMap;let $={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return B.get(t);if("objectStoreNames"===e)return t.objectStoreNames||j.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return K(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function H(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(F||(F=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(G(this),t),K(V.get(this))}:function(...t){return K(e.apply(G(this),t))}:function(t,...n){const i=e.call(G(this),t,...n);return j.set(i,t.sort?t.sort():[t]),K(i)}:(t instanceof IDBTransaction&&function(t){if(B.has(t))return;const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("complete",r),t.removeEventListener("error",s),t.removeEventListener("abort",s)},r=()=>{e(),i()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",r),t.addEventListener("error",s),t.addEventListener("abort",s)}));B.set(t,e)}(t),n=t,(U||(U=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((t=>n instanceof t))?new Proxy(t,$):t);var e,n}function K(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("success",r),t.removeEventListener("error",s)},r=()=>{e(K(t.result)),i()},s=()=>{n(t.error),i()};t.addEventListener("success",r),t.addEventListener("error",s)}));return e.then((e=>{e instanceof IDBCursor&&V.set(e,t)})).catch((()=>{})),z.set(e,t),e}(t);if(q.has(t))return q.get(t);const e=H(t);return e!==t&&(q.set(t,e),z.set(e,t)),e}const G=t=>z.get(t);function W(t,e,{blocked:n,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(t,e),a=K(o);return i&&o.addEventListener("upgradeneeded",(t=>{i(K(o.result),t.oldVersion,t.newVersion,K(o.transaction))})),n&&o.addEventListener("blocked",(()=>n())),a.then((t=>{s&&t.addEventListener("close",(()=>s())),r&&t.addEventListener("versionchange",(()=>r()))})).catch((()=>{})),a}const Q=["get","getKey","getAll","getAllKeys","count"],X=["put","add","delete","clear"],Y=new Map;function J(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(Y.get(e))return Y.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,r=X.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!Q.includes(n))return;const s=async function(t,...e){const s=this.transaction(t,r?"readwrite":"readonly");let o=s.store;return i&&(o=o.index(e.shift())),(await Promise.all([o[n](...e),r&&s.done]))[0]};return Y.set(e,s),s}var Z;Z=$,$={...Z,get:(t,e,n)=>J(t,e)||Z.get(t,e,n),has:(t,e)=>!!J(t,e)||Z.has(t,e)};class tt{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const et="@firebase/app",nt="0.8.4",it=new P("@firebase/app"),rt="[DEFAULT]",st={[et]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},ot=new Map,at=new Map;function ct(t,e){try{t.container.addComponent(e)}catch(n){it.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function ut(t){const e=t.name;if(at.has(e))return it.debug(`There were multiple attempts to register component ${e}.`),!1;at.set(e,t);for(const e of ot.values())ct(e,t);return!0}function ht(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}const lt=new p("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class dt{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new S("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw lt.create("app-deleted",{appName:this._name})}}const ft="9.14.0";function pt(t,e={}){let n=t;"object"!=typeof e&&(e={name:e});const i=Object.assign({name:rt,automaticDataCollectionEnabled:!1},e),r=i.name;if("string"!=typeof r||!r)throw lt.create("bad-app-name",{appName:String(r)});if(n||(n=(()=>{var t;return null===(t=u())||void 0===t?void 0:t.config})()),!n)throw lt.create("no-options");const s=ot.get(r);if(s){if(g(n,s.options)&&g(i,s.config))return s;throw lt.create("duplicate-app",{appName:r})}const o=new A(r);for(const t of at.values())o.addComponent(t);const a=new dt(n,i,o);return ot.set(r,a),a}function mt(t="[DEFAULT]"){const e=ot.get(t);if(!e&&t===rt)return pt();if(!e)throw lt.create("no-app",{appName:t});return e}function gt(t,e,n){var i;let r=null!==(i=st[t])&&void 0!==i?i:t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const t=[`Unable to register library "${r}" with version "${e}":`];return s&&t.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&t.push("and"),o&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void it.warn(t.join(" "))}ut(new S(`${r}-version`,(()=>({library:r,version:e})),"VERSION"))}const yt="firebase-heartbeat-store";let vt=null;function _t(){return vt||(vt=W("firebase-heartbeat-database",1,{upgrade:(t,e)=>{0===e&&t.createObjectStore(yt)}}).catch((t=>{throw lt.create("idb-open",{originalErrorMessage:t.message})}))),vt}async function wt(t,e){var n;try{const n=(await _t()).transaction(yt,"readwrite"),i=n.objectStore(yt);return await i.put(e,bt(t)),n.done}catch(t){if(t instanceof f)it.warn(t.message);else{const e=lt.create("idb-set",{originalErrorMessage:null===(n=t)||void 0===n?void 0:n.message});it.warn(e.message)}}}function bt(t){return`${t.name}!${t.options.appId}`}class Tt{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new Et(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),e=It();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==e&&!this._heartbeatsCache.heartbeats.some((t=>t.date===e)))return this._heartbeatsCache.heartbeats.push({date:e,agent:t}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const t=It(),{heartbeatsToSend:e,unsentEntries:n}=function(t,e=1024){const n=[];let i=t.slice();for(const r of t){const t=n.find((t=>t.agent===r.agent));if(t){if(t.dates.push(r.date),St(n)>e){t.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),St(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),r=i(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function It(){return(new Date).toISOString().substring(0,10)}class Et{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!a()&&c().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const t=await async function(t){var e;try{return(await _t()).transaction(yt).objectStore(yt).get(bt(t))}catch(t){if(t instanceof f)it.warn(t.message);else{const n=lt.create("idb-get",{originalErrorMessage:null===(e=t)||void 0===e?void 0:e.message});it.warn(n.message)}}}(this.app);return t||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return wt(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return wt(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function St(t){return i(JSON.stringify({version:2,heartbeats:t})).length}ut(new S("platform-logger",(t=>new tt(t)),"PRIVATE")),ut(new S("heartbeat",(t=>new Tt(t)),"PRIVATE")),gt(et,nt,""),gt(et,nt,"esm2017"),gt("fire-js",""),gt("firebase","9.14.0","app");const kt="@firebase/installations",Ct="0.5.16",At="w:0.5.16",Dt=new p("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function Nt(t){return t instanceof f&&t.code.includes("request-failed")}function Rt({projectId:t}){return`https://firebaseinstallations.googleapis.com/v1/projects/${t}/installations`}function Ot(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}async function xt(t,e){const n=(await e.json()).error;return Dt.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function Mt({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}async function Lt(t){const e=await t();return e.status>=500&&e.status<600?t():e}function Pt(t){return new Promise((e=>{setTimeout(e,t)}))}const Ut=/^[cdef][\w-]{21}$/;function Ft(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const e=function(t){return(e=t,btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var e}(t);return Ut.test(e)?e:""}catch(t){return""}}function Vt(t){return`${t.appName}!${t.appId}`}const Bt=new Map;function jt(t,e){const n=Vt(t);qt(n,e),function(t,e){const n=(!zt&&"BroadcastChannel"in self&&(zt=new BroadcastChannel("[Firebase] FID Change"),zt.onmessage=t=>{qt(t.data.key,t.data.fid)}),zt);n&&n.postMessage({key:t,fid:e}),0===Bt.size&&zt&&(zt.close(),zt=null)}(n,e)}function qt(t,e){const n=Bt.get(t);if(n)for(const t of n)t(e)}let zt=null;const $t="firebase-installations-store";let Ht=null;function Kt(){return Ht||(Ht=W("firebase-installations-database",1,{upgrade:(t,e)=>{0===e&&t.createObjectStore($t)}})),Ht}async function Gt(t,e){const n=Vt(t),i=(await Kt()).transaction($t,"readwrite"),r=i.objectStore($t),s=await r.get(n);return await r.put(e,n),await i.done,s&&s.fid===e.fid||jt(t,e.fid),e}async function Wt(t){const e=Vt(t),n=(await Kt()).transaction($t,"readwrite");await n.objectStore($t).delete(e),await n.done}async function Qt(t,e){const n=Vt(t),i=(await Kt()).transaction($t,"readwrite"),r=i.objectStore($t),s=await r.get(n),o=e(s);return void 0===o?await r.delete(n):await r.put(o,n),await i.done,!o||s&&s.fid===o.fid||jt(t,o.fid),o}async function Xt(t){let e;const n=await Qt(t.appConfig,(n=>{const i=function(t){return Zt(t||{fid:Ft(),registrationStatus:0})}(n),r=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(Dt.create("app-offline"))};const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=async function(t,e){try{const n=await async function({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const i=Rt(t),r=Mt(t),s=e.getImmediate({optional:!0});if(s){const t=await s.getHeartbeatsHeader();t&&r.append("x-firebase-client",t)}const o={fid:n,authVersion:"FIS_v2",appId:t.appId,sdkVersion:At},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await Lt((()=>fetch(i,a)));if(c.ok){const t=await c.json();return{fid:t.fid||n,registrationStatus:2,refreshToken:t.refreshToken,authToken:Ot(t.authToken)}}throw await xt("Create Installation",c)}(t,e);return Gt(t.appConfig,n)}catch(n){throw Nt(n)&&409===n.customData.serverCode?await Wt(t.appConfig):await Gt(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}(t,n);return{installationEntry:n,registrationPromise:i}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:Yt(t)}:{installationEntry:e}}(t,i);return e=r.registrationPromise,r.installationEntry}));return""===n.fid?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}async function Yt(t){let e=await Jt(t.appConfig);for(;1===e.registrationStatus;)await Pt(100),e=await Jt(t.appConfig);if(0===e.registrationStatus){const{installationEntry:e,registrationPromise:n}=await Xt(t);return n||e}return e}function Jt(t){return Qt(t,(t=>{if(!t)throw Dt.create("installation-not-found");return Zt(t)}))}function Zt(t){return 1===(e=t).registrationStatus&&e.registrationTime+1e4<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}async function te({appConfig:t,heartbeatServiceProvider:e},n){const i=function(t,{fid:e}){return`${Rt(t)}/${e}/authTokens:generate`}(t,n),r=function(t,{refreshToken:e}){const n=Mt(t);return n.append("Authorization",function(t){return`FIS_v2 ${t}`}(e)),n}(t,n),s=e.getImmediate({optional:!0});if(s){const t=await s.getHeartbeatsHeader();t&&r.append("x-firebase-client",t)}const o={installation:{sdkVersion:At,appId:t.appId}},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await Lt((()=>fetch(i,a)));if(c.ok)return Ot(await c.json());throw await xt("Generate Auth Token",c)}async function ee(t,e=!1){let n;const i=await Qt(t.appConfig,(i=>{if(!ie(i))throw Dt.create("not-registered");const r=i.authToken;if(!e&&(2===(s=r).requestStatus&&!function(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+36e5}(s)))return i;var s;if(1===r.requestStatus)return n=async function(t,e){let n=await ne(t.appConfig);for(;1===n.authToken.requestStatus;)await Pt(100),n=await ne(t.appConfig);const i=n.authToken;return 0===i.requestStatus?ee(t,e):i}(t,e),i;{if(!navigator.onLine)throw Dt.create("app-offline");const e=function(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}(i);return n=async function(t,e){try{const n=await te(t,e),i=Object.assign(Object.assign({},e),{authToken:n});return await Gt(t.appConfig,i),n}catch(n){if(!Nt(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Gt(t.appConfig,n)}else await Wt(t.appConfig);throw n}}(t,e),e}}));return n?await n:i.authToken}function ne(t){return Qt(t,(t=>{if(!ie(t))throw Dt.create("not-registered");return 1===(e=t.authToken).requestStatus&&e.requestTime+1e4<Date.now()?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t;var e}))}function ie(t){return void 0!==t&&2===t.registrationStatus}function re(t){return Dt.create("missing-app-config-values",{valueName:t})}const se="installations";ut(new S(se,(t=>{const e=t.getProvider("app").getImmediate(),n=function(t){if(!t||!t.options)throw re("App Configuration");if(!t.name)throw re("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw re(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e);return{app:e,appConfig:n,heartbeatServiceProvider:ht(e,"heartbeat"),_delete:()=>Promise.resolve()}}),"PUBLIC")),ut(new S("installations-internal",(t=>{const e=ht(t.getProvider("app").getImmediate(),se).getImmediate();return{getId:()=>async function(t){const e=t,{installationEntry:n,registrationPromise:i}=await Xt(e);return i?i.catch(console.error):ee(e).catch(console.error),n.fid}(e),getToken:t=>async function(t,e=!1){const n=t;return await async function(t){const{registrationPromise:e}=await Xt(t);e&&await e}(n),(await ee(n,e)).token}(e,t)}}),"PRIVATE")),gt(kt,Ct),gt(kt,Ct,"esm2017");const oe="analytics",ae="https://www.googletagmanager.com/gtag/js",ce=new P("@firebase/analytics");function ue(t){return Promise.all(t.map((t=>t.catch((t=>t)))))}const he=new p("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),le=new class{constructor(t={},e=1e3){this.throttleMetadata=t,this.intervalMillis=e}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,e){this.throttleMetadata[t]=e}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}};function de(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function fe(t,e=le,n){const{appId:i,apiKey:r,measurementId:s}=t.options;if(!i)throw he.create("no-app-id");if(!r){if(s)return{measurementId:s,appId:i};throw he.create("no-api-key")}const o=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new me;return setTimeout((async()=>{a.abort()}),void 0!==n?n:6e4),pe({appId:i,apiKey:r,measurementId:s},o,a,e)}async function pe(t,{throttleEndTimeMillis:e,backoffCount:n},i,r=le){var s,o;const{appId:a,measurementId:c}=t;try{await function(t,e){return new Promise(((n,i)=>{const r=Math.max(e-Date.now(),0),s=setTimeout(n,r);t.addEventListener((()=>{clearTimeout(s),i(he.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}(i,e)}catch(t){if(c)return ce.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${null===(s=t)||void 0===s?void 0:s.message}]`),{appId:a,measurementId:c};throw t}try{const e=await async function(t){var e;const{appId:n,apiKey:i}=t,r={method:"GET",headers:de(i)},s="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),o=await fetch(s,r);if(200!==o.status&&304!==o.status){let t="";try{const n=await o.json();(null===(e=n.error)||void 0===e?void 0:e.message)&&(t=n.error.message)}catch(t){}throw he.create("config-fetch-failed",{httpStatus:o.status,responseMessage:t})}return o.json()}(t);return r.deleteThrottleMetadata(a),e}catch(e){const s=e;if(!function(t){if(!(t instanceof f&&t.customData))return!1;const e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(s)){if(r.deleteThrottleMetadata(a),c)return ce.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${null==s?void 0:s.message}]`),{appId:a,measurementId:c};throw e}const u=503===Number(null===(o=null==s?void 0:s.customData)||void 0===o?void 0:o.httpStatus)?I(n,r.intervalMillis,30):I(n,r.intervalMillis),h={throttleEndTimeMillis:Date.now()+u,backoffCount:n+1};return r.setThrottleMetadata(a,h),ce.debug(`Calling attemptFetch again in ${u} millis`),pe(t,h,i,r)}}class me{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach((t=>t()))}}let ge,ye;async function ve(t,e,n,i,r,s,o){var u;const h=fe(t);h.then((e=>{n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&ce.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${e.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((t=>ce.error(t))),e.push(h);const l=async function(){var t;if(!a())return ce.warn(he.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await c()}catch(e){return ce.warn(he.create("indexeddb-unavailable",{errorInfo:null===(t=e)||void 0===t?void 0:t.toString()}).message),!1}return!0}().then((t=>t?i.getId():void 0)),[d,f]=await Promise.all([h,l]);(function(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(ae)&&n.src.includes(t))return n;return null})(s)||function(t,e){const n=document.createElement("script");n.src=`${ae}?l=${t}&id=${e}`,n.async=!0,document.head.appendChild(n)}(s,d.measurementId),ye&&(r("consent","default",ye),ye=void 0),r("js",new Date);const p=null!==(u=null==o?void 0:o.config)&&void 0!==u?u:{};return p.origin="firebase",p.update=!0,null!=f&&(p.firebase_id=f),r("config",d.measurementId,p),ge&&(r("set",ge),ge=void 0),d.measurementId}class _e{constructor(t){this.app=t}_delete(){return delete we[this.app.options.appId],Promise.resolve()}}let we={},be=[];const Te={};let Ie,Ee,Se="dataLayer",ke=!1;function Ce(t,e,n){!function(){const t=[];if(o()&&t.push("This is a browser extension environment."),"undefined"!=typeof navigator&&navigator.cookieEnabled||t.push("Cookies are not available."),t.length>0){const e=t.map(((t,e)=>`(${e+1}) ${t}`)).join(" "),n=he.create("invalid-analytics-context",{errorInfo:e});ce.warn(n.message)}}();const i=t.options.appId;if(!i)throw he.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw he.create("no-api-key");ce.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=we[i])throw he.create("already-exists",{id:i});if(!ke){!function(t){let e=[];Array.isArray(window.dataLayer)?e=window.dataLayer:window.dataLayer=e}();const{wrappedGtag:t,gtagCore:e}=function(t,e,n,i,r){let s=function(...t){window.dataLayer.push(arguments)};return window.gtag&&"function"==typeof window.gtag&&(s=window.gtag),window.gtag=function(t,e,n,i){return async function(r,s,o){try{"event"===r?await async function(t,e,n,i,r){try{let s=[];if(r&&r.send_to){let t=r.send_to;Array.isArray(t)||(t=[t]);const i=await ue(n);for(const n of t){const t=i.find((t=>t.measurementId===n)),r=t&&e[t.appId];if(!r){s=[];break}s.push(r)}}0===s.length&&(s=Object.values(e)),await Promise.all(s),t("event",i,r||{})}catch(t){ce.error(t)}}(t,e,n,s,o):"config"===r?await async function(t,e,n,i,r,s){const o=i[r];try{if(o)await e[o];else{const t=(await ue(n)).find((t=>t.measurementId===r));t&&await e[t.appId]}}catch(t){ce.error(t)}t("config",r,s)}(t,e,n,i,s,o):"consent"===r?t("consent","update",o):t("set",s)}catch(t){ce.error(t)}}}(s,t,e,n),{gtagCore:s,wrappedGtag:window.gtag}}(we,be,Te);Ee=t,Ie=e,ke=!0}return we[i]=ve(t,be,Te,e,Ie,Se,n),new _e(t)}const Ae="@firebase/analytics",De="0.8.4";ut(new S(oe,((t,{options:e})=>Ce(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),e)),"PUBLIC")),ut(new S("analytics-internal",(function(t){try{const e=t.getProvider(oe).getImmediate();return{logEvent:(t,n,i)=>function(t,e,n,i){t=E(t),async function(t,e,n,i,r){if(r&&r.global)t("event",n,i);else{const r=await e;t("event",n,Object.assign(Object.assign({},i),{send_to:r}))}}(Ee,we[t.app.options.appId],e,n,i).catch((t=>ce.error(t)))}(e,t,n,i)}}catch(t){throw he.create("interop-component-reg-failed",{reason:t})}}),"PRIVATE")),gt(Ae,De),gt(Ae,De,"esm2017");const Ne=pt({apiKey:"AIzaSyAfLyWlU3BMjia7qU9-qYDGGMuuPEBtFqU",authDomain:"blitz-chat-d6dc9.firebaseapp.com",projectId:"blitz-chat-d6dc9",storageBucket:"blitz-chat-d6dc9.appspot.com",messagingSenderId:"909983333760",appId:"1:909983333760:web:be045f1d22c5d9378ed565",measurementId:"G-8VW8H07175"}),Re=(function(t=mt()){const e=ht(t=E(t),oe);e.isInitialized()?e.getImmediate():function(t,e={}){const n=ht(t,oe);if(n.isInitialized()){const t=n.getImmediate();if(g(e,n.getOptions()))return t;throw he.create("already-initialized")}n.initialize({options:e})}(t)}(Ne),document.getElementById("register-btn"),document.getElementById("login-btn"),document.getElementById("logout-btn")),Oe=document.getElementById("create-chat-btn"),xe=(document.getElementById("complete-create-chat-btn"),[...document.querySelectorAll(".back-btn")]),Me=[...document.querySelectorAll(".show-password-btn")],Le=document.getElementById("google-auth-btn"),Pe=document.getElementById("github-auth-btn"),Ue=document.getElementById("facebook-auth-btn"),Fe=document.getElementById("register-page"),Ve=document.getElementById("login-page"),Be=document.getElementById("chatrooms-page"),je=document.getElementById("chat-page"),qe=document.getElementById("create-chat-page"),ze=[Fe,Ve,Be,je,qe],$e=document.getElementById("register-form"),He=document.getElementById("register-form-err"),Ke=document.getElementById("register-name-err"),Ge=document.getElementById("register-email-err"),We=document.getElementById("register-password-err"),Qe=document.getElementById("login-link"),Xe=document.getElementById("login-form"),Ye=document.getElementById("login-form-err"),Je=document.getElementById("login-email-err"),Ze=document.getElementById("login-password-err"),tn=document.getElementById("register-link"),en=document.getElementById("create-chat-form"),nn=document.getElementById("create-chatroom-name-err"),rn=(document.getElementById("create-chatroom-description-err"),document.getElementById("create-chatroom-theme-err")),sn=document.getElementById("message-form"),on=document.getElementById("chatrooms-list"),an=document.getElementById("chatroom-active-users"),cn=document.getElementById("chatroom-name"),un=document.getElementById("messages-list"),hn=(document.getElementsByTagName("body"),t=>{null==t||t.classList.remove("page--hidden"),ze.map((e=>{e!==t&&(null==e||e.classList.add("page--hidden"))}))}),ln=t=>!(!t||t.length<4),dn=t=>!!t,fn=t=>!!t,pn=t=>!!t;var mn,gn="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t.g?t.g:"undefined"!=typeof self?self:{},yn={},vn=vn||{},_n=gn||self;function wn(){}function bn(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function Tn(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var In="closure_uid_"+(1e9*Math.random()>>>0),En=0;function Sn(t,e,n){return t.call.apply(t.bind,arguments)}function kn(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function Cn(t,e,n){return(Cn=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Sn:kn).apply(null,arguments)}function An(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function Dn(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Wb=function(t,n,i){for(var r=Array(arguments.length-2),s=2;s<arguments.length;s++)r[s-2]=arguments[s];return e.prototype[n].apply(t,r)}}function Nn(){this.s=this.s,this.o=this.o}Nn.prototype.s=!1,Nn.prototype.na=function(){var t;!this.s&&(this.s=!0,this.M(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,In)&&t[In]||(t[In]=++En))},Nn.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Rn=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function On(t){const e=t.length;if(0<e){const n=Array(e);for(let i=0;i<e;i++)n[i]=t[i];return n}return[]}function xn(t,e){for(let e=1;e<arguments.length;e++){const n=arguments[e];if(bn(n)){const e=t.length||0,i=n.length||0;t.length=e+i;for(let r=0;r<i;r++)t[e+r]=n[r]}else t.push(n)}}function Mn(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Mn.prototype.h=function(){this.defaultPrevented=!0};var Ln=function(){if(!_n.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{_n.addEventListener("test",wn,e),_n.removeEventListener("test",wn,e)}catch(t){}return t}();function Pn(t){return/^[\s\xa0]*$/.test(t)}var Un=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Fn(t,e){return t<e?-1:t>e?1:0}function Vn(){var t=_n.navigator;return t&&(t=t.userAgent)?t:""}function Bn(t){return-1!=Vn().indexOf(t)}function jn(t){return jn[" "](t),t}jn[" "]=wn;var qn,zn,$n=Bn("Opera"),Hn=Bn("Trident")||Bn("MSIE"),Kn=Bn("Edge"),Gn=Kn||Hn,Wn=Bn("Gecko")&&!(-1!=Vn().toLowerCase().indexOf("webkit")&&!Bn("Edge"))&&!(Bn("Trident")||Bn("MSIE"))&&!Bn("Edge"),Qn=-1!=Vn().toLowerCase().indexOf("webkit")&&!Bn("Edge");function Xn(){var t=_n.document;return t?t.documentMode:void 0}t:{var Yn="",Jn=(zn=Vn(),Wn?/rv:([^\);]+)(\)|;)/.exec(zn):Kn?/Edge\/([\d\.]+)/.exec(zn):Hn?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(zn):Qn?/WebKit\/(\S+)/.exec(zn):$n?/(?:Version)[ \/]?(\S+)/.exec(zn):void 0);if(Jn&&(Yn=Jn?Jn[1]:""),Hn){var Zn=Xn();if(null!=Zn&&Zn>parseFloat(Yn)){qn=String(Zn);break t}}qn=Yn}var ti,ei={};function ni(){return function(t){var e=ei;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=function(){let t=0;const e=Un(String(qn)).split("."),n=Un("9").split("."),i=Math.max(e.length,n.length);for(let o=0;0==t&&o<i;o++){var r=e[o]||"",s=n[o]||"";do{if(r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==r[0].length&&0==s[0].length)break;t=Fn(0==r[1].length?0:parseInt(r[1],10),0==s[1].length?0:parseInt(s[1],10))||Fn(0==r[2].length,0==s[2].length)||Fn(r[2],s[2]),r=r[3],s=s[3]}while(0==t)}return 0<=t}()}()}_n.document&&Hn?ti=Xn()||parseInt(qn,10)||void 0:ti=void 0;var ii=ti;function ri(t,e){if(Mn.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(Wn){t:{try{jn(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:si[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&ri.X.h.call(this)}}Dn(ri,Mn);var si={2:"touch",3:"pen",4:"mouse"};ri.prototype.h=function(){ri.X.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var oi="closure_listenable_"+(1e6*Math.random()|0),ai=0;function ci(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.ha=r,this.key=++ai,this.ba=this.ea=!1}function ui(t){t.ba=!0,t.listener=null,t.proxy=null,t.src=null,t.ha=null}function hi(t,e,n){for(const i in t)e.call(n,t[i],i,t)}function li(t){const e={};for(const n in t)e[n]=t[n];return e}const di="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function fi(t,e){let n,i;for(let e=1;e<arguments.length;e++){for(n in i=arguments[e],i)t[n]=i[n];for(let e=0;e<di.length;e++)n=di[e],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function pi(t){this.src=t,this.g={},this.h=0}function mi(t,e){var n=e.type;if(n in t.g){var i,r=t.g[n],s=Rn(r,e);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(ui(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function gi(t,e,n,i){for(var r=0;r<t.length;++r){var s=t[r];if(!s.ba&&s.listener==e&&s.capture==!!n&&s.ha==i)return r}return-1}pi.prototype.add=function(t,e,n,i,r){var s=t.toString();(t=this.g[s])||(t=this.g[s]=[],this.h++);var o=gi(t,e,i,r);return-1<o?(e=t[o],n||(e.ea=!1)):((e=new ci(e,this.src,s,!!i,r)).ea=n,t.push(e)),e};var yi="closure_lm_"+(1e6*Math.random()|0),vi={};function _i(t,e,n,i,r){if(i&&i.once)return bi(t,e,n,i,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)_i(t,e[s],n,i,r);return null}return n=Ai(n),t&&t[oi]?t.N(e,n,Tn(i)?!!i.capture:!!i,r):wi(t,e,n,!1,i,r)}function wi(t,e,n,i,r,s){if(!e)throw Error("Invalid event type");var o=Tn(r)?!!r.capture:!!r,a=ki(t);if(a||(t[yi]=a=new pi(t)),(n=a.add(e,n,i,o,s)).proxy)return n;if(i=function(){const t=Si;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)Ln||(r=o),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(Ei(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function bi(t,e,n,i,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)bi(t,e[s],n,i,r);return null}return n=Ai(n),t&&t[oi]?t.O(e,n,Tn(i)?!!i.capture:!!i,r):wi(t,e,n,!0,i,r)}function Ti(t,e,n,i,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)Ti(t,e[s],n,i,r);else i=Tn(i)?!!i.capture:!!i,n=Ai(n),t&&t[oi]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=gi(s=t.g[e],n,i,r))&&(ui(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete t.g[e],t.h--))):t&&(t=ki(t))&&(e=t.g[e.toString()],t=-1,e&&(t=gi(e,n,i,r)),(n=-1<t?e[t]:null)&&Ii(n))}function Ii(t){if("number"!=typeof t&&t&&!t.ba){var e=t.src;if(e&&e[oi])mi(e.i,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(Ei(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=ki(e))?(mi(n,t),0==n.h&&(n.src=null,e[yi]=null)):ui(t)}}}function Ei(t){return t in vi?vi[t]:vi[t]="on"+t}function Si(t,e){if(t.ba)t=!0;else{e=new ri(e,this);var n=t.listener,i=t.ha||t.src;t.ea&&Ii(t),t=n.call(i,e)}return t}function ki(t){return(t=t[yi])instanceof pi?t:null}var Ci="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ai(t){return"function"==typeof t?t:(t[Ci]||(t[Ci]=function(e){return t.handleEvent(e)}),t[Ci])}function Di(){Nn.call(this),this.i=new pi(this),this.P=this,this.I=null}function Ni(t,e){var n,i=t.I;if(i)for(n=[];i;i=i.I)n.push(i);if(t=t.P,i=e.type||e,"string"==typeof e)e=new Mn(e,t);else if(e instanceof Mn)e.target=e.target||t;else{var r=e;fi(e=new Mn(i,t),r)}if(r=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];r=Ri(o,i,!0,e)&&r}if(r=Ri(o=e.g=t,i,!0,e)&&r,r=Ri(o,i,!1,e)&&r,n)for(s=0;s<n.length;s++)r=Ri(o=e.g=n[s],i,!1,e)&&r}function Ri(t,e,n,i){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.ba&&o.capture==n){var a=o.listener,c=o.ha||o.src;o.ea&&mi(t.i,o),r=!1!==a.call(c,i)&&r}}return r&&!i.defaultPrevented}Dn(Di,Nn),Di.prototype[oi]=!0,Di.prototype.removeEventListener=function(t,e,n,i){Ti(this,t,e,n,i)},Di.prototype.M=function(){if(Di.X.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],i=0;i<n.length;i++)ui(n[i]);delete e.g[t],e.h--}}this.I=null},Di.prototype.N=function(t,e,n,i){return this.i.add(String(t),e,!1,n,i)},Di.prototype.O=function(t,e,n,i){return this.i.add(String(t),e,!0,n,i)};var Oi=_n.JSON.stringify;function xi(){var t=Bi;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Mi,Li=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}((()=>new Pi),(t=>t.reset()));class Pi{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function Ui(t){_n.setTimeout((()=>{throw t}),0)}function Fi(t,e){Mi||function(){var t=_n.Promise.resolve(void 0);Mi=function(){t.then(ji)}}(),Vi||(Mi(),Vi=!0),Bi.add(t,e)}var Vi=!1,Bi=new class{constructor(){this.h=this.g=null}add(t,e){const n=Li.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}};function ji(){for(var t;t=xi();){try{t.h.call(t.g)}catch(t){Ui(t)}var e=Li;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Vi=!1}function qi(t,e){Di.call(this),this.h=t||1,this.g=e||_n,this.j=Cn(this.lb,this),this.l=Date.now()}function zi(t){t.ca=!1,t.R&&(t.g.clearTimeout(t.R),t.R=null)}function $i(t,e,n){if("function"==typeof t)n&&(t=Cn(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=Cn(t.handleEvent,t)}return 2147483647<Number(e)?-1:_n.setTimeout(t,e||0)}function Hi(t){t.g=$i((()=>{t.g=null,t.i&&(t.i=!1,Hi(t))}),t.j);const e=t.h;t.h=null,t.m.apply(null,e)}Dn(qi,Di),(mn=qi.prototype).ca=!1,mn.R=null,mn.lb=function(){if(this.ca){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-t):(this.R&&(this.g.clearTimeout(this.R),this.R=null),Ni(this,"tick"),this.ca&&(zi(this),this.start()))}},mn.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},mn.M=function(){qi.X.M.call(this),zi(this),delete this.g};class Ki extends Nn{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:Hi(this)}M(){super.M(),this.g&&(_n.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Gi(t){Nn.call(this),this.h=t,this.g={}}Dn(Gi,Nn);var Wi=[];function Qi(t,e,n,i){Array.isArray(n)||(n&&(Wi[0]=n.toString()),n=Wi);for(var r=0;r<n.length;r++){var s=_i(e,n[r],i||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function Xi(t){hi(t.g,(function(t,e){this.g.hasOwnProperty(e)&&Ii(t)}),t),t.g={}}function Yi(){this.g=!0}function Ji(t,e,n,i){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<r.length;o++)r[o]=""}}}return Oi(n)}catch(t){return e}}(t,n)+(i?" "+i:"")}))}Gi.prototype.M=function(){Gi.X.M.call(this),Xi(this)},Gi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Yi.prototype.Aa=function(){this.g=!1},Yi.prototype.info=function(){};var Zi={},tr=null;function er(){return tr=tr||new Di}function nr(t){Mn.call(this,Zi.Pa,t)}function ir(t){const e=er();Ni(e,new nr(e))}function rr(t,e){Mn.call(this,Zi.STAT_EVENT,t),this.stat=e}function sr(t){const e=er();Ni(e,new rr(e,t))}function or(t,e){Mn.call(this,Zi.Qa,t),this.size=e}function ar(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return _n.setTimeout((function(){t()}),e)}Zi.Pa="serverreachability",Dn(nr,Mn),Zi.STAT_EVENT="statevent",Dn(rr,Mn),Zi.Qa="timingevent",Dn(or,Mn);var cr={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},ur={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function hr(){}function lr(t){return t.h||(t.h=t.i())}function dr(){}hr.prototype.h=null;var fr,pr={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function mr(){Mn.call(this,"d")}function gr(){Mn.call(this,"c")}function yr(){}function vr(t,e,n,i){this.l=t,this.j=e,this.m=n,this.U=i||1,this.S=new Gi(this),this.O=wr,t=Gn?125:void 0,this.T=new qi(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new _r}function _r(){this.i=null,this.g="",this.h=!1}Dn(mr,Mn),Dn(gr,Mn),Dn(yr,hr),yr.prototype.g=function(){return new XMLHttpRequest},yr.prototype.i=function(){return{}},fr=new yr;var wr=45e3,br={},Tr={};function Ir(t,e,n){t.K=1,t.v=qr(Ur(e)),t.s=n,t.P=!0,Er(t,null)}function Er(t,e){t.F=Date.now(),Ar(t),t.A=Ur(t.v);var n=t.A,i=t.U;Array.isArray(i)||(i=[String(i)]),es(n.i,"t",i),t.C=0,n=t.l.H,t.h=new _r,t.g=to(t.l,n?e:null,!t.s),0<t.N&&(t.L=new Ki(Cn(t.La,t,t.g),t.N)),Qi(t.S,t.g,"readystatechange",t.ib),e=t.H?li(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.da(t.A,t.u,t.s,e)):(t.u="GET",t.g.da(t.A,t.u,null,e)),ir(),function(t,e,n,i,r,s){t.info((function(){if(t.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var h=u[0];u=u[1];var l=h.split("_");o=2<=l.length&&"type"==l[1]?o+(h+"=")+u+"&":o+(h+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+e+"\n"+n+"\n"+o}))}(t.j,t.u,t.A,t.m,t.U,t.s)}function Sr(t){return!!t.g&&"GET"==t.u&&2!=t.K&&t.l.Da}function kr(t,e,n){let i,r=!0;for(;!t.I&&t.C<n.length;){if(i=Cr(t,n),i==Tr){4==e&&(t.o=4,sr(14),r=!1),Ji(t.j,t.m,null,"[Incomplete Response]");break}if(i==br){t.o=4,sr(15),Ji(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}Ji(t.j,t.m,i,null),xr(t,i)}Sr(t)&&i!=Tr&&i!=br&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,sr(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.$&&(t.$=!0,(e=t.l).g==t&&e.$&&!e.K&&(e.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),Ks(e),e.K=!0,sr(11))):(Ji(t.j,t.m,n,"[Invalid Chunked Response]"),Or(t),Rr(t))}function Cr(t,e){var n=t.C,i=e.indexOf("\n",n);return-1==i?Tr:(n=Number(e.substring(n,i)),isNaN(n)?br:(i+=1)+n>e.length?Tr:(e=e.substr(i,n),t.C=i+n,e))}function Ar(t){t.V=Date.now()+t.O,Dr(t,t.O)}function Dr(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=ar(Cn(t.gb,t),e)}function Nr(t){t.B&&(_n.clearTimeout(t.B),t.B=null)}function Rr(t){0==t.l.G||t.I||Qs(t.l,t)}function Or(t){Nr(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,zi(t.T),Xi(t.S),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function xr(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||as(n.h,t)))if(!t.J&&as(n.h,t)&&3==n.G){try{var i=n.Fa.g.parse(e)}catch(t){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;Ws(n),Fs(n)}Hs(n),sr(18)}}else n.Ba=r[1],0<n.Ba-n.T&&37500>r[2]&&n.L&&0==n.A&&!n.v&&(n.v=ar(Cn(n.cb,n),6e3));if(1>=os(n.h)&&n.ja){try{n.ja()}catch(t){}n.ja=void 0}}else Ys(n,11)}else if((t.J||n.g==t)&&Ws(n),!Pn(e))for(r=n.Fa.g.parse(e),e=0;e<r.length;e++){let u=r[e];if(n.T=u[0],u=u[1],2==n.G)if("c"==u[0]){n.I=u[1],n.ka=u[2];const e=u[3];null!=e&&(n.ma=e,n.j.info("VER="+n.ma));const r=u[4];null!=r&&(n.Ca=r,n.j.info("SVER="+n.Ca));const h=u[5];null!=h&&"number"==typeof h&&0<h&&(i=1.5*h,n.J=i,n.j.info("backChannelRequestTimeoutMs_="+i)),i=n;const l=t.g;if(l){const t=l.g?l.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var s=i.h;s.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(cs(s,s.h),s.h=null))}if(i.D){const t=l.g?l.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(i.za=t,jr(i.F,i.D,t))}}n.G=3,n.l&&n.l.xa(),n.$&&(n.P=Date.now()-t.F,n.j.info("Handshake RTT: "+n.P+"ms"));var o=t;if((i=n).sa=Zs(i,i.H?i.ka:null,i.V),o.J){us(i.h,o);var a=o,c=i.J;c&&a.setTimeout(c),a.B&&(Nr(a),Ar(a)),i.g=o}else $s(i);0<n.i.length&&Bs(n)}else"stop"!=u[0]&&"close"!=u[0]||Ys(n,7);else 3==n.G&&("stop"==u[0]||"close"==u[0]?"stop"==u[0]?Ys(n,7):Us(n):"noop"!=u[0]&&n.l&&n.l.wa(u),n.A=0)}ir()}catch(t){}}function Mr(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(bn(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function(t){if(t.oa&&"function"==typeof t.oa)return t.oa();if(!t.W||"function"!=typeof t.W){if("undefined"!=typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!=typeof Set&&t instanceof Set)){if(bn(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const i in t)e[n++]=i;return e}}}(t),i=function(t){if(t.W&&"function"==typeof t.W)return t.W();if("undefined"!=typeof Map&&t instanceof Map||"undefined"!=typeof Set&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(bn(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t),r=i.length,s=0;s<r;s++)e.call(void 0,i[s],n&&n[s],t)}(mn=vr.prototype).setTimeout=function(t){this.O=t},mn.ib=function(t){t=t.target;const e=this.L;e&&3==Rs(t)?e.l():this.La(t)},mn.La=function(t){try{if(t==this.g)t:{const h=Rs(this.g);var e=this.g.Ea();if(this.g.aa(),!(3>h)&&(3!=h||Gn||this.g&&(this.h.h||this.g.fa()||Os(this.g)))){this.I||4!=h||7==e||ir(),Nr(this);var n=this.g.aa();this.Y=n;e:if(Sr(this)){var i=Os(this.g);t="";var r=i.length,s=4==Rs(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Or(this),Rr(this);var o="";break e}this.h.i=new _n.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,t+=this.h.i.decode(i[e],{stream:s&&e==r-1});i.splice(0,r),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.fa();if(this.i=200==n,function(t,e,n,i,r,s,o){t.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+e+"\n"+n+"\n"+s+" "+o}))}(this.j,this.u,this.A,this.m,this.U,h,n),this.i){if(this.Z&&!this.J){e:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Pn(a)){var u=a;break e}}u=null}if(!(n=u)){this.i=!1,this.o=3,sr(12),Or(this),Rr(this);break t}Ji(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,xr(this,n)}this.P?(kr(this,h,o),Gn&&this.i&&3==h&&(Qi(this.S,this.T,"tick",this.hb),this.T.start())):(Ji(this.j,this.m,o,null),xr(this,o)),4==h&&Or(this),this.i&&!this.I&&(4==h?Qs(this.l,this):(this.i=!1,Ar(this)))}else 400==n&&0<o.indexOf("Unknown SID")?(this.o=3,sr(12)):(this.o=0,sr(13)),Or(this),Rr(this)}}}catch(t){}},mn.hb=function(){if(this.g){var t=Rs(this.g),e=this.g.fa();this.C<e.length&&(Nr(this),kr(this,t,e),this.i&&4!=t&&Ar(this))}},mn.cancel=function(){this.I=!0,Or(this)},mn.gb=function(){this.B=null;const t=Date.now();0<=t-this.V?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.K&&(ir(),sr(17)),Or(this),this.o=2,Rr(this)):Dr(this,this.V-t)};var Lr=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Pr(t,e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Pr){this.h=void 0!==e?e:t.h,Fr(this,t.j),this.s=t.s,this.g=t.g,Vr(this,t.m),this.l=t.l,e=t.i;var n=new Yr;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),Br(this,n),this.o=t.o}else t&&(n=String(t).match(Lr))?(this.h=!!e,Fr(this,n[1]||"",!0),this.s=zr(n[2]||""),this.g=zr(n[3]||"",!0),Vr(this,n[4]),this.l=zr(n[5]||"",!0),Br(this,n[6]||"",!0),this.o=zr(n[7]||"")):(this.h=!!e,this.i=new Yr(null,this.h))}function Ur(t){return new Pr(t)}function Fr(t,e,n){t.j=n?zr(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Vr(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Br(t,e,n){e instanceof Yr?(t.i=e,function(t,e){e&&!t.j&&(Jr(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Zr(this,e),es(this,n,t))}),t)),t.j=e}(t.i,t.h)):(n||(e=$r(e,Qr)),t.i=new Yr(e,t.h))}function jr(t,e,n){t.i.set(e,n)}function qr(t){return jr(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function zr(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function $r(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Hr),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Hr(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Pr.prototype.toString=function(){var t=[],e=this.j;e&&t.push($r(e,Kr,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push($r(e,Kr,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push($r(n,"/"==n.charAt(0)?Wr:Gr,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",$r(n,Xr)),t.join("")};var Kr=/[#\/\?@]/g,Gr=/[#\?:]/g,Wr=/[#\?]/g,Qr=/[#\?@]/g,Xr=/#/g;function Yr(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Jr(t){t.g||(t.g=new Map,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var s=t[n].substring(0,i);r=t[n].substring(i+1)}else s=t[n];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Zr(t,e){Jr(t),e=ns(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function ts(t,e){return Jr(t),e=ns(t,e),t.g.has(e)}function es(t,e,n){Zr(t,e),0<n.length&&(t.i=null,t.g.set(ns(t,e),On(n)),t.h+=n.length)}function ns(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function is(t){this.l=t||rs,t=_n.PerformanceNavigationTiming?0<(t=_n.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(_n.g&&_n.g.Ga&&_n.g.Ga()&&_n.g.Ga().$b),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(mn=Yr.prototype).add=function(t,e){Jr(this),this.i=null,t=ns(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},mn.forEach=function(t,e){Jr(this),this.g.forEach((function(n,i){n.forEach((function(n){t.call(e,n,i,this)}),this)}),this)},mn.oa=function(){Jr(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let i=0;i<e.length;i++){const r=t[i];for(let t=0;t<r.length;t++)n.push(e[i])}return n},mn.W=function(t){Jr(this);let e=[];if("string"==typeof t)ts(this,t)&&(e=e.concat(this.g.get(ns(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},mn.set=function(t,e){return Jr(this),this.i=null,ts(this,t=ns(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},mn.get=function(t,e){return t&&0<(t=this.W(t)).length?String(t[0]):e},mn.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var i=e[n];const s=encodeURIComponent(String(i)),o=this.W(i);for(i=0;i<o.length;i++){var r=s;""!==o[i]&&(r+="="+encodeURIComponent(String(o[i]))),t.push(r)}}return this.i=t.join("&")};var rs=10;function ss(t){return!!t.h||!!t.g&&t.g.size>=t.j}function os(t){return t.h?1:t.g?t.g.size:0}function as(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function cs(t,e){t.g?t.g.add(e):t.h=e}function us(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function hs(t){if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return On(t.i)}function ls(){}function ds(){this.g=new ls}function fs(t,e,n){const i=n||"";try{Mr(t,(function(t,n){let r=t;Tn(t)&&(r=Oi(t)),e.push(i+n+"="+encodeURIComponent(r))}))}catch(t){throw e.push(i+"type="+encodeURIComponent("_badmap")),t}}function ps(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}function ms(t){this.l=t.ac||null,this.j=t.jb||!1}function gs(t,e){Di.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=ys,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}is.prototype.cancel=function(){if(this.i=hs(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}},ls.prototype.stringify=function(t){return _n.JSON.stringify(t,void 0)},ls.prototype.parse=function(t){return _n.JSON.parse(t,void 0)},Dn(ms,hr),ms.prototype.g=function(){return new gs(this.l,this.j)},ms.prototype.i=function(t){return function(){return t}}({}),Dn(gs,Di);var ys=0;function vs(t){t.j.read().then(t.Ta.bind(t)).catch(t.ga.bind(t))}function _s(t){t.readyState=4,t.l=null,t.j=null,t.A=null,ws(t)}function ws(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(mn=gs.prototype).open=function(t,e){if(this.readyState!=ys)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,ws(this)},mn.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||_n).fetch(new Request(this.B,e)).then(this.Wa.bind(this),this.ga.bind(this))},mn.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,_s(this)),this.readyState=ys},mn.Wa=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,ws(this)),this.g&&(this.readyState=3,ws(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(void 0!==_n.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;vs(this)}else t.text().then(this.Va.bind(this),this.ga.bind(this))},mn.Ta=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?_s(this):ws(this),3==this.readyState&&vs(this)}},mn.Va=function(t){this.g&&(this.response=this.responseText=t,_s(this))},mn.Ua=function(t){this.g&&(this.response=t,_s(this))},mn.ga=function(){this.g&&_s(this)},mn.setRequestHeader=function(t,e){this.v.append(t,e)},mn.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},mn.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(gs.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var bs=_n.JSON.parse;function Ts(t){Di.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Is,this.K=this.L=!1}Dn(Ts,Di);var Is="",Es=/^https?$/i,Ss=["POST","PUT"];function ks(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Cs(t),Ds(t)}function Cs(t){t.D||(t.D=!0,Ni(t,"complete"),Ni(t,"error"))}function As(t){if(t.h&&void 0!==vn&&(!t.C[1]||4!=Rs(t)||2!=t.aa()))if(t.v&&4==Rs(t))$i(t.Ha,0,t);else if(Ni(t,"readystatechange"),4==Rs(t)){t.h=!1;try{const a=t.aa();t:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var i;if(i=0===a){var r=String(t.H).match(Lr)[1]||null;if(!r&&_n.self&&_n.self.location){var s=_n.self.location.protocol;r=s.substr(0,s.length-1)}i=!Es.test(r?r.toLowerCase():"")}n=i}if(n)Ni(t,"complete"),Ni(t,"success");else{t.m=6;try{var o=2<Rs(t)?t.g.statusText:""}catch(t){o=""}t.j=o+" ["+t.aa()+"]",Cs(t)}}finally{Ds(t)}}}function Ds(t,e){if(t.g){Ns(t);const n=t.g,i=t.C[0]?wn:null;t.g=null,t.C=null,e||Ni(t,"ready");try{n.onreadystatechange=i}catch(t){}}}function Ns(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(_n.clearTimeout(t.A),t.A=null)}function Rs(t){return t.g?t.g.readyState:0}function Os(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case Is:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function xs(t){let e="";return hi(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}function Ms(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}i||(n=xs(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):jr(t,e,n))}function Ls(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Ps(t){this.Ca=0,this.i=[],this.j=new Yi,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=Ls("failFast",!1,t),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=Ls("baseRetryDelayMs",5e3,t),this.bb=Ls("retryDelaySeedMs",1e4,t),this.$a=Ls("forwardChannelMaxRetries",2,t),this.ta=Ls("forwardChannelRequestTimeoutMs",2e4,t),this.ra=t&&t.xmlHttpFactory||void 0,this.Da=t&&t.Zb||!1,this.J=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.I="",this.h=new is(t&&t.concurrentRequestLimit),this.Fa=new ds,this.O=t&&t.fastHandshake||!1,this.N=t&&t.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=t&&t.Xb||!1,t&&t.Aa&&this.j.Aa(),t&&t.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&t&&t.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function Us(t){if(Vs(t),3==t.G){var e=t.U++,n=Ur(t.F);jr(n,"SID",t.I),jr(n,"RID",e),jr(n,"TYPE","terminate"),qs(t,n),(e=new vr(t,t.j,e,void 0)).K=2,e.v=qr(Ur(n)),n=!1,_n.navigator&&_n.navigator.sendBeacon&&(n=_n.navigator.sendBeacon(e.v.toString(),"")),!n&&_n.Image&&((new Image).src=e.v,n=!0),n||(e.g=to(e.l,null),e.g.da(e.v)),e.F=Date.now(),Ar(e)}Js(t)}function Fs(t){t.g&&(Ks(t),t.g.cancel(),t.g=null)}function Vs(t){Fs(t),t.u&&(_n.clearTimeout(t.u),t.u=null),Ws(t),t.h.cancel(),t.m&&("number"==typeof t.m&&_n.clearTimeout(t.m),t.m=null)}function Bs(t){ss(t.h)||t.m||(t.m=!0,Fi(t.Ja,t),t.C=0)}function js(t,e){var n;n=e?e.m:t.U++;const i=Ur(t.F);jr(i,"SID",t.I),jr(i,"RID",n),jr(i,"AID",t.T),qs(t,i),t.o&&t.s&&Ms(i,t.o,t.s),n=new vr(t,t.j,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.i=e.D.concat(t.i)),e=zs(t,n,1e3),n.setTimeout(Math.round(.5*t.ta)+Math.round(.5*t.ta*Math.random())),cs(t.h,n),Ir(n,i,e)}function qs(t,e){t.ia&&hi(t.ia,(function(t,n){jr(e,n,t)})),t.l&&Mr({},(function(t,n){jr(e,n,t)}))}function zs(t,e,n){n=Math.min(t.i.length,n);var i=t.l?Cn(t.l.Ra,t.l,t):null;t:{var r=t.i;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=r[0].h,t.push("ofs="+e)):e=0:t.push("ofs="+e);let s=!0;for(let o=0;o<n;o++){let n=r[o].h;const a=r[o].g;if(n-=e,0>n)e=Math.max(0,r[o].h-100),s=!1;else try{fs(a,t,"req"+n+"_")}catch(t){i&&i(a)}}if(s){i=t.join("&");break t}}}return t=t.i.splice(0,n),e.D=t,i}function $s(t){t.g||t.u||(t.Z=1,Fi(t.Ia,t),t.A=0)}function Hs(t){return!(t.g||t.u||3<=t.A||(t.Z++,t.u=ar(Cn(t.Ia,t),Xs(t,t.A)),t.A++,0))}function Ks(t){null!=t.B&&(_n.clearTimeout(t.B),t.B=null)}function Gs(t){t.g=new vr(t,t.j,"rpc",t.Z),null===t.o&&(t.g.H=t.s),t.g.N=0;var e=Ur(t.sa);jr(e,"RID","rpc"),jr(e,"SID",t.I),jr(e,"CI",t.L?"0":"1"),jr(e,"AID",t.T),jr(e,"TYPE","xmlhttp"),qs(t,e),t.o&&t.s&&Ms(e,t.o,t.s),t.J&&t.g.setTimeout(t.J);var n=t.g;t=t.ka,n.K=1,n.v=qr(Ur(e)),n.s=null,n.P=!0,Er(n,t)}function Ws(t){null!=t.v&&(_n.clearTimeout(t.v),t.v=null)}function Qs(t,e){var n=null;if(t.g==e){Ws(t),Ks(t),t.g=null;var i=2}else{if(!as(t.h,e))return;n=e.D,us(t.h,e),i=1}if(0!=t.G)if(t.pa=e.Y,e.i)if(1==i){n=e.s?e.s.length:0,e=Date.now()-e.F;var r=t.C;Ni(i=er(),new or(i,n)),Bs(t)}else $s(t);else if(3==(r=e.o)||0==r&&0<t.pa||!(1==i&&function(t,e){return!(os(t.h)>=t.h.j-(t.m?1:0)||(t.m?(t.i=e.D.concat(t.i),0):1==t.G||2==t.G||t.C>=(t.Za?0:t.$a)||(t.m=ar(Cn(t.Ja,t,e),Xs(t,t.C)),t.C++,0)))}(t,e)||2==i&&Hs(t)))switch(n&&0<n.length&&(e=t.h,e.i=e.i.concat(n)),r){case 1:Ys(t,5);break;case 4:Ys(t,10);break;case 3:Ys(t,6);break;default:Ys(t,2)}}function Xs(t,e){let n=t.Xa+Math.floor(Math.random()*t.bb);return t.l||(n*=2),n*e}function Ys(t,e){if(t.j.info("Error code "+e),2==e){var n=null;t.l&&(n=null);var i=Cn(t.kb,t);n||(n=new Pr("//www.google.com/images/cleardot.gif"),_n.location&&"http"==_n.location.protocol||Fr(n,"https"),qr(n)),function(t,e){const n=new Yi;if(_n.Image){const i=new Image;i.onload=An(ps,n,i,"TestLoadImage: loaded",!0,e),i.onerror=An(ps,n,i,"TestLoadImage: error",!1,e),i.onabort=An(ps,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=An(ps,n,i,"TestLoadImage: timeout",!1,e),_n.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=t}else e(!1)}(n.toString(),i)}else sr(2);t.G=0,t.l&&t.l.va(e),Js(t),Vs(t)}function Js(t){if(t.G=0,t.la=[],t.l){const e=hs(t.h);0==e.length&&0==t.i.length||(xn(t.la,e),xn(t.la,t.i),t.h.i.length=0,On(t.i),t.i.length=0),t.l.ua()}}function Zs(t,e,n){var i=n instanceof Pr?Ur(n):new Pr(n,void 0);if(""!=i.g)e&&(i.g=e+"."+i.g),Vr(i,i.m);else{var r=_n.location;i=r.protocol,e=e?e+"."+r.hostname:r.hostname,r=+r.port;var s=new Pr(null,void 0);i&&Fr(s,i),e&&(s.g=e),r&&Vr(s,r),n&&(s.l=n),i=s}return n=t.D,e=t.za,n&&e&&jr(i,n,e),jr(i,"VER",t.ma),qs(t,i),i}function to(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Da&&!t.ra?new Ts(new ms({jb:!0})):new Ts(t.ra)).Ka(t.H),e}function eo(){}function no(){if(Hn&&!(10<=Number(ii)))throw Error("Environmental error: no available transport.")}function io(t,e){Di.call(this),this.g=new Ps(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.S=t,(t=e&&e.Yb)&&!Pn(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Pn(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new oo(this)}function ro(t){mr.call(this);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function so(){gr.call(this),this.status=1}function oo(t){this.g=t}(mn=Ts.prototype).Ka=function(t){this.L=t},mn.da=function(t,e,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():fr.g(),this.C=this.u?lr(this.u):lr(fr),this.g.onreadystatechange=Cn(this.Ha,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(t){return void ks(this,t)}if(t=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var r in i)n.set(r,i[r]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const t of i.keys())n.set(t,i.get(t))}i=Array.from(n.keys()).find((t=>"content-type"==t.toLowerCase())),r=_n.FormData&&t instanceof _n.FormData,!(0<=Rn(Ss,e))||i||r||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[t,e]of n)this.g.setRequestHeader(t,e);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Ns(this),0<this.B&&((this.K=function(t){return Hn&&ni()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Cn(this.qa,this)):this.A=$i(this.qa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){ks(this,t)}},mn.qa=function(){void 0!==vn&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Ni(this,"timeout"),this.abort(8))},mn.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Ni(this,"complete"),Ni(this,"abort"),Ds(this))},mn.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Ds(this,!0)),Ts.X.M.call(this)},mn.Ha=function(){this.s||(this.F||this.v||this.l?As(this):this.fb())},mn.fb=function(){As(this)},mn.aa=function(){try{return 2<Rs(this)?this.g.status:-1}catch(t){return-1}},mn.fa=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},mn.Sa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),bs(e)}},mn.Ea=function(){return this.m},mn.Oa=function(){return"string"==typeof this.j?this.j:String(this.j)},(mn=Ps.prototype).ma=8,mn.G=1,mn.Ja=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.U=Math.floor(1e5*Math.random()),t=this.U++;const r=new vr(this,this.j,t,void 0);let s=this.s;if(this.S&&(s?(s=li(s),fi(s,this.S)):s=this.S),null!==this.o||this.N||(r.H=s,s=null),this.O)t:{for(var e=0,n=0;n<this.i.length;n++){var i=this.i[n];if(void 0===(i="__data__"in i.g&&"string"==typeof(i=i.g.__data__)?i.length:void 0))break;if(4096<(e+=i)){e=n;break t}if(4096===e||n===this.i.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=zs(this,r,e),jr(n=Ur(this.F),"RID",t),jr(n,"CVER",22),this.D&&jr(n,"X-HTTP-Session-Id",this.D),qs(this,n),s&&(this.N?e="headers="+encodeURIComponent(String(xs(s)))+"&"+e:this.o&&Ms(n,this.o,s)),cs(this.h,r),this.Ya&&jr(n,"TYPE","init"),this.O?(jr(n,"$req",e),jr(n,"SID","null"),r.Z=!0,Ir(r,n,null)):Ir(r,n,e),this.G=2}}else 3==this.G&&(t?js(this,t):0==this.i.length||ss(this.h)||js(this))},mn.Ia=function(){if(this.u=null,Gs(this),this.$&&!(this.K||null==this.g||0>=this.P)){var t=2*this.P;this.j.info("BP detection timer enabled: "+t),this.B=ar(Cn(this.eb,this),t)}},mn.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,sr(10),Fs(this),Gs(this))},mn.cb=function(){null!=this.v&&(this.v=null,Fs(this),Hs(this),sr(19))},mn.kb=function(t){t?(this.j.info("Successfully pinged google.com"),sr(2)):(this.j.info("Failed to ping google.com"),sr(1))},(mn=eo.prototype).xa=function(){},mn.wa=function(){},mn.va=function(){},mn.ua=function(){},mn.Ra=function(){},no.prototype.g=function(t,e){return new io(t,e)},Dn(io,Di),io.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;sr(0),t.V=e,t.ia=n||{},t.L=t.Y,t.F=Zs(t,null,t.V),Bs(t)},io.prototype.close=function(){Us(this.g)},io.prototype.u=function(t){var e=this.g;if("string"==typeof t){var n={};n.__data__=t,t=n}else this.v&&((n={}).__data__=Oi(t),t=n);e.i.push(new class{constructor(t,e){this.h=t,this.g=e}}(e.ab++,t)),3==e.G&&Bs(e)},io.prototype.M=function(){this.g.l=null,delete this.j,Us(this.g),delete this.g,io.X.M.call(this)},Dn(ro,mr),Dn(so,gr),Dn(oo,eo),oo.prototype.xa=function(){Ni(this.g,"a")},oo.prototype.wa=function(t){Ni(this.g,new ro(t))},oo.prototype.va=function(t){Ni(this.g,new so)},oo.prototype.ua=function(){Ni(this.g,"b")},no.prototype.createWebChannel=no.prototype.g,io.prototype.send=io.prototype.u,io.prototype.open=io.prototype.m,io.prototype.close=io.prototype.close,cr.NO_ERROR=0,cr.TIMEOUT=8,cr.HTTP_ERROR=6,ur.COMPLETE="complete",dr.EventType=pr,pr.OPEN="a",pr.CLOSE="b",pr.ERROR="c",pr.MESSAGE="d",Di.prototype.listen=Di.prototype.N,Ts.prototype.listenOnce=Ts.prototype.O,Ts.prototype.getLastError=Ts.prototype.Oa,Ts.prototype.getLastErrorCode=Ts.prototype.Ea,Ts.prototype.getStatus=Ts.prototype.aa,Ts.prototype.getResponseJson=Ts.prototype.Sa,Ts.prototype.getResponseText=Ts.prototype.fa,Ts.prototype.send=Ts.prototype.da,Ts.prototype.setWithCredentials=Ts.prototype.Ka;var ao=yn.createWebChannelTransport=function(){return new no},co=yn.getStatEventTarget=function(){return er()},uo=yn.ErrorCode=cr,ho=yn.EventType=ur,lo=yn.Event=Zi,fo=yn.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},po=yn.FetchXmlHttpFactory=ms,mo=yn.WebChannel=dr,go=yn.XhrIo=Ts;const yo="@firebase/firestore";class vo{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}vo.UNAUTHENTICATED=new vo(null),vo.GOOGLE_CREDENTIALS=new vo("google-credentials-uid"),vo.FIRST_PARTY=new vo("first-party-uid"),vo.MOCK_USER=new vo("mock-user");let _o="9.14.0";const wo=new P("@firebase/firestore");function bo(){return wo.logLevel}function To(t,...e){if(wo.logLevel<=N.DEBUG){const n=e.map(So);wo.debug(`Firestore (${_o}): ${t}`,...n)}}function Io(t,...e){if(wo.logLevel<=N.ERROR){const n=e.map(So);wo.error(`Firestore (${_o}): ${t}`,...n)}}function Eo(t,...e){if(wo.logLevel<=N.WARN){const n=e.map(So);wo.warn(`Firestore (${_o}): ${t}`,...n)}}function So(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function ko(t="Unexpected state"){const e=`FIRESTORE (${_o}) INTERNAL ASSERTION FAILED: `+t;throw Io(e),new Error(e)}function Co(t,e){t||ko()}function Ao(t,e){return t}const Do={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class No extends f{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ro{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class Oo{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class xo{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(vo.UNAUTHENTICATED)))}shutdown(){}}class Mo{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class Lo{constructor(t){this.t=t,this.currentUser=vo.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let n=this.i;const i=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let r=new Ro;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new Ro,t.enqueueRetryable((()=>i(this.currentUser)))};const s=()=>{const e=r;t.enqueueRetryable((async()=>{await e.promise,await i(this.currentUser)}))},o=t=>{To("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((t=>o(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?o(t):(To("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new Ro)}}),0),s()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?(To("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(Co("string"==typeof e.accessToken),new Oo(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return Co(null===t||"string"==typeof t),new vo(t)}}class Po{constructor(t,e,n,i){this.h=t,this.l=e,this.m=n,this.g=i,this.type="FirstParty",this.user=vo.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(Co(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const t=this.I();return t&&this.p.set("Authorization",t),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class Uo{constructor(t,e,n,i){this.h=t,this.l=e,this.m=n,this.g=i}getToken(){return Promise.resolve(new Po(this.h,this.l,this.m,this.g))}start(t,e){t.enqueueRetryable((()=>e(vo.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Fo{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Vo{constructor(t){this.T=t,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(t,e){const n=t=>{null!=t.error&&To("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${t.error.message}`);const n=t.token!==this.A;return this.A=t.token,To("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable((()=>n(e)))};const i=t=>{To("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.appCheck.addTokenListener(this.o)};this.T.onInit((t=>i(t))),setTimeout((()=>{if(!this.appCheck){const t=this.T.getImmediate({optional:!0});t?i(t):To("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((t=>t?(Co("string"==typeof t.token),this.A=t.token,new Fo(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Bo(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}class jo{static R(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const i=Bo(40);for(let r=0;r<i.length;++r)n.length<20&&i[r]<e&&(n+=t.charAt(i[r]%t.length))}return n}}function qo(t,e){return t<e?-1:t>e?1:0}function zo(t,e,n){return t.length===e.length&&t.every(((t,i)=>n(t,e[i])))}class $o{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new No(Do.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new No(Do.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new No(Do.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new No(Do.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return $o.fromMillis(Date.now())}static fromDate(t){return $o.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new $o(e,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?qo(this.nanoseconds,t.nanoseconds):qo(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Ho{constructor(t){this.timestamp=t}static fromTimestamp(t){return new Ho(t)}static min(){return new Ho(new $o(0,0))}static max(){return new Ho(new $o(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Ko{constructor(t,e,n){void 0===e?e=0:e>t.length&&ko(),void 0===n?n=t.length-e:n>t.length-e&&ko(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===Ko.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Ko?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const n=t.get(i),r=e.get(i);if(n<r)return-1;if(n>r)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class Go extends Ko{construct(t,e,n){return new Go(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new No(Do.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((t=>t.length>0)))}return new Go(e)}static emptyPath(){return new Go([])}}const Wo=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Qo extends Ko{construct(t,e,n){return new Qo(t,e,n)}static isValidIdentifier(t){return Wo.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Qo.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Qo(["__name__"])}static fromServerFormat(t){const e=[];let n="",i=0;const r=()=>{if(0===n.length)throw new No(Do.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let s=!1;for(;i<t.length;){const e=t[i];if("\\"===e){if(i+1===t.length)throw new No(Do.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[i+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new No(Do.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,i+=2}else"`"===e?(s=!s,i++):"."!==e||s?(n+=e,i++):(r(),i++)}if(r(),s)throw new No(Do.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Qo(e)}static emptyPath(){return new Qo([])}}class Xo{constructor(t){this.path=t}static fromPath(t){return new Xo(Go.fromString(t))}static fromName(t){return new Xo(Go.fromString(t).popFirst(5))}static empty(){return new Xo(Go.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===Go.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return Go.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Xo(new Go(t.slice()))}}function Yo(t){return new Jo(t.readTime,t.key,-1)}class Jo{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new Jo(Ho.min(),Xo.empty(),-1)}static max(){return new Jo(Ho.max(),Xo.empty(),-1)}}function Zo(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=Xo.comparator(t.documentKey,e.documentKey),0!==n?n:qo(t.largestBatchId,e.largestBatchId))}class ta{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function ea(t){if(t.code!==Do.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==t.message)throw t;To("LocalStore","Unexpectedly lost primary lease")}class na{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&ko(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new na(((n,i)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,i)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,i)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof na?e:na.resolve(e)}catch(t){return na.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):na.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):na.reject(e)}static resolve(t){return new na(((e,n)=>{e(t)}))}static reject(t){return new na(((e,n)=>{n(t)}))}static waitFor(t){return new na(((e,n)=>{let i=0,r=0,s=!1;t.forEach((t=>{++i,t.next((()=>{++r,s&&r===i&&e()}),(t=>n(t)))})),s=!0,r===i&&e()}))}static or(t){let e=na.resolve(!1);for(const n of t)e=e.next((t=>t?na.resolve(t):n()));return e}static forEach(t,e){const n=[];return t.forEach(((t,i)=>{n.push(e.call(this,t,i))})),this.waitFor(n)}static mapArray(t,e){return new na(((n,i)=>{const r=t.length,s=new Array(r);let o=0;for(let a=0;a<r;a++){const c=a;e(t[c]).next((t=>{s[c]=t,++o,o===r&&n(s)}),(t=>i(t)))}}))}static doWhile(t,e){return new na(((n,i)=>{const r=()=>{!0===t()?e().next((()=>{r()}),i):n()};r()}))}}function ia(t){return"IndexedDbTransactionError"===t.name}class ra{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.ut(t),this.ct=t=>e.writeSequenceNumber(t))}ut(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ct&&this.ct(t),t}}function sa(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function oa(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function aa(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}ra.at=-1;class ca{constructor(t,e){this.comparator=t,this.root=e||ha.EMPTY}insert(t,e){return new ca(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,ha.BLACK,null,null))}remove(t){return new ca(this.comparator,this.root.remove(t,this.comparator).copy(null,null,ha.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(0===i)return e+n.left.size;i<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new ua(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new ua(this.root,t,this.comparator,!1)}getReverseIterator(){return new ua(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new ua(this.root,t,this.comparator,!0)}}class ua{constructor(t,e,n,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!t.isEmpty();)if(r=e?n(t.key,e):1,e&&i&&(r*=-1),r<0)t=this.isReverse?t.left:t.right;else{if(0===r){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class ha{constructor(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:ha.RED,this.left=null!=i?i:ha.EMPTY,this.right=null!=r?r:ha.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,i,r){return new ha(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const r=n(t,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return ha.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===e(t,i.key)){if(i.right.isEmpty())return ha.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,ha.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,ha.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ko();if(this.right.isRed())throw ko();const t=this.left.check();if(t!==this.right.check())throw ko();return t+(this.isRed()?0:1)}}ha.EMPTY=null,ha.RED=!0,ha.BLACK=!1,ha.EMPTY=new class{constructor(){this.size=0}get key(){throw ko()}get value(){throw ko()}get color(){throw ko()}get left(){throw ko()}get right(){throw ko()}copy(t,e,n,i,r){return this}insert(t,e,n){return new ha(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class la{constructor(t){this.comparator=t,this.data=new ca(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new da(this.data.getIterator())}getIteratorFrom(t){return new da(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof la))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(0!==this.comparator(t,i))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new la(this.comparator);return e.data=t,e}}class da{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class fa{constructor(t){this.fields=t,t.sort(Qo.comparator)}static empty(){return new fa([])}unionWith(t){let e=new la(Qo.comparator);for(const t of this.fields)e=e.add(t);for(const n of t)e=e.add(n);return new fa(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return zo(this.fields,t.fields,((t,e)=>t.isEqual(e)))}}class pa{constructor(t){this.binaryString=t}static fromBase64String(t){const e=atob(t);return new pa(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new pa(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return qo(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}pa.EMPTY_BYTE_STRING=new pa("");const ma=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ga(t){if(Co(!!t),"string"==typeof t){let e=0;const n=ma.exec(t);if(Co(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:ya(t.seconds),nanos:ya(t.nanos)}}function ya(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function va(t){return"string"==typeof t?pa.fromBase64String(t):pa.fromUint8Array(t)}function _a(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function wa(t){const e=t.mapValue.fields.__previous_value__;return _a(e)?wa(e):e}function ba(t){const e=ga(t.mapValue.fields.__local_write_time__.timestampValue);return new $o(e.seconds,e.nanos)}class Ta{constructor(t,e,n,i,r,s,o,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=i,this.ssl=r,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.useFetchStreams=a}}class Ia{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new Ia("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof Ia&&t.projectId===this.projectId&&t.database===this.database}}function Ea(t){return null==t}function Sa(t){return 0===t&&1/t==-1/0}const ka={fields:{__type__:{stringValue:"__max__"}}};function Ca(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?_a(t)?4:ja(t)?9007199254740991:10:ko()}function Aa(t,e){if(t===e)return!0;const n=Ca(t);if(n!==Ca(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ba(t).isEqual(ba(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=ga(t.timestampValue),i=ga(e.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return va(t.bytesValue).isEqual(va(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return ya(t.geoPointValue.latitude)===ya(e.geoPointValue.latitude)&&ya(t.geoPointValue.longitude)===ya(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return ya(t.integerValue)===ya(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=ya(t.doubleValue),i=ya(e.doubleValue);return n===i?Sa(n)===Sa(i):isNaN(n)&&isNaN(i)}return!1}(t,e);case 9:return zo(t.arrayValue.values||[],e.arrayValue.values||[],Aa);case 10:return function(t,e){const n=t.mapValue.fields||{},i=e.mapValue.fields||{};if(sa(n)!==sa(i))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===i[t]||!Aa(n[t],i[t])))return!1;return!0}(t,e);default:return ko()}}function Da(t,e){return void 0!==(t.values||[]).find((t=>Aa(t,e)))}function Na(t,e){if(t===e)return 0;const n=Ca(t),i=Ca(e);if(n!==i)return qo(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return qo(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=ya(t.integerValue||t.doubleValue),i=ya(e.integerValue||e.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(t,e);case 3:return Ra(t.timestampValue,e.timestampValue);case 4:return Ra(ba(t),ba(e));case 5:return qo(t.stringValue,e.stringValue);case 6:return function(t,e){const n=va(t),i=va(e);return n.compareTo(i)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),i=e.split("/");for(let t=0;t<n.length&&t<i.length;t++){const e=qo(n[t],i[t]);if(0!==e)return e}return qo(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=qo(ya(t.latitude),ya(e.latitude));return 0!==n?n:qo(ya(t.longitude),ya(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],i=e.values||[];for(let t=0;t<n.length&&t<i.length;++t){const e=Na(n[t],i[t]);if(e)return e}return qo(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){if(t===ka&&e===ka)return 0;if(t===ka)return 1;if(e===ka)return-1;const n=t.fields||{},i=Object.keys(n),r=e.fields||{},s=Object.keys(r);i.sort(),s.sort();for(let t=0;t<i.length&&t<s.length;++t){const e=qo(i[t],s[t]);if(0!==e)return e;const o=Na(n[i[t]],r[s[t]]);if(0!==o)return o}return qo(i.length,s.length)}(t.mapValue,e.mapValue);default:throw ko()}}function Ra(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return qo(t,e);const n=ga(t),i=ga(e),r=qo(n.seconds,i.seconds);return 0!==r?r:qo(n.nanos,i.nanos)}function Oa(t){return xa(t)}function xa(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=ga(t);return`time(${e.seconds},${e.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?va(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,Xo.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(t){let e="[",n=!0;for(const i of t.values||[])n?n=!1:e+=",",e+=xa(i);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",i=!0;for(const r of e)i?i=!1:n+=",",n+=`${r}:${xa(t.fields[r])}`;return n+"}"}(t.mapValue):ko();var e,n}function Ma(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function La(t){return!!t&&"integerValue"in t}function Pa(t){return!!t&&"arrayValue"in t}function Ua(t){return!!t&&"nullValue"in t}function Fa(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Va(t){return!!t&&"mapValue"in t}function Ba(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return oa(t.mapValue.fields,((t,n)=>e.mapValue.fields[t]=Ba(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Ba(t.arrayValue.values[n]);return e}return Object.assign({},t)}function ja(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}class qa{constructor(t){this.value=t}static empty(){return new qa({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!Va(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Ba(e)}setAll(t){let e=Qo.emptyPath(),n={},i=[];t.forEach(((t,r)=>{if(!e.isImmediateParentOf(r)){const t=this.getFieldsMap(e);this.applyChanges(t,n,i),n={},i=[],e=r.popLast()}t?n[r.lastSegment()]=Ba(t):i.push(r.lastSegment())}));const r=this.getFieldsMap(e);this.applyChanges(r,n,i)}delete(t){const e=this.field(t.popLast());Va(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Aa(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=e.mapValue.fields[t.get(n)];Va(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,n){oa(e,((e,n)=>t[e]=n));for(const e of n)delete t[e]}clone(){return new qa(Ba(this.value))}}function za(t){const e=[];return oa(t.fields,((t,n)=>{const i=new Qo([t]);if(Va(n)){const t=za(n.mapValue).fields;if(0===t.length)e.push(i);else for(const n of t)e.push(i.child(n))}else e.push(i)})),new fa(e)}class $a{constructor(t,e,n,i,r,s){this.key=t,this.documentType=e,this.version=n,this.readTime=i,this.data=r,this.documentState=s}static newInvalidDocument(t){return new $a(t,0,Ho.min(),Ho.min(),qa.empty(),0)}static newFoundDocument(t,e,n){return new $a(t,1,e,Ho.min(),n,0)}static newNoDocument(t,e){return new $a(t,2,e,Ho.min(),qa.empty(),0)}static newUnknownDocument(t,e){return new $a(t,3,e,Ho.min(),qa.empty(),2)}convertToFoundDocument(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=qa.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=qa.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ho.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof $a&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new $a(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Ha{constructor(t,e=null,n=[],i=[],r=null,s=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=s,this.endAt=o,this.ht=null}}function Ka(t,e=null,n=[],i=[],r=null,s=null,o=null){return new Ha(t,e,n,i,r,s,o)}function Ga(t){const e=Ao(t);if(null===e.ht){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((t=>{return(e=t).field.canonicalString()+e.op.toString()+Oa(e.value);var e})).join(","),t+="|ob:",t+=e.orderBy.map((t=>function(t){return t.field.canonicalString()+t.dir}(t))).join(","),Ea(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((t=>Oa(t))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((t=>Oa(t))).join(",")),e.ht=t}return e.ht}function Wa(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!ac(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(n=t.filters[r],i=e.filters[r],n.op!==i.op||!n.field.isEqual(i.field)||!Aa(n.value,i.value))return!1;var n,i;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!uc(t.startAt,e.startAt)&&uc(t.endAt,e.endAt)}function Qa(t){return Xo.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}class Xa extends class{}{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.lt(t,e,n):new Ya(t,e,n):"array-contains"===e?new ec(t,n):"in"===e?new nc(t,n):"not-in"===e?new ic(t,n):"array-contains-any"===e?new rc(t,n):new Xa(t,e,n)}static lt(t,e,n){return"in"===e?new Ja(t,n):new Za(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.ft(Na(e,this.value)):null!==e&&Ca(this.value)===Ca(e)&&this.ft(Na(e,this.value))}ft(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return ko()}}dt(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class Ya extends Xa{constructor(t,e,n){super(t,e,n),this.key=Xo.fromName(n.referenceValue)}matches(t){const e=Xo.comparator(t.key,this.key);return this.ft(e)}}class Ja extends Xa{constructor(t,e){super(t,"in",e),this.keys=tc(0,e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class Za extends Xa{constructor(t,e){super(t,"not-in",e),this.keys=tc(0,e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function tc(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((t=>Xo.fromName(t.referenceValue)))}class ec extends Xa{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Pa(e)&&Da(e.arrayValue,this.value)}}class nc extends Xa{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&Da(this.value.arrayValue,e)}}class ic extends Xa{constructor(t,e){super(t,"not-in",e)}matches(t){if(Da(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!Da(this.value.arrayValue,e)}}class rc extends Xa{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Pa(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>Da(this.value.arrayValue,t)))}}class sc{constructor(t,e){this.position=t,this.inclusive=e}}class oc{constructor(t,e="asc"){this.field=t,this.dir=e}}function ac(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function cc(t,e,n){let i=0;for(let r=0;r<t.position.length;r++){const s=e[r],o=t.position[r];if(i=s.field.isKeyField()?Xo.comparator(Xo.fromName(o.referenceValue),n.key):Na(o,n.data.field(s.field)),"desc"===s.dir&&(i*=-1),0!==i)break}return i}function uc(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Aa(t.position[n],e.position[n]))return!1;return!0}class hc{constructor(t,e=null,n=[],i=[],r=null,s="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=i,this.limit=r,this.limitType=s,this.startAt=o,this.endAt=a,this._t=null,this.wt=null,this.startAt,this.endAt}}function lc(t){return new hc(t)}function dc(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function fc(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function pc(t){for(const e of t.filters)if(e.dt())return e.field;return null}function mc(t){return null!==t.collectionGroup}function gc(t){const e=Ao(t);if(null===e._t){e._t=[];const t=pc(e),n=fc(e);if(null!==t&&null===n)t.isKeyField()||e._t.push(new oc(t)),e._t.push(new oc(Qo.keyField(),"asc"));else{let t=!1;for(const n of e.explicitOrderBy)e._t.push(n),n.field.isKeyField()&&(t=!0);if(!t){const t=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e._t.push(new oc(Qo.keyField(),t))}}}return e._t}function yc(t){const e=Ao(t);if(!e.wt)if("F"===e.limitType)e.wt=Ka(e.path,e.collectionGroup,gc(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const n of gc(e)){const e="desc"===n.dir?"asc":"desc";t.push(new oc(n.field,e))}const n=e.endAt?new sc(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new sc(e.startAt.position,e.startAt.inclusive):null;e.wt=Ka(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}return e.wt}function vc(t,e,n){return new hc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function _c(t,e){return Wa(yc(t),yc(e))&&t.limitType===e.limitType}function wc(t){return`${Ga(yc(t))}|lt:${t.limitType}`}function bc(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map((t=>{return`${(e=t).field.canonicalString()} ${e.op} ${Oa(e.value)}`;var e})).join(", ")}]`),Ea(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map((t=>function(t){return`${t.field.canonicalString()} (${t.dir})`}(t))).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((t=>Oa(t))).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((t=>Oa(t))).join(",")),`Target(${e})`}(yc(t))}; limitType=${t.limitType})`}function Tc(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Xo.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of t.explicitOrderBy)if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,n){const i=cc(t,e,n);return t.inclusive?i<=0:i<0}(t.startAt,gc(t),e)||t.endAt&&!function(t,e,n){const i=cc(t,e,n);return t.inclusive?i>=0:i>0}(t.endAt,gc(t),e))}(t,e)}function Ic(t){return(e,n)=>{let i=!1;for(const r of gc(t)){const t=Ec(r,e,n);if(0!==t)return t;i=i||r.field.isKeyField()}return 0}}function Ec(t,e,n){const i=t.field.isKeyField()?Xo.comparator(e.key,n.key):function(t,e,n){const i=e.data.field(t),r=n.data.field(t);return null!==i&&null!==r?Na(i,r):ko()}(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return ko()}}function Sc(t,e){if(t.gt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Sa(e)?"-0":e}}function kc(t){return{integerValue:""+t}}function Cc(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!Sa(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?kc(e):Sc(t,e)}class Ac{constructor(){this._=void 0}}function Dc(t,e,n){return t instanceof Oc?function(t,e){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof xc?Mc(t,e):t instanceof Lc?Pc(t,e):function(t,e){const n=Rc(t,e),i=Fc(n)+Fc(t.yt);return La(n)&&La(t.yt)?kc(i):Sc(t.It,i)}(t,e)}function Nc(t,e,n){return t instanceof xc?Mc(t,e):t instanceof Lc?Pc(t,e):n}function Rc(t,e){return t instanceof Uc?La(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}class Oc extends Ac{}class xc extends Ac{constructor(t){super(),this.elements=t}}function Mc(t,e){const n=Vc(e);for(const e of t.elements)n.some((t=>Aa(t,e)))||n.push(e);return{arrayValue:{values:n}}}class Lc extends Ac{constructor(t){super(),this.elements=t}}function Pc(t,e){let n=Vc(e);for(const e of t.elements)n=n.filter((t=>!Aa(t,e)));return{arrayValue:{values:n}}}class Uc extends Ac{constructor(t,e){super(),this.It=t,this.yt=e}}function Fc(t){return ya(t.integerValue||t.doubleValue)}function Vc(t){return Pa(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Bc{constructor(t,e){this.version=t,this.transformResults=e}}class jc{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new jc}static exists(t){return new jc(void 0,t)}static updateTime(t){return new jc(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function qc(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class zc{}function $c(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new tu(t.key,jc.none()):new Qc(t.key,t.data,jc.none());{const n=t.data,i=qa.empty();let r=new la(Qo.comparator);for(let t of e.fields)if(!r.has(t)){let e=n.field(t);null===e&&t.length>1&&(t=t.popLast(),e=n.field(t)),null===e?i.delete(t):i.set(t,e),r=r.add(t)}return new Xc(t.key,i,new fa(r.toArray()),jc.none())}}function Hc(t,e,n){t instanceof Qc?function(t,e,n){const i=t.value.clone(),r=Jc(t.fieldTransforms,e,n.transformResults);i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):t instanceof Xc?function(t,e,n){if(!qc(t.precondition,e))return void e.convertToUnknownDocument(n.version);const i=Jc(t.fieldTransforms,e,n.transformResults),r=e.data;r.setAll(Yc(t)),r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Kc(t,e,n,i){return t instanceof Qc?function(t,e,n,i){if(!qc(t.precondition,e))return n;const r=t.value.clone(),s=Zc(t.fieldTransforms,i,e);return r.setAll(s),e.convertToFoundDocument(e.version,r).setHasLocalMutations(),null}(t,e,n,i):t instanceof Xc?function(t,e,n,i){if(!qc(t.precondition,e))return n;const r=Zc(t.fieldTransforms,i,e),s=e.data;return s.setAll(Yc(t)),s.setAll(r),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),null===n?null:n.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map((t=>t.field)))}(t,e,n,i):function(t,e,n){return qc(t.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):n}(t,e,n)}function Gc(t,e){let n=null;for(const i of t.fieldTransforms){const t=e.data.field(i.field),r=Rc(i.transform,t||null);null!=r&&(null===n&&(n=qa.empty()),n.set(i.field,r))}return n||null}function Wc(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&zo(t,e,((t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof xc&&e instanceof xc||t instanceof Lc&&e instanceof Lc?zo(t.elements,e.elements,Aa):t instanceof Uc&&e instanceof Uc?Aa(t.yt,e.yt):t instanceof Oc&&e instanceof Oc}(t.transform,e.transform)}(t,e)))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Qc extends zc{constructor(t,e,n,i=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Xc extends zc{constructor(t,e,n,i,r=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=i,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function Yc(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}})),e}function Jc(t,e,n){const i=new Map;Co(t.length===n.length);for(let r=0;r<n.length;r++){const s=t[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,Nc(o,a,n[r]))}return i}function Zc(t,e,n){const i=new Map;for(const r of t){const t=r.transform,s=n.data.field(r.field);i.set(r.field,Dc(t,s,e))}return i}class tu extends zc{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class eu extends zc{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class nu{constructor(t){this.count=t}}var iu,ru;function su(t){if(void 0===t)return Io("GRPC error has no .code"),Do.UNKNOWN;switch(t){case iu.OK:return Do.OK;case iu.CANCELLED:return Do.CANCELLED;case iu.UNKNOWN:return Do.UNKNOWN;case iu.DEADLINE_EXCEEDED:return Do.DEADLINE_EXCEEDED;case iu.RESOURCE_EXHAUSTED:return Do.RESOURCE_EXHAUSTED;case iu.INTERNAL:return Do.INTERNAL;case iu.UNAVAILABLE:return Do.UNAVAILABLE;case iu.UNAUTHENTICATED:return Do.UNAUTHENTICATED;case iu.INVALID_ARGUMENT:return Do.INVALID_ARGUMENT;case iu.NOT_FOUND:return Do.NOT_FOUND;case iu.ALREADY_EXISTS:return Do.ALREADY_EXISTS;case iu.PERMISSION_DENIED:return Do.PERMISSION_DENIED;case iu.FAILED_PRECONDITION:return Do.FAILED_PRECONDITION;case iu.ABORTED:return Do.ABORTED;case iu.OUT_OF_RANGE:return Do.OUT_OF_RANGE;case iu.UNIMPLEMENTED:return Do.UNIMPLEMENTED;case iu.DATA_LOSS:return Do.DATA_LOSS;default:return ko()}}(ru=iu||(iu={}))[ru.OK=0]="OK",ru[ru.CANCELLED=1]="CANCELLED",ru[ru.UNKNOWN=2]="UNKNOWN",ru[ru.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ru[ru.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ru[ru.NOT_FOUND=5]="NOT_FOUND",ru[ru.ALREADY_EXISTS=6]="ALREADY_EXISTS",ru[ru.PERMISSION_DENIED=7]="PERMISSION_DENIED",ru[ru.UNAUTHENTICATED=16]="UNAUTHENTICATED",ru[ru.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ru[ru.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ru[ru.ABORTED=10]="ABORTED",ru[ru.OUT_OF_RANGE=11]="OUT_OF_RANGE",ru[ru.UNIMPLEMENTED=12]="UNIMPLEMENTED",ru[ru.INTERNAL=13]="INTERNAL",ru[ru.UNAVAILABLE=14]="UNAVAILABLE",ru[ru.DATA_LOSS=15]="DATA_LOSS";class ou{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[e,i]of n)if(this.equalsFn(e,t))return i}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),i=this.inner[n];if(void 0===i)return this.inner[n]=[[t,e]],void this.innerSize++;for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],t))return void(i[n]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return 1===n.length?delete this.inner[e]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(t){oa(this.inner,((e,n)=>{for(const[e,i]of n)t(e,i)}))}isEmpty(){return aa(this.inner)}size(){return this.innerSize}}const au=new ca(Xo.comparator);function cu(){return au}const uu=new ca(Xo.comparator);function hu(...t){let e=uu;for(const n of t)e=e.insert(n.key,n);return e}function lu(t){let e=uu;return t.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function du(){return pu()}function fu(){return pu()}function pu(){return new ou((t=>t.toString()),((t,e)=>t.isEqual(e)))}const mu=new ca(Xo.comparator),gu=new la(Xo.comparator);function yu(...t){let e=gu;for(const n of t)e=e.add(n);return e}const vu=new la(qo);function _u(){return vu}class wu{constructor(t,e,n,i,r){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(t,e,n){const i=new Map;return i.set(t,bu.createSynthesizedTargetChangeForCurrentChange(t,e,n)),new wu(Ho.min(),i,_u(),cu(),yu())}}class bu{constructor(t,e,n,i,r){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(t,e,n){return new bu(n,e,yu(),yu(),yu())}}class Tu{constructor(t,e,n,i){this.Tt=t,this.removedTargetIds=e,this.key=n,this.Et=i}}class Iu{constructor(t,e){this.targetId=t,this.At=e}}class Eu{constructor(t,e,n=pa.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}}class Su{constructor(){this.Rt=0,this.bt=Au(),this.Pt=pa.EMPTY_BYTE_STRING,this.vt=!1,this.Vt=!0}get current(){return this.vt}get resumeToken(){return this.Pt}get St(){return 0!==this.Rt}get Dt(){return this.Vt}Ct(t){t.approximateByteSize()>0&&(this.Vt=!0,this.Pt=t)}xt(){let t=yu(),e=yu(),n=yu();return this.bt.forEach(((i,r)=>{switch(r){case 0:t=t.add(i);break;case 2:e=e.add(i);break;case 1:n=n.add(i);break;default:ko()}})),new bu(this.Pt,this.vt,t,e,n)}Nt(){this.Vt=!1,this.bt=Au()}kt(t,e){this.Vt=!0,this.bt=this.bt.insert(t,e)}Ot(t){this.Vt=!0,this.bt=this.bt.remove(t)}Mt(){this.Rt+=1}Ft(){this.Rt-=1}$t(){this.Vt=!0,this.vt=!0}}class ku{constructor(t){this.Bt=t,this.Lt=new Map,this.Ut=cu(),this.qt=Cu(),this.Kt=new la(qo)}Gt(t){for(const e of t.Tt)t.Et&&t.Et.isFoundDocument()?this.Qt(e,t.Et):this.jt(e,t.key,t.Et);for(const e of t.removedTargetIds)this.jt(e,t.key,t.Et)}Wt(t){this.forEachTarget(t,(e=>{const n=this.zt(e);switch(t.state){case 0:this.Ht(e)&&n.Ct(t.resumeToken);break;case 1:n.Ft(),n.St||n.Nt(),n.Ct(t.resumeToken);break;case 2:n.Ft(),n.St||this.removeTarget(e);break;case 3:this.Ht(e)&&(n.$t(),n.Ct(t.resumeToken));break;case 4:this.Ht(e)&&(this.Jt(e),n.Ct(t.resumeToken));break;default:ko()}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.Lt.forEach(((t,n)=>{this.Ht(n)&&e(n)}))}Yt(t){const e=t.targetId,n=t.At.count,i=this.Xt(e);if(i){const t=i.target;if(Qa(t))if(0===n){const n=new Xo(t.path);this.jt(e,n,$a.newNoDocument(n,Ho.min()))}else Co(1===n);else this.Zt(e)!==n&&(this.Jt(e),this.Kt=this.Kt.add(e))}}te(t){const e=new Map;this.Lt.forEach(((n,i)=>{const r=this.Xt(i);if(r){if(n.current&&Qa(r.target)){const e=new Xo(r.target.path);null!==this.Ut.get(e)||this.ee(i,e)||this.jt(i,e,$a.newNoDocument(e,t))}n.Dt&&(e.set(i,n.xt()),n.Nt())}}));let n=yu();this.qt.forEach(((t,e)=>{let i=!0;e.forEachWhile((t=>{const e=this.Xt(t);return!e||2===e.purpose||(i=!1,!1)})),i&&(n=n.add(t))})),this.Ut.forEach(((e,n)=>n.setReadTime(t)));const i=new wu(t,e,this.Kt,this.Ut,n);return this.Ut=cu(),this.qt=Cu(),this.Kt=new la(qo),i}Qt(t,e){if(!this.Ht(t))return;const n=this.ee(t,e.key)?2:0;this.zt(t).kt(e.key,n),this.Ut=this.Ut.insert(e.key,e),this.qt=this.qt.insert(e.key,this.ne(e.key).add(t))}jt(t,e,n){if(!this.Ht(t))return;const i=this.zt(t);this.ee(t,e)?i.kt(e,1):i.Ot(e),this.qt=this.qt.insert(e,this.ne(e).delete(t)),n&&(this.Ut=this.Ut.insert(e,n))}removeTarget(t){this.Lt.delete(t)}Zt(t){const e=this.zt(t).xt();return this.Bt.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Mt(t){this.zt(t).Mt()}zt(t){let e=this.Lt.get(t);return e||(e=new Su,this.Lt.set(t,e)),e}ne(t){let e=this.qt.get(t);return e||(e=new la(qo),this.qt=this.qt.insert(t,e)),e}Ht(t){const e=null!==this.Xt(t);return e||To("WatchChangeAggregator","Detected inactive target",t),e}Xt(t){const e=this.Lt.get(t);return e&&e.St?null:this.Bt.se(t)}Jt(t){this.Lt.set(t,new Su),this.Bt.getRemoteKeysForTarget(t).forEach((e=>{this.jt(t,e,null)}))}ee(t,e){return this.Bt.getRemoteKeysForTarget(t).has(e)}}function Cu(){return new ca(Xo.comparator)}function Au(){return new ca(Xo.comparator)}const Du={asc:"ASCENDING",desc:"DESCENDING"},Nu={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class Ru{constructor(t,e){this.databaseId=t,this.gt=e}}function Ou(t,e){return t.gt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function xu(t,e){return t.gt?e.toBase64():e.toUint8Array()}function Mu(t,e){return Ou(t,e.toTimestamp())}function Lu(t){return Co(!!t),Ho.fromTimestamp(function(t){const e=ga(t);return new $o(e.seconds,e.nanos)}(t))}function Pu(t,e){return function(t){return new Go(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function Uu(t){const e=Go.fromString(t);return Co(eh(e)),e}function Fu(t,e){return Pu(t.databaseId,e.path)}function Vu(t,e){const n=Uu(e);if(n.get(1)!==t.databaseId.projectId)throw new No(Do.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new No(Do.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Xo(qu(n))}function Bu(t,e){return Pu(t.databaseId,e)}function ju(t){return new Go(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function qu(t){return Co(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function zu(t,e,n){return{name:Fu(t,e),fields:n.value.mapValue.fields}}function $u(t,e){return{documents:[Bu(t,e.path)]}}function Hu(t,e){const n={structuredQuery:{}},i=e.path;null!==e.collectionGroup?(n.parent=Bu(t,i),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Bu(t,i.popLast()),n.structuredQuery.from=[{collectionId:i.lastSegment()}]);const r=function(t){if(0===t.length)return;const e=t.map((t=>function(t){if("=="===t.op){if(Fa(t.value))return{unaryFilter:{field:Xu(t.field),op:"IS_NAN"}};if(Ua(t.value))return{unaryFilter:{field:Xu(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Fa(t.value))return{unaryFilter:{field:Xu(t.field),op:"IS_NOT_NAN"}};if(Ua(t.value))return{unaryFilter:{field:Xu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Xu(t.field),op:Qu(t.op),value:t.value}}}(t)));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}(e.filters);r&&(n.structuredQuery.where=r);const s=function(t){if(0!==t.length)return t.map((t=>function(t){return{field:Xu(t.field),direction:Wu(t.dir)}}(t)))}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const o=function(t,e){return t.gt||Ea(e)?e:{value:e}}(t,e.limit);var a;return null!==o&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(n.structuredQuery.endAt=function(t){return{before:!t.inclusive,values:t.position}}(e.endAt)),n}function Ku(t){let e=function(t){const e=Uu(t);return 4===e.length?Go.emptyPath():qu(e)}(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){Co(1===i);const t=n.from[0];t.allDescendants?r=t.collectionId:e=e.child(t.collectionId)}let s=[];n.where&&(s=Gu(n.where));let o=[];n.orderBy&&(o=n.orderBy.map((t=>function(t){return new oc(Yu(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t))));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,Ea(e)?null:e}(n.limit));let c=null;n.startAt&&(c=function(t){const e=!!t.before,n=t.values||[];return new sc(n,e)}(n.startAt));let u=null;return n.endAt&&(u=function(t){const e=!t.before,n=t.values||[];return new sc(n,e)}(n.endAt)),function(t,e,n,i,r,s,o,a){return new hc(t,e,n,i,r,s,o,a)}(e,r,o,s,a,"F",c,u)}function Gu(t){return t?void 0!==t.unaryFilter?[Zu(t)]:void 0!==t.fieldFilter?[Ju(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((t=>Gu(t))).reduce(((t,e)=>t.concat(e))):ko():[]}function Wu(t){return Du[t]}function Qu(t){return Nu[t]}function Xu(t){return{fieldPath:t.canonicalString()}}function Yu(t){return Qo.fromServerFormat(t.fieldPath)}function Ju(t){return Xa.create(Yu(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ko()}}(t.fieldFilter.op),t.fieldFilter.value)}function Zu(t){switch(t.unaryFilter.op){case"IS_NAN":const e=Yu(t.unaryFilter.field);return Xa.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=Yu(t.unaryFilter.field);return Xa.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Yu(t.unaryFilter.field);return Xa.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=Yu(t.unaryFilter.field);return Xa.create(r,"!=",{nullValue:"NULL_VALUE"});default:return ko()}}function th(t){const e=[];return t.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function eh(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}class nh{constructor(t,e,n,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let e=0;e<this.mutations.length;e++){const i=this.mutations[e];i.key.isEqual(t.key)&&Hc(i,t,n[e])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=Kc(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=Kc(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=fu();return this.mutations.forEach((i=>{const r=t.get(i.key),s=r.overlayedDocument;let o=this.applyToLocalView(s,r.mutatedFields);o=e.has(i.key)?null:o;const a=$c(s,o);null!==a&&n.set(i.key,a),s.isValidDocument()||s.convertToNoDocument(Ho.min())})),n}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),yu())}isEqual(t){return this.batchId===t.batchId&&zo(this.mutations,t.mutations,((t,e)=>Wc(t,e)))&&zo(this.baseMutations,t.baseMutations,((t,e)=>Wc(t,e)))}}class ih{constructor(t,e,n,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=i}static from(t,e,n){Co(t.mutations.length===n.length);let i=mu;const r=t.mutations;for(let t=0;t<r.length;t++)i=i.insert(r[t].key,n[t].version);return new ih(t,e,n,i)}}class rh{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class sh{constructor(t,e,n,i,r=Ho.min(),s=Ho.min(),o=pa.EMPTY_BYTE_STRING){this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o}withSequenceNumber(t){return new sh(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(t,e){return new sh(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)}withLastLimboFreeSnapshotVersion(t){return new sh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}class oh{constructor(t){this.re=t}}function ah(t){const e=Ku({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?vc(e,e.limit,"L"):e}class ch{constructor(){}ce(t,e){this.ae(t,e),e.he()}ae(t,e){if("nullValue"in t)this.le(e,5);else if("booleanValue"in t)this.le(e,10),e.fe(t.booleanValue?1:0);else if("integerValue"in t)this.le(e,15),e.fe(ya(t.integerValue));else if("doubleValue"in t){const n=ya(t.doubleValue);isNaN(n)?this.le(e,13):(this.le(e,15),Sa(n)?e.fe(0):e.fe(n))}else if("timestampValue"in t){const n=t.timestampValue;this.le(e,20),"string"==typeof n?e.de(n):(e.de(`${n.seconds||""}`),e.fe(n.nanos||0))}else if("stringValue"in t)this._e(t.stringValue,e),this.we(e);else if("bytesValue"in t)this.le(e,30),e.me(va(t.bytesValue)),this.we(e);else if("referenceValue"in t)this.ge(t.referenceValue,e);else if("geoPointValue"in t){const n=t.geoPointValue;this.le(e,45),e.fe(n.latitude||0),e.fe(n.longitude||0)}else"mapValue"in t?ja(t)?this.le(e,Number.MAX_SAFE_INTEGER):(this.ye(t.mapValue,e),this.we(e)):"arrayValue"in t?(this.pe(t.arrayValue,e),this.we(e)):ko()}_e(t,e){this.le(e,25),this.Ie(t,e)}Ie(t,e){e.de(t)}ye(t,e){const n=t.fields||{};this.le(e,55);for(const t of Object.keys(n))this._e(t,e),this.ae(n[t],e)}pe(t,e){const n=t.values||[];this.le(e,50);for(const t of n)this.ae(t,e)}ge(t,e){this.le(e,37),Xo.fromName(t).path.forEach((t=>{this.le(e,60),this.Ie(t,e)}))}le(t,e){t.fe(e)}we(t){t.fe(2)}}ch.Te=new ch;class uh{constructor(){this.Ye=new hh}addToCollectionParentIndex(t,e){return this.Ye.add(e),na.resolve()}getCollectionParents(t,e){return na.resolve(this.Ye.getEntries(e))}addFieldIndex(t,e){return na.resolve()}deleteFieldIndex(t,e){return na.resolve()}getDocumentsMatchingTarget(t,e){return na.resolve(null)}getIndexType(t,e){return na.resolve(0)}getFieldIndexes(t,e){return na.resolve([])}getNextCollectionGroupToUpdate(t){return na.resolve(null)}getMinOffset(t,e){return na.resolve(Jo.min())}getMinOffsetFromCollectionGroup(t,e){return na.resolve(Jo.min())}updateCollectionGroup(t,e,n){return na.resolve()}updateIndexEntries(t,e){return na.resolve()}}class hh{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e]||new la(Go.comparator),r=!i.has(n);return this.index[e]=i.add(n),r}has(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e];return i&&i.has(n)}getEntries(t){return(this.index[t]||new la(Go.comparator)).toArray()}}new Uint8Array(0);class lh{constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}static withCacheSize(t){return new lh(t,lh.DEFAULT_COLLECTION_PERCENTILE,lh.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}lh.DEFAULT_COLLECTION_PERCENTILE=10,lh.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,lh.DEFAULT=new lh(41943040,lh.DEFAULT_COLLECTION_PERCENTILE,lh.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),lh.DISABLED=new lh(-1,0,0);class dh{constructor(t){this.bn=t}next(){return this.bn+=2,this.bn}static Pn(){return new dh(0)}static vn(){return new dh(-1)}}class fh{constructor(){this.changes=new ou((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,$a.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?na.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class ph{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class mh{constructor(t,e,n,i){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=i}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next((i=>(n=i,this.getBaseDocument(t,e,n)))).next((t=>(null!==n&&Kc(n.mutation,t,fa.empty(),$o.now()),t)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.getLocalViewOfDocuments(t,e,yu()).next((()=>e))))}getLocalViewOfDocuments(t,e,n=yu()){const i=du();return this.populateOverlays(t,i,e).next((()=>this.computeViews(t,e,i,n).next((t=>{let e=hu();return t.forEach(((t,n)=>{e=e.insert(t,n.overlayedDocument)})),e}))))}getOverlayedDocuments(t,e){const n=du();return this.populateOverlays(t,n,e).next((()=>this.computeViews(t,e,n,yu())))}populateOverlays(t,e,n){const i=[];return n.forEach((t=>{e.has(t)||i.push(t)})),this.documentOverlayCache.getOverlays(t,i).next((t=>{t.forEach(((t,n)=>{e.set(t,n)}))}))}computeViews(t,e,n,i){let r=cu();const s=pu(),o=pu();return e.forEach(((t,e)=>{const o=n.get(e.key);i.has(e.key)&&(void 0===o||o.mutation instanceof Xc)?r=r.insert(e.key,e):void 0!==o&&(s.set(e.key,o.mutation.getFieldMask()),Kc(o.mutation,e,o.mutation.getFieldMask(),$o.now()))})),this.recalculateAndSaveOverlays(t,r).next((t=>(t.forEach(((t,e)=>s.set(t,e))),e.forEach(((t,e)=>{var n;return o.set(t,new ph(e,null!==(n=s.get(t))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(t,e){const n=pu();let i=new ca(((t,e)=>t-e)),r=yu();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((t=>{for(const r of t)r.keys().forEach((t=>{const s=e.get(t);if(null===s)return;let o=n.get(t)||fa.empty();o=r.applyToLocalView(s,o),n.set(t,o);const a=(i.get(r.batchId)||yu()).add(t);i=i.insert(r.batchId,a)}))})).next((()=>{const s=[],o=i.getReverseIterator();for(;o.hasNext();){const i=o.getNext(),a=i.key,c=i.value,u=fu();c.forEach((t=>{if(!r.has(t)){const i=$c(e.get(t),n.get(t));null!==i&&u.set(t,i),r=r.add(t)}})),s.push(this.documentOverlayCache.saveOverlays(t,a,u))}return na.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.recalculateAndSaveOverlays(t,e)))}getDocumentsMatchingQuery(t,e,n){return function(t){return Xo.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):mc(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n):this.getDocumentsMatchingCollectionQuery(t,e,n)}getNextDocuments(t,e,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,i).next((r=>{const s=i-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,i-r.size):na.resolve(du());let o=-1,a=r;return s.next((e=>na.forEach(e,((e,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),r.get(e)?na.resolve():this.getBaseDocument(t,e,n).next((t=>{a=a.insert(e,t)}))))).next((()=>this.populateOverlays(t,e,r))).next((()=>this.computeViews(t,a,e,yu()))).next((t=>({batchId:o,changes:lu(t)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new Xo(e)).next((t=>{let e=hu();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}getDocumentsMatchingCollectionGroupQuery(t,e,n){const i=e.collectionGroup;let r=hu();return this.indexManager.getCollectionParents(t,i).next((s=>na.forEach(s,(s=>{const o=function(t,e){return new hc(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return this.getDocumentsMatchingCollectionQuery(t,o,n).next((t=>{t.forEach(((t,e)=>{r=r.insert(t,e)}))}))})).next((()=>r))))}getDocumentsMatchingCollectionQuery(t,e,n){let i;return this.remoteDocumentCache.getAllFromCollection(t,e.path,n).next((r=>(i=r,this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId)))).next((t=>{t.forEach(((t,e)=>{const n=e.getKey();null===i.get(n)&&(i=i.insert(n,$a.newInvalidDocument(n)))}));let n=hu();return i.forEach(((i,r)=>{const s=t.get(i);void 0!==s&&Kc(s.mutation,r,fa.empty(),$o.now()),Tc(e,r)&&(n=n.insert(i,r))})),n}))}getBaseDocument(t,e,n){return null===n||1===n.mutation.type?this.remoteDocumentCache.getEntry(t,e):na.resolve($a.newInvalidDocument(e))}}class gh{constructor(t){this.It=t,this.Zn=new Map,this.ts=new Map}getBundleMetadata(t,e){return na.resolve(this.Zn.get(e))}saveBundleMetadata(t,e){var n;return this.Zn.set(e.id,{id:(n=e).id,version:n.version,createTime:Lu(n.createTime)}),na.resolve()}getNamedQuery(t,e){return na.resolve(this.ts.get(e))}saveNamedQuery(t,e){return this.ts.set(e.name,function(t){return{name:t.name,query:ah(t.bundledQuery),readTime:Lu(t.readTime)}}(e)),na.resolve()}}class yh{constructor(){this.overlays=new ca(Xo.comparator),this.es=new Map}getOverlay(t,e){return na.resolve(this.overlays.get(e))}getOverlays(t,e){const n=du();return na.forEach(e,(e=>this.getOverlay(t,e).next((t=>{null!==t&&n.set(e,t)})))).next((()=>n))}saveOverlays(t,e,n){return n.forEach(((n,i)=>{this.ue(t,e,i)})),na.resolve()}removeOverlaysForBatchId(t,e,n){const i=this.es.get(n);return void 0!==i&&(i.forEach((t=>this.overlays=this.overlays.remove(t))),this.es.delete(n)),na.resolve()}getOverlaysForCollection(t,e,n){const i=du(),r=e.length+1,s=new Xo(e.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const t=o.getNext().value,s=t.getKey();if(!e.isPrefixOf(s.path))break;s.path.length===r&&t.largestBatchId>n&&i.set(t.getKey(),t)}return na.resolve(i)}getOverlaysForCollectionGroup(t,e,n,i){let r=new ca(((t,e)=>t-e));const s=this.overlays.getIterator();for(;s.hasNext();){const t=s.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=r.get(t.largestBatchId);null===e&&(e=du(),r=r.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const o=du(),a=r.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((t,e)=>o.set(t,e))),!(o.size()>=i)););return na.resolve(o)}ue(t,e,n){const i=this.overlays.get(n.key);if(null!==i){const t=this.es.get(i.largestBatchId).delete(n.key);this.es.set(i.largestBatchId,t)}this.overlays=this.overlays.insert(n.key,new rh(e,n));let r=this.es.get(e);void 0===r&&(r=yu(),this.es.set(e,r)),this.es.set(e,r.add(n.key))}}class vh{constructor(){this.ns=new la(_h.ss),this.rs=new la(_h.os)}isEmpty(){return this.ns.isEmpty()}addReference(t,e){const n=new _h(t,e);this.ns=this.ns.add(n),this.rs=this.rs.add(n)}us(t,e){t.forEach((t=>this.addReference(t,e)))}removeReference(t,e){this.cs(new _h(t,e))}hs(t,e){t.forEach((t=>this.removeReference(t,e)))}ls(t){const e=new Xo(new Go([])),n=new _h(e,t),i=new _h(e,t+1),r=[];return this.rs.forEachInRange([n,i],(t=>{this.cs(t),r.push(t.key)})),r}fs(){this.ns.forEach((t=>this.cs(t)))}cs(t){this.ns=this.ns.delete(t),this.rs=this.rs.delete(t)}ds(t){const e=new Xo(new Go([])),n=new _h(e,t),i=new _h(e,t+1);let r=yu();return this.rs.forEachInRange([n,i],(t=>{r=r.add(t.key)})),r}containsKey(t){const e=new _h(t,0),n=this.ns.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class _h{constructor(t,e){this.key=t,this._s=e}static ss(t,e){return Xo.comparator(t.key,e.key)||qo(t._s,e._s)}static os(t,e){return qo(t._s,e._s)||Xo.comparator(t.key,e.key)}}class wh{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.ws=1,this.gs=new la(_h.ss)}checkEmpty(t){return na.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,n,i){const r=this.ws;this.ws++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new nh(r,e,n,i);this.mutationQueue.push(s);for(const e of i)this.gs=this.gs.add(new _h(e.key,r)),this.indexManager.addToCollectionParentIndex(t,e.key.path.popLast());return na.resolve(s)}lookupMutationBatch(t,e){return na.resolve(this.ys(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,i=this.ps(n),r=i<0?0:i;return na.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return na.resolve(0===this.mutationQueue.length?-1:this.ws-1)}getAllMutationBatches(t){return na.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new _h(e,0),i=new _h(e,Number.POSITIVE_INFINITY),r=[];return this.gs.forEachInRange([n,i],(t=>{const e=this.ys(t._s);r.push(e)})),na.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new la(qo);return e.forEach((t=>{const e=new _h(t,0),i=new _h(t,Number.POSITIVE_INFINITY);this.gs.forEachInRange([e,i],(t=>{n=n.add(t._s)}))})),na.resolve(this.Is(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,i=n.length+1;let r=n;Xo.isDocumentKey(r)||(r=r.child(""));const s=new _h(new Xo(r),0);let o=new la(qo);return this.gs.forEachWhile((t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===i&&(o=o.add(t._s)),!0)}),s),na.resolve(this.Is(o))}Is(t){const e=[];return t.forEach((t=>{const n=this.ys(t);null!==n&&e.push(n)})),e}removeMutationBatch(t,e){Co(0===this.Ts(e.batchId,"removed")),this.mutationQueue.shift();let n=this.gs;return na.forEach(e.mutations,(i=>{const r=new _h(i.key,e.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((()=>{this.gs=n}))}An(t){}containsKey(t,e){const n=new _h(e,0),i=this.gs.firstAfterOrEqual(n);return na.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,na.resolve()}Ts(t,e){return this.ps(t)}ps(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}ys(t){const e=this.ps(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class bh{constructor(t){this.Es=t,this.docs=new ca(Xo.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,i=this.docs.get(n),r=i?i.size:0,s=this.Es(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:s}),this.size+=s-r,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return na.resolve(n?n.document.mutableCopy():$a.newInvalidDocument(e))}getEntries(t,e){let n=cu();return e.forEach((t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():$a.newInvalidDocument(t))})),na.resolve(n)}getAllFromCollection(t,e,n){let i=cu();const r=new Xo(e.child("")),s=this.docs.getIteratorFrom(r);for(;s.hasNext();){const{key:t,value:{document:r}}=s.getNext();if(!e.isPrefixOf(t.path))break;t.path.length>e.length+1||Zo(Yo(r),n)<=0||(i=i.insert(r.key,r.mutableCopy()))}return na.resolve(i)}getAllFromCollectionGroup(t,e,n,i){ko()}As(t,e){return na.forEach(this.docs,(t=>e(t)))}newChangeBuffer(t){return new Th(this)}getSize(t){return na.resolve(this.size)}}class Th extends fh{constructor(t){super(),this.Yn=t}applyChanges(t){const e=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?e.push(this.Yn.addEntry(t,i)):this.Yn.removeEntry(n)})),na.waitFor(e)}getFromCache(t,e){return this.Yn.getEntry(t,e)}getAllFromCache(t,e){return this.Yn.getEntries(t,e)}}class Ih{constructor(t){this.persistence=t,this.Rs=new ou((t=>Ga(t)),Wa),this.lastRemoteSnapshotVersion=Ho.min(),this.highestTargetId=0,this.bs=0,this.Ps=new vh,this.targetCount=0,this.vs=dh.Pn()}forEachTarget(t,e){return this.Rs.forEach(((t,n)=>e(n))),na.resolve()}getLastRemoteSnapshotVersion(t){return na.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return na.resolve(this.bs)}allocateTargetId(t){return this.highestTargetId=this.vs.next(),na.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.bs&&(this.bs=e),na.resolve()}Dn(t){this.Rs.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.vs=new dh(e),this.highestTargetId=e),t.sequenceNumber>this.bs&&(this.bs=t.sequenceNumber)}addTargetData(t,e){return this.Dn(e),this.targetCount+=1,na.resolve()}updateTargetData(t,e){return this.Dn(e),na.resolve()}removeTargetData(t,e){return this.Rs.delete(e.target),this.Ps.ls(e.targetId),this.targetCount-=1,na.resolve()}removeTargets(t,e,n){let i=0;const r=[];return this.Rs.forEach(((s,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.Rs.delete(s),r.push(this.removeMatchingKeysForTargetId(t,o.targetId)),i++)})),na.waitFor(r).next((()=>i))}getTargetCount(t){return na.resolve(this.targetCount)}getTargetData(t,e){const n=this.Rs.get(e)||null;return na.resolve(n)}addMatchingKeys(t,e,n){return this.Ps.us(e,n),na.resolve()}removeMatchingKeys(t,e,n){this.Ps.hs(e,n);const i=this.persistence.referenceDelegate,r=[];return i&&e.forEach((e=>{r.push(i.markPotentiallyOrphaned(t,e))})),na.waitFor(r)}removeMatchingKeysForTargetId(t,e){return this.Ps.ls(e),na.resolve()}getMatchingKeysForTargetId(t,e){const n=this.Ps.ds(e);return na.resolve(n)}containsKey(t,e){return na.resolve(this.Ps.containsKey(e))}}class Eh{constructor(t,e){this.Vs={},this.overlays={},this.Ss=new ra(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=t(this),this.Cs=new Ih(this),this.indexManager=new uh,this.remoteDocumentCache=function(t){return new bh(t)}((t=>this.referenceDelegate.xs(t))),this.It=new oh(e),this.Ns=new gh(this.It)}start(){return Promise.resolve()}shutdown(){return this.Ds=!1,Promise.resolve()}get started(){return this.Ds}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new yh,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.Vs[t.toKey()];return n||(n=new wh(e,this.referenceDelegate),this.Vs[t.toKey()]=n),n}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ns}runTransaction(t,e,n){To("MemoryPersistence","Starting transaction:",t);const i=new Sh(this.Ss.next());return this.referenceDelegate.ks(),n(i).next((t=>this.referenceDelegate.Os(i).next((()=>t)))).toPromise().then((t=>(i.raiseOnCommittedEvent(),t)))}Ms(t,e){return na.or(Object.values(this.Vs).map((n=>()=>n.containsKey(t,e))))}}class Sh extends ta{constructor(t){super(),this.currentSequenceNumber=t}}class kh{constructor(t){this.persistence=t,this.Fs=new vh,this.$s=null}static Bs(t){return new kh(t)}get Ls(){if(this.$s)return this.$s;throw ko()}addReference(t,e,n){return this.Fs.addReference(n,e),this.Ls.delete(n.toString()),na.resolve()}removeReference(t,e,n){return this.Fs.removeReference(n,e),this.Ls.add(n.toString()),na.resolve()}markPotentiallyOrphaned(t,e){return this.Ls.add(e.toString()),na.resolve()}removeTarget(t,e){this.Fs.ls(e.targetId).forEach((t=>this.Ls.add(t.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((t=>{t.forEach((t=>this.Ls.add(t.toString())))})).next((()=>n.removeTargetData(t,e)))}ks(){this.$s=new Set}Os(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return na.forEach(this.Ls,(n=>{const i=Xo.fromPath(n);return this.Us(t,i).next((t=>{t||e.removeEntry(i,Ho.min())}))})).next((()=>(this.$s=null,e.apply(t))))}updateLimboDocument(t,e){return this.Us(t,e).next((t=>{t?this.Ls.delete(e.toString()):this.Ls.add(e.toString())}))}xs(t){return 0}Us(t,e){return na.or([()=>na.resolve(this.Fs.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ms(t,e)])}}class Ch{constructor(t,e,n,i){this.targetId=t,this.fromCache=e,this.Si=n,this.Di=i}static Ci(t,e){let n=yu(),i=yu();for(const t of e.docChanges)switch(t.type){case 0:n=n.add(t.doc.key);break;case 1:i=i.add(t.doc.key)}return new Ch(t,e.fromCache,n,i)}}class Ah{constructor(){this.xi=!1}initialize(t,e){this.Ni=t,this.indexManager=e,this.xi=!0}getDocumentsMatchingQuery(t,e,n,i){return this.ki(t,e).next((r=>r||this.Oi(t,e,i,n))).next((n=>n||this.Mi(t,e)))}ki(t,e){if(dc(e))return na.resolve(null);let n=yc(e);return this.indexManager.getIndexType(t,n).next((i=>0===i?null:(null!==e.limit&&1===i&&(e=vc(e,null,"F"),n=yc(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next((i=>{const r=yu(...i);return this.Ni.getDocuments(t,r).next((i=>this.indexManager.getMinOffset(t,n).next((n=>{const s=this.Fi(e,i);return this.$i(e,s,r,n.readTime)?this.ki(t,vc(e,null,"F")):this.Bi(t,s,e,n)}))))})))))}Oi(t,e,n,i){return dc(e)||i.isEqual(Ho.min())?this.Mi(t,e):this.Ni.getDocuments(t,n).next((r=>{const s=this.Fi(e,r);return this.$i(e,s,n,i)?this.Mi(t,e):(bo()<=N.DEBUG&&To("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),bc(e)),this.Bi(t,s,e,function(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,r=Ho.fromTimestamp(1e9===i?new $o(n+1,0):new $o(n,i));return new Jo(r,Xo.empty(),e)}(i,-1)))}))}Fi(t,e){let n=new la(Ic(t));return e.forEach(((e,i)=>{Tc(t,i)&&(n=n.add(i))})),n}$i(t,e,n,i){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const r="F"===t.limitType?e.last():e.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}Mi(t,e){return bo()<=N.DEBUG&&To("QueryEngine","Using full collection scan to execute query:",bc(e)),this.Ni.getDocumentsMatchingQuery(t,e,Jo.min())}Bi(t,e,n,i){return this.Ni.getDocumentsMatchingQuery(t,n,i).next((t=>(e.forEach((e=>{t=t.insert(e.key,e)})),t)))}}class Dh{constructor(t,e,n,i){this.persistence=t,this.Li=e,this.It=i,this.Ui=new ca(qo),this.qi=new ou((t=>Ga(t)),Wa),this.Ki=new Map,this.Gi=t.getRemoteDocumentCache(),this.Cs=t.getTargetCache(),this.Ns=t.getBundleCache(),this.Qi(n)}Qi(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new mh(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.Ui)))}}async function Nh(t,e){const n=Ao(t);return await n.persistence.runTransaction("Handle user change","readonly",(t=>{let i;return n.mutationQueue.getAllMutationBatches(t).next((r=>(i=r,n.Qi(e),n.mutationQueue.getAllMutationBatches(t)))).next((e=>{const r=[],s=[];let o=yu();for(const t of i){r.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){s.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return n.localDocuments.getDocuments(t,o).next((t=>({ji:t,removedBatchIds:r,addedBatchIds:s})))}))}))}function Rh(t){const e=Ao(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Cs.getLastRemoteSnapshotVersion(t)))}function Oh(t,e){const n=Ao(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(t=>(void 0===e&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(t,e))))}async function xh(t,e,n){const i=Ao(t),r=i.Ui.get(e),s=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",s,(t=>i.persistence.referenceDelegate.removeTarget(t,r)))}catch(t){if(!ia(t))throw t;To("LocalStore",`Failed to update sequence numbers for target ${e}: ${t}`)}i.Ui=i.Ui.remove(e),i.qi.delete(r.target)}function Mh(t,e,n){const i=Ao(t);let r=Ho.min(),s=yu();return i.persistence.runTransaction("Execute query","readonly",(t=>function(t,e,n){const i=Ao(t),r=i.qi.get(n);return void 0!==r?na.resolve(i.Ui.get(r)):i.Cs.getTargetData(e,n)}(i,t,yc(e)).next((e=>{if(e)return r=e.lastLimboFreeSnapshotVersion,i.Cs.getMatchingKeysForTargetId(t,e.targetId).next((t=>{s=t}))})).next((()=>i.Li.getDocumentsMatchingQuery(t,e,n?r:Ho.min(),n?s:yu()))).next((t=>(function(t,e,n){let i=t.Ki.get(e)||Ho.min();n.forEach(((t,e)=>{e.readTime.compareTo(i)>0&&(i=e.readTime)})),t.Ki.set(e,i)}(i,function(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}(e),t),{documents:t,Hi:s})))))}class Lh{constructor(){this.activeTargetIds=_u()}er(t){this.activeTargetIds=this.activeTargetIds.add(t)}nr(t){this.activeTargetIds=this.activeTargetIds.delete(t)}tr(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Ph{constructor(){this.Lr=new Lh,this.Ur={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return this.Lr.er(t),this.Ur[t]||"not-current"}updateQueryState(t,e,n){this.Ur[t]=e}removeLocalQueryTarget(t){this.Lr.nr(t)}isLocalQueryTarget(t){return this.Lr.activeTargetIds.has(t)}clearQueryState(t){delete this.Ur[t]}getAllActiveQueryTargets(){return this.Lr.activeTargetIds}isActiveQueryTarget(t){return this.Lr.activeTargetIds.has(t)}start(){return this.Lr=new Lh,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class Uh{qr(t){}shutdown(){}}class Fh{constructor(){this.Kr=()=>this.Gr(),this.Qr=()=>this.jr(),this.Wr=[],this.zr()}qr(t){this.Wr.push(t)}shutdown(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}zr(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}Gr(){To("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.Wr)t(0)}jr(){To("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.Wr)t(1)}static C(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const Vh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Bh{constructor(t){this.Hr=t.Hr,this.Jr=t.Jr}Yr(t){this.Xr=t}Zr(t){this.eo=t}onMessage(t){this.no=t}close(){this.Jr()}send(t){this.Hr(t)}so(){this.Xr()}io(t){this.eo(t)}ro(t){this.no(t)}}class jh extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http";this.oo=e+"://"+t.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get co(){return!1}ao(t,e,n,i,r){const s=this.ho(t,e);To("RestConnection","Sending: ",s,n);const o={};return this.lo(o,i,r),this.fo(t,s,o,n).then((t=>(To("RestConnection","Received: ",t),t)),(e=>{throw Eo("RestConnection",`${t} failed with error: `,e,"url: ",s,"request:",n),e}))}_o(t,e,n,i,r,s){return this.ao(t,e,n,i,r)}lo(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+_o,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((e,n)=>t[n]=e)),n&&n.headers.forEach(((e,n)=>t[n]=e))}ho(t,e){const n=Vh[t];return`${this.oo}/v1/${e}:${n}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams}fo(t,e,n,i){return new Promise(((r,s)=>{const o=new go;o.setWithCredentials(!0),o.listenOnce(ho.COMPLETE,(()=>{var e;try{switch(o.getLastErrorCode()){case uo.NO_ERROR:const n=o.getResponseJson();To("Connection","XHR received:",JSON.stringify(n)),r(n);break;case uo.TIMEOUT:To("Connection",'RPC "'+t+'" timed out'),s(new No(Do.DEADLINE_EXCEEDED,"Request time out"));break;case uo.HTTP_ERROR:const i=o.getStatus();if(To("Connection",'RPC "'+t+'" failed with status:',i,"response text:",o.getResponseText()),i>0){let t=o.getResponseJson();Array.isArray(t)&&(t=t[0]);const n=null===(e=t)||void 0===e?void 0:e.error;if(n&&n.status&&n.message){const t=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(Do).indexOf(e)>=0?e:Do.UNKNOWN}(n.status);s(new No(t,n.message))}else s(new No(Do.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new No(Do.UNAVAILABLE,"Connection failed."));break;default:ko()}}finally{To("Connection",'RPC "'+t+'" completed.')}}));const a=JSON.stringify(i);o.send(e,"POST",a,n,15)}))}wo(t,e,n){const i=[this.oo,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=ao(),s=co(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new po({})),this.lo(o.initMessageHeaders,e,n),o.encodeInitMessageHeaders=!0;const a=i.join("");To("Connection","Creating WebChannel: "+a,o);const c=r.createWebChannel(a,o);let u=!1,h=!1;const l=new Bh({Hr:t=>{h?To("Connection","Not sending because WebChannel is closed:",t):(u||(To("Connection","Opening WebChannel transport."),c.open(),u=!0),To("Connection","WebChannel sending:",t),c.send(t))},Jr:()=>c.close()}),d=(t,e,n)=>{t.listen(e,(t=>{try{n(t)}catch(t){setTimeout((()=>{throw t}),0)}}))};return d(c,mo.EventType.OPEN,(()=>{h||To("Connection","WebChannel transport opened.")})),d(c,mo.EventType.CLOSE,(()=>{h||(h=!0,To("Connection","WebChannel transport closed"),l.io())})),d(c,mo.EventType.ERROR,(t=>{h||(h=!0,Eo("Connection","WebChannel transport errored:",t),l.io(new No(Do.UNAVAILABLE,"The operation could not be completed")))})),d(c,mo.EventType.MESSAGE,(t=>{var e;if(!h){const n=t.data[0];Co(!!n);const i=n,r=i.error||(null===(e=i[0])||void 0===e?void 0:e.error);if(r){To("Connection","WebChannel received error:",r);const t=r.status;let e=function(t){const e=iu[t];if(void 0!==e)return su(e)}(t),n=r.message;void 0===e&&(e=Do.INTERNAL,n="Unknown error status: "+t+" with message "+r.message),h=!0,l.io(new No(e,n)),c.close()}else To("Connection","WebChannel received:",n),l.ro(n)}})),d(s,lo.STAT_EVENT,(t=>{t.stat===fo.PROXY?To("Connection","Detected buffering proxy"):t.stat===fo.NOPROXY&&To("Connection","Detected no buffering proxy")})),setTimeout((()=>{l.so()}),0),l}}function qh(){return"undefined"!=typeof document?document:null}function zh(t){return new Ru(t,!0)}class $h{constructor(t,e,n=1e3,i=1.5,r=6e4){this.Hs=t,this.timerId=e,this.mo=n,this.yo=i,this.po=r,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}reset(){this.Io=0}Ao(){this.Io=this.po}Ro(t){this.cancel();const e=Math.floor(this.Io+this.bo()),n=Math.max(0,Date.now()-this.Eo),i=Math.max(0,e-n);i>0&&To("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Io} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.To=this.Hs.enqueueAfterDelay(this.timerId,i,(()=>(this.Eo=Date.now(),t()))),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}Po(){null!==this.To&&(this.To.skipDelay(),this.To=null)}cancel(){null!==this.To&&(this.To.cancel(),this.To=null)}bo(){return(Math.random()-.5)*this.Io}}class Hh{constructor(t,e,n,i,r,s,o,a){this.Hs=t,this.vo=n,this.Vo=i,this.connection=r,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new $h(t,e)}No(){return 1===this.state||5===this.state||this.ko()}ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Oo()}async stop(){this.No()&&await this.close(0)}Mo(){this.state=0,this.xo.reset()}Fo(){this.ko()&&null===this.Do&&(this.Do=this.Hs.enqueueAfterDelay(this.vo,6e4,(()=>this.$o())))}Bo(t){this.Lo(),this.stream.send(t)}async $o(){if(this.ko())return this.close(0)}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}Uo(){this.Co&&(this.Co.cancel(),this.Co=null)}async close(t,e){this.Lo(),this.Uo(),this.xo.cancel(),this.So++,4!==t?this.xo.reset():e&&e.code===Do.RESOURCE_EXHAUSTED?(Io(e.toString()),Io("Using maximum backoff delay to prevent overloading the backend."),this.xo.Ao()):e&&e.code===Do.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.qo(),this.stream.close(),this.stream=null),this.state=t,await this.listener.Zr(e)}qo(){}auth(){this.state=1;const t=this.Ko(this.So),e=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([t,n])=>{this.So===e&&this.Go(t,n)}),(e=>{t((()=>{const t=new No(Do.UNKNOWN,"Fetching auth token failed: "+e.message);return this.Qo(t)}))}))}Go(t,e){const n=this.Ko(this.So);this.stream=this.jo(t,e),this.stream.Yr((()=>{n((()=>(this.state=2,this.Co=this.Hs.enqueueAfterDelay(this.Vo,1e4,(()=>(this.ko()&&(this.state=3),Promise.resolve()))),this.listener.Yr())))})),this.stream.Zr((t=>{n((()=>this.Qo(t)))})),this.stream.onMessage((t=>{n((()=>this.onMessage(t)))}))}Oo(){this.state=5,this.xo.Ro((async()=>{this.state=0,this.start()}))}Qo(t){return To("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}Ko(t){return e=>{this.Hs.enqueueAndForget((()=>this.So===t?e():(To("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Kh extends Hh{constructor(t,e,n,i,r,s){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,n,i,s),this.It=r}jo(t,e){return this.connection.wo("Listen",t,e)}onMessage(t){this.xo.reset();const e=function(t,e){let n;if("targetChange"in e){e.targetChange;const i=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:ko()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=function(t,e){return t.gt?(Co(void 0===e||"string"==typeof e),pa.fromBase64String(e||"")):(Co(void 0===e||e instanceof Uint8Array),pa.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(t){const e=void 0===t.code?Do.UNKNOWN:su(t.code);return new No(e,t.message||"")}(o);n=new Eu(i,r,s,a||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=Vu(t,i.document.name),s=Lu(i.document.updateTime),o=new qa({mapValue:{fields:i.document.fields}}),a=$a.newFoundDocument(r,s,o),c=i.targetIds||[],u=i.removedTargetIds||[];n=new Tu(c,u,a.key,a)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=Vu(t,i.document),s=i.readTime?Lu(i.readTime):Ho.min(),o=$a.newNoDocument(r,s),a=i.removedTargetIds||[];n=new Tu([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=Vu(t,i.document),s=i.removedTargetIds||[];n=new Tu([],s,r,null)}else{if(!("filter"in e))return ko();{e.filter;const t=e.filter;t.targetId;const i=t.count||0,r=new nu(i),s=t.targetId;n=new Iu(s,r)}}return n}(this.It,t),n=function(t){if(!("targetChange"in t))return Ho.min();const e=t.targetChange;return e.targetIds&&e.targetIds.length?Ho.min():e.readTime?Lu(e.readTime):Ho.min()}(t);return this.listener.Wo(e,n)}zo(t){const e={};e.database=ju(this.It),e.addTarget=function(t,e){let n;const i=e.target;return n=Qa(i)?{documents:$u(t,i)}:{query:Hu(t,i)},n.targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=xu(t,e.resumeToken):e.snapshotVersion.compareTo(Ho.min())>0&&(n.readTime=Ou(t,e.snapshotVersion.toTimestamp())),n}(this.It,t);const n=function(t,e){const n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return ko()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.It,t);n&&(e.labels=n),this.Bo(e)}Ho(t){const e={};e.database=ju(this.It),e.removeTarget=t,this.Bo(e)}}class Gh extends Hh{constructor(t,e,n,i,r,s){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,i,s),this.It=r,this.Jo=!1}get Yo(){return this.Jo}start(){this.Jo=!1,this.lastStreamToken=void 0,super.start()}qo(){this.Jo&&this.Xo([])}jo(t,e){return this.connection.wo("Write",t,e)}onMessage(t){if(Co(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Jo){this.xo.reset();const e=function(t,e){return t&&t.length>0?(Co(void 0!==e),t.map((t=>function(t,e){let n=t.updateTime?Lu(t.updateTime):Lu(e);return n.isEqual(Ho.min())&&(n=Lu(e)),new Bc(n,t.transformResults||[])}(t,e)))):[]}(t.writeResults,t.commitTime),n=Lu(t.commitTime);return this.listener.Zo(n,e)}return Co(!t.writeResults||0===t.writeResults.length),this.Jo=!0,this.listener.tu()}eu(){const t={};t.database=ju(this.It),this.Bo(t)}Xo(t){const e={streamToken:this.lastStreamToken,writes:t.map((t=>function(t,e){let n;if(e instanceof Qc)n={update:zu(t,e.key,e.value)};else if(e instanceof tu)n={delete:Fu(t,e.key)};else if(e instanceof Xc)n={update:zu(t,e.key,e.data),updateMask:th(e.fieldMask)};else{if(!(e instanceof eu))return ko();n={verify:Fu(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((t=>function(t,e){const n=e.transform;if(n instanceof Oc)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof xc)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Lc)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Uc)return{fieldPath:e.field.canonicalString(),increment:n.yt};throw ko()}(0,t)))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Mu(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:ko()}(t,e.precondition)),n}(this.It,t)))};this.Bo(e)}}class Wh extends class{}{constructor(t,e,n,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.It=i,this.nu=!1}su(){if(this.nu)throw new No(Do.FAILED_PRECONDITION,"The client has already been terminated.")}ao(t,e,n){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,r])=>this.connection.ao(t,e,n,i,r))).catch((t=>{throw"FirebaseError"===t.name?(t.code===Do.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new No(Do.UNKNOWN,t.toString())}))}_o(t,e,n,i){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([r,s])=>this.connection._o(t,e,n,r,s,i))).catch((t=>{throw"FirebaseError"===t.name?(t.code===Do.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new No(Do.UNKNOWN,t.toString())}))}terminate(){this.nu=!0}}class Qh{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}uu(){0===this.iu&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.ru=null,this.au("Backend didn't respond within 10 seconds."),this.cu("Offline"),Promise.resolve()))))}hu(t){"Online"===this.state?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.cu("Offline")))}set(t){this.lu(),this.iu=0,"Online"===t&&(this.ou=!1),this.cu(t)}cu(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}au(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ou?(Io(e),this.ou=!1):To("OnlineStateTracker",e)}lu(){null!==this.ru&&(this.ru.cancel(),this.ru=null)}}class Xh{constructor(t,e,n,i,r){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=r,this.mu.qr((t=>{n.enqueueAndForget((async()=>{sl(this)&&(To("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=Ao(t);e._u.add(4),await Jh(e),e.gu.set("Unknown"),e._u.delete(4),await Yh(e)}(this))}))})),this.gu=new Qh(n,i)}}async function Yh(t){if(sl(t))for(const e of t.wu)await e(!0)}async function Jh(t){for(const e of t.wu)await e(!1)}function Zh(t,e){const n=Ao(t);n.du.has(e.targetId)||(n.du.set(e.targetId,e),rl(n)?il(n):Tl(n).ko()&&el(n,e))}function tl(t,e){const n=Ao(t),i=Tl(n);n.du.delete(e),i.ko()&&nl(n,e),0===n.du.size&&(i.ko()?i.Fo():sl(n)&&n.gu.set("Unknown"))}function el(t,e){t.yu.Mt(e.targetId),Tl(t).zo(e)}function nl(t,e){t.yu.Mt(e),Tl(t).Ho(e)}function il(t){t.yu=new ku({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),se:e=>t.du.get(e)||null}),Tl(t).start(),t.gu.uu()}function rl(t){return sl(t)&&!Tl(t).No()&&t.du.size>0}function sl(t){return 0===Ao(t)._u.size}function ol(t){t.yu=void 0}async function al(t){t.du.forEach(((e,n)=>{el(t,e)}))}async function cl(t,e){ol(t),rl(t)?(t.gu.hu(e),il(t)):t.gu.set("Unknown")}async function ul(t,e,n){if(t.gu.set("Online"),e instanceof Eu&&2===e.state&&e.cause)try{await async function(t,e){const n=e.cause;for(const i of e.targetIds)t.du.has(i)&&(await t.remoteSyncer.rejectListen(i,n),t.du.delete(i),t.yu.removeTarget(i))}(t,e)}catch(n){To("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await hl(t,n)}else if(e instanceof Tu?t.yu.Gt(e):e instanceof Iu?t.yu.Yt(e):t.yu.Wt(e),!n.isEqual(Ho.min()))try{const e=await Rh(t.localStore);n.compareTo(e)>=0&&await function(t,e){const n=t.yu.te(e);return n.targetChanges.forEach(((n,i)=>{if(n.resumeToken.approximateByteSize()>0){const r=t.du.get(i);r&&t.du.set(i,r.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((e=>{const n=t.du.get(e);if(!n)return;t.du.set(e,n.withResumeToken(pa.EMPTY_BYTE_STRING,n.snapshotVersion)),nl(t,e);const i=new sh(n.target,e,1,n.sequenceNumber);el(t,i)})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)}catch(e){To("RemoteStore","Failed to raise snapshot:",e),await hl(t,e)}}async function hl(t,e,n){if(!ia(e))throw e;t._u.add(1),await Jh(t),t.gu.set("Offline"),n||(n=()=>Rh(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{To("RemoteStore","Retrying IndexedDB access"),await n(),t._u.delete(1),await Yh(t)}))}function ll(t,e){return e().catch((n=>hl(t,n,e)))}async function dl(t){const e=Ao(t),n=Il(e);let i=e.fu.length>0?e.fu[e.fu.length-1].batchId:-1;for(;fl(e);)try{const t=await Oh(e.localStore,i);if(null===t){0===e.fu.length&&n.Fo();break}i=t.batchId,pl(e,t)}catch(t){await hl(e,t)}ml(e)&&gl(e)}function fl(t){return sl(t)&&t.fu.length<10}function pl(t,e){t.fu.push(e);const n=Il(t);n.ko()&&n.Yo&&n.Xo(e.mutations)}function ml(t){return sl(t)&&!Il(t).No()&&t.fu.length>0}function gl(t){Il(t).start()}async function yl(t){Il(t).eu()}async function vl(t){const e=Il(t);for(const n of t.fu)e.Xo(n.mutations)}async function _l(t,e,n){const i=t.fu.shift(),r=ih.from(i,e,n);await ll(t,(()=>t.remoteSyncer.applySuccessfulWrite(r))),await dl(t)}async function wl(t,e){e&&Il(t).Yo&&await async function(t,e){if(function(t){switch(t){default:return ko();case Do.CANCELLED:case Do.UNKNOWN:case Do.DEADLINE_EXCEEDED:case Do.RESOURCE_EXHAUSTED:case Do.INTERNAL:case Do.UNAVAILABLE:case Do.UNAUTHENTICATED:return!1;case Do.INVALID_ARGUMENT:case Do.NOT_FOUND:case Do.ALREADY_EXISTS:case Do.PERMISSION_DENIED:case Do.FAILED_PRECONDITION:case Do.ABORTED:case Do.OUT_OF_RANGE:case Do.UNIMPLEMENTED:case Do.DATA_LOSS:return!0}}(n=e.code)&&n!==Do.ABORTED){const n=t.fu.shift();Il(t).Mo(),await ll(t,(()=>t.remoteSyncer.rejectFailedWrite(n.batchId,e))),await dl(t)}var n}(t,e),ml(t)&&gl(t)}async function bl(t,e){const n=Ao(t);n.asyncQueue.verifyOperationInProgress(),To("RemoteStore","RemoteStore received new credentials");const i=sl(n);n._u.add(3),await Jh(n),i&&n.gu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n._u.delete(3),await Yh(n)}function Tl(t){return t.pu||(t.pu=function(t,e,n){const i=Ao(t);return i.su(),new Kh(e,i.connection,i.authCredentials,i.appCheckCredentials,i.It,n)}(t.datastore,t.asyncQueue,{Yr:al.bind(null,t),Zr:cl.bind(null,t),Wo:ul.bind(null,t)}),t.wu.push((async e=>{e?(t.pu.Mo(),rl(t)?il(t):t.gu.set("Unknown")):(await t.pu.stop(),ol(t))}))),t.pu}function Il(t){return t.Iu||(t.Iu=function(t,e,n){const i=Ao(t);return i.su(),new Gh(e,i.connection,i.authCredentials,i.appCheckCredentials,i.It,n)}(t.datastore,t.asyncQueue,{Yr:yl.bind(null,t),Zr:wl.bind(null,t),tu:vl.bind(null,t),Zo:_l.bind(null,t)}),t.wu.push((async e=>{e?(t.Iu.Mo(),await dl(t)):(await t.Iu.stop(),t.fu.length>0&&(To("RemoteStore",`Stopping write stream with ${t.fu.length} pending writes`),t.fu=[]))}))),t.Iu}class El{constructor(t,e,n,i,r){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=i,this.removalCallback=r,this.deferred=new Ro,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}static createAndSchedule(t,e,n,i,r){const s=Date.now()+n,o=new El(t,e,s,i,r);return o.start(n),o}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new No(Do.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Sl(t,e){if(Io("AsyncQueue",`${e}: ${t}`),ia(t))return new No(Do.UNAVAILABLE,`${e}: ${t}`);throw t}class kl{constructor(t){this.comparator=t?(e,n)=>t(e,n)||Xo.comparator(e.key,n.key):(t,e)=>Xo.comparator(t.key,e.key),this.keyedMap=hu(),this.sortedSet=new ca(this.comparator)}static emptySet(t){return new kl(t.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,n)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof kl))return!1;if(this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(!t.isEqual(i))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const n=new kl;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n}}class Cl{constructor(){this.Tu=new ca(Xo.comparator)}track(t){const e=t.doc.key,n=this.Tu.get(e);n?0!==t.type&&3===n.type?this.Tu=this.Tu.insert(e,t):3===t.type&&1!==n.type?this.Tu=this.Tu.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Tu=this.Tu.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Tu=this.Tu.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Tu=this.Tu.remove(e):1===t.type&&2===n.type?this.Tu=this.Tu.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Tu=this.Tu.insert(e,{type:2,doc:t.doc}):ko():this.Tu=this.Tu.insert(e,t)}Eu(){const t=[];return this.Tu.inorderTraversal(((e,n)=>{t.push(n)})),t}}class Al{constructor(t,e,n,i,r,s,o,a,c){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=r,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=c}static fromInitialDocuments(t,e,n,i,r){const s=[];return e.forEach((t=>{s.push({type:0,doc:t})})),new Al(t,e,kl.emptySet(e),s,n,i,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&_c(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let t=0;t<e.length;t++)if(e[t].type!==n[t].type||!e[t].doc.isEqual(n[t].doc))return!1;return!0}}class Dl{constructor(){this.Au=void 0,this.listeners=[]}}class Nl{constructor(){this.queries=new ou((t=>wc(t)),_c),this.onlineState="Unknown",this.Ru=new Set}}async function Rl(t,e){const n=Ao(t),i=e.query;let r=!1,s=n.queries.get(i);if(s||(r=!0,s=new Dl),r)try{s.Au=await n.onListen(i)}catch(t){const n=Sl(t,`Initialization of query '${bc(e.query)}' failed`);return void e.onError(n)}n.queries.set(i,s),s.listeners.push(e),e.bu(n.onlineState),s.Au&&e.Pu(s.Au)&&Ll(n)}async function Ol(t,e){const n=Ao(t),i=e.query;let r=!1;const s=n.queries.get(i);if(s){const t=s.listeners.indexOf(e);t>=0&&(s.listeners.splice(t,1),r=0===s.listeners.length)}if(r)return n.queries.delete(i),n.onUnlisten(i)}function xl(t,e){const n=Ao(t);let i=!1;for(const t of e){const e=t.query,r=n.queries.get(e);if(r){for(const e of r.listeners)e.Pu(t)&&(i=!0);r.Au=t}}i&&Ll(n)}function Ml(t,e,n){const i=Ao(t),r=i.queries.get(e);if(r)for(const t of r.listeners)t.onError(n);i.queries.delete(e)}function Ll(t){t.Ru.forEach((t=>{t.next()}))}class Pl{constructor(t,e,n){this.query=t,this.vu=e,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=n||{}}Pu(t){if(!this.options.includeMetadataChanges){const e=[];for(const n of t.docChanges)3!==n.type&&e.push(n);t=new Al(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Vu?this.Du(t)&&(this.vu.next(t),e=!0):this.Cu(t,this.onlineState)&&(this.xu(t),e=!0),this.Su=t,e}onError(t){this.vu.error(t)}bu(t){this.onlineState=t;let e=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,t)&&(this.xu(this.Su),e=!0),e}Cu(t,e){if(!t.fromCache)return!0;const n="Offline"!==e;return(!this.options.Nu||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||"Offline"===e)}Du(t){if(t.docChanges.length>0)return!0;const e=this.Su&&this.Su.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges}xu(t){t=Al.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Vu=!0,this.vu.next(t)}}class Ul{constructor(t){this.key=t}}class Fl{constructor(t){this.key=t}}class Vl{constructor(t,e){this.query=t,this.Uu=e,this.qu=null,this.hasCachedResults=!1,this.current=!1,this.Ku=yu(),this.mutatedKeys=yu(),this.Gu=Ic(t),this.Qu=new kl(this.Gu)}get ju(){return this.Uu}Wu(t,e){const n=e?e.zu:new Cl,i=e?e.Qu:this.Qu;let r=e?e.mutatedKeys:this.mutatedKeys,s=i,o=!1;const a="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal(((t,e)=>{const u=i.get(t),h=Tc(this.query,e)?e:null,l=!!u&&this.mutatedKeys.has(u.key),d=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations);let f=!1;u&&h?u.data.isEqual(h.data)?l!==d&&(n.track({type:3,doc:h}),f=!0):this.Hu(u,h)||(n.track({type:2,doc:h}),f=!0,(a&&this.Gu(h,a)>0||c&&this.Gu(h,c)<0)&&(o=!0)):!u&&h?(n.track({type:0,doc:h}),f=!0):u&&!h&&(n.track({type:1,doc:u}),f=!0,(a||c)&&(o=!0)),f&&(h?(s=s.add(h),r=d?r.add(t):r.delete(t)):(s=s.delete(t),r=r.delete(t)))})),null!==this.query.limit)for(;s.size>this.query.limit;){const t="F"===this.query.limitType?s.last():s.first();s=s.delete(t.key),r=r.delete(t.key),n.track({type:1,doc:t})}return{Qu:s,zu:n,$i:o,mutatedKeys:r}}Hu(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,n){const i=this.Qu;this.Qu=t.Qu,this.mutatedKeys=t.mutatedKeys;const r=t.zu.Eu();r.sort(((t,e)=>function(t,e){const n=t=>{switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ko()}};return n(t)-n(e)}(t.type,e.type)||this.Gu(t.doc,e.doc))),this.Ju(n);const s=e?this.Yu():[],o=0===this.Ku.size&&this.current?1:0,a=o!==this.qu;return this.qu=o,0!==r.length||a?{snapshot:new Al(this.query,t.Qu,i,r,t.mutatedKeys,0===o,a,!1,!!n&&n.resumeToken.approximateByteSize()>0),Xu:s}:{Xu:s}}bu(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new Cl,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Xu:[]}}Zu(t){return!this.Uu.has(t)&&!!this.Qu.has(t)&&!this.Qu.get(t).hasLocalMutations}Ju(t){t&&(t.addedDocuments.forEach((t=>this.Uu=this.Uu.add(t))),t.modifiedDocuments.forEach((t=>{})),t.removedDocuments.forEach((t=>this.Uu=this.Uu.delete(t))),this.current=t.current)}Yu(){if(!this.current)return[];const t=this.Ku;this.Ku=yu(),this.Qu.forEach((t=>{this.Zu(t.key)&&(this.Ku=this.Ku.add(t.key))}));const e=[];return t.forEach((t=>{this.Ku.has(t)||e.push(new Fl(t))})),this.Ku.forEach((n=>{t.has(n)||e.push(new Ul(n))})),e}tc(t){this.Uu=t.Hi,this.Ku=yu();const e=this.Wu(t.documents);return this.applyChanges(e,!0)}ec(){return Al.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,0===this.qu,this.hasCachedResults)}}class Bl{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class jl{constructor(t){this.key=t,this.nc=!1}}class ql{constructor(t,e,n,i,r,s){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=s,this.sc={},this.ic=new ou((t=>wc(t)),_c),this.rc=new Map,this.oc=new Set,this.uc=new ca(Xo.comparator),this.cc=new Map,this.ac=new vh,this.hc={},this.lc=new Map,this.fc=dh.vn(),this.onlineState="Unknown",this.dc=void 0}get isPrimaryClient(){return!0===this.dc}}async function zl(t,e){const n=function(t){const e=Ao(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Hl.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=sd.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Gl.bind(null,e),e.sc.Wo=xl.bind(null,e.eventManager),e.sc.wc=Ml.bind(null,e.eventManager),e}(t);let i,r;const s=n.ic.get(e);if(s)i=s.targetId,n.sharedClientState.addLocalQueryTarget(i),r=s.view.ec();else{const t=await function(t,e){const n=Ao(t);return n.persistence.runTransaction("Allocate target","readwrite",(t=>{let i;return n.Cs.getTargetData(t,e).next((r=>r?(i=r,na.resolve(i)):n.Cs.allocateTargetId(t).next((r=>(i=new sh(e,r,0,t.currentSequenceNumber),n.Cs.addTargetData(t,i).next((()=>i)))))))})).then((t=>{const i=n.Ui.get(t.targetId);return(null===i||t.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ui=n.Ui.insert(t.targetId,t),n.qi.set(e,t.targetId)),t}))}(n.localStore,yc(e));n.isPrimaryClient&&Zh(n.remoteStore,t);const s=n.sharedClientState.addLocalQueryTarget(t.targetId);i=t.targetId,r=await async function(t,e,n,i,r){t._c=(e,n,i)=>async function(t,e,n,i){let r=e.view.Wu(n);r.$i&&(r=await Mh(t.localStore,e.query,!1).then((({documents:t})=>e.view.Wu(t,r))));const s=i&&i.targetChanges.get(e.targetId),o=e.view.applyChanges(r,t.isPrimaryClient,s);return td(t,e.targetId,o.Xu),o.snapshot}(t,e,n,i);const s=await Mh(t.localStore,e,!0),o=new Vl(e,s.Hi),a=o.Wu(s.documents),c=bu.createSynthesizedTargetChangeForCurrentChange(n,i&&"Offline"!==t.onlineState,r),u=o.applyChanges(a,t.isPrimaryClient,c);td(t,n,u.Xu);const h=new Bl(e,n,o);return t.ic.set(e,h),t.rc.has(n)?t.rc.get(n).push(e):t.rc.set(n,[e]),u.snapshot}(n,e,i,"current"===s,t.resumeToken)}return r}async function $l(t,e){const n=Ao(t),i=n.ic.get(e),r=n.rc.get(i.targetId);if(r.length>1)return n.rc.set(i.targetId,r.filter((t=>!_c(t,e)))),void n.ic.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await xh(n.localStore,i.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(i.targetId),tl(n.remoteStore,i.targetId),Jl(n,i.targetId)})).catch(ea)):(Jl(n,i.targetId),await xh(n.localStore,i.targetId,!0))}async function Hl(t,e){const n=Ao(t);try{const t=await function(t,e){const n=Ao(t),i=e.snapshotVersion;let r=n.Ui;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(t=>{const s=n.Gi.newChangeBuffer({trackRemovals:!0});r=n.Ui;const o=[];e.targetChanges.forEach(((s,a)=>{const c=r.get(a);if(!c)return;o.push(n.Cs.removeMatchingKeys(t,s.removedDocuments,a).next((()=>n.Cs.addMatchingKeys(t,s.addedDocuments,a))));let u=c.withSequenceNumber(t.currentSequenceNumber);e.targetMismatches.has(a)?u=u.withResumeToken(pa.EMPTY_BYTE_STRING,Ho.min()).withLastLimboFreeSnapshotVersion(Ho.min()):s.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(s.resumeToken,i)),r=r.insert(a,u),function(t,e,n){return 0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,u,s)&&o.push(n.Cs.updateTargetData(t,u))}));let a=cu(),c=yu();if(e.documentUpdates.forEach((i=>{e.resolvedLimboDocuments.has(i)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(t,i))})),o.push(function(t,e,n){let i=yu(),r=yu();return n.forEach((t=>i=i.add(t))),e.getEntries(t,i).next((t=>{let i=cu();return n.forEach(((n,s)=>{const o=t.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(r=r.add(n)),s.isNoDocument()&&s.version.isEqual(Ho.min())?(e.removeEntry(n,s.readTime),i=i.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(e.addEntry(s),i=i.insert(n,s)):To("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)})),{Wi:i,zi:r}}))}(t,s,e.documentUpdates).next((t=>{a=t.Wi,c=t.zi}))),!i.isEqual(Ho.min())){const e=n.Cs.getLastRemoteSnapshotVersion(t).next((e=>n.Cs.setTargetsMetadata(t,t.currentSequenceNumber,i)));o.push(e)}return na.waitFor(o).next((()=>s.apply(t))).next((()=>n.localDocuments.getLocalViewOfDocuments(t,a,c))).next((()=>a))})).then((t=>(n.Ui=r,t)))}(n.localStore,e);e.targetChanges.forEach(((t,e)=>{const i=n.cc.get(e);i&&(Co(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?i.nc=!0:t.modifiedDocuments.size>0?Co(i.nc):t.removedDocuments.size>0&&(Co(i.nc),i.nc=!1))})),await id(n,t,e)}catch(t){await ea(t)}}function Kl(t,e,n){const i=Ao(t);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const t=[];i.ic.forEach(((n,i)=>{const r=i.view.bu(e);r.snapshot&&t.push(r.snapshot)})),function(t,e){const n=Ao(t);n.onlineState=e;let i=!1;n.queries.forEach(((t,n)=>{for(const t of n.listeners)t.bu(e)&&(i=!0)})),i&&Ll(n)}(i.eventManager,e),t.length&&i.sc.Wo(t),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function Gl(t,e,n){const i=Ao(t);i.sharedClientState.updateQueryState(e,"rejected",n);const r=i.cc.get(e),s=r&&r.key;if(s){let t=new ca(Xo.comparator);t=t.insert(s,$a.newNoDocument(s,Ho.min()));const n=yu().add(s),r=new wu(Ho.min(),new Map,new la(qo),t,n);await Hl(i,r),i.uc=i.uc.remove(s),i.cc.delete(e),nd(i)}else await xh(i.localStore,e,!1).then((()=>Jl(i,e,n))).catch(ea)}async function Wl(t,e){const n=Ao(t),i=e.batch.batchId;try{const t=await function(t,e){const n=Ao(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(t=>{const i=e.batch.keys(),r=n.Gi.newChangeBuffer({trackRemovals:!0});return function(t,e,n,i){const r=n.batch,s=r.keys();let o=na.resolve();return s.forEach((t=>{o=o.next((()=>i.getEntry(e,t))).next((e=>{const s=n.docVersions.get(t);Co(null!==s),e.version.compareTo(s)<0&&(r.applyToRemoteDocument(e,n),e.isValidDocument()&&(e.setReadTime(n.commitVersion),i.addEntry(e)))}))})),o.next((()=>t.mutationQueue.removeMutationBatch(e,r)))}(n,t,e,r).next((()=>r.apply(t))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,function(t){let e=yu();for(let n=0;n<t.mutationResults.length;++n)t.mutationResults[n].transformResults.length>0&&(e=e.add(t.batch.mutations[n].key));return e}(e)))).next((()=>n.localDocuments.getDocuments(t,i)))}))}(n.localStore,e);Yl(n,i,null),Xl(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await id(n,t)}catch(t){await ea(t)}}async function Ql(t,e,n){const i=Ao(t);try{const t=await function(t,e){const n=Ao(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(t=>{let i;return n.mutationQueue.lookupMutationBatch(t,e).next((e=>(Co(null!==e),i=e.keys(),n.mutationQueue.removeMutationBatch(t,e)))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,i))).next((()=>n.localDocuments.getDocuments(t,i)))}))}(i.localStore,e);Yl(i,e,n),Xl(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await id(i,t)}catch(n){await ea(n)}}function Xl(t,e){(t.lc.get(e)||[]).forEach((t=>{t.resolve()})),t.lc.delete(e)}function Yl(t,e,n){const i=Ao(t);let r=i.hc[i.currentUser.toKey()];if(r){const t=r.get(e);t&&(n?t.reject(n):t.resolve(),r=r.remove(e)),i.hc[i.currentUser.toKey()]=r}}function Jl(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const i of t.rc.get(e))t.ic.delete(i),n&&t.sc.wc(i,n);t.rc.delete(e),t.isPrimaryClient&&t.ac.ls(e).forEach((e=>{t.ac.containsKey(e)||Zl(t,e)}))}function Zl(t,e){t.oc.delete(e.path.canonicalString());const n=t.uc.get(e);null!==n&&(tl(t.remoteStore,n),t.uc=t.uc.remove(e),t.cc.delete(n),nd(t))}function td(t,e,n){for(const i of n)i instanceof Ul?(t.ac.addReference(i.key,e),ed(t,i)):i instanceof Fl?(To("SyncEngine","Document no longer in limbo: "+i.key),t.ac.removeReference(i.key,e),t.ac.containsKey(i.key)||Zl(t,i.key)):ko()}function ed(t,e){const n=e.key,i=n.path.canonicalString();t.uc.get(n)||t.oc.has(i)||(To("SyncEngine","New document in limbo: "+n),t.oc.add(i),nd(t))}function nd(t){for(;t.oc.size>0&&t.uc.size<t.maxConcurrentLimboResolutions;){const e=t.oc.values().next().value;t.oc.delete(e);const n=new Xo(Go.fromString(e)),i=t.fc.next();t.cc.set(i,new jl(n)),t.uc=t.uc.insert(n,i),Zh(t.remoteStore,new sh(yc(lc(n.path)),i,2,ra.at))}}async function id(t,e,n){const i=Ao(t),r=[],s=[],o=[];i.ic.isEmpty()||(i.ic.forEach(((t,a)=>{o.push(i._c(a,e,n).then((t=>{if((t||n)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(a.targetId,(null==t?void 0:t.fromCache)?"not-current":"current"),t){r.push(t);const e=Ch.Ci(a.targetId,t);s.push(e)}})))})),await Promise.all(o),i.sc.Wo(r),await async function(t,e){const n=Ao(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>na.forEach(e,(e=>na.forEach(e.Si,(i=>n.persistence.referenceDelegate.addReference(t,e.targetId,i))).next((()=>na.forEach(e.Di,(i=>n.persistence.referenceDelegate.removeReference(t,e.targetId,i)))))))))}catch(t){if(!ia(t))throw t;To("LocalStore","Failed to update sequence numbers: "+t)}for(const t of e){const e=t.targetId;if(!t.fromCache){const t=n.Ui.get(e),i=t.snapshotVersion,r=t.withLastLimboFreeSnapshotVersion(i);n.Ui=n.Ui.insert(e,r)}}}(i.localStore,s))}async function rd(t,e){const n=Ao(t);if(!n.currentUser.isEqual(e)){To("SyncEngine","User change. New user:",e.toKey());const t=await Nh(n.localStore,e);n.currentUser=e,function(t,e){t.lc.forEach((t=>{t.forEach((t=>{t.reject(new No(Do.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.lc.clear()}(n),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await id(n,t.ji)}}function sd(t,e){const n=Ao(t),i=n.cc.get(e);if(i&&i.nc)return yu().add(i.key);{let t=yu();const i=n.rc.get(e);if(!i)return t;for(const e of i){const i=n.ic.get(e);t=t.unionWith(i.view.ju)}return t}}function od(t){const e=Ao(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Wl.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Ql.bind(null,e),e}class ad{constructor(){this.synchronizeTabs=!1}async initialize(t){this.It=zh(t.databaseInfo.databaseId),this.sharedClientState=this.gc(t),this.persistence=this.yc(t),await this.persistence.start(),this.localStore=this.Ic(t),this.gcScheduler=this.Tc(t,this.localStore),this.indexBackfillerScheduler=this.Ec(t,this.localStore)}Tc(t,e){return null}Ec(t,e){return null}Ic(t){return function(t,e,n,i){return new Dh(t,e,n,i)}(this.persistence,new Ah,t.initialUser,this.It)}yc(t){return new Eh(kh.Bs,this.It)}gc(t){return new Ph}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class cd{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>Kl(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=rd.bind(null,this.syncEngine),await async function(t,e){const n=Ao(t);e?(n._u.delete(2),await Yh(n)):e||(n._u.add(2),await Jh(n),n.gu.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new Nl}createDatastore(t){const e=zh(t.databaseInfo.databaseId),n=(i=t.databaseInfo,new jh(i));var i;return function(t,e,n,i){return new Wh(t,e,n,i)}(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return e=this.localStore,n=this.datastore,i=t.asyncQueue,r=t=>Kl(this.syncEngine,t,0),s=Fh.C()?new Fh:new Uh,new Xh(e,n,i,r,s);var e,n,i,r,s}createSyncEngine(t,e){return function(t,e,n,i,r,s,o){const a=new ql(t,e,n,i,r,s);return o&&(a.dc=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return async function(t){const e=Ao(t);To("RemoteStore","RemoteStore shutting down."),e._u.add(5),await Jh(e),e.mu.shutdown(),e.gu.set("Unknown")}(this.remoteStore)}}function ud(t,e,n){if(!n)throw new No(Do.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function hd(t){if(!Xo.isDocumentKey(t))throw new No(Do.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function ld(t){if(Xo.isDocumentKey(t))throw new No(Do.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function dd(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":ko()}function fd(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new No(Do.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=dd(t);throw new No(Do.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}const pd=new Map;class md{constructor(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new No(Do.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new No(Do.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function(t,e,n,i){if(!0===e&&!0===i)throw new No(Do.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling)}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class gd{constructor(t,e,n,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new md({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new No(Do.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new No(Do.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new md(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new xo;switch(t.type){case"gapi":const e=t.client;return new Uo(e,t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new No(Do.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=pd.get(t);e&&(To("ComponentProvider","Removing Datastore"),pd.delete(t),e.terminate())}(this),Promise.resolve()}}class yd{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new _d(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new yd(this.firestore,t,this._key)}}class vd{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new vd(this.firestore,t,this._query)}}class _d extends vd{constructor(t,e,n){super(t,e,lc(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new yd(this.firestore,null,new Xo(t))}withConverter(t){return new _d(this.firestore,t,this._path)}}function wd(t,e,...n){if(t=E(t),ud("collection","path",e),t instanceof gd){const i=Go.fromString(e,...n);return ld(i),new _d(t,null,i)}{if(!(t instanceof yd||t instanceof _d))throw new No(Do.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(Go.fromString(e,...n));return ld(i),new _d(t.firestore,null,i)}}function bd(t,e,...n){if(t=E(t),1===arguments.length&&(e=jo.R()),ud("doc","path",e),t instanceof gd){const i=Go.fromString(e,...n);return hd(i),new yd(t,null,new Xo(i))}{if(!(t instanceof yd||t instanceof _d))throw new No(Do.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(Go.fromString(e,...n));return hd(i),new yd(t.firestore,t instanceof _d?t.converter:null,new Xo(i))}}class Td{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Rc(this.observer.next,t)}error(t){this.observer.error?this.Rc(this.observer.error,t):Io("Uncaught Error in snapshot listener:",t.toString())}bc(){this.muted=!0}Rc(t,e){this.muted||setTimeout((()=>{this.muted||t(e)}),0)}}class Id{constructor(t,e,n,i){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=i,this.user=vo.UNAUTHENTICATED,this.clientId=jo.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async t=>{To("FirestoreClient","Received user=",t.uid),await this.authCredentialListener(t),this.user=t})),this.appCheckCredentials.start(n,(t=>(To("FirestoreClient","Received new app check token=",t),this.appCheckCredentialListener(t,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new No(Do.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Ro;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=Sl(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function Ed(t,e){t.asyncQueue.verifyOperationInProgress();const n=await async function(t){return t.offlineComponents||(To("FirestoreClient","Using default OfflineComponentProvider"),await async function(t,e){t.asyncQueue.verifyOperationInProgress(),To("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener((async t=>{i.isEqual(t)||(await Nh(e.localStore,t),i=t)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t.offlineComponents=e}(t,new ad)),t.offlineComponents}(t);To("FirestoreClient","Initializing OnlineComponentProvider");const i=await t.getConfiguration();await e.initialize(n,i),t.setCredentialChangeListener((t=>bl(e.remoteStore,t))),t.setAppCheckTokenChangeListener(((t,n)=>bl(e.remoteStore,n))),t.onlineComponents=e}async function Sd(t){return t.onlineComponents||(To("FirestoreClient","Using default OnlineComponentProvider"),await Ed(t,new cd)),t.onlineComponents}async function kd(t){const e=await Sd(t),n=e.eventManager;return n.onListen=zl.bind(null,e.syncEngine),n.onUnlisten=$l.bind(null,e.syncEngine),n}class Cd{constructor(){this.Bc=Promise.resolve(),this.Lc=[],this.Uc=!1,this.qc=[],this.Kc=null,this.Gc=!1,this.Qc=!1,this.jc=[],this.xo=new $h(this,"async_queue_retry"),this.Wc=()=>{const t=qh();t&&To("AsyncQueue","Visibility state changed to "+t.visibilityState),this.xo.Po()};const t=qh();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Wc)}get isShuttingDown(){return this.Uc}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.zc(),this.Hc(t)}enterRestrictedMode(t){if(!this.Uc){this.Uc=!0,this.Qc=t||!1;const e=qh();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Wc)}}enqueue(t){if(this.zc(),this.Uc)return new Promise((()=>{}));const e=new Ro;return this.Hc((()=>this.Uc&&this.Qc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Lc.push(t),this.Jc())))}async Jc(){if(0!==this.Lc.length){try{await this.Lc[0](),this.Lc.shift(),this.xo.reset()}catch(t){if(!ia(t))throw t;To("AsyncQueue","Operation failed with retryable error: "+t)}this.Lc.length>0&&this.xo.Ro((()=>this.Jc()))}}Hc(t){const e=this.Bc.then((()=>(this.Gc=!0,t().catch((t=>{this.Kc=t,this.Gc=!1;const e=function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t);throw Io("INTERNAL UNHANDLED ERROR: ",e),t})).then((t=>(this.Gc=!1,t))))));return this.Bc=e,e}enqueueAfterDelay(t,e,n){this.zc(),this.jc.indexOf(t)>-1&&(e=0);const i=El.createAndSchedule(this,t,e,n,(t=>this.Yc(t)));return this.qc.push(i),i}zc(){this.Kc&&ko()}verifyOperationInProgress(){}async Xc(){let t;do{t=this.Bc,await t}while(t!==this.Bc)}Zc(t){for(const e of this.qc)if(e.timerId===t)return!0;return!1}ta(t){return this.Xc().then((()=>{this.qc.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this.qc)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.Xc()}))}ea(t){this.jc.push(t)}Yc(t){const e=this.qc.indexOf(t);this.qc.splice(e,1)}}function Ad(t){return function(t,e){if("object"!=typeof t||null===t)return!1;const n=t;for(const t of["next","error","complete"])if(t in n&&"function"==typeof n[t])return!0;return!1}(t)}class Dd extends gd{constructor(t,e,n,i){super(t,e,n,i),this.type="firestore",this._queue=new Cd,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Rd(this),this._firestoreClient.terminate()}}function Nd(t){return t._firestoreClient||Rd(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Rd(t){var e;const n=t._freezeSettings(),i=function(t,e,n,i){return new Ta(t,e,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,i.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new Id(t._authCredentials,t._appCheckCredentials,t._queue,i)}class Od{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Od(pa.fromBase64String(t))}catch(t){throw new No(Do.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new Od(pa.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class xd{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new No(Do.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Qo(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class Md{constructor(t){this._methodName=t}}class Ld{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new No(Do.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new No(Do.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return qo(this._lat,t._lat)||qo(this._long,t._long)}}const Pd=/^__.*__$/;class Ud{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return null!==this.fieldMask?new Xc(t,this.data,this.fieldMask,e,this.fieldTransforms):new Qc(t,this.data,e,this.fieldTransforms)}}class Fd{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return new Xc(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function Vd(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ko()}}class Bd{constructor(t,e,n,i,r,s){this.settings=t,this.databaseId=e,this.It=n,this.ignoreUndefinedProperties=i,void 0===r&&this.na(),this.fieldTransforms=r||[],this.fieldMask=s||[]}get path(){return this.settings.path}get sa(){return this.settings.sa}ia(t){return new Bd(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.It,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ra(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.ia({path:n,oa:!1});return i.ua(t),i}ca(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.ia({path:n,oa:!1});return i.na(),i}aa(t){return this.ia({path:void 0,oa:!0})}ha(t){return Jd(t,this.settings.methodName,this.settings.la||!1,this.path,this.settings.fa)}contains(t){return void 0!==this.fieldMask.find((e=>t.isPrefixOf(e)))||void 0!==this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))}na(){if(this.path)for(let t=0;t<this.path.length;t++)this.ua(this.path.get(t))}ua(t){if(0===t.length)throw this.ha("Document fields must not be empty");if(Vd(this.sa)&&Pd.test(t))throw this.ha('Document fields cannot begin and end with "__"')}}class jd{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.It=n||zh(t)}da(t,e,n,i=!1){return new Bd({sa:t,methodName:e,fa:n,path:Qo.emptyPath(),oa:!1,la:i},this.databaseId,this.It,this.ignoreUndefinedProperties)}}function qd(t){const e=t._freezeSettings(),n=zh(t._databaseId);return new jd(t._databaseId,!!e.ignoreUndefinedProperties,n)}function zd(t,e,n,i,r,s={}){const o=t.da(s.merge||s.mergeFields?2:0,e,n,r);Wd("Data must be an object, but it was:",o,i);const a=Kd(i,o);let c,u;if(s.merge)c=new fa(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const t=[];for(const i of s.mergeFields){const r=Qd(e,i,n);if(!o.contains(r))throw new No(Do.INVALID_ARGUMENT,`Field '${r}' is specified in your field mask but missing from your input data.`);Zd(t,r)||t.push(r)}c=new fa(t),u=o.fieldTransforms.filter((t=>c.covers(t.field)))}else c=null,u=o.fieldTransforms;return new Ud(new qa(a),c,u)}class $d extends Md{_toFieldTransform(t){if(2!==t.sa)throw 1===t.sa?t.ha(`${this._methodName}() can only appear at the top level of your update data`):t.ha(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof $d}}function Hd(t,e){if(Gd(t=E(t)))return Wd("Unsupported field value:",e,t),Kd(t,e);if(t instanceof Md)return function(t,e){if(!Vd(e.sa))throw e.ha(`${t._methodName}() can only be used with update() and set()`);if(!e.path)throw e.ha(`${t._methodName}() is not currently supported inside arrays`);const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.oa&&4!==e.sa)throw e.ha("Nested arrays are not supported");return function(t,e){const n=[];let i=0;for(const r of t){let t=Hd(r,e.aa(i));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),i++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=E(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Cc(e.It,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=$o.fromDate(t);return{timestampValue:Ou(e.It,n)}}if(t instanceof $o){const n=new $o(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Ou(e.It,n)}}if(t instanceof Ld)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Od)return{bytesValue:xu(e.It,t._byteString)};if(t instanceof yd){const n=e.databaseId,i=t.firestore._databaseId;if(!i.isEqual(n))throw e.ha(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Pu(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.ha(`Unsupported field value: ${dd(t)}`)}(t,e)}function Kd(t,e){const n={};return aa(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):oa(t,((t,i)=>{const r=Hd(i,e.ra(t));null!=r&&(n[t]=r)})),{mapValue:{fields:n}}}function Gd(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof $o||t instanceof Ld||t instanceof Od||t instanceof yd||t instanceof Md)}function Wd(t,e,n){if(!Gd(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const i=dd(n);throw"an object"===i?e.ha(t+" a custom object"):e.ha(t+" "+i)}}function Qd(t,e,n){if((e=E(e))instanceof xd)return e._internalPath;if("string"==typeof e)return Yd(t,e);throw Jd("Field path arguments must be of type string or ",t,!1,void 0,n)}const Xd=new RegExp("[~\\*/\\[\\]]");function Yd(t,e,n){if(e.search(Xd)>=0)throw Jd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new xd(...e.split("."))._internalPath}catch(i){throw Jd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Jd(t,e,n,i,r){const s=i&&!i.isEmpty(),o=void 0!==r;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${i}`),o&&(c+=` in document ${r}`),c+=")"),new No(Do.INVALID_ARGUMENT,a+t+c)}function Zd(t,e){return t.some((t=>t.isEqual(e)))}class tf{constructor(t,e,n,i,r){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=i,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new yd(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new ef(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(nf("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class ef extends tf{data(){return super.data()}}function nf(t,e){return"string"==typeof e?Yd(t,e):e instanceof xd?e._internalPath:e._delegate._internalPath}class rf{}class sf extends rf{constructor(t,e,n){super(),this.ma=t,this.ga=e,this.ya=n,this.type="where"}_apply(t){const e=qd(t.firestore),n=function(t,e,n,i,r,s,o){let a;if(r.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new No(Do.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){cf(o,s);const e=[];for(const n of o)e.push(af(i,t,n));a={arrayValue:{values:e}}}else a=af(i,t,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||cf(o,s),a=function(t,e,n,i=!1){return Hd(n,t.da(i?4:3,e))}(n,"where",o,"in"===s||"not-in"===s);const c=Xa.create(r,s,a);return function(t,e){if(e.dt()){const n=pc(t);if(null!==n&&!n.isEqual(e.field))throw new No(Do.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${e.field.toString()}'`);const i=fc(t);null!==i&&uf(0,e.field,i)}const n=function(t,e){for(const n of t.filters)if(e.indexOf(n.op)>=0)return n.op;return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==n)throw n===e.op?new No(Do.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new No(Do.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}(t,c),c}(t._query,0,e,t.firestore._databaseId,this.ma,this.ga,this.ya);return new vd(t.firestore,t.converter,function(t,e){const n=t.filters.concat([e]);return new hc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))}}class of extends rf{constructor(t,e){super(),this.ma=t,this.pa=e,this.type="orderBy"}_apply(t){const e=function(t,e,n){if(null!==t.startAt)throw new No(Do.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new No(Do.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const i=new oc(e,n);return function(t,e){if(null===fc(t)){const n=pc(t);null!==n&&uf(0,n,e.field)}}(t,i),i}(t._query,this.ma,this.pa);return new vd(t.firestore,t.converter,function(t,e){const n=t.explicitOrderBy.concat([e]);return new hc(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))}}function af(t,e,n){if("string"==typeof(n=E(n))){if(""===n)throw new No(Do.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!mc(e)&&-1!==n.indexOf("/"))throw new No(Do.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=e.path.child(Go.fromString(n));if(!Xo.isDocumentKey(i))throw new No(Do.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Ma(t,new Xo(i))}if(n instanceof yd)return Ma(t,n._key);throw new No(Do.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${dd(n)}.`)}function cf(t,e){if(!Array.isArray(t)||0===t.length)throw new No(Do.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(t.length>10)throw new No(Do.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function uf(t,e,n){if(!n.isEqual(e))throw new No(Do.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}class hf{convertValue(t,e="none"){switch(Ca(t)){case 0:return null;case 1:return t.booleanValue;case 2:return ya(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(va(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw ko()}}convertObject(t,e){const n={};return oa(t.fields,((t,i)=>{n[t]=this.convertValue(i,e)})),n}convertGeoPoint(t){return new Ld(ya(t.latitude),ya(t.longitude))}convertArray(t,e){return(t.values||[]).map((t=>this.convertValue(t,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const n=wa(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(ba(t));default:return null}}convertTimestamp(t){const e=ga(t);return new $o(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=Go.fromString(t);Co(eh(n));const i=new Ia(n.get(1),n.get(3)),r=new Xo(n.popFirst(5));return i.isEqual(e)||Io(`Document ${r} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),r}}class lf{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class df extends tf{constructor(t,e,n,i,r,s){super(t,e,n,i,s),this._firestore=t,this._firestoreImpl=t,this.metadata=r}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new ff(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const n=this._document.data.field(nf("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}}class ff extends df{data(t={}){return super.data(t)}}class pf{constructor(t,e,n,i){this._firestore=t,this._userDataWriter=e,this._snapshot=i,this.metadata=new lf(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach((n=>{t.call(e,new ff(this._firestore,this._userDataWriter,n.key,n,new lf(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new No(Do.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){let e=0;return t._snapshot.docChanges.map((n=>{const i=new ff(t._firestore,t._userDataWriter,n.doc.key,n.doc,new lf(t._snapshot.mutatedKeys.has(n.doc.key),t._snapshot.fromCache),t.query.converter);return n.doc,{type:"added",doc:i,oldIndex:-1,newIndex:e++}}))}{let n=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((t=>e||3!==t.type)).map((e=>{const i=new ff(t._firestore,t._userDataWriter,e.doc.key,e.doc,new lf(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter);let r=-1,s=-1;return 0!==e.type&&(r=n.indexOf(e.doc.key),n=n.delete(e.doc.key)),1!==e.type&&(n=n.add(e.doc),s=n.indexOf(e.doc.key)),{type:mf(e.type),doc:i,oldIndex:r,newIndex:s}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function mf(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ko()}}class gf extends hf{constructor(t){super(),this.firestore=t}convertBytes(t){return new Od(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new yd(this.firestore,null,e)}}function yf(t,e){const n=fd(t.firestore,Dd),i=bd(t),r=function(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}(t.converter,e);return _f(n,[zd(qd(t.firestore),"addDoc",i._key,r,null!==t.converter,{}).toMutation(i._key,jc.exists(!1))]).then((()=>i))}function vf(t,...e){var n,i,r;t=E(t);let s={includeMetadataChanges:!1},o=0;"object"!=typeof e[o]||Ad(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(Ad(e[o])){const t=e[o];e[o]=null===(n=t.next)||void 0===n?void 0:n.bind(t),e[o+1]=null===(i=t.error)||void 0===i?void 0:i.bind(t),e[o+2]=null===(r=t.complete)||void 0===r?void 0:r.bind(t)}let c,u,h;if(t instanceof yd)u=fd(t.firestore,Dd),h=lc(t._key.path),c={next:n=>{e[o]&&e[o](wf(u,t,n))},error:e[o+1],complete:e[o+2]};else{const n=fd(t,vd);u=fd(n.firestore,Dd),h=n._query;const i=new gf(u);c={next:t=>{e[o]&&e[o](new pf(u,i,n,t))},error:e[o+1],complete:e[o+2]},function(t){if("L"===t.limitType&&0===t.explicitOrderBy.length)throw new No(Do.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(t._query)}return function(t,e,n,i){const r=new Td(i),s=new Pl(e,r,n);return t.asyncQueue.enqueueAndForget((async()=>Rl(await kd(t),s))),()=>{r.bc(),t.asyncQueue.enqueueAndForget((async()=>Ol(await kd(t),s)))}}(Nd(u),h,a,c)}function _f(t,e){return function(t,e){const n=new Ro;return t.asyncQueue.enqueueAndForget((async()=>async function(t,e,n){const i=od(t);try{const t=await function(t,e){const n=Ao(t),i=$o.now(),r=e.reduce(((t,e)=>t.add(e.key)),yu());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(t=>{let a=cu(),c=yu();return n.Gi.getEntries(t,r).next((t=>{a=t,a.forEach(((t,e)=>{e.isValidDocument()||(c=c.add(t))}))})).next((()=>n.localDocuments.getOverlayedDocuments(t,a))).next((r=>{s=r;const o=[];for(const t of e){const e=Gc(t,s.get(t.key).overlayedDocument);null!=e&&o.push(new Xc(t.key,e,za(e.value.mapValue),jc.exists(!0)))}return n.mutationQueue.addMutationBatch(t,i,o,e)})).next((e=>{o=e;const i=e.applyToLocalDocumentSet(s,c);return n.documentOverlayCache.saveOverlays(t,e.batchId,i)}))})).then((()=>({batchId:o.batchId,changes:lu(s)})))}(i.localStore,e);i.sharedClientState.addPendingMutation(t.batchId),function(t,e,n){let i=t.hc[t.currentUser.toKey()];i||(i=new ca(qo)),i=i.insert(e,n),t.hc[t.currentUser.toKey()]=i}(i,t.batchId,n),await id(i,t.changes),await dl(i.remoteStore)}catch(t){const e=Sl(t,"Failed to persist write");n.reject(e)}}(await function(t){return Sd(t).then((t=>t.syncEngine))}(t),e,n))),n.promise}(Nd(t),e)}function wf(t,e,n){const i=n.docs.get(e._key),r=new gf(t);return new df(t,r,e._key,i,new lf(n.hasPendingWrites,n.fromCache),e.converter)}!function(t,e=!0){_o="9.14.0",ut(new S("firestore",((t,{instanceIdentifier:n,options:i})=>{const r=t.getProvider("app").getImmediate(),s=new Dd(new Lo(t.getProvider("auth-internal")),new Vo(t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new No(Do.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ia(t.options.projectId,e)}(r,n),r);return i=Object.assign({useFetchStreams:e},i),s._setSettings(i),s}),"PUBLIC").setMultipleInstances(!0)),gt(yo,"3.7.3",t),gt(yo,"3.7.3","esm2017")}();const bf=t=>{let e=t.toDate().getHours(),n=t.toDate().getMinutes();return parseInt(e)<10&&(e=`0${e}`),parseInt(n)<10&&(n=`0${n}`),`${e}h ${n}`};var Tf=function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};const If=function(t,e){const n="string"==typeof t?t:"(default)",r=ht("object"==typeof t?t:mt(),"firestore").getImmediate({identifier:n});if(!r._initialized){const t=(t=>{const e=h("firestore");if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return"["===e[0]?[e.substring(1,n-1),i]:[e.substring(0,n),i]})();t&&function(t,e,n,r={}){var s;const o=(t=fd(t,gd))._getSettings();if("firestore.googleapis.com"!==o.host&&o.host!==e&&Eo("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},o),{host:`${e}:${n}`,ssl:!1})),r.mockUserToken){let e,n;if("string"==typeof r.mockUserToken)e=r.mockUserToken,n=vo.MOCK_USER;else{e=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",r=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[i(JSON.stringify({alg:"none",type:"JWT"})),i(JSON.stringify(o)),""].join(".")}(r.mockUserToken,null===(s=t._app)||void 0===s?void 0:s.options.projectId);const o=r.mockUserToken.sub||r.mockUserToken.user_id;if(!o)throw new No(Do.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new vo(o)}t._authCredentials=new Mo(new Oo(e,n))}}(r,...t)}return r}(Ne);let Ef=wd(If,"chatrooms"),Sf=wd(If,"messages");const kf=t=>Tf(void 0,void 0,void 0,(function*(){const e=bd(If,"chatrooms",t),n=yield function(t){t=fd(t,yd);const e=fd(t.firestore,Dd);return function(t,e,n={}){const i=new Ro;return t.asyncQueue.enqueueAndForget((async()=>function(t,e,n,i,r){const s=new Td({next:s=>{e.enqueueAndForget((()=>Ol(t,o)));const a=s.docs.has(n);!a&&s.fromCache?r.reject(new No(Do.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&s.fromCache&&i&&"server"===i.source?r.reject(new No(Do.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):r.resolve(s)},error:t=>r.reject(t)}),o=new Pl(lc(n.path),s,{includeMetadataChanges:!0,Nu:!0});return Rl(t,o)}(await kd(t),t.asyncQueue,e,n,i))),i.promise}(Nd(e),t._key).then((n=>wf(e,t,n)))}(e);var i;i=n.data(),un.className="",un.classList.add("chat__messages",`chat__messages--${i.theme}`),cn.innerHTML=i.name,an.innerHTML=i.activeUsers})),Cf=(t,e)=>Tf(void 0,void 0,void 0,(function*(){const n=bd(If,"chatrooms",t);yield function(t,e,n,...i){t=fd(t,yd);const r=fd(t.firestore,Dd),s=qd(r);let o;return o="string"==typeof(e=E(e))||e instanceof xd?function(t,e,n,i,r,s){const o=t.da(1,e,n),a=[Qd(e,i,n)],c=[r];if(s.length%2!=0)throw new No(Do.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let t=0;t<s.length;t+=2)a.push(Qd(e,s[t])),c.push(s[t+1]);const u=[],h=qa.empty();for(let t=a.length-1;t>=0;--t)if(!Zd(u,a[t])){const e=a[t];let n=c[t];n=E(n);const i=o.ca(e);if(n instanceof $d)u.push(e);else{const t=Hd(n,i);null!=t&&(u.push(e),h.set(e,t))}}const l=new fa(u);return new Fd(h,l,o.fieldTransforms)}(s,"updateDoc",t._key,e,n,i):function(t,e,n,i){const r=t.da(1,e,n);Wd("Data must be an object, but it was:",r,i);const s=[],o=qa.empty();oa(i,((t,i)=>{const a=Yd(e,t,n);i=E(i);const c=r.ca(a);if(i instanceof $d)s.push(a);else{const t=Hd(i,c);null!=t&&(s.push(a),o.set(a,t))}}));const a=new fa(s);return new Fd(o,a,r.fieldTransforms)}(s,"updateDoc",t._key,e),_f(r,[o.toMutation(t._key,jc.exists(!0))])}(n,{lastMessage:e.message,timeOfLastMessage:bf(e.timestamp)})})),Af=t=>Tf(void 0,void 0,void 0,(function*(){const e=function(t,...e){for(const n of e)t=n._apply(t);return t}(Sf,function(t,e,n){const i=nf("where","chatroomId");return new sf(i,"==",n)}(0,0,t),function(t,e="asc"){const n=e,i=nf("orderBy","timestamp");return new of(i,n)}());vf(e,(t=>{un.innerHTML="",t.forEach((t=>{(t=>{let e=document.createElement("li");t.user==sessionStorage.getItem("userId")?e.classList.add("chat__message--owned"):e.classList.add("chat__message"),e.innerHTML=`\n        <p class="chat__message-content">${t.message}</p>\n        <p class="chat__message-timestamp extra-subtle">${bf(t.timestamp)}</p>\n    `,un.appendChild(e),Cf(sessionStorage.getItem("currentChatroomId"),t)})(t.data())}))}))}));function Df(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Nf(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var Rf,Of,xf,Mf,Lf,Pf,Uf,Ff,Vf,Bf,jf,qf,zf,$f,Hf,Kf={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Gf={duration:.5,overwrite:!1,delay:0},Wf=1e8,Qf=1e-8,Xf=2*Math.PI,Yf=Xf/4,Jf=0,Zf=Math.sqrt,tp=Math.cos,ep=Math.sin,np=function(t){return"string"==typeof t},ip=function(t){return"function"==typeof t},rp=function(t){return"number"==typeof t},sp=function(t){return void 0===t},op=function(t){return"object"==typeof t},ap=function(t){return!1!==t},cp=function(){return"undefined"!=typeof window},up=function(t){return ip(t)||np(t)},hp="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},lp=Array.isArray,dp=/(?:-?\.?\d|\.)+/gi,fp=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,pp=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,mp=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,gp=/[+-]=-?[.\d]+/,yp=/[^,'"\[\]\s]+/gi,vp=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,_p={},wp={},bp=function(t){return(wp=Xp(t,_p))&&Qg},Tp=function(t,e){return console.warn("Invalid property",t,"set to",e,"Missing plugin? gsap.registerPlugin()")},Ip=function(t,e){return!e&&console.warn(t)},Ep=function(t,e){return t&&(_p[t]=e)&&wp&&(wp[t]=e)||_p},Sp=function(){return 0},kp={suppressEvents:!0,isStart:!0,kill:!1},Cp={suppressEvents:!0,kill:!1},Ap={suppressEvents:!0},Dp={},Np=[],Rp={},Op={},xp={},Mp=30,Lp=[],Pp="",Up=function(t){var e,n,i=t[0];if(op(i)||ip(i)||(t=[t]),!(e=(i._gsap||{}).harness)){for(n=Lp.length;n--&&!Lp[n].targetTest(i););e=Lp[n]}for(n=t.length;n--;)t[n]&&(t[n]._gsap||(t[n]._gsap=new hg(t[n],e)))||t.splice(n,1);return t},Fp=function(t){return t._gsap||Up(Am(t))[0]._gsap},Vp=function(t,e,n){return(n=t[e])&&ip(n)?t[e]():sp(n)&&t.getAttribute&&t.getAttribute(e)||n},Bp=function(t,e){return(t=t.split(",")).forEach(e)||t},jp=function(t){return Math.round(1e5*t)/1e5||0},qp=function(t){return Math.round(1e7*t)/1e7||0},zp=function(t,e){var n=e.charAt(0),i=parseFloat(e.substr(2));return t=parseFloat(t),"+"===n?t+i:"-"===n?t-i:"*"===n?t*i:t/i},$p=function(t,e){for(var n=e.length,i=0;t.indexOf(e[i])<0&&++i<n;);return i<n},Hp=function(){var t,e,n=Np.length,i=Np.slice(0);for(Rp={},Np.length=0,t=0;t<n;t++)(e=i[t])&&e._lazy&&(e.render(e._lazy[0],e._lazy[1],!0)._lazy=0)},Kp=function(t,e,n,i){Np.length&&Hp(),t.render(e,n,i||Of&&e<0&&(t._initted||t._startAt)),Np.length&&Hp()},Gp=function(t){var e=parseFloat(t);return(e||0===e)&&(t+"").match(yp).length<2?e:np(t)?t.trim():t},Wp=function(t){return t},Qp=function(t,e){for(var n in e)n in t||(t[n]=e[n]);return t},Xp=function(t,e){for(var n in e)t[n]=e[n];return t},Yp=function t(e,n){for(var i in n)"__proto__"!==i&&"constructor"!==i&&"prototype"!==i&&(e[i]=op(n[i])?t(e[i]||(e[i]={}),n[i]):n[i]);return e},Jp=function(t,e){var n,i={};for(n in t)n in e||(i[n]=t[n]);return i},Zp=function(t){var e,n=t.parent||Mf,i=t.keyframes?(e=lp(t.keyframes),function(t,n){for(var i in n)i in t||"duration"===i&&e||"ease"===i||(t[i]=n[i])}):Qp;if(ap(t.inherit))for(;n;)i(t,n.vars.defaults),n=n.parent||n._dp;return t},tm=function(t,e,n,i,r){void 0===n&&(n="_first"),void 0===i&&(i="_last");var s,o=t[i];if(r)for(s=e[r];o&&o[r]>s;)o=o._prev;return o?(e._next=o._next,o._next=e):(e._next=t[n],t[n]=e),e._next?e._next._prev=e:t[i]=e,e._prev=o,e.parent=e._dp=t,e},em=function(t,e,n,i){void 0===n&&(n="_first"),void 0===i&&(i="_last");var r=e._prev,s=e._next;r?r._next=s:t[n]===e&&(t[n]=s),s?s._prev=r:t[i]===e&&(t[i]=r),e._next=e._prev=e.parent=null},nm=function(t,e){t.parent&&(!e||t.parent.autoRemoveChildren)&&t.parent.remove(t),t._act=0},im=function(t,e){if(t&&(!e||e._end>t._dur||e._start<0))for(var n=t;n;)n._dirty=1,n=n.parent;return t},rm=function(t){for(var e=t.parent;e&&e.parent;)e._dirty=1,e.totalDuration(),e=e.parent;return t},sm=function(t,e,n,i){return t._startAt&&(Of?t._startAt.revert(Cp):t.vars.immediateRender&&!t.vars.autoRevert||t._startAt.render(e,!0,i))},om=function t(e){return!e||e._ts&&t(e.parent)},am=function(t){return t._repeat?cm(t._tTime,t=t.duration()+t._rDelay)*t:0},cm=function(t,e){var n=Math.floor(t/=e);return t&&n===t?n-1:n},um=function(t,e){return(t-e._start)*e._ts+(e._ts>=0?0:e._dirty?e.totalDuration():e._tDur)},hm=function(t){return t._end=qp(t._start+(t._tDur/Math.abs(t._ts||t._rts||Qf)||0))},lm=function(t,e){var n=t._dp;return n&&n.smoothChildTiming&&t._ts&&(t._start=qp(n._time-(t._ts>0?e/t._ts:((t._dirty?t.totalDuration():t._tDur)-e)/-t._ts)),hm(t),n._dirty||im(n,t)),t},dm=function(t,e){var n;if((e._time||e._initted&&!e._dur)&&(n=um(t.rawTime(),e),(!e._dur||Em(0,e.totalDuration(),n)-e._tTime>Qf)&&e.render(n,!0)),im(t,e)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(n=t;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;t._zTime=-1e-8}},fm=function(t,e,n,i){return e.parent&&nm(e),e._start=qp((rp(n)?n:n||t!==Mf?bm(t,n,e):t._time)+e._delay),e._end=qp(e._start+(e.totalDuration()/Math.abs(e.timeScale())||0)),tm(t,e,"_first","_last",t._sort?"_start":0),ym(e)||(t._recent=e),i||dm(t,e),t._ts<0&&lm(t,t._tTime),t},pm=function(t,e){return(_p.ScrollTrigger||Tp("scrollTrigger",e))&&_p.ScrollTrigger.create(e,t)},mm=function(t,e,n,i,r){return vg(t,e,r),t._initted?!n&&t._pt&&!Of&&(t._dur&&!1!==t.vars.lazy||!t._dur&&t.vars.lazy)&&Vf!==Ym.frame?(Np.push(t),t._lazy=[r,i],1):void 0:1},gm=function t(e){var n=e.parent;return n&&n._ts&&n._initted&&!n._lock&&(n.rawTime()<0||t(n))},ym=function(t){var e=t.data;return"isFromStart"===e||"isStart"===e},vm=function(t,e,n,i){var r=t._repeat,s=qp(e)||0,o=t._tTime/t._tDur;return o&&!i&&(t._time*=s/t._dur),t._dur=s,t._tDur=r?r<0?1e10:qp(s*(r+1)+t._rDelay*r):s,o>0&&!i&&lm(t,t._tTime=t._tDur*o),t.parent&&hm(t),n||im(t.parent,t),t},_m=function(t){return t instanceof dg?im(t):vm(t,t._dur)},wm={_start:0,endTime:Sp,totalDuration:Sp},bm=function t(e,n,i){var r,s,o,a=e.labels,c=e._recent||wm,u=e.duration()>=Wf?c.endTime(!1):e._dur;return np(n)&&(isNaN(n)||n in a)?(s=n.charAt(0),o="%"===n.substr(-1),r=n.indexOf("="),"<"===s||">"===s?(r>=0&&(n=n.replace(/=/,"")),("<"===s?c._start:c.endTime(c._repeat>=0))+(parseFloat(n.substr(1))||0)*(o?(r<0?c:i).totalDuration()/100:1)):r<0?(n in a||(a[n]=u),a[n]):(s=parseFloat(n.charAt(r-1)+n.substr(r+1)),o&&i&&(s=s/100*(lp(i)?i[0]:i).totalDuration()),r>1?t(e,n.substr(0,r-1),i)+s:u+s)):null==n?u:+n},Tm=function(t,e,n){var i,r,s=rp(e[1]),o=(s?2:1)+(t<2?0:1),a=e[o];if(s&&(a.duration=e[1]),a.parent=n,t){for(i=a,r=n;r&&!("immediateRender"in i);)i=r.vars.defaults||{},r=ap(r.vars.inherit)&&r.parent;a.immediateRender=ap(i.immediateRender),t<2?a.runBackwards=1:a.startAt=e[o-1]}return new Ig(e[0],a,e[o+1])},Im=function(t,e){return t||0===t?e(t):e},Em=function(t,e,n){return n<t?t:n>e?e:n},Sm=function(t,e){return np(t)&&(e=vp.exec(t))?e[1]:""},km=[].slice,Cm=function(t,e){return t&&op(t)&&"length"in t&&(!e&&!t.length||t.length-1 in t&&op(t[0]))&&!t.nodeType&&t!==Lf},Am=function(t,e,n){return xf&&!e&&xf.selector?xf.selector(t):!np(t)||n||!Pf&&Jm()?lp(t)?function(t,e,n){return void 0===n&&(n=[]),t.forEach((function(t){var i;return np(t)&&!e||Cm(t,1)?(i=n).push.apply(i,Am(t)):n.push(t)}))||n}(t,n):Cm(t)?km.call(t,0):t?[t]:[]:km.call((e||Uf).querySelectorAll(t),0)},Dm=function(t){return t=Am(t)[0]||Ip("Invalid scope")||{},function(e){var n=t.current||t.nativeElement||t;return Am(e,n.querySelectorAll?n:n===t?Ip("Invalid scope")||Uf.createElement("div"):t)}},Nm=function(t){return t.sort((function(){return.5-Math.random()}))},Rm=function(t){if(ip(t))return t;var e=op(t)?t:{each:t},n=sg(e.ease),i=e.from||0,r=parseFloat(e.base)||0,s={},o=i>0&&i<1,a=isNaN(i)||o,c=e.axis,u=i,h=i;return np(i)?u=h={center:.5,edges:.5,end:1}[i]||0:!o&&a&&(u=i[0],h=i[1]),function(t,o,l){var d,f,p,m,g,y,v,_,w,b=(l||e).length,T=s[b];if(!T){if(!(w="auto"===e.grid?0:(e.grid||[1,Wf])[1])){for(v=-Wf;v<(v=l[w++].getBoundingClientRect().left)&&w<b;);w--}for(T=s[b]=[],d=a?Math.min(w,b)*u-.5:i%w,f=w===Wf?0:a?b*h/w-.5:i/w|0,v=0,_=Wf,y=0;y<b;y++)p=y%w-d,m=f-(y/w|0),T[y]=g=c?Math.abs("y"===c?m:p):Zf(p*p+m*m),g>v&&(v=g),g<_&&(_=g);"random"===i&&Nm(T),T.max=v-_,T.min=_,T.v=b=(parseFloat(e.amount)||parseFloat(e.each)*(w>b?b-1:c?"y"===c?b/w:w:Math.max(w,b/w))||0)*("edges"===i?-1:1),T.b=b<0?r-b:r,T.u=Sm(e.amount||e.each)||0,n=n&&b<0?ig(n):n}return b=(T[t]-T.min)/T.max||0,qp(T.b+(n?n(b):b)*T.v)+T.u}},Om=function(t){var e=Math.pow(10,((t+"").split(".")[1]||"").length);return function(n){var i=qp(Math.round(parseFloat(n)/t)*t*e);return(i-i%1)/e+(rp(n)?0:Sm(n))}},xm=function(t,e){var n,i,r=lp(t);return!r&&op(t)&&(n=r=t.radius||Wf,t.values?(t=Am(t.values),(i=!rp(t[0]))&&(n*=n)):t=Om(t.increment)),Im(e,r?ip(t)?function(e){return i=t(e),Math.abs(i-e)<=n?i:e}:function(e){for(var r,s,o=parseFloat(i?e.x:e),a=parseFloat(i?e.y:0),c=Wf,u=0,h=t.length;h--;)(r=i?(r=t[h].x-o)*r+(s=t[h].y-a)*s:Math.abs(t[h]-o))<c&&(c=r,u=h);return u=!n||c<=n?t[u]:e,i||u===e||rp(e)?u:u+Sm(e)}:Om(t))},Mm=function(t,e,n,i){return Im(lp(t)?!e:!0===n?!!(n=0):!i,(function(){return lp(t)?t[~~(Math.random()*t.length)]:(n=n||1e-5)&&(i=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((t-n/2+Math.random()*(e-t+.99*n))/n)*n*i)/i}))},Lm=function(t,e,n){return Im(n,(function(n){return t[~~e(n)]}))},Pm=function(t){for(var e,n,i,r,s=0,o="";~(e=t.indexOf("random(",s));)i=t.indexOf(")",e),r="["===t.charAt(e+7),n=t.substr(e+7,i-e-7).match(r?yp:dp),o+=t.substr(s,e-s)+Mm(r?n:+n[0],r?0:+n[1],+n[2]||1e-5),s=i+1;return o+t.substr(s,t.length-s)},Um=function(t,e,n,i,r){var s=e-t,o=i-n;return Im(r,(function(e){return n+((e-t)/s*o||0)}))},Fm=function(t,e,n){var i,r,s,o=t.labels,a=Wf;for(i in o)(r=o[i]-e)<0==!!n&&r&&a>(r=Math.abs(r))&&(s=i,a=r);return s},Vm=function(t,e,n){var i,r,s,o=t.vars,a=o[e],c=xf,u=t._ctx;if(a)return i=o[e+"Params"],r=o.callbackScope||t,n&&Np.length&&Hp(),u&&(xf=u),s=i?a.apply(r,i):a.call(r),xf=c,s},Bm=function(t){return nm(t),t.scrollTrigger&&t.scrollTrigger.kill(!!Of),t.progress()<1&&Vm(t,"onInterrupt"),t},jm=function(t){var e=(t=!t.name&&t.default||t).name,n=ip(t),i=e&&!n&&t.init?function(){this._props=[]}:t,r={init:Sp,render:Og,add:gg,kill:Mg,modifier:xg,rawVars:0},s={targetTest:0,get:0,getSetter:Ag,aliases:{},register:0};if(Jm(),t!==i){if(Op[e])return;Qp(i,Qp(Jp(t,r),s)),Xp(i.prototype,Xp(r,Jp(t,s))),Op[i.prop=e]=i,t.targetTest&&(Lp.push(i),Dp[e]=1),e=("css"===e?"CSS":e.charAt(0).toUpperCase()+e.substr(1))+"Plugin"}Ep(e,i),t.register&&t.register(Qg,i,Ug)},qm=255,zm={aqua:[0,qm,qm],lime:[0,qm,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,qm],navy:[0,0,128],white:[qm,qm,qm],olive:[128,128,0],yellow:[qm,qm,0],orange:[qm,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[qm,0,0],pink:[qm,192,203],cyan:[0,qm,qm],transparent:[qm,qm,qm,0]},$m=function(t,e,n){return(6*(t+=t<0?1:t>1?-1:0)<1?e+(n-e)*t*6:t<.5?n:3*t<2?e+(n-e)*(2/3-t)*6:e)*qm+.5|0},Hm=function(t,e,n){var i,r,s,o,a,c,u,h,l,d,f=t?rp(t)?[t>>16,t>>8&qm,t&qm]:0:zm.black;if(!f){if(","===t.substr(-1)&&(t=t.substr(0,t.length-1)),zm[t])f=zm[t];else if("#"===t.charAt(0)){if(t.length<6&&(i=t.charAt(1),r=t.charAt(2),s=t.charAt(3),t="#"+i+i+r+r+s+s+(5===t.length?t.charAt(4)+t.charAt(4):"")),9===t.length)return[(f=parseInt(t.substr(1,6),16))>>16,f>>8&qm,f&qm,parseInt(t.substr(7),16)/255];f=[(t=parseInt(t.substr(1),16))>>16,t>>8&qm,t&qm]}else if("hsl"===t.substr(0,3))if(f=d=t.match(dp),e){if(~t.indexOf("="))return f=t.match(fp),n&&f.length<4&&(f[3]=1),f}else o=+f[0]%360/360,a=+f[1]/100,i=2*(c=+f[2]/100)-(r=c<=.5?c*(a+1):c+a-c*a),f.length>3&&(f[3]*=1),f[0]=$m(o+1/3,i,r),f[1]=$m(o,i,r),f[2]=$m(o-1/3,i,r);else f=t.match(dp)||zm.transparent;f=f.map(Number)}return e&&!d&&(i=f[0]/qm,r=f[1]/qm,s=f[2]/qm,c=((u=Math.max(i,r,s))+(h=Math.min(i,r,s)))/2,u===h?o=a=0:(l=u-h,a=c>.5?l/(2-u-h):l/(u+h),o=u===i?(r-s)/l+(r<s?6:0):u===r?(s-i)/l+2:(i-r)/l+4,o*=60),f[0]=~~(o+.5),f[1]=~~(100*a+.5),f[2]=~~(100*c+.5)),n&&f.length<4&&(f[3]=1),f},Km=function(t){var e=[],n=[],i=-1;return t.split(Wm).forEach((function(t){var r=t.match(pp)||[];e.push.apply(e,r),n.push(i+=r.length+1)})),e.c=n,e},Gm=function(t,e,n){var i,r,s,o,a="",c=(t+a).match(Wm),u=e?"hsla(":"rgba(",h=0;if(!c)return t;if(c=c.map((function(t){return(t=Hm(t,e,1))&&u+(e?t[0]+","+t[1]+"%,"+t[2]+"%,"+t[3]:t.join(","))+")"})),n&&(s=Km(t),(i=n.c).join(a)!==s.c.join(a)))for(o=(r=t.replace(Wm,"1").split(pp)).length-1;h<o;h++)a+=r[h]+(~i.indexOf(h)?c.shift()||u+"0,0,0,0)":(s.length?s:c.length?c:n).shift());if(!r)for(o=(r=t.split(Wm)).length-1;h<o;h++)a+=r[h]+c[h];return a+r[o]},Wm=function(){var t,e="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(t in zm)e+="|"+t+"\\b";return new RegExp(e+")","gi")}(),Qm=/hsl[a]?\(/,Xm=function(t){var e,n=t.join(" ");if(Wm.lastIndex=0,Wm.test(n))return e=Qm.test(n),t[1]=Gm(t[1],e),t[0]=Gm(t[0],e,Km(t[1])),!0},Ym=function(){var t,e,n,i,r,s,o=Date.now,a=500,c=33,u=o(),h=u,l=1e3/240,d=l,f=[],p=function n(p){var m,g,y,v,_=o()-h,w=!0===p;if(_>a&&(u+=_-c),((m=(y=(h+=_)-u)-d)>0||w)&&(v=++i.frame,r=y-1e3*i.time,i.time=y/=1e3,d+=m+(m>=l?4:l-m),g=1),w||(t=e(n)),g)for(s=0;s<f.length;s++)f[s](y,r,v,p)};return i={time:0,frame:0,tick:function(){p(!0)},deltaRatio:function(t){return r/(1e3/(t||60))},wake:function(){Ff&&(!Pf&&cp()&&(Lf=Pf=window,Uf=Lf.document||{},_p.gsap=Qg,(Lf.gsapVersions||(Lf.gsapVersions=[])).push(Qg.version),bp(wp||Lf.GreenSockGlobals||!Lf.gsap&&Lf||{}),n=Lf.requestAnimationFrame),t&&i.sleep(),e=n||function(t){return setTimeout(t,d-1e3*i.time+1|0)},jf=1,p(2))},sleep:function(){(n?Lf.cancelAnimationFrame:clearTimeout)(t),jf=0,e=Sp},lagSmoothing:function(t,e){a=t||1e8,c=Math.min(e,a,0)},fps:function(t){l=1e3/(t||240),d=1e3*i.time+l},add:function(t,e,n){var r=e?function(e,n,s,o){t(e,n,s,o),i.remove(r)}:t;return i.remove(t),f[n?"unshift":"push"](r),Jm(),r},remove:function(t,e){~(e=f.indexOf(t))&&f.splice(e,1)&&s>=e&&s--},_listeners:f},i}(),Jm=function(){return!jf&&Ym.wake()},Zm={},tg=/^[\d.\-M][\d.\-,\s]/,eg=/["']/g,ng=function(t){for(var e,n,i,r={},s=t.substr(1,t.length-3).split(":"),o=s[0],a=1,c=s.length;a<c;a++)n=s[a],e=a!==c-1?n.lastIndexOf(","):n.length,i=n.substr(0,e),r[o]=isNaN(i)?i.replace(eg,"").trim():+i,o=n.substr(e+1).trim();return r},ig=function(t){return function(e){return 1-t(1-e)}},rg=function t(e,n){for(var i,r=e._first;r;)r instanceof dg?t(r,n):!r.vars.yoyoEase||r._yoyo&&r._repeat||r._yoyo===n||(r.timeline?t(r.timeline,n):(i=r._ease,r._ease=r._yEase,r._yEase=i,r._yoyo=n)),r=r._next},sg=function(t,e){return t&&(ip(t)?t:Zm[t]||function(t){var e,n,i,r,s=(t+"").split("("),o=Zm[s[0]];return o&&s.length>1&&o.config?o.config.apply(null,~t.indexOf("{")?[ng(s[1])]:(e=t,n=e.indexOf("(")+1,i=e.indexOf(")"),r=e.indexOf("(",n),e.substring(n,~r&&r<i?e.indexOf(")",i+1):i)).split(",").map(Gp)):Zm._CE&&tg.test(t)?Zm._CE("",t):o}(t))||e},og=function(t,e,n,i){void 0===n&&(n=function(t){return 1-e(1-t)}),void 0===i&&(i=function(t){return t<.5?e(2*t)/2:1-e(2*(1-t))/2});var r,s={easeIn:e,easeOut:n,easeInOut:i};return Bp(t,(function(t){for(var e in Zm[t]=_p[t]=s,Zm[r=t.toLowerCase()]=n,s)Zm[r+("easeIn"===e?".in":"easeOut"===e?".out":".inOut")]=Zm[t+"."+e]=s[e]})),s},ag=function(t){return function(e){return e<.5?(1-t(1-2*e))/2:.5+t(2*(e-.5))/2}},cg=function t(e,n,i){var r=n>=1?n:1,s=(i||(e?.3:.45))/(n<1?n:1),o=s/Xf*(Math.asin(1/r)||0),a=function(t){return 1===t?1:r*Math.pow(2,-10*t)*ep((t-o)*s)+1},c="out"===e?a:"in"===e?function(t){return 1-a(1-t)}:ag(a);return s=Xf/s,c.config=function(n,i){return t(e,n,i)},c},ug=function t(e,n){void 0===n&&(n=1.70158);var i=function(t){return t?--t*t*((n+1)*t+n)+1:0},r="out"===e?i:"in"===e?function(t){return 1-i(1-t)}:ag(i);return r.config=function(n){return t(e,n)},r};Bp("Linear,Quad,Cubic,Quart,Quint,Strong",(function(t,e){var n=e<5?e+1:e;og(t+",Power"+(n-1),e?function(t){return Math.pow(t,n)}:function(t){return t},(function(t){return 1-Math.pow(1-t,n)}),(function(t){return t<.5?Math.pow(2*t,n)/2:1-Math.pow(2*(1-t),n)/2}))})),Zm.Linear.easeNone=Zm.none=Zm.Linear.easeIn,og("Elastic",cg("in"),cg("out"),cg()),qf=7.5625,$f=1/(zf=2.75),Hf=function(t){return t<$f?qf*t*t:t<.7272727272727273?qf*Math.pow(t-1.5/zf,2)+.75:t<.9090909090909092?qf*(t-=2.25/zf)*t+.9375:qf*Math.pow(t-2.625/zf,2)+.984375},og("Bounce",(function(t){return 1-Hf(1-t)}),Hf),og("Expo",(function(t){return t?Math.pow(2,10*(t-1)):0})),og("Circ",(function(t){return-(Zf(1-t*t)-1)})),og("Sine",(function(t){return 1===t?1:1-tp(t*Yf)})),og("Back",ug("in"),ug("out"),ug()),Zm.SteppedEase=Zm.steps=_p.SteppedEase={config:function(t,e){void 0===t&&(t=1);var n=1/t,i=t+(e?0:1),r=e?1:0;return function(t){return((i*Em(0,.99999999,t)|0)+r)*n}}},Gf.ease=Zm["quad.out"],Bp("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",(function(t){return Pp+=t+","+t+"Params,"}));var hg=function(t,e){this.id=Jf++,t._gsap=this,this.target=t,this.harness=e,this.get=e?e.get:Vp,this.set=e?e.getSetter:Ag},lg=function(){function t(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,vm(this,+t.duration,1,1),this.data=t.data,xf&&(this._ctx=xf,xf.data.push(this)),jf||Ym.wake()}var e=t.prototype;return e.delay=function(t){return t||0===t?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+t-this._delay),this._delay=t,this):this._delay},e.duration=function(t){return arguments.length?this.totalDuration(this._repeat>0?t+(t+this._rDelay)*this._repeat:t):this.totalDuration()&&this._dur},e.totalDuration=function(t){return arguments.length?(this._dirty=0,vm(this,this._repeat<0?t:(t-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(t,e){if(Jm(),!arguments.length)return this._tTime;var n=this._dp;if(n&&n.smoothChildTiming&&this._ts){for(lm(this,t),!n._dp||n.parent||dm(n,this);n&&n.parent;)n.parent._time!==n._start+(n._ts>=0?n._tTime/n._ts:(n.totalDuration()-n._tTime)/-n._ts)&&n.totalTime(n._tTime,!0),n=n.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&t<this._tDur||this._ts<0&&t>0||!this._tDur&&!t)&&fm(this._dp,this,this._start-this._delay)}return(this._tTime!==t||!this._dur&&!e||this._initted&&Math.abs(this._zTime)===Qf||!t&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=t),Kp(this,t,e)),this},e.time=function(t,e){return arguments.length?this.totalTime(Math.min(this.totalDuration(),t+am(this))%(this._dur+this._rDelay)||(t?this._dur:0),e):this._time},e.totalProgress=function(t,e){return arguments.length?this.totalTime(this.totalDuration()*t,e):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},e.progress=function(t,e){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?t:1-t)+am(this),e):this.duration()?Math.min(1,this._time/this._dur):this.ratio},e.iteration=function(t,e){var n=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(t-1)*n,e):this._repeat?cm(this._tTime,n)+1:1},e.timeScale=function(t){if(!arguments.length)return-1e-8===this._rts?0:this._rts;if(this._rts===t)return this;var e=this.parent&&this._ts?um(this.parent._time,this):this._tTime;return this._rts=+t||0,this._ts=this._ps||-1e-8===t?0:this._rts,this.totalTime(Em(-this._delay,this._tDur,e),!0),hm(this),rm(this)},e.paused=function(t){return arguments.length?(this._ps!==t&&(this._ps=t,t?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Jm(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&Math.abs(this._zTime)!==Qf&&(this._tTime-=Qf)))),this):this._ps},e.startTime=function(t){if(arguments.length){this._start=t;var e=this.parent||this._dp;return e&&(e._sort||!this.parent)&&fm(e,this,t-this._delay),this}return this._start},e.endTime=function(t){return this._start+(ap(t)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(t){var e=this.parent||this._dp;return e?t&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?um(e.rawTime(t),this):this._tTime:this._tTime},e.revert=function(t){void 0===t&&(t=Ap);var e=Of;return Of=t,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(t),this.totalTime(-.01,t.suppressEvents)),"nested"!==this.data&&!1!==t.kill&&this.kill(),Of=e,this},e.globalTime=function(t){for(var e=this,n=arguments.length?t:e.rawTime();e;)n=e._start+n/(e._ts||1),e=e._dp;return!this.parent&&this.vars.immediateRender?-1:n},e.repeat=function(t){return arguments.length?(this._repeat=t===1/0?-2:t,_m(this)):-2===this._repeat?1/0:this._repeat},e.repeatDelay=function(t){if(arguments.length){var e=this._time;return this._rDelay=t,_m(this),e?this.time(e):this}return this._rDelay},e.yoyo=function(t){return arguments.length?(this._yoyo=t,this):this._yoyo},e.seek=function(t,e){return this.totalTime(bm(this,t),ap(e))},e.restart=function(t,e){return this.play().totalTime(t?-this._delay:0,ap(e))},e.play=function(t,e){return null!=t&&this.seek(t,e),this.reversed(!1).paused(!1)},e.reverse=function(t,e){return null!=t&&this.seek(t||this.totalDuration(),e),this.reversed(!0).paused(!1)},e.pause=function(t,e){return null!=t&&this.seek(t,e),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(t){return arguments.length?(!!t!==this.reversed()&&this.timeScale(-this._rts||(t?-1e-8:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-1e-8,this},e.isActive=function(){var t,e=this.parent||this._dp,n=this._start;return!(e&&!(this._ts&&this._initted&&e.isActive()&&(t=e.rawTime(!0))>=n&&t<this.endTime(!0)-Qf))},e.eventCallback=function(t,e,n){var i=this.vars;return arguments.length>1?(e?(i[t]=e,n&&(i[t+"Params"]=n),"onUpdate"===t&&(this._onUpdate=e)):delete i[t],this):i[t]},e.then=function(t){var e=this;return new Promise((function(n){var i=ip(t)?t:Wp,r=function(){var t=e.then;e.then=null,ip(i)&&(i=i(e))&&(i.then||i===e)&&(e.then=t),n(i),e.then=t};e._initted&&1===e.totalProgress()&&e._ts>=0||!e._tTime&&e._ts<0?r():e._prom=r}))},e.kill=function(){Bm(this)},t}();Qp(lg.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-1e-8,_prom:0,_ps:!1,_rts:1});var dg=function(t){function e(e,n){var i;return void 0===e&&(e={}),(i=t.call(this,e)||this).labels={},i.smoothChildTiming=!!e.smoothChildTiming,i.autoRemoveChildren=!!e.autoRemoveChildren,i._sort=ap(e.sortChildren),Mf&&fm(e.parent||Mf,Df(i),n),e.reversed&&i.reverse(),e.paused&&i.paused(!0),e.scrollTrigger&&pm(Df(i),e.scrollTrigger),i}Nf(e,t);var n=e.prototype;return n.to=function(t,e,n){return Tm(0,arguments,this),this},n.from=function(t,e,n){return Tm(1,arguments,this),this},n.fromTo=function(t,e,n,i){return Tm(2,arguments,this),this},n.set=function(t,e,n){return e.duration=0,e.parent=this,Zp(e).repeatDelay||(e.repeat=0),e.immediateRender=!!e.immediateRender,new Ig(t,e,bm(this,n),1),this},n.call=function(t,e,n){return fm(this,Ig.delayedCall(0,t,e),n)},n.staggerTo=function(t,e,n,i,r,s,o){return n.duration=e,n.stagger=n.stagger||i,n.onComplete=s,n.onCompleteParams=o,n.parent=this,new Ig(t,n,bm(this,r)),this},n.staggerFrom=function(t,e,n,i,r,s,o){return n.runBackwards=1,Zp(n).immediateRender=ap(n.immediateRender),this.staggerTo(t,e,n,i,r,s,o)},n.staggerFromTo=function(t,e,n,i,r,s,o,a){return i.startAt=n,Zp(i).immediateRender=ap(i.immediateRender),this.staggerTo(t,e,i,r,s,o,a)},n.render=function(t,e,n){var i,r,s,o,a,c,u,h,l,d,f,p,m=this._time,g=this._dirty?this.totalDuration():this._tDur,y=this._dur,v=t<=0?0:qp(t),_=this._zTime<0!=t<0&&(this._initted||!y);if(this!==Mf&&v>g&&t>=0&&(v=g),v!==this._tTime||n||_){if(m!==this._time&&y&&(v+=this._time-m,t+=this._time-m),i=v,l=this._start,c=!(h=this._ts),_&&(y||(m=this._zTime),(t||!e)&&(this._zTime=t)),this._repeat){if(f=this._yoyo,a=y+this._rDelay,this._repeat<-1&&t<0)return this.totalTime(100*a+t,e,n);if(i=qp(v%a),v===g?(o=this._repeat,i=y):((o=~~(v/a))&&o===v/a&&(i=y,o--),i>y&&(i=y)),d=cm(this._tTime,a),!m&&this._tTime&&d!==o&&(d=o),f&&1&o&&(i=y-i,p=1),o!==d&&!this._lock){var w=f&&1&d,b=w===(f&&1&o);if(o<d&&(w=!w),m=w?0:y,this._lock=1,this.render(m||(p?0:qp(o*a)),e,!y)._lock=0,this._tTime=v,!e&&this.parent&&Vm(this,"onRepeat"),this.vars.repeatRefresh&&!p&&(this.invalidate()._lock=1),m&&m!==this._time||c!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(y=this._dur,g=this._tDur,b&&(this._lock=2,m=w?y:-1e-4,this.render(m,!0),this.vars.repeatRefresh&&!p&&this.invalidate()),this._lock=0,!this._ts&&!c)return this;rg(this,p)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(u=function(t,e,n){var i;if(n>e)for(i=t._first;i&&i._start<=n;){if("isPause"===i.data&&i._start>e)return i;i=i._next}else for(i=t._last;i&&i._start>=n;){if("isPause"===i.data&&i._start<e)return i;i=i._prev}}(this,qp(m),qp(i)),u&&(v-=i-(i=u._start))),this._tTime=v,this._time=i,this._act=!h,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=t,m=0),!m&&i&&!e&&(Vm(this,"onStart"),this._tTime!==v))return this;if(i>=m&&t>=0)for(r=this._first;r;){if(s=r._next,(r._act||i>=r._start)&&r._ts&&u!==r){if(r.parent!==this)return this.render(t,e,n);if(r.render(r._ts>0?(i-r._start)*r._ts:(r._dirty?r.totalDuration():r._tDur)+(i-r._start)*r._ts,e,n),i!==this._time||!this._ts&&!c){u=0,s&&(v+=this._zTime=-1e-8);break}}r=s}else{r=this._last;for(var T=t<0?t:i;r;){if(s=r._prev,(r._act||T<=r._end)&&r._ts&&u!==r){if(r.parent!==this)return this.render(t,e,n);if(r.render(r._ts>0?(T-r._start)*r._ts:(r._dirty?r.totalDuration():r._tDur)+(T-r._start)*r._ts,e,n||Of&&(r._initted||r._startAt)),i!==this._time||!this._ts&&!c){u=0,s&&(v+=this._zTime=T?-1e-8:Qf);break}}r=s}}if(u&&!e&&(this.pause(),u.render(i>=m?0:-1e-8)._zTime=i>=m?1:-1,this._ts))return this._start=l,hm(this),this.render(t,e,n);this._onUpdate&&!e&&Vm(this,"onUpdate",!0),(v===g&&this._tTime>=this.totalDuration()||!v&&m)&&(l!==this._start&&Math.abs(h)===Math.abs(this._ts)||this._lock||((t||!y)&&(v===g&&this._ts>0||!v&&this._ts<0)&&nm(this,1),e||t<0&&!m||!v&&!m&&g||(Vm(this,v===g&&t>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(v<g&&this.timeScale()>0)&&this._prom())))}return this},n.add=function(t,e){var n=this;if(rp(e)||(e=bm(this,e,t)),!(t instanceof lg)){if(lp(t))return t.forEach((function(t){return n.add(t,e)})),this;if(np(t))return this.addLabel(t,e);if(!ip(t))return this;t=Ig.delayedCall(0,t)}return this!==t?fm(this,t,e):this},n.getChildren=function(t,e,n,i){void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===n&&(n=!0),void 0===i&&(i=-Wf);for(var r=[],s=this._first;s;)s._start>=i&&(s instanceof Ig?e&&r.push(s):(n&&r.push(s),t&&r.push.apply(r,s.getChildren(!0,e,n)))),s=s._next;return r},n.getById=function(t){for(var e=this.getChildren(1,1,1),n=e.length;n--;)if(e[n].vars.id===t)return e[n]},n.remove=function(t){return np(t)?this.removeLabel(t):ip(t)?this.killTweensOf(t):(em(this,t),t===this._recent&&(this._recent=this._last),im(this))},n.totalTime=function(e,n){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=qp(Ym.time-(this._ts>0?e/this._ts:(this.totalDuration()-e)/-this._ts))),t.prototype.totalTime.call(this,e,n),this._forcing=0,this):this._tTime},n.addLabel=function(t,e){return this.labels[t]=bm(this,e),this},n.removeLabel=function(t){return delete this.labels[t],this},n.addPause=function(t,e,n){var i=Ig.delayedCall(0,e||Sp,n);return i.data="isPause",this._hasPause=1,fm(this,i,bm(this,t))},n.removePause=function(t){var e=this._first;for(t=bm(this,t);e;)e._start===t&&"isPause"===e.data&&nm(e),e=e._next},n.killTweensOf=function(t,e,n){for(var i=this.getTweensOf(t,n),r=i.length;r--;)fg!==i[r]&&i[r].kill(t,e);return this},n.getTweensOf=function(t,e){for(var n,i=[],r=Am(t),s=this._first,o=rp(e);s;)s instanceof Ig?$p(s._targets,r)&&(o?(!fg||s._initted&&s._ts)&&s.globalTime(0)<=e&&s.globalTime(s.totalDuration())>e:!e||s.isActive())&&i.push(s):(n=s.getTweensOf(r,e)).length&&i.push.apply(i,n),s=s._next;return i},n.tweenTo=function(t,e){e=e||{};var n,i=this,r=bm(i,t),s=e,o=s.startAt,a=s.onStart,c=s.onStartParams,u=s.immediateRender,h=Ig.to(i,Qp({ease:e.ease||"none",lazy:!1,immediateRender:!1,time:r,overwrite:"auto",duration:e.duration||Math.abs((r-(o&&"time"in o?o.time:i._time))/i.timeScale())||Qf,onStart:function(){if(i.pause(),!n){var t=e.duration||Math.abs((r-(o&&"time"in o?o.time:i._time))/i.timeScale());h._dur!==t&&vm(h,t,0,1).render(h._time,!0,!0),n=1}a&&a.apply(h,c||[])}},e));return u?h.render(0):h},n.tweenFromTo=function(t,e,n){return this.tweenTo(e,Qp({startAt:{time:bm(this,t)}},n))},n.recent=function(){return this._recent},n.nextLabel=function(t){return void 0===t&&(t=this._time),Fm(this,bm(this,t))},n.previousLabel=function(t){return void 0===t&&(t=this._time),Fm(this,bm(this,t),1)},n.currentLabel=function(t){return arguments.length?this.seek(t,!0):this.previousLabel(this._time+Qf)},n.shiftChildren=function(t,e,n){void 0===n&&(n=0);for(var i,r=this._first,s=this.labels;r;)r._start>=n&&(r._start+=t,r._end+=t),r=r._next;if(e)for(i in s)s[i]>=n&&(s[i]+=t);return im(this)},n.invalidate=function(e){var n=this._first;for(this._lock=0;n;)n.invalidate(e),n=n._next;return t.prototype.invalidate.call(this,e)},n.clear=function(t){void 0===t&&(t=!0);for(var e,n=this._first;n;)e=n._next,this.remove(n),n=e;return this._dp&&(this._time=this._tTime=this._pTime=0),t&&(this.labels={}),im(this)},n.totalDuration=function(t){var e,n,i,r=0,s=this,o=s._last,a=Wf;if(arguments.length)return s.timeScale((s._repeat<0?s.duration():s.totalDuration())/(s.reversed()?-t:t));if(s._dirty){for(i=s.parent;o;)e=o._prev,o._dirty&&o.totalDuration(),(n=o._start)>a&&s._sort&&o._ts&&!s._lock?(s._lock=1,fm(s,o,n-o._delay,1)._lock=0):a=n,n<0&&o._ts&&(r-=n,(!i&&!s._dp||i&&i.smoothChildTiming)&&(s._start+=n/s._ts,s._time-=n,s._tTime-=n),s.shiftChildren(-n,!1,-Infinity),a=0),o._end>r&&o._ts&&(r=o._end),o=e;vm(s,s===Mf&&s._time>r?s._time:r,1,1),s._dirty=0}return s._tDur},e.updateRoot=function(t){if(Mf._ts&&(Kp(Mf,um(t,Mf)),Vf=Ym.frame),Ym.frame>=Mp){Mp+=Kf.autoSleep||120;var e=Mf._first;if((!e||!e._ts)&&Kf.autoSleep&&Ym._listeners.length<2){for(;e&&!e._ts;)e=e._next;e||Ym.sleep()}}},e}(lg);Qp(dg.prototype,{_lock:0,_hasPause:0,_forcing:0});var fg,pg,mg=function(t,e,n,i,r,s,o){var a,c,u,h,l,d,f,p,m=new Ug(this._pt,t,e,0,1,Rg,null,r),g=0,y=0;for(m.b=n,m.e=i,n+="",(f=~(i+="").indexOf("random("))&&(i=Pm(i)),s&&(s(p=[n,i],t,e),n=p[0],i=p[1]),c=n.match(mp)||[];a=mp.exec(i);)h=a[0],l=i.substring(g,a.index),u?u=(u+1)%5:"rgba("===l.substr(-5)&&(u=1),h!==c[y++]&&(d=parseFloat(c[y-1])||0,m._pt={_next:m._pt,p:l||1===y?l:",",s:d,c:"="===h.charAt(1)?zp(d,h)-d:parseFloat(h)-d,m:u&&u<4?Math.round:0},g=mp.lastIndex);return m.c=g<i.length?i.substring(g,i.length):"",m.fp=o,(gp.test(i)||f)&&(m.e=0),this._pt=m,m},gg=function(t,e,n,i,r,s,o,a,c,u){ip(i)&&(i=i(r||0,t,s));var h,l=t[e],d="get"!==n?n:ip(l)?c?t[e.indexOf("set")||!ip(t["get"+e.substr(3)])?e:"get"+e.substr(3)](c):t[e]():l,f=ip(l)?c?kg:Sg:Eg;if(np(i)&&(~i.indexOf("random(")&&(i=Pm(i)),"="===i.charAt(1)&&((h=zp(d,i)+(Sm(d)||0))||0===h)&&(i=h)),!u||d!==i||pg)return isNaN(d*i)||""===i?(!l&&!(e in t)&&Tp(e,i),mg.call(this,t,e,d,i,f,a||Kf.stringFilter,c)):(h=new Ug(this._pt,t,e,+d||0,i-(d||0),"boolean"==typeof l?Ng:Dg,0,f),c&&(h.fp=c),o&&h.modifier(o,this,t),this._pt=h)},yg=function(t,e,n,i,r,s){var o,a,c,u;if(Op[t]&&!1!==(o=new Op[t]).init(r,o.rawVars?e[t]:function(t,e,n,i,r){if(ip(t)&&(t=wg(t,r,e,n,i)),!op(t)||t.style&&t.nodeType||lp(t)||hp(t))return np(t)?wg(t,r,e,n,i):t;var s,o={};for(s in t)o[s]=wg(t[s],r,e,n,i);return o}(e[t],i,r,s,n),n,i,s)&&(n._pt=a=new Ug(n._pt,r,t,0,1,o.render,o,0,o.priority),n!==Bf))for(c=n._ptLookup[n._targets.indexOf(r)],u=o._props.length;u--;)c[o._props[u]]=a;return o},vg=function t(e,n,i){var r,s,o,a,c,u,h,l,d,f,p,m,g,y=e.vars,v=y.ease,_=y.startAt,w=y.immediateRender,b=y.lazy,T=y.onUpdate,I=y.onUpdateParams,E=y.callbackScope,S=y.runBackwards,k=y.yoyoEase,C=y.keyframes,A=y.autoRevert,D=e._dur,N=e._startAt,R=e._targets,O=e.parent,x=O&&"nested"===O.data?O.vars.targets:R,M="auto"===e._overwrite&&!Rf,L=e.timeline;if(L&&(!C||!v)&&(v="none"),e._ease=sg(v,Gf.ease),e._yEase=k?ig(sg(!0===k?v:k,Gf.ease)):0,k&&e._yoyo&&!e._repeat&&(k=e._yEase,e._yEase=e._ease,e._ease=k),e._from=!L&&!!y.runBackwards,!L||C&&!y.stagger){if(m=(l=R[0]?Fp(R[0]).harness:0)&&y[l.prop],r=Jp(y,Dp),N&&(N._zTime<0&&N.progress(1),n<0&&S&&w&&!A?N.render(-1,!0):N.revert(S&&D?Cp:kp),N._lazy=0),_){if(nm(e._startAt=Ig.set(R,Qp({data:"isStart",overwrite:!1,parent:O,immediateRender:!0,lazy:ap(b),startAt:null,delay:0,onUpdate:T,onUpdateParams:I,callbackScope:E,stagger:0},_))),e._startAt._dp=0,n<0&&(Of||!w&&!A)&&e._startAt.revert(Cp),w&&D&&n<=0&&i<=0)return void(n&&(e._zTime=n))}else if(S&&D&&!N)if(n&&(w=!1),o=Qp({overwrite:!1,data:"isFromStart",lazy:w&&ap(b),immediateRender:w,stagger:0,parent:O},r),m&&(o[l.prop]=m),nm(e._startAt=Ig.set(R,o)),e._startAt._dp=0,n<0&&(Of?e._startAt.revert(Cp):e._startAt.render(-1,!0)),e._zTime=n,w){if(!n)return}else t(e._startAt,Qf,Qf);for(e._pt=e._ptCache=0,b=D&&ap(b)||b&&!D,s=0;s<R.length;s++){if(h=(c=R[s])._gsap||Up(R)[s]._gsap,e._ptLookup[s]=f={},Rp[h.id]&&Np.length&&Hp(),p=x===R?s:x.indexOf(c),l&&!1!==(d=new l).init(c,m||r,e,p,x)&&(e._pt=a=new Ug(e._pt,c,d.name,0,1,d.render,d,0,d.priority),d._props.forEach((function(t){f[t]=a})),d.priority&&(u=1)),!l||m)for(o in r)Op[o]&&(d=yg(o,r,e,p,c,x))?d.priority&&(u=1):f[o]=a=gg.call(e,c,o,"get",r[o],p,x,0,y.stringFilter);e._op&&e._op[s]&&e.kill(c,e._op[s]),M&&e._pt&&(fg=e,Mf.killTweensOf(c,f,e.globalTime(n)),g=!e.parent,fg=0),e._pt&&b&&(Rp[h.id]=1)}u&&Pg(e),e._onInit&&e._onInit(e)}e._onUpdate=T,e._initted=(!e._op||e._pt)&&!g,C&&n<=0&&L.render(Wf,!0,!0)},_g=function(t,e,n,i){var r,s,o=e.ease||i||"power1.inOut";if(lp(e))s=n[t]||(n[t]=[]),e.forEach((function(t,n){return s.push({t:n/(e.length-1)*100,v:t,e:o})}));else for(r in e)s=n[r]||(n[r]=[]),"ease"===r||s.push({t:parseFloat(t),v:e[r],e:o})},wg=function(t,e,n,i,r){return ip(t)?t.call(e,n,i,r):np(t)&&~t.indexOf("random(")?Pm(t):t},bg=Pp+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",Tg={};Bp(bg+",id,stagger,delay,duration,paused,scrollTrigger",(function(t){return Tg[t]=1}));var Ig=function(t){function e(e,n,i,r){var s;"number"==typeof n&&(i.duration=n,n=i,i=null);var o,a,c,u,h,l,d,f,p=(s=t.call(this,r?n:Zp(n))||this).vars,m=p.duration,g=p.delay,y=p.immediateRender,v=p.stagger,_=p.overwrite,w=p.keyframes,b=p.defaults,T=p.scrollTrigger,I=p.yoyoEase,E=n.parent||Mf,S=(lp(e)||hp(e)?rp(e[0]):"length"in n)?[e]:Am(e);if(s._targets=S.length?Up(S):Ip("GSAP target "+e+" not found. https://greensock.com",!Kf.nullTargetWarn)||[],s._ptLookup=[],s._overwrite=_,w||v||up(m)||up(g)){if(n=s.vars,(o=s.timeline=new dg({data:"nested",defaults:b||{},targets:E&&"nested"===E.data?E.vars.targets:S})).kill(),o.parent=o._dp=Df(s),o._start=0,v||up(m)||up(g)){if(u=S.length,d=v&&Rm(v),op(v))for(h in v)~bg.indexOf(h)&&(f||(f={}),f[h]=v[h]);for(a=0;a<u;a++)(c=Jp(n,Tg)).stagger=0,I&&(c.yoyoEase=I),f&&Xp(c,f),l=S[a],c.duration=+wg(m,Df(s),a,l,S),c.delay=(+wg(g,Df(s),a,l,S)||0)-s._delay,!v&&1===u&&c.delay&&(s._delay=g=c.delay,s._start+=g,c.delay=0),o.to(l,c,d?d(a,l,S):0),o._ease=Zm.none;o.duration()?m=g=0:s.timeline=0}else if(w){Zp(Qp(o.vars.defaults,{ease:"none"})),o._ease=sg(w.ease||n.ease||"none");var k,C,A,D=0;if(lp(w))w.forEach((function(t){return o.to(S,t,">")})),o.duration();else{for(h in c={},w)"ease"===h||"easeEach"===h||_g(h,w[h],c,w.easeEach);for(h in c)for(k=c[h].sort((function(t,e){return t.t-e.t})),D=0,a=0;a<k.length;a++)(A={ease:(C=k[a]).e,duration:(C.t-(a?k[a-1].t:0))/100*m})[h]=C.v,o.to(S,A,D),D+=A.duration;o.duration()<m&&o.to({},{duration:m-o.duration()})}}m||s.duration(m=o.duration())}else s.timeline=0;return!0!==_||Rf||(fg=Df(s),Mf.killTweensOf(S),fg=0),fm(E,Df(s),i),n.reversed&&s.reverse(),n.paused&&s.paused(!0),(y||!m&&!w&&s._start===qp(E._time)&&ap(y)&&om(Df(s))&&"nested"!==E.data)&&(s._tTime=-1e-8,s.render(Math.max(0,-g)||0)),T&&pm(Df(s),T),s}Nf(e,t);var n=e.prototype;return n.render=function(t,e,n){var i,r,s,o,a,c,u,h,l,d=this._time,f=this._tDur,p=this._dur,m=t<0,g=t>f-Qf&&!m?f:t<Qf?0:t;if(p){if(g!==this._tTime||!t||n||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==m){if(i=g,h=this.timeline,this._repeat){if(o=p+this._rDelay,this._repeat<-1&&m)return this.totalTime(100*o+t,e,n);if(i=qp(g%o),g===f?(s=this._repeat,i=p):((s=~~(g/o))&&s===g/o&&(i=p,s--),i>p&&(i=p)),(c=this._yoyo&&1&s)&&(l=this._yEase,i=p-i),a=cm(this._tTime,o),i===d&&!n&&this._initted)return this._tTime=g,this;s!==a&&(h&&this._yEase&&rg(h,c),!this.vars.repeatRefresh||c||this._lock||(this._lock=n=1,this.render(qp(o*s),!0).invalidate()._lock=0))}if(!this._initted){if(mm(this,m?t:i,n,e,g))return this._tTime=0,this;if(d!==this._time)return this;if(p!==this._dur)return this.render(t,e,n)}if(this._tTime=g,this._time=i,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=u=(l||this._ease)(i/p),this._from&&(this.ratio=u=1-u),i&&!d&&!e&&(Vm(this,"onStart"),this._tTime!==g))return this;for(r=this._pt;r;)r.r(u,r.d),r=r._next;h&&h.render(t<0?t:!i&&c?-1e-8:h._dur*h._ease(i/this._dur),e,n)||this._startAt&&(this._zTime=t),this._onUpdate&&!e&&(m&&sm(this,t,0,n),Vm(this,"onUpdate")),this._repeat&&s!==a&&this.vars.onRepeat&&!e&&this.parent&&Vm(this,"onRepeat"),g!==this._tDur&&g||this._tTime!==g||(m&&!this._onUpdate&&sm(this,t,0,!0),(t||!p)&&(g===this._tDur&&this._ts>0||!g&&this._ts<0)&&nm(this,1),e||m&&!d||!(g||d||c)||(Vm(this,g===f?"onComplete":"onReverseComplete",!0),this._prom&&!(g<f&&this.timeScale()>0)&&this._prom()))}}else!function(t,e,n,i){var r,s,o,a=t.ratio,c=e<0||!e&&(!t._start&&gm(t)&&(t._initted||!ym(t))||(t._ts<0||t._dp._ts<0)&&!ym(t))?0:1,u=t._rDelay,h=0;if(u&&t._repeat&&(h=Em(0,t._tDur,e),s=cm(h,u),t._yoyo&&1&s&&(c=1-c),s!==cm(t._tTime,u)&&(a=1-c,t.vars.repeatRefresh&&t._initted&&t.invalidate())),c!==a||Of||i||t._zTime===Qf||!e&&t._zTime){if(!t._initted&&mm(t,e,i,n,h))return;for(o=t._zTime,t._zTime=e||(n?Qf:0),n||(n=e&&!o),t.ratio=c,t._from&&(c=1-c),t._time=0,t._tTime=h,r=t._pt;r;)r.r(c,r.d),r=r._next;e<0&&sm(t,e,0,!0),t._onUpdate&&!n&&Vm(t,"onUpdate"),h&&t._repeat&&!n&&t.parent&&Vm(t,"onRepeat"),(e>=t._tDur||e<0)&&t.ratio===c&&(c&&nm(t,1),n||Of||(Vm(t,c?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=e)}(this,t,e,n);return this},n.targets=function(){return this._targets},n.invalidate=function(e){return(!e||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(e),t.prototype.invalidate.call(this,e)},n.resetTo=function(t,e,n,i){jf||Ym.wake(),this._ts||this.play();var r=Math.min(this._dur,(this._dp._time-this._start)*this._ts);return this._initted||vg(this,r),function(t,e,n,i,r,s,o){var a,c,u,h,l=(t._pt&&t._ptCache||(t._ptCache={}))[e];if(!l)for(l=t._ptCache[e]=[],u=t._ptLookup,h=t._targets.length;h--;){if((a=u[h][e])&&a.d&&a.d._pt)for(a=a.d._pt;a&&a.p!==e&&a.fp!==e;)a=a._next;if(!a)return pg=1,t.vars[e]="+=0",vg(t,o),pg=0,1;l.push(a)}for(h=l.length;h--;)(a=(c=l[h])._pt||c).s=!i&&0!==i||r?a.s+(i||0)+s*a.c:i,a.c=n-a.s,c.e&&(c.e=jp(n)+Sm(c.e)),c.b&&(c.b=a.s+Sm(c.b))}(this,t,e,n,i,this._ease(r/this._dur),r)?this.resetTo(t,e,n,i):(lm(this,0),this.parent||tm(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},n.kill=function(t,e){if(void 0===e&&(e="all"),!(t||e&&"all"!==e))return this._lazy=this._pt=0,this.parent?Bm(this):this;if(this.timeline){var n=this.timeline.totalDuration();return this.timeline.killTweensOf(t,e,fg&&!0!==fg.vars.overwrite)._first||Bm(this),this.parent&&n!==this.timeline.totalDuration()&&vm(this,this._dur*this.timeline._tDur/n,0,1),this}var i,r,s,o,a,c,u,h=this._targets,l=t?Am(t):h,d=this._ptLookup,f=this._pt;if((!e||"all"===e)&&function(t,e){for(var n=t.length,i=n===e.length;i&&n--&&t[n]===e[n];);return n<0}(h,l))return"all"===e&&(this._pt=0),Bm(this);for(i=this._op=this._op||[],"all"!==e&&(np(e)&&(a={},Bp(e,(function(t){return a[t]=1})),e=a),e=function(t,e){var n,i,r,s,o=t[0]?Fp(t[0]).harness:0,a=o&&o.aliases;if(!a)return e;for(i in n=Xp({},e),a)if(i in n)for(r=(s=a[i].split(",")).length;r--;)n[s[r]]=n[i];return n}(h,e)),u=h.length;u--;)if(~l.indexOf(h[u]))for(a in r=d[u],"all"===e?(i[u]=e,o=r,s={}):(s=i[u]=i[u]||{},o=e),o)(c=r&&r[a])&&("kill"in c.d&&!0!==c.d.kill(a)||em(this,c,"_pt"),delete r[a]),"all"!==s&&(s[a]=1);return this._initted&&!this._pt&&f&&Bm(this),this},e.to=function(t,n){return new e(t,n,arguments[2])},e.from=function(t,e){return Tm(1,arguments)},e.delayedCall=function(t,n,i,r){return new e(n,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:t,onComplete:n,onReverseComplete:n,onCompleteParams:i,onReverseCompleteParams:i,callbackScope:r})},e.fromTo=function(t,e,n){return Tm(2,arguments)},e.set=function(t,n){return n.duration=0,n.repeatDelay||(n.repeat=0),new e(t,n)},e.killTweensOf=function(t,e,n){return Mf.killTweensOf(t,e,n)},e}(lg);Qp(Ig.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),Bp("staggerTo,staggerFrom,staggerFromTo",(function(t){Ig[t]=function(){var e=new dg,n=km.call(arguments,0);return n.splice("staggerFromTo"===t?5:4,0,0),e[t].apply(e,n)}}));var Eg=function(t,e,n){return t[e]=n},Sg=function(t,e,n){return t[e](n)},kg=function(t,e,n,i){return t[e](i.fp,n)},Cg=function(t,e,n){return t.setAttribute(e,n)},Ag=function(t,e){return ip(t[e])?Sg:sp(t[e])&&t.setAttribute?Cg:Eg},Dg=function(t,e){return e.set(e.t,e.p,Math.round(1e6*(e.s+e.c*t))/1e6,e)},Ng=function(t,e){return e.set(e.t,e.p,!!(e.s+e.c*t),e)},Rg=function(t,e){var n=e._pt,i="";if(!t&&e.b)i=e.b;else if(1===t&&e.e)i=e.e;else{for(;n;)i=n.p+(n.m?n.m(n.s+n.c*t):Math.round(1e4*(n.s+n.c*t))/1e4)+i,n=n._next;i+=e.c}e.set(e.t,e.p,i,e)},Og=function(t,e){for(var n=e._pt;n;)n.r(t,n.d),n=n._next},xg=function(t,e,n,i){for(var r,s=this._pt;s;)r=s._next,s.p===i&&s.modifier(t,e,n),s=r},Mg=function(t){for(var e,n,i=this._pt;i;)n=i._next,i.p===t&&!i.op||i.op===t?em(this,i,"_pt"):i.dep||(e=1),i=n;return!e},Lg=function(t,e,n,i){i.mSet(t,e,i.m.call(i.tween,n,i.mt),i)},Pg=function(t){for(var e,n,i,r,s=t._pt;s;){for(e=s._next,n=i;n&&n.pr>s.pr;)n=n._next;(s._prev=n?n._prev:r)?s._prev._next=s:i=s,(s._next=n)?n._prev=s:r=s,s=e}t._pt=i},Ug=function(){function t(t,e,n,i,r,s,o,a,c){this.t=e,this.s=i,this.c=r,this.p=n,this.r=s||Dg,this.d=o||this,this.set=a||Eg,this.pr=c||0,this._next=t,t&&(t._prev=this)}return t.prototype.modifier=function(t,e,n){this.mSet=this.mSet||this.set,this.set=Lg,this.m=t,this.mt=n,this.tween=e},t}();Bp(Pp+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",(function(t){return Dp[t]=1})),_p.TweenMax=_p.TweenLite=Ig,_p.TimelineLite=_p.TimelineMax=dg,Mf=new dg({sortChildren:!1,defaults:Gf,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),Kf.stringFilter=Xm;var Fg=[],Vg={},Bg=[],jg=0,qg=function(t){return(Vg[t]||Bg).map((function(t){return t()}))},zg=function(){var t=Date.now(),e=[];t-jg>2&&(qg("matchMediaInit"),Fg.forEach((function(t){var n,i,r,s,o=t.queries,a=t.conditions;for(i in o)(n=Lf.matchMedia(o[i]).matches)&&(r=1),n!==a[i]&&(a[i]=n,s=1);s&&(t.revert(),r&&e.push(t))})),qg("matchMediaRevert"),e.forEach((function(t){return t.onMatch(t)})),jg=t,qg("matchMedia"))},$g=function(){function t(t,e){this.selector=e&&Dm(e),this.data=[],this._r=[],this.isReverted=!1,t&&this.add(t)}var e=t.prototype;return e.add=function(t,e,n){ip(t)&&(n=e,e=t,t=ip);var i=this,r=function(){var t,r=xf,s=i.selector;return r&&r!==i&&r.data.push(i),n&&(i.selector=Dm(n)),xf=i,t=e.apply(i,arguments),ip(t)&&i._r.push(t),xf=r,i.selector=s,i.isReverted=!1,t};return i.last=r,t===ip?r(i):t?i[t]=r:r},e.ignore=function(t){var e=xf;xf=null,t(this),xf=e},e.getTweens=function(){var e=[];return this.data.forEach((function(n){return n instanceof t?e.push.apply(e,n.getTweens()):n instanceof Ig&&!(n.parent&&"nested"===n.parent.data)&&e.push(n)})),e},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(t,e){var n=this;if(t){var i=this.getTweens();this.data.forEach((function(t){"isFlip"===t.data&&(t.revert(),t.getChildren(!0,!0,!1).forEach((function(t){return i.splice(i.indexOf(t),1)})))})),i.map((function(t){return{g:t.globalTime(0),t}})).sort((function(t,e){return e.g-t.g||-1})).forEach((function(e){return e.t.revert(t)})),this.data.forEach((function(e){return!(e instanceof lg)&&e.revert&&e.revert(t)})),this._r.forEach((function(e){return e(t,n)})),this.isReverted=!0}else this.data.forEach((function(t){return t.kill&&t.kill()}));if(this.clear(),e){var r=Fg.indexOf(this);~r&&Fg.splice(r,1)}},e.revert=function(t){this.kill(t||{})},t}(),Hg=function(){function t(t){this.contexts=[],this.scope=t}var e=t.prototype;return e.add=function(t,e,n){op(t)||(t={matches:t});var i,r,s,o=new $g(0,n||this.scope),a=o.conditions={};for(r in this.contexts.push(o),e=o.add("onMatch",e),o.queries=t,t)"all"===r?s=1:(i=Lf.matchMedia(t[r]))&&(Fg.indexOf(o)<0&&Fg.push(o),(a[r]=i.matches)&&(s=1),i.addListener?i.addListener(zg):i.addEventListener("change",zg));return s&&e(o),this},e.revert=function(t){this.kill(t||{})},e.kill=function(t){this.contexts.forEach((function(e){return e.kill(t,!0)}))},t}(),Kg={registerPlugin:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e.forEach((function(t){return jm(t)}))},timeline:function(t){return new dg(t)},getTweensOf:function(t,e){return Mf.getTweensOf(t,e)},getProperty:function(t,e,n,i){np(t)&&(t=Am(t)[0]);var r=Fp(t||{}).get,s=n?Wp:Gp;return"native"===n&&(n=""),t?e?s((Op[e]&&Op[e].get||r)(t,e,n,i)):function(e,n,i){return s((Op[e]&&Op[e].get||r)(t,e,n,i))}:t},quickSetter:function(t,e,n){if((t=Am(t)).length>1){var i=t.map((function(t){return Qg.quickSetter(t,e,n)})),r=i.length;return function(t){for(var e=r;e--;)i[e](t)}}t=t[0]||{};var s=Op[e],o=Fp(t),a=o.harness&&(o.harness.aliases||{})[e]||e,c=s?function(e){var i=new s;Bf._pt=0,i.init(t,n?e+n:e,Bf,0,[t]),i.render(1,i),Bf._pt&&Og(1,Bf)}:o.set(t,a);return s?c:function(e){return c(t,a,n?e+n:e,o,1)}},quickTo:function(t,e,n){var i,r=Qg.to(t,Xp(((i={})[e]="+=0.1",i.paused=!0,i),n||{})),s=function(t,n,i){return r.resetTo(e,t,n,i)};return s.tween=r,s},isTweening:function(t){return Mf.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=sg(t.ease,Gf.ease)),Yp(Gf,t||{})},config:function(t){return Yp(Kf,t||{})},registerEffect:function(t){var e=t.name,n=t.effect,i=t.plugins,r=t.defaults,s=t.extendTimeline;(i||"").split(",").forEach((function(t){return t&&!Op[t]&&!_p[t]&&Ip(e+" effect requires "+t+" plugin.")})),xp[e]=function(t,e,i){return n(Am(t),Qp(e||{},r),i)},s&&(dg.prototype[e]=function(t,n,i){return this.add(xp[e](t,op(n)?n:(i=n)&&{},this),i)})},registerEase:function(t,e){Zm[t]=sg(e)},parseEase:function(t,e){return arguments.length?sg(t,e):Zm},getById:function(t){return Mf.getById(t)},exportRoot:function(t,e){void 0===t&&(t={});var n,i,r=new dg(t);for(r.smoothChildTiming=ap(t.smoothChildTiming),Mf.remove(r),r._dp=0,r._time=r._tTime=Mf._time,n=Mf._first;n;)i=n._next,!e&&!n._dur&&n instanceof Ig&&n.vars.onComplete===n._targets[0]||fm(r,n,n._start-n._delay),n=i;return fm(Mf,r,0),r},context:function(t,e){return t?new $g(t,e):xf},matchMedia:function(t){return new Hg(t)},matchMediaRefresh:function(){return Fg.forEach((function(t){var e,n,i=t.conditions;for(n in i)i[n]&&(i[n]=!1,e=1);e&&t.revert()}))||zg()},addEventListener:function(t,e){var n=Vg[t]||(Vg[t]=[]);~n.indexOf(e)||n.push(e)},removeEventListener:function(t,e){var n=Vg[t],i=n&&n.indexOf(e);i>=0&&n.splice(i,1)},utils:{wrap:function t(e,n,i){var r=n-e;return lp(e)?Lm(e,t(0,e.length),n):Im(i,(function(t){return(r+(t-e)%r)%r+e}))},wrapYoyo:function t(e,n,i){var r=n-e,s=2*r;return lp(e)?Lm(e,t(0,e.length-1),n):Im(i,(function(t){return e+((t=(s+(t-e)%s)%s||0)>r?s-t:t)}))},distribute:Rm,random:Mm,snap:xm,normalize:function(t,e,n){return Um(t,e,0,1,n)},getUnit:Sm,clamp:function(t,e,n){return Im(n,(function(n){return Em(t,e,n)}))},splitColor:Hm,toArray:Am,selector:Dm,mapRange:Um,pipe:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t){return e.reduce((function(t,e){return e(t)}),t)}},unitize:function(t,e){return function(n){return t(parseFloat(n))+(e||Sm(n))}},interpolate:function t(e,n,i,r){var s=isNaN(e+n)?0:function(t){return(1-t)*e+t*n};if(!s){var o,a,c,u,h,l=np(e),d={};if(!0===i&&(r=1)&&(i=null),l)e={p:e},n={p:n};else if(lp(e)&&!lp(n)){for(c=[],u=e.length,h=u-2,a=1;a<u;a++)c.push(t(e[a-1],e[a]));u--,s=function(t){t*=u;var e=Math.min(h,~~t);return c[e](t-e)},i=n}else r||(e=Xp(lp(e)?[]:{},e));if(!c){for(o in n)gg.call(d,e,o,"get",n[o]);s=function(t){return Og(t,d)||(l?e.p:e)}}}return Im(i,s)},shuffle:Nm},install:bp,effects:xp,ticker:Ym,updateRoot:dg.updateRoot,plugins:Op,globalTimeline:Mf,core:{PropTween:Ug,globals:Ep,Tween:Ig,Timeline:dg,Animation:lg,getCache:Fp,_removeLinkedListItem:em,reverting:function(){return Of},context:function(t){return t&&xf&&(xf.data.push(t),t._ctx=xf),xf},suppressOverwrites:function(t){return Rf=t}}};Bp("to,from,fromTo,delayedCall,set,killTweensOf",(function(t){return Kg[t]=Ig[t]})),Ym.add(dg.updateRoot),Bf=Kg.to({},{duration:0});var Gg=function(t,e){for(var n=t._pt;n&&n.p!==e&&n.op!==e&&n.fp!==e;)n=n._next;return n},Wg=function(t,e){return{name:t,rawVars:1,init:function(t,n,i){i._onInit=function(t){var i,r;if(np(n)&&(i={},Bp(n,(function(t){return i[t]=1})),n=i),e){for(r in i={},n)i[r]=e(n[r]);n=i}!function(t,e){var n,i,r,s=t._targets;for(n in e)for(i=s.length;i--;)(r=t._ptLookup[i][n])&&(r=r.d)&&(r._pt&&(r=Gg(r,n)),r&&r.modifier&&r.modifier(e[n],t,s[i],n))}(t,n)}}}},Qg=Kg.registerPlugin({name:"attr",init:function(t,e,n,i,r){var s,o,a;for(s in this.tween=n,e)a=t.getAttribute(s)||"",(o=this.add(t,"setAttribute",(a||0)+"",e[s],i,r,0,0,s)).op=s,o.b=a,this._props.push(s)},render:function(t,e){for(var n=e._pt;n;)Of?n.set(n.t,n.p,n.b,n):n.r(t,n.d),n=n._next}},{name:"endArray",init:function(t,e){for(var n=e.length;n--;)this.add(t,n,t[n]||0,e[n],0,0,0,0,0,1)}},Wg("roundProps",Om),Wg("modifiers"),Wg("snap",xm))||Kg;Ig.version=dg.version=Qg.version="3.11.3",Ff=1,cp()&&Jm(),Zm.Power0,Zm.Power1,Zm.Power2,Zm.Power3,Zm.Power4,Zm.Linear,Zm.Quad,Zm.Cubic,Zm.Quart,Zm.Quint,Zm.Strong,Zm.Elastic,Zm.Back,Zm.SteppedEase,Zm.Bounce,Zm.Sine,Zm.Expo,Zm.Circ;var Xg,Yg,Jg,Zg,ty,ey,ny,iy,ry={},sy=180/Math.PI,oy=Math.PI/180,ay=Math.atan2,cy=/([A-Z])/g,uy=/(left|right|width|margin|padding|x)/i,hy=/[\s,\(]\S/,ly={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},dy=function(t,e){return e.set(e.t,e.p,Math.round(1e4*(e.s+e.c*t))/1e4+e.u,e)},fy=function(t,e){return e.set(e.t,e.p,1===t?e.e:Math.round(1e4*(e.s+e.c*t))/1e4+e.u,e)},py=function(t,e){return e.set(e.t,e.p,t?Math.round(1e4*(e.s+e.c*t))/1e4+e.u:e.b,e)},my=function(t,e){var n=e.s+e.c*t;e.set(e.t,e.p,~~(n+(n<0?-.5:.5))+e.u,e)},gy=function(t,e){return e.set(e.t,e.p,t?e.e:e.b,e)},yy=function(t,e){return e.set(e.t,e.p,1!==t?e.b:e.e,e)},vy=function(t,e,n){return t.style[e]=n},_y=function(t,e,n){return t.style.setProperty(e,n)},wy=function(t,e,n){return t._gsap[e]=n},by=function(t,e,n){return t._gsap.scaleX=t._gsap.scaleY=n},Ty=function(t,e,n,i,r){var s=t._gsap;s.scaleX=s.scaleY=n,s.renderTransform(r,s)},Iy=function(t,e,n,i,r){var s=t._gsap;s[e]=n,s.renderTransform(r,s)},Ey="transform",Sy=Ey+"Origin",ky=function(t,e){var n=this,i=this.target,r=i.style;if(t in ry){if(this.tfm=this.tfm||{},"transform"!==t&&(~(t=ly[t]||t).indexOf(",")?t.split(",").forEach((function(t){return n.tfm[t]=$y(i,t)})):this.tfm[t]=i._gsap.x?i._gsap[t]:$y(i,t)),this.props.indexOf(Ey)>=0)return;i._gsap.svg&&(this.svgo=i.getAttribute("data-svg-origin"),this.props.push(Sy,e,"")),t=Ey}(r||e)&&this.props.push(t,e,r[t])},Cy=function(t){t.translate&&(t.removeProperty("translate"),t.removeProperty("scale"),t.removeProperty("rotate"))},Ay=function(){var t,e,n=this.props,i=this.target,r=i.style,s=i._gsap;for(t=0;t<n.length;t+=3)n[t+1]?i[n[t]]=n[t+2]:n[t+2]?r[n[t]]=n[t+2]:r.removeProperty(n[t].replace(cy,"-$1").toLowerCase());if(this.tfm){for(e in this.tfm)s[e]=this.tfm[e];s.svg&&(s.renderTransform(),i.setAttribute("data-svg-origin",this.svgo||"")),!(t=ny())||t.isStart||r[Ey]||(Cy(r),s.uncache=1)}},Dy=function(t,e){var n={target:t,props:[],revert:Ay,save:ky};return e&&e.split(",").forEach((function(t){return n.save(t)})),n},Ny=function(t,e){var n=Yg.createElementNS?Yg.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):Yg.createElement(t);return n.style?n:Yg.createElement(t)},Ry=function t(e,n,i){var r=getComputedStyle(e);return r[n]||r.getPropertyValue(n.replace(cy,"-$1").toLowerCase())||r.getPropertyValue(n)||!i&&t(e,xy(n)||n,1)||""},Oy="O,Moz,ms,Ms,Webkit".split(","),xy=function(t,e,n){var i=(e||ty).style,r=5;if(t in i&&!n)return t;for(t=t.charAt(0).toUpperCase()+t.substr(1);r--&&!(Oy[r]+t in i););return r<0?null:(3===r?"ms":r>=0?Oy[r]:"")+t},My=function(){"undefined"!=typeof window&&window.document&&(Xg=window,Yg=Xg.document,Jg=Yg.documentElement,ty=Ny("div")||{style:{}},Ny("div"),Ey=xy(Ey),Sy=Ey+"Origin",ty.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",iy=!!xy("perspective"),ny=Qg.core.reverting,Zg=1)},Ly=function t(e){var n,i=Ny("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),r=this.parentNode,s=this.nextSibling,o=this.style.cssText;if(Jg.appendChild(i),i.appendChild(this),this.style.display="block",e)try{n=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=t}catch(t){}else this._gsapBBox&&(n=this._gsapBBox());return r&&(s?r.insertBefore(this,s):r.appendChild(this)),Jg.removeChild(i),this.style.cssText=o,n},Py=function(t,e){for(var n=e.length;n--;)if(t.hasAttribute(e[n]))return t.getAttribute(e[n])},Uy=function(t){var e;try{e=t.getBBox()}catch(n){e=Ly.call(t,!0)}return e&&(e.width||e.height)||t.getBBox===Ly||(e=Ly.call(t,!0)),!e||e.width||e.x||e.y?e:{x:+Py(t,["x","cx","x1"])||0,y:+Py(t,["y","cy","y1"])||0,width:0,height:0}},Fy=function(t){return!(!t.getCTM||t.parentNode&&!t.ownerSVGElement||!Uy(t))},Vy=function(t,e){if(e){var n=t.style;e in ry&&e!==Sy&&(e=Ey),n.removeProperty?("ms"!==e.substr(0,2)&&"webkit"!==e.substr(0,6)||(e="-"+e),n.removeProperty(e.replace(cy,"-$1").toLowerCase())):n.removeAttribute(e)}},By=function(t,e,n,i,r,s){var o=new Ug(t._pt,e,n,0,1,s?yy:gy);return t._pt=o,o.b=i,o.e=r,t._props.push(n),o},jy={deg:1,rad:1,turn:1},qy={grid:1,flex:1},zy=function t(e,n,i,r){var s,o,a,c,u=parseFloat(i)||0,h=(i+"").trim().substr((u+"").length)||"px",l=ty.style,d=uy.test(n),f="svg"===e.tagName.toLowerCase(),p=(f?"client":"offset")+(d?"Width":"Height"),m=100,g="px"===r,y="%"===r;return r===h||!u||jy[r]||jy[h]?u:("px"!==h&&!g&&(u=t(e,n,i,"px")),c=e.getCTM&&Fy(e),!y&&"%"!==h||!ry[n]&&!~n.indexOf("adius")?(l[d?"width":"height"]=m+(g?h:r),o=~n.indexOf("adius")||"em"===r&&e.appendChild&&!f?e:e.parentNode,c&&(o=(e.ownerSVGElement||{}).parentNode),o&&o!==Yg&&o.appendChild||(o=Yg.body),(a=o._gsap)&&y&&a.width&&d&&a.time===Ym.time&&!a.uncache?jp(u/a.width*m):((y||"%"===h)&&!qy[Ry(o,"display")]&&(l.position=Ry(e,"position")),o===e&&(l.position="static"),o.appendChild(ty),s=ty[p],o.removeChild(ty),l.position="absolute",d&&y&&((a=Fp(o)).time=Ym.time,a.width=o[p]),jp(g?s*u/m:s&&u?m/s*u:0))):(s=c?e.getBBox()[d?"width":"height"]:e[p],jp(y?u/s*m:u/100*s)))},$y=function(t,e,n,i){var r;return Zg||My(),e in ly&&"transform"!==e&&~(e=ly[e]).indexOf(",")&&(e=e.split(",")[0]),ry[e]&&"transform"!==e?(r=nv(t,i),r="transformOrigin"!==e?r[e]:r.svg?r.origin:iv(Ry(t,Sy))+" "+r.zOrigin+"px"):(!(r=t.style[e])||"auto"===r||i||~(r+"").indexOf("calc("))&&(r=Qy[e]&&Qy[e](t,e,n)||Ry(t,e)||Vp(t,e)||("opacity"===e?1:0)),n&&!~(r+"").trim().indexOf(" ")?zy(t,e,r,n)+n:r},Hy=function(t,e,n,i){if(!n||"none"===n){var r=xy(e,t,1),s=r&&Ry(t,r,1);s&&s!==n?(e=r,n=s):"borderColor"===e&&(n=Ry(t,"borderTopColor"))}var o,a,c,u,h,l,d,f,p,m,g,y=new Ug(this._pt,t.style,e,0,1,Rg),v=0,_=0;if(y.b=n,y.e=i,n+="","auto"==(i+="")&&(t.style[e]=i,i=Ry(t,e)||i,t.style[e]=n),Xm(o=[n,i]),i=o[1],c=(n=o[0]).match(pp)||[],(i.match(pp)||[]).length){for(;a=pp.exec(i);)d=a[0],p=i.substring(v,a.index),h?h=(h+1)%5:"rgba("!==p.substr(-5)&&"hsla("!==p.substr(-5)||(h=1),d!==(l=c[_++]||"")&&(u=parseFloat(l)||0,g=l.substr((u+"").length),"="===d.charAt(1)&&(d=zp(u,d)+g),f=parseFloat(d),m=d.substr((f+"").length),v=pp.lastIndex-m.length,m||(m=m||Kf.units[e]||g,v===i.length&&(i+=m,y.e+=m)),g!==m&&(u=zy(t,e,l,m)||0),y._pt={_next:y._pt,p:p||1===_?p:",",s:u,c:f-u,m:h&&h<4||"zIndex"===e?Math.round:0});y.c=v<i.length?i.substring(v,i.length):""}else y.r="display"===e&&"none"===i?yy:gy;return gp.test(i)&&(y.e=0),this._pt=y,y},Ky={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Gy=function(t){var e=t.split(" "),n=e[0],i=e[1]||"50%";return"top"!==n&&"bottom"!==n&&"left"!==i&&"right"!==i||(t=n,n=i,i=t),e[0]=Ky[n]||n,e[1]=Ky[i]||i,e.join(" ")},Wy=function(t,e){if(e.tween&&e.tween._time===e.tween._dur){var n,i,r,s=e.t,o=s.style,a=e.u,c=s._gsap;if("all"===a||!0===a)o.cssText="",i=1;else for(r=(a=a.split(",")).length;--r>-1;)n=a[r],ry[n]&&(i=1,n="transformOrigin"===n?Sy:Ey),Vy(s,n);i&&(Vy(s,Ey),c&&(c.svg&&s.removeAttribute("transform"),nv(s,1),c.uncache=1,Cy(o)))}},Qy={clearProps:function(t,e,n,i,r){if("isFromStart"!==r.data){var s=t._pt=new Ug(t._pt,e,n,0,0,Wy);return s.u=i,s.pr=-10,s.tween=r,t._props.push(n),1}}},Xy=[1,0,0,1,0,0],Yy={},Jy=function(t){return"matrix(1, 0, 0, 1, 0, 0)"===t||"none"===t||!t},Zy=function(t){var e=Ry(t,Ey);return Jy(e)?Xy:e.substr(7).match(fp).map(jp)},tv=function(t,e){var n,i,r,s,o=t._gsap||Fp(t),a=t.style,c=Zy(t);return o.svg&&t.getAttribute("transform")?"1,0,0,1,0,0"===(c=[(r=t.transform.baseVal.consolidate().matrix).a,r.b,r.c,r.d,r.e,r.f]).join(",")?Xy:c:(c!==Xy||t.offsetParent||t===Jg||o.svg||(r=a.display,a.display="block",(n=t.parentNode)&&t.offsetParent||(s=1,i=t.nextElementSibling,Jg.appendChild(t)),c=Zy(t),r?a.display=r:Vy(t,"display"),s&&(i?n.insertBefore(t,i):n?n.appendChild(t):Jg.removeChild(t))),e&&c.length>6?[c[0],c[1],c[4],c[5],c[12],c[13]]:c)},ev=function(t,e,n,i,r,s){var o,a,c,u=t._gsap,h=r||tv(t,!0),l=u.xOrigin||0,d=u.yOrigin||0,f=u.xOffset||0,p=u.yOffset||0,m=h[0],g=h[1],y=h[2],v=h[3],_=h[4],w=h[5],b=e.split(" "),T=parseFloat(b[0])||0,I=parseFloat(b[1])||0;n?h!==Xy&&(a=m*v-g*y)&&(c=T*(-g/a)+I*(m/a)-(m*w-g*_)/a,T=T*(v/a)+I*(-y/a)+(y*w-v*_)/a,I=c):(T=(o=Uy(t)).x+(~b[0].indexOf("%")?T/100*o.width:T),I=o.y+(~(b[1]||b[0]).indexOf("%")?I/100*o.height:I)),i||!1!==i&&u.smooth?(_=T-l,w=I-d,u.xOffset=f+(_*m+w*y)-_,u.yOffset=p+(_*g+w*v)-w):u.xOffset=u.yOffset=0,u.xOrigin=T,u.yOrigin=I,u.smooth=!!i,u.origin=e,u.originIsAbsolute=!!n,t.style[Sy]="0px 0px",s&&(By(s,u,"xOrigin",l,T),By(s,u,"yOrigin",d,I),By(s,u,"xOffset",f,u.xOffset),By(s,u,"yOffset",p,u.yOffset)),t.setAttribute("data-svg-origin",T+" "+I)},nv=function(t,e){var n=t._gsap||new hg(t);if("x"in n&&!e&&!n.uncache)return n;var i,r,s,o,a,c,u,h,l,d,f,p,m,g,y,v,_,w,b,T,I,E,S,k,C,A,D,N,R,O,x,M,L=t.style,P=n.scaleX<0,U="px",F="deg",V=getComputedStyle(t),B=Ry(t,Sy)||"0";return i=r=s=c=u=h=l=d=f=0,o=a=1,n.svg=!(!t.getCTM||!Fy(t)),V.translate&&("none"===V.translate&&"none"===V.scale&&"none"===V.rotate||(L[Ey]=("none"!==V.translate?"translate3d("+(V.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+("none"!==V.rotate?"rotate("+V.rotate+") ":"")+("none"!==V.scale?"scale("+V.scale.split(" ").join(",")+") ":"")+("none"!==V[Ey]?V[Ey]:"")),L.scale=L.rotate=L.translate="none"),g=tv(t,n.svg),n.svg&&(n.uncache?(C=t.getBBox(),B=n.xOrigin-C.x+"px "+(n.yOrigin-C.y)+"px",k=""):k=!e&&t.getAttribute("data-svg-origin"),ev(t,k||B,!!k||n.originIsAbsolute,!1!==n.smooth,g)),p=n.xOrigin||0,m=n.yOrigin||0,g!==Xy&&(w=g[0],b=g[1],T=g[2],I=g[3],i=E=g[4],r=S=g[5],6===g.length?(o=Math.sqrt(w*w+b*b),a=Math.sqrt(I*I+T*T),c=w||b?ay(b,w)*sy:0,(l=T||I?ay(T,I)*sy+c:0)&&(a*=Math.abs(Math.cos(l*oy))),n.svg&&(i-=p-(p*w+m*T),r-=m-(p*b+m*I))):(M=g[6],O=g[7],D=g[8],N=g[9],R=g[10],x=g[11],i=g[12],r=g[13],s=g[14],u=(y=ay(M,R))*sy,y&&(k=E*(v=Math.cos(-y))+D*(_=Math.sin(-y)),C=S*v+N*_,A=M*v+R*_,D=E*-_+D*v,N=S*-_+N*v,R=M*-_+R*v,x=O*-_+x*v,E=k,S=C,M=A),h=(y=ay(-T,R))*sy,y&&(v=Math.cos(-y),x=I*(_=Math.sin(-y))+x*v,w=k=w*v-D*_,b=C=b*v-N*_,T=A=T*v-R*_),c=(y=ay(b,w))*sy,y&&(k=w*(v=Math.cos(y))+b*(_=Math.sin(y)),C=E*v+S*_,b=b*v-w*_,S=S*v-E*_,w=k,E=C),u&&Math.abs(u)+Math.abs(c)>359.9&&(u=c=0,h=180-h),o=jp(Math.sqrt(w*w+b*b+T*T)),a=jp(Math.sqrt(S*S+M*M)),y=ay(E,S),l=Math.abs(y)>2e-4?y*sy:0,f=x?1/(x<0?-x:x):0),n.svg&&(k=t.getAttribute("transform"),n.forceCSS=t.setAttribute("transform","")||!Jy(Ry(t,Ey)),k&&t.setAttribute("transform",k))),Math.abs(l)>90&&Math.abs(l)<270&&(P?(o*=-1,l+=c<=0?180:-180,c+=c<=0?180:-180):(a*=-1,l+=l<=0?180:-180)),e=e||n.uncache,n.x=i-((n.xPercent=i&&(!e&&n.xPercent||(Math.round(t.offsetWidth/2)===Math.round(-i)?-50:0)))?t.offsetWidth*n.xPercent/100:0)+U,n.y=r-((n.yPercent=r&&(!e&&n.yPercent||(Math.round(t.offsetHeight/2)===Math.round(-r)?-50:0)))?t.offsetHeight*n.yPercent/100:0)+U,n.z=s+U,n.scaleX=jp(o),n.scaleY=jp(a),n.rotation=jp(c)+F,n.rotationX=jp(u)+F,n.rotationY=jp(h)+F,n.skewX=l+F,n.skewY=d+F,n.transformPerspective=f+U,(n.zOrigin=parseFloat(B.split(" ")[2])||0)&&(L[Sy]=iv(B)),n.xOffset=n.yOffset=0,n.force3D=Kf.force3D,n.renderTransform=n.svg?hv:iy?uv:sv,n.uncache=0,n},iv=function(t){return(t=t.split(" "))[0]+" "+t[1]},rv=function(t,e,n){var i=Sm(e);return jp(parseFloat(e)+parseFloat(zy(t,"x",n+"px",i)))+i},sv=function(t,e){e.z="0px",e.rotationY=e.rotationX="0deg",e.force3D=0,uv(t,e)},ov="0deg",av="0px",cv=") ",uv=function(t,e){var n=e||this,i=n.xPercent,r=n.yPercent,s=n.x,o=n.y,a=n.z,c=n.rotation,u=n.rotationY,h=n.rotationX,l=n.skewX,d=n.skewY,f=n.scaleX,p=n.scaleY,m=n.transformPerspective,g=n.force3D,y=n.target,v=n.zOrigin,_="",w="auto"===g&&t&&1!==t||!0===g;if(v&&(h!==ov||u!==ov)){var b,T=parseFloat(u)*oy,I=Math.sin(T),E=Math.cos(T);T=parseFloat(h)*oy,b=Math.cos(T),s=rv(y,s,I*b*-v),o=rv(y,o,-Math.sin(T)*-v),a=rv(y,a,E*b*-v+v)}m!==av&&(_+="perspective("+m+cv),(i||r)&&(_+="translate("+i+"%, "+r+"%) "),(w||s!==av||o!==av||a!==av)&&(_+=a!==av||w?"translate3d("+s+", "+o+", "+a+") ":"translate("+s+", "+o+cv),c!==ov&&(_+="rotate("+c+cv),u!==ov&&(_+="rotateY("+u+cv),h!==ov&&(_+="rotateX("+h+cv),l===ov&&d===ov||(_+="skew("+l+", "+d+cv),1===f&&1===p||(_+="scale("+f+", "+p+cv),y.style[Ey]=_||"translate(0, 0)"},hv=function(t,e){var n,i,r,s,o,a=e||this,c=a.xPercent,u=a.yPercent,h=a.x,l=a.y,d=a.rotation,f=a.skewX,p=a.skewY,m=a.scaleX,g=a.scaleY,y=a.target,v=a.xOrigin,_=a.yOrigin,w=a.xOffset,b=a.yOffset,T=a.forceCSS,I=parseFloat(h),E=parseFloat(l);d=parseFloat(d),f=parseFloat(f),(p=parseFloat(p))&&(f+=p=parseFloat(p),d+=p),d||f?(d*=oy,f*=oy,n=Math.cos(d)*m,i=Math.sin(d)*m,r=Math.sin(d-f)*-g,s=Math.cos(d-f)*g,f&&(p*=oy,o=Math.tan(f-p),r*=o=Math.sqrt(1+o*o),s*=o,p&&(o=Math.tan(p),n*=o=Math.sqrt(1+o*o),i*=o)),n=jp(n),i=jp(i),r=jp(r),s=jp(s)):(n=m,s=g,i=r=0),(I&&!~(h+"").indexOf("px")||E&&!~(l+"").indexOf("px"))&&(I=zy(y,"x",h,"px"),E=zy(y,"y",l,"px")),(v||_||w||b)&&(I=jp(I+v-(v*n+_*r)+w),E=jp(E+_-(v*i+_*s)+b)),(c||u)&&(o=y.getBBox(),I=jp(I+c/100*o.width),E=jp(E+u/100*o.height)),o="matrix("+n+","+i+","+r+","+s+","+I+","+E+")",y.setAttribute("transform",o),T&&(y.style[Ey]=o)},lv=function(t,e,n,i,r){var s,o,a=360,c=np(r),u=parseFloat(r)*(c&&~r.indexOf("rad")?sy:1)-i,h=i+u+"deg";return c&&("short"===(s=r.split("_")[1])&&(u%=a)!=u%180&&(u+=u<0?a:-360),"cw"===s&&u<0?u=(u+36e9)%a-~~(u/a)*a:"ccw"===s&&u>0&&(u=(u-36e9)%a-~~(u/a)*a)),t._pt=o=new Ug(t._pt,e,n,i,u,fy),o.e=h,o.u="deg",t._props.push(n),o},dv=function(t,e){for(var n in e)t[n]=e[n];return t},fv=function(t,e,n){var i,r,s,o,a,c,u,h=dv({},n._gsap),l=n.style;for(r in h.svg?(s=n.getAttribute("transform"),n.setAttribute("transform",""),l[Ey]=e,i=nv(n,1),Vy(n,Ey),n.setAttribute("transform",s)):(s=getComputedStyle(n)[Ey],l[Ey]=e,i=nv(n,1),l[Ey]=s),ry)(s=h[r])!==(o=i[r])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(r)<0&&(a=Sm(s)!==(u=Sm(o))?zy(n,r,s,u):parseFloat(s),c=parseFloat(o),t._pt=new Ug(t._pt,i,r,a,c-a,dy),t._pt.u=u||0,t._props.push(r));dv(i,h)};Bp("padding,margin,Width,Radius",(function(t,e){var n="Top",i="Right",r="Bottom",s="Left",o=(e<3?[n,i,r,s]:[n+s,n+i,r+i,r+s]).map((function(n){return e<2?t+n:"border"+n+t}));Qy[e>1?"border"+t:t]=function(t,e,n,i,r){var s,a;if(arguments.length<4)return s=o.map((function(e){return $y(t,e,n)})),5===(a=s.join(" ")).split(s[0]).length?s[0]:a;s=(i+"").split(" "),a={},o.forEach((function(t,e){return a[t]=s[e]=s[e]||s[(e-1)/2|0]})),t.init(e,a,r)}}));var pv,mv,gv={name:"css",register:My,targetTest:function(t){return t.style&&t.nodeType},init:function(t,e,n,i,r){var s,o,a,c,u,h,l,d,f,p,m,g,y,v,_,w,b=this._props,T=t.style,I=n.vars.startAt;for(l in Zg||My(),this.styles=this.styles||Dy(t),w=this.styles.props,this.tween=n,e)if("autoRound"!==l&&(o=e[l],!Op[l]||!yg(l,e,n,i,t,r)))if(u=typeof o,h=Qy[l],"function"===u&&(u=typeof(o=o.call(n,i,t,r))),"string"===u&&~o.indexOf("random(")&&(o=Pm(o)),h)h(this,t,l,o,n)&&(_=1);else if("--"===l.substr(0,2))s=(getComputedStyle(t).getPropertyValue(l)+"").trim(),o+="",Wm.lastIndex=0,Wm.test(s)||(d=Sm(s),f=Sm(o)),f?d!==f&&(s=zy(t,l,s,f)+f):d&&(o+=d),this.add(T,"setProperty",s,o,i,r,0,0,l),b.push(l),w.push(l,0,T[l]);else if("undefined"!==u){if(I&&l in I?(s="function"==typeof I[l]?I[l].call(n,i,t,r):I[l],np(s)&&~s.indexOf("random(")&&(s=Pm(s)),Sm(s+"")||(s+=Kf.units[l]||Sm($y(t,l))||""),"="===(s+"").charAt(1)&&(s=$y(t,l))):s=$y(t,l),c=parseFloat(s),(p="string"===u&&"="===o.charAt(1)&&o.substr(0,2))&&(o=o.substr(2)),a=parseFloat(o),l in ly&&("autoAlpha"===l&&(1===c&&"hidden"===$y(t,"visibility")&&a&&(c=0),w.push("visibility",0,T.visibility),By(this,T,"visibility",c?"inherit":"hidden",a?"inherit":"hidden",!a)),"scale"!==l&&"transform"!==l&&~(l=ly[l]).indexOf(",")&&(l=l.split(",")[0])),m=l in ry)if(this.styles.save(l),g||((y=t._gsap).renderTransform&&!e.parseTransform||nv(t,e.parseTransform),v=!1!==e.smoothOrigin&&y.smooth,(g=this._pt=new Ug(this._pt,T,Ey,0,1,y.renderTransform,y,0,-1)).dep=1),"scale"===l)this._pt=new Ug(this._pt,y,"scaleY",c,(p?zp(c,p+a):a)-c||0,dy),this._pt.u=0,b.push("scaleY",l),l+="X";else{if("transformOrigin"===l){w.push(Sy,0,T[Sy]),o=Gy(o),y.svg?ev(t,o,0,v,0,this):((f=parseFloat(o.split(" ")[2])||0)!==y.zOrigin&&By(this,y,"zOrigin",y.zOrigin,f),By(this,T,l,iv(s),iv(o)));continue}if("svgOrigin"===l){ev(t,o,1,v,0,this);continue}if(l in Yy){lv(this,y,l,c,p?zp(c,p+o):o);continue}if("smoothOrigin"===l){By(this,y,"smooth",y.smooth,o);continue}if("force3D"===l){y[l]=o;continue}if("transform"===l){fv(this,o,t);continue}}else l in T||(l=xy(l)||l);if(m||(a||0===a)&&(c||0===c)&&!hy.test(o)&&l in T)a||(a=0),(d=(s+"").substr((c+"").length))!==(f=Sm(o)||(l in Kf.units?Kf.units[l]:d))&&(c=zy(t,l,s,f)),this._pt=new Ug(this._pt,m?y:T,l,c,(p?zp(c,p+a):a)-c,m||"px"!==f&&"zIndex"!==l||!1===e.autoRound?dy:my),this._pt.u=f||0,d!==f&&"%"!==f&&(this._pt.b=s,this._pt.r=py);else if(l in T)Hy.call(this,t,l,s,p?p+o:o);else{if(!(l in t)){Tp(l,o);continue}this.add(t,l,s||t[l],p?p+o:o,i,r)}m||(l in T?w.push(l,0,T[l]):w.push(l,1,s||t[l])),b.push(l)}_&&Pg(this)},render:function(t,e){if(e.tween._time||!ny())for(var n=e._pt;n;)n.r(t,n.d),n=n._next;else e.styles.revert()},get:$y,aliases:ly,getSetter:function(t,e,n){var i=ly[e];return i&&i.indexOf(",")<0&&(e=i),e in ry&&e!==Sy&&(t._gsap.x||$y(t,"x"))?n&&ey===n?"scale"===e?by:wy:(ey=n||{})&&("scale"===e?Ty:Iy):t.style&&!sp(t.style[e])?vy:~e.indexOf("-")?_y:Ag(t,e)},core:{_removeProperty:Vy,_getMatrix:tv}};Qg.utils.checkPrefix=xy,Qg.core.getStyleSaver=Dy,mv=Bp("x,y,z,scale,scaleX,scaleY,xPercent,yPercent"+","+(pv="rotation,rotationX,rotationY,skewX,skewY")+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",(function(t){ry[t]=1})),Bp(pv,(function(t){Kf.units[t]="deg",Yy[t]=1})),ly[mv[13]]="x,y,z,scale,scaleX,scaleY,xPercent,yPercent,"+pv,Bp("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",(function(t){var e=t.split(":");ly[e[1]]=mv[e[0]]})),Bp("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",(function(t){Kf.units[t]="px"})),Qg.registerPlugin(gv);var yv=Qg.registerPlugin(gv)||Qg;function vv(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}yv.core.Tween,yv.timeline({paused:!0}),Object.create,Object.create;const _v=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},wv=new p("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),bv=new P("@firebase/auth");function Tv(t,...e){bv.logLevel<=N.ERROR&&bv.error(`Auth (9.14.0): ${t}`,...e)}function Iv(t,...e){throw kv(t,...e)}function Ev(t,...e){return kv(t,...e)}function Sv(t,e,n){const i=Object.assign(Object.assign({},_v()),{[e]:n});return new p("auth","Firebase",i).create(e,{appName:t.name})}function kv(t,...e){if("string"!=typeof t){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return wv.create(t,...e)}function Cv(t,e,...n){if(!t)throw kv(e,...n)}function Av(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Tv(e),new Error(e)}function Dv(t,e){t||Av(e)}const Nv=new Map;function Rv(t){Dv(t instanceof Function,"Expected a class definition");let e=Nv.get(t);return e?(Dv(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Nv.set(t,e),e)}function Ov(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.href)||""}function xv(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.protocol)||null}class Mv{constructor(t,e){this.shortDelay=t,this.longDelay=e,Dv(e>t,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(s())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===xv()||"https:"===xv()||o()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function Lv(t,e){Dv(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class Pv{static initialize(t,e,n){this.fetchImpl=t,e&&(this.headersImpl=e),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void Av("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void Av("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void Av("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Uv={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},Fv=new Mv(3e4,6e4);function Vv(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Bv(t,e,n,i,r={}){return jv(t,r,(async()=>{let r={},s={};i&&("GET"===e?s=i:r={body:JSON.stringify(i)});const o=v(Object.assign({key:t.config.apiKey},s)).slice(1),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/json",t.languageCode&&(a["X-Firebase-Locale"]=t.languageCode),Pv.fetch()(zv(t,t.config.apiHost,n,o),Object.assign({method:e,headers:a,referrerPolicy:"no-referrer"},r))}))}async function jv(t,e,n){t._canInitEmulator=!1;const i=Object.assign(Object.assign({},Uv),e);try{const e=new $v(t),r=await Promise.race([n(),e.promise]);e.clearNetworkTimeout();const s=await r.json();if("needConfirmation"in s)throw Hv(t,"account-exists-with-different-credential",s);if(r.ok&&!("errorMessage"in s))return s;{const e=r.ok?s.errorMessage:s.error.message,[n,o]=e.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Hv(t,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw Hv(t,"email-already-in-use",s);if("USER_DISABLED"===n)throw Hv(t,"user-disabled",s);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw Sv(t,a,o);Iv(t,a)}}catch(e){if(e instanceof f)throw e;Iv(t,"network-request-failed")}}async function qv(t,e,n,i,r={}){const s=await Bv(t,e,n,i,r);return"mfaPendingCredential"in s&&Iv(t,"multi-factor-auth-required",{_serverResponse:s}),s}function zv(t,e,n,i){const r=`${e}${n}?${i}`;return t.config.emulator?Lv(t.config,r):`${t.config.apiScheme}://${r}`}class $v{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise(((t,e)=>{this.timer=setTimeout((()=>e(Ev(this.auth,"network-request-failed"))),Fv.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function Hv(t,e,n){const i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=Ev(t,e,i);return r.customData._tokenResponse=n,r}function Kv(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch(t){}}function Gv(t){return 1e3*Number(t)}function Wv(t){var e;const[n,i,s]=t.split(".");if(void 0===n||void 0===i||void 0===s)return Tv("JWT malformed, contained fewer than 3 sections"),null;try{const t=r(i);return t?JSON.parse(t):(Tv("Failed to decode base64 JWT payload"),null)}catch(t){return Tv("Caught error parsing JWT payload as JSON",null===(e=t)||void 0===e?void 0:e.toString()),null}}async function Qv(t,e,n=!1){if(n)return e;try{return await e}catch(e){throw e instanceof f&&function({code:t}){return"auth/user-disabled"===t||"auth/user-token-expired"===t}(e)&&t.auth.currentUser===t&&await t.auth.signOut(),e}}class Xv{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const t=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),t}{this.errorBackoff=3e4;const t=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,t)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout((async()=>{await this.iteration()}),e)}async iteration(){var t;try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null===(t=e)||void 0===t?void 0:t.code)&&this.schedule(!0))}this.schedule()}}class Yv{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=Kv(this.lastLoginAt),this.creationTime=Kv(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Jv(t){var e;const n=t.auth,i=await t.getIdToken(),r=await Qv(t,async function(t,e){return Bv(t,"POST","/v1/accounts:lookup",e)}(n,{idToken:i}));Cv(null==r?void 0:r.users.length,n,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const o=(null===(e=s.providerUserInfo)||void 0===e?void 0:e.length)?s.providerUserInfo.map((t=>{var{providerId:e}=t,n=vv(t,["providerId"]);return{providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],a=function(t,e){const n=t.filter((t=>!e.some((e=>e.providerId===t.providerId))));return[...n,...e]}(t.providerData,o),c=t.isAnonymous,u=!(t.email&&s.passwordHash||(null==a?void 0:a.length)),h=!!c&&u,l={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Yv(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(t,l)}class Zv{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){Cv(t.idToken,"internal-error"),Cv(void 0!==t.idToken,"internal-error"),Cv(void 0!==t.refreshToken,"internal-error");const e="expiresIn"in t&&void 0!==t.expiresIn?Number(t.expiresIn):function(t){const e=Wv(t);return Cv(e,"internal-error"),Cv(void 0!==e.exp,"internal-error"),Cv(void 0!==e.iat,"internal-error"),Number(e.exp)-Number(e.iat)}(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}async getToken(t,e=!1){return Cv(!this.accessToken||this.refreshToken,t,"user-token-expired"),e||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:n,refreshToken:i,expiresIn:r}=await async function(t,e){const n=await jv(t,{},(async()=>{const n=v({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:r}=t.config,s=zv(t,i,"/v1/token",`key=${r}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",Pv.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(t,e);this.updateTokensAndExpiration(n,i,Number(r))}updateTokensAndExpiration(t,e,n){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(t,e){const{refreshToken:n,accessToken:i,expirationTime:r}=e,s=new Zv;return n&&(Cv("string"==typeof n,"internal-error",{appName:t}),s.refreshToken=n),i&&(Cv("string"==typeof i,"internal-error",{appName:t}),s.accessToken=i),r&&(Cv("number"==typeof r,"internal-error",{appName:t}),s.expirationTime=r),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new Zv,this.toJSON())}_performRefresh(){return Av("not implemented")}}function t_(t,e){Cv("string"==typeof t||void 0===t,"internal-error",{appName:e})}class e_{constructor(t){var{uid:e,auth:n,stsTokenManager:i}=t,r=vv(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Xv(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Yv(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(t){const e=await Qv(this,this.stsTokenManager.getToken(this.auth,t));return Cv(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return async function(t,e=!1){const n=E(t),i=await n.getIdToken(e),r=Wv(i);Cv(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const s="object"==typeof r.firebase?r.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:r,token:i,authTime:Kv(Gv(r.auth_time)),issuedAtTime:Kv(Gv(r.iat)),expirationTime:Kv(Gv(r.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,t)}reload(){return async function(t){const e=E(t);await Jv(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}(this)}_assign(t){this!==t&&(Cv(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map((t=>Object.assign({},t))),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){return new e_(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(t){Cv(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),e&&await Jv(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const t=await this.getIdToken();return await Qv(this,async function(t,e){return Bv(t,"POST","/v1/accounts:delete",e)}(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((t=>Object.assign({},t))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var n,i,r,s,o,a,c,u;const h=null!==(n=e.displayName)&&void 0!==n?n:void 0,l=null!==(i=e.email)&&void 0!==i?i:void 0,d=null!==(r=e.phoneNumber)&&void 0!==r?r:void 0,f=null!==(s=e.photoURL)&&void 0!==s?s:void 0,p=null!==(o=e.tenantId)&&void 0!==o?o:void 0,m=null!==(a=e._redirectEventId)&&void 0!==a?a:void 0,g=null!==(c=e.createdAt)&&void 0!==c?c:void 0,y=null!==(u=e.lastLoginAt)&&void 0!==u?u:void 0,{uid:v,emailVerified:_,isAnonymous:w,providerData:b,stsTokenManager:T}=e;Cv(v&&T,t,"internal-error");const I=Zv.fromJSON(this.name,T);Cv("string"==typeof v,t,"internal-error"),t_(h,t.name),t_(l,t.name),Cv("boolean"==typeof _,t,"internal-error"),Cv("boolean"==typeof w,t,"internal-error"),t_(d,t.name),t_(f,t.name),t_(p,t.name),t_(m,t.name),t_(g,t.name),t_(y,t.name);const E=new e_({uid:v,auth:t,email:l,emailVerified:_,displayName:h,isAnonymous:w,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:I,createdAt:g,lastLoginAt:y});return b&&Array.isArray(b)&&(E.providerData=b.map((t=>Object.assign({},t)))),m&&(E._redirectEventId=m),E}static async _fromIdTokenResponse(t,e,n=!1){const i=new Zv;i.updateFromServerResponse(e);const r=new e_({uid:e.localId,auth:t,stsTokenManager:i,isAnonymous:n});return await Jv(r),r}}class n_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return void 0===e?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}n_.type="NONE";const i_=n_;function r_(t,e,n){return`firebase:${t}:${e}:${n}`}class s_{constructor(t,e,n){this.persistence=t,this.auth=e,this.userKey=n;const{config:i,name:r}=this.auth;this.fullUserKey=r_(this.userKey,i.apiKey,r),this.fullPersistenceKey=r_("persistence",i.apiKey,r),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?e_._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=t,e?this.setCurrentUser(e):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,n="authUser"){if(!e.length)return new s_(Rv(i_),t,n);const i=(await Promise.all(e.map((async t=>{if(await t._isAvailable())return t})))).filter((t=>t));let r=i[0]||Rv(i_);const s=r_(n,t.config.apiKey,t.name);let o=null;for(const n of e)try{const e=await n._get(s);if(e){const i=e_._fromJSON(t,e);n!==r&&(o=i),r=n;break}}catch(t){}const a=i.filter((t=>t._shouldAllowMigration));return r._shouldAllowMigration&&a.length?(r=a[0],o&&await r._set(s,o.toJSON()),await Promise.all(e.map((async t=>{if(t!==r)try{await t._remove(s)}catch(t){}}))),new s_(r,t,n)):new s_(r,t,n)}}function o_(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(h_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(a_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(d_(e))return"Blackberry";if(f_(e))return"Webos";if(c_(e))return"Safari";if((e.includes("chrome/")||u_(e))&&!e.includes("edge/"))return"Chrome";if(l_(e))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(e);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function a_(t=s()){return/firefox\//i.test(t)}function c_(t=s()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function u_(t=s()){return/crios\//i.test(t)}function h_(t=s()){return/iemobile/i.test(t)}function l_(t=s()){return/android/i.test(t)}function d_(t=s()){return/blackberry/i.test(t)}function f_(t=s()){return/webos/i.test(t)}function p_(t=s()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function m_(t=s()){return p_(t)||l_(t)||f_(t)||d_(t)||/windows phone/i.test(t)||h_(t)}function g_(t,e=[]){let n;switch(t){case"Browser":n=o_(s());break;case"Worker":n=`${o_(s())}-${t}`;break;default:n=t}return`${n}/JsCore/9.14.0/${e.length?e.join(","):"FirebaseCore-web"}`}class y_{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const n=e=>new Promise(((n,i)=>{try{n(t(e))}catch(t){i(t)}}));n.onAbort=e,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(t){var e;if(this.auth.currentUser===t)return;const n=[];try{for(const e of this.queue)await e(t),e.onAbort&&n.push(e.onAbort)}catch(t){n.reverse();for(const t of n)try{t()}catch(t){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===(e=t)||void 0===e?void 0:e.message})}}}class v_{constructor(t,e,n){this.app=t,this.heartbeatServiceProvider=e,this.config=n,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new w_(this),this.idTokenSubscription=new w_(this),this.beforeStateQueue=new y_(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=wv,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=n.sdkClientVersion}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=Rv(e)),this._initializationPromise=this.queue((async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await s_.create(this,t),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(t){}await this.initializeCurrentUser(e),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();return this.currentUser||t?this.currentUser&&t&&this.currentUser.uid===t.uid?(this._currentUser._assign(t),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(t,!0):void 0}async initializeCurrentUser(t){var e;const n=await this.assertedPersistence.getCurrentUser();let i=n,r=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(e=this.redirectUser)||void 0===e?void 0:e._redirectEventId,s=null==i?void 0:i._redirectEventId,o=await this.tryRedirectSignIn(t);n&&n!==s||!(null==o?void 0:o.user)||(i=o.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(t){i=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(t)))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Cv(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch(t){await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){var e;try{await Jv(t)}catch(t){if("auth/network-request-failed"!==(null===(e=t)||void 0===e?void 0:e.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(t){const e=t?E(t):null;return e&&Cv(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t,e=!1){if(!this._deleted)return t&&Cv(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue((async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()}))}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(t){return this.queue((async()=>{await this.assertedPersistence.setPersistence(Rv(t))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new p("auth","Firebase",t())}onAuthStateChanged(t,e,n){return this.registerStateListener(this.authStateSubscription,t,e,n)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,n){return this.registerStateListener(this.idTokenSubscription,t,e,n)}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}async _setRedirectUser(t,e){const n=await this.getOrInitRedirectPersistenceManager(e);return null===t?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&Rv(t)||this._popupRedirectResolver;Cv(e,this,"argument-error"),this.redirectPersistenceManager=await s_.create(this,[Rv(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var e,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(e=this._currentUser)||void 0===e?void 0:e._redirectEventId)===t?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(t)))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,n,i){if(this._deleted)return()=>{};const r="function"==typeof e?e:e.next.bind(e),s=this._isInitialized?Promise.resolve():this._initializationPromise;return Cv(s,this,"internal-error"),s.then((()=>r(this.currentUser))),"function"==typeof e?t.addObserver(e,n,i):t.addObserver(e)}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return Cv(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){t&&!this.frameworks.includes(t)&&(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=g_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(t=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader());return n&&(e["X-Firebase-Client"]=n),e}}function __(t){return E(t)}class w_{constructor(t){this.auth=t,this.observer=null,this.addObserver=function(t,e){const n=new b(t,void 0);return n.subscribe.bind(n)}((t=>this.observer=t))}get next(){return Cv(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function b_(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function T_(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}class I_{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return Av("not implemented")}_getIdTokenResponse(t){return Av("not implemented")}_linkToIdToken(t,e){return Av("not implemented")}_getReauthenticationResolver(t){return Av("not implemented")}}class E_ extends I_{constructor(t,e,n,i=null){super("password",n),this._email=t,this._password=e,this._tenantId=i}static _fromEmailAndPassword(t,e){return new E_(t,e,"password")}static _fromEmailAndCode(t,e,n=null){return new E_(t,e,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t;if((null==e?void 0:e.email)&&(null==e?void 0:e.password)){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":return async function(t,e){return qv(t,"POST","/v1/accounts:signInWithPassword",Vv(t,e))}(t,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(t,e){return qv(t,"POST","/v1/accounts:signInWithEmailLink",Vv(t,e))}(t,{email:this._email,oobCode:this._password});default:Iv(t,"internal-error")}}async _linkToIdToken(t,e){switch(this.signInMethod){case"password":return async function(t,e){return Bv(t,"POST","/v1/accounts:update",e)}(t,{idToken:e,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(t,e){return qv(t,"POST","/v1/accounts:signInWithEmailLink",Vv(t,e))}(t,{idToken:e,email:this._email,oobCode:this._password});default:Iv(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}async function S_(t,e){return qv(t,"POST","/v1/accounts:signInWithIdp",Vv(t,e))}class k_ extends I_{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new k_(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):Iv("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t,{providerId:n,signInMethod:i}=e,r=vv(e,["providerId","signInMethod"]);if(!n||!i)return null;const s=new k_(n,i);return s.idToken=r.idToken||void 0,s.accessToken=r.accessToken||void 0,s.secret=r.secret,s.nonce=r.nonce,s.pendingToken=r.pendingToken||null,s}_getIdTokenResponse(t){return S_(t,this.buildRequest())}_linkToIdToken(t,e){const n=this.buildRequest();return n.idToken=e,S_(t,n)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,S_(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=v(e)}return t}}const C_={USER_NOT_FOUND:"user-not-found"};class A_ extends I_{constructor(t){super("phone","phone"),this.params=t}static _fromVerification(t,e){return new A_({verificationId:t,verificationCode:e})}static _fromTokenResponse(t,e){return new A_({phoneNumber:t,temporaryProof:e})}_getIdTokenResponse(t){return async function(t,e){return qv(t,"POST","/v1/accounts:signInWithPhoneNumber",Vv(t,e))}(t,this._makeVerificationRequest())}_linkToIdToken(t,e){return async function(t,e){const n=await qv(t,"POST","/v1/accounts:signInWithPhoneNumber",Vv(t,e));if(n.temporaryProof)throw Hv(t,"account-exists-with-different-credential",n);return n}(t,Object.assign({idToken:e},this._makeVerificationRequest()))}_getReauthenticationResolver(t){return async function(t,e){return qv(t,"POST","/v1/accounts:signInWithPhoneNumber",Vv(t,Object.assign(Object.assign({},e),{operation:"REAUTH"})),C_)}(t,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:t,phoneNumber:e,verificationId:n,verificationCode:i}=this.params;return t&&e?{temporaryProof:t,phoneNumber:e}:{sessionInfo:n,code:i}}toJSON(){const t={providerId:this.providerId};return this.params.phoneNumber&&(t.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(t.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(t.verificationCode=this.params.verificationCode),this.params.verificationId&&(t.verificationId=this.params.verificationId),t}static fromJSON(t){"string"==typeof t&&(t=JSON.parse(t));const{verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:r}=t;return n||e||i||r?new A_({verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:r}):null}}class D_{constructor(t){var e,n,i,r,s,o;const a=_(w(t)),c=null!==(e=a.apiKey)&&void 0!==e?e:null,u=null!==(n=a.oobCode)&&void 0!==n?n:null,h=function(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=a.mode)&&void 0!==i?i:null);Cv(c&&u&&h,"argument-error"),this.apiKey=c,this.operation=h,this.code=u,this.continueUrl=null!==(r=a.continueUrl)&&void 0!==r?r:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(t){const e=function(t){const e=_(w(t)).link,n=e?_(w(e)).deep_link_id:null,i=_(w(t)).deep_link_id;return(i?_(w(i)).link:null)||i||n||e||t}(t);try{return new D_(e)}catch(t){return null}}}class N_{constructor(){this.providerId=N_.PROVIDER_ID}static credential(t,e){return E_._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const n=D_.parseLink(e);return Cv(n,"argument-error"),E_._fromEmailAndCode(t,n.code,n.tenantId)}}N_.PROVIDER_ID="password",N_.EMAIL_PASSWORD_SIGN_IN_METHOD="password",N_.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class R_{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class O_ extends R_{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class x_ extends O_{constructor(){super("facebook.com")}static credential(t){return k_._fromParams({providerId:x_.PROVIDER_ID,signInMethod:x_.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return x_.credentialFromTaggedObject(t)}static credentialFromError(t){return x_.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return x_.credential(t.oauthAccessToken)}catch(t){return null}}}x_.FACEBOOK_SIGN_IN_METHOD="facebook.com",x_.PROVIDER_ID="facebook.com";class M_ extends O_{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return k_._fromParams({providerId:M_.PROVIDER_ID,signInMethod:M_.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return M_.credentialFromTaggedObject(t)}static credentialFromError(t){return M_.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:n}=t;if(!e&&!n)return null;try{return M_.credential(e,n)}catch(t){return null}}}M_.GOOGLE_SIGN_IN_METHOD="google.com",M_.PROVIDER_ID="google.com";class L_ extends O_{constructor(){super("github.com")}static credential(t){return k_._fromParams({providerId:L_.PROVIDER_ID,signInMethod:L_.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return L_.credentialFromTaggedObject(t)}static credentialFromError(t){return L_.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return L_.credential(t.oauthAccessToken)}catch(t){return null}}}L_.GITHUB_SIGN_IN_METHOD="github.com",L_.PROVIDER_ID="github.com";class P_ extends O_{constructor(){super("twitter.com")}static credential(t,e){return k_._fromParams({providerId:P_.PROVIDER_ID,signInMethod:P_.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return P_.credentialFromTaggedObject(t)}static credentialFromError(t){return P_.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:n}=t;if(!e||!n)return null;try{return P_.credential(e,n)}catch(t){return null}}}P_.TWITTER_SIGN_IN_METHOD="twitter.com",P_.PROVIDER_ID="twitter.com";class U_{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,n,i=!1){const r=await e_._fromIdTokenResponse(t,n,i),s=F_(n);return new U_({user:r,providerId:s,_tokenResponse:n,operationType:e})}static async _forOperation(t,e,n){await t._updateTokensIfNecessary(n,!0);const i=F_(n);return new U_({user:t,providerId:i,_tokenResponse:n,operationType:e})}}function F_(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class V_ extends f{constructor(t,e,n,i){var r;super(e.code,e.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,V_.prototype),this.customData={appName:t.name,tenantId:null!==(r=t.tenantId)&&void 0!==r?r:void 0,_serverResponse:e.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,e,n,i){return new V_(t,e,n,i)}}function B_(t,e,n,i){return("reauthenticate"===e?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw V_._fromErrorAndOperation(t,n,e,i);throw n}))}async function j_(t,e,n=!1){const i="signIn",r=await B_(t,i,e),s=await U_._fromIdTokenResponse(t,i,r);return n||await t._updateCurrentUser(s.user),s}new WeakMap;const q_="__sak";class z_{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(q_,"1"),this.storage.removeItem(q_),Promise.resolve(!0)):Promise.resolve(!1)}catch(t){return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}class $_ extends z_{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const t=s();return c_(t)||p_(t)}()&&function(){try{return!(!window||window===window.top)}catch(t){return!1}}(),this.fallbackToPolling=m_(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const n=this.storage.getItem(e),i=this.localCache[e];n!==i&&t(e,i,n)}}onStorageEvent(t,e=!1){if(!t.key)return void this.forAllChangedKeys(((t,e,n)=>{this.notifyListeners(t,n)}));const n=t.key;if(e?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(t.newValue!==i)null!==t.newValue?this.storage.setItem(n,t.newValue):this.storage.removeItem(n);else if(this.localCache[n]===t.newValue&&!e)return}const i=()=>{const t=this.storage.getItem(n);(e||this.localCache[n]!==t)&&this.notifyListeners(n,t)},r=this.storage.getItem(n);!function(){const t=s();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}()||10!==document.documentMode||r===t.newValue||t.newValue===t.oldValue?i():setTimeout(i,10)}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e?JSON.parse(e):e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((t,e,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}$_.type="LOCAL";const H_=$_;class K_ extends z_{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(t,e){}_removeListener(t,e){}}K_.type="SESSION";const G_=K_;class W_{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find((e=>e.isListeningto(t)));if(e)return e;const n=new W_(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:n,eventType:i,data:r}=e.data,s=this.handlersMap[i];if(!(null==s?void 0:s.size))return;e.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(s).map((async t=>t(e.origin,r))),a=await function(t){return Promise.all(t.map((async t=>{try{return{fulfilled:!0,value:await t}}catch(t){return{fulfilled:!1,reason:t}}})))}(o);e.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(t,e){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),e&&0!==this.handlersMap[t].size||delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Q_(t="",e=10){let n="";for(let t=0;t<e;t++)n+=Math.floor(10*Math.random());return t+n}W_.receivers=[];class X_{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,n=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,s;return new Promise(((o,a)=>{const c=Q_("",20);i.port1.start();const u=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:i,onMessage(t){const e=t;if(e.data.eventId===c)switch(e.data.status){case"ack":clearTimeout(u),r=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(r),o(e.data.response);break;default:clearTimeout(u),clearTimeout(r),a(new Error("invalid_response"))}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:t,eventId:c,data:e},[i.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function Y_(){return window}function J_(){return void 0!==Y_().WorkerGlobalScope&&"function"==typeof Y_().importScripts}const Z_="firebaseLocalStorageDb",tw="firebaseLocalStorage",ew="fbase_key";class nw{constructor(t){this.request=t}toPromise(){return new Promise(((t,e)=>{this.request.addEventListener("success",(()=>{t(this.request.result)})),this.request.addEventListener("error",(()=>{e(this.request.error)}))}))}}function iw(t,e){return t.transaction([tw],e?"readwrite":"readonly").objectStore(tw)}function rw(){const t=indexedDB.open(Z_,1);return new Promise(((e,n)=>{t.addEventListener("error",(()=>{n(t.error)})),t.addEventListener("upgradeneeded",(()=>{const e=t.result;try{e.createObjectStore(tw,{keyPath:ew})}catch(t){n(t)}})),t.addEventListener("success",(async()=>{const n=t.result;n.objectStoreNames.contains(tw)?e(n):(n.close(),await function(){const t=indexedDB.deleteDatabase(Z_);return new nw(t).toPromise()}(),e(await rw()))}))}))}async function sw(t,e,n){const i=iw(t,!0).put({[ew]:e,value:n});return new nw(i).toPromise()}function ow(t,e){const n=iw(t,!0).delete(e);return new nw(n).toPromise()}class aw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await rw()),this.db}async _withRetries(t){let e=0;for(;;)try{const e=await this._openDb();return await t(e)}catch(t){if(e++>3)throw t;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return J_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=W_._getInstance(J_()?self:null),this.receiver._subscribe("keyChanged",(async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)}))),this.receiver._subscribe("ping",(async(t,e)=>["keyChanged"]))}async initializeSender(){var t,e;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(t){return null}}(),!this.activeServiceWorker)return;this.sender=new X_(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(t=n[0])||void 0===t?void 0:t.fulfilled)&&(null===(e=n[0])||void 0===e?void 0:e.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(this.sender&&this.activeServiceWorker&&function(){var t;return(null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await rw();return await sw(t,q_,"1"),await ow(t,q_),!0}catch(t){}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite((async()=>(await this._withRetries((n=>sw(n,t,e))),this.localCache[t]=e,this.notifyServiceWorker(t))))}async _get(t){const e=await this._withRetries((e=>async function(t,e){const n=iw(t,!1).get(e),i=await new nw(n).toPromise();return void 0===i?null:i.value}(e,t)));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite((async()=>(await this._withRetries((e=>ow(e,t))),delete this.localCache[t],this.notifyServiceWorker(t))))}async _poll(){const t=await this._withRetries((t=>{const e=iw(t,!1).getAll();return new nw(e).toPromise()}));if(!t)return[];if(0!==this.pendingWrites)return[];const e=[],n=new Set;for(const{fbase_key:i,value:r}of t)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),e.push(i));for(const t of Object.keys(this.localCache))this.localCache[t]&&!n.has(t)&&(this.notifyListeners(t,null),e.push(t));return e}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}aw.type="LOCAL";const cw=aw;function uw(t){return`__${t}${Math.floor(1e6*Math.random())}`}uw("rcb"),new Mv(3e4,6e4);class hw{constructor(t){this.providerId=hw.PROVIDER_ID,this.auth=__(t)}verifyPhoneNumber(t,e){return async function(t,e,n){var i;const r=await n.verify();try{let s;if(Cv("string"==typeof r,t,"argument-error"),Cv("recaptcha"===n.type,t,"argument-error"),s="string"==typeof e?{phoneNumber:e}:e,"session"in s){const e=s.session;if("phoneNumber"in s){Cv("enroll"===e.type,t,"internal-error");const n=await function(t,e){return Bv(t,"POST","/v2/accounts/mfaEnrollment:start",Vv(t,e))}(t,{idToken:e.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:r}});return n.phoneSessionInfo.sessionInfo}{Cv("signin"===e.type,t,"internal-error");const n=(null===(i=s.multiFactorHint)||void 0===i?void 0:i.uid)||s.multiFactorUid;Cv(n,t,"missing-multi-factor-info");const o=await function(t,e){return Bv(t,"POST","/v2/accounts/mfaSignIn:start",Vv(t,e))}(t,{mfaPendingCredential:e.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:r}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:e}=await async function(t,e){return Bv(t,"POST","/v1/accounts:sendVerificationCode",Vv(t,e))}(t,{phoneNumber:s.phoneNumber,recaptchaToken:r});return e}}finally{n._reset()}}(this.auth,t,E(e))}static credential(t,e){return A_._fromVerification(t,e)}static credentialFromResult(t){const e=t;return hw.credentialFromTaggedObject(e)}static credentialFromError(t){return hw.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{phoneNumber:e,temporaryProof:n}=t;return e&&n?A_._fromTokenResponse(e,n):null}}function lw(t,e){return e?Rv(e):(Cv(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}hw.PROVIDER_ID="phone",hw.PHONE_SIGN_IN_METHOD="phone";class dw extends I_{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return S_(t,this._buildIdpRequest())}_linkToIdToken(t,e){return S_(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return S_(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function fw(t){return j_(t.auth,new dw(t),t.bypassAuthState)}function pw(t){const{auth:e,user:n}=t;return Cv(n,e,"internal-error"),async function(t,e,n=!1){var i;const{auth:r}=t,s="reauthenticate";try{const i=await Qv(t,B_(r,s,e,t),n);Cv(i.idToken,r,"internal-error");const o=Wv(i.idToken);Cv(o,r,"internal-error");const{sub:a}=o;return Cv(t.uid===a,r,"user-mismatch"),U_._forOperation(t,s,i)}catch(t){throw"auth/user-not-found"===(null===(i=t)||void 0===i?void 0:i.code)&&Iv(r,"user-mismatch"),t}}(n,new dw(t),t.bypassAuthState)}async function mw(t){const{auth:e,user:n}=t;return Cv(n,e,"internal-error"),async function(t,e,n=!1){const i=await Qv(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return U_._forOperation(t,"link",i)}(n,new dw(t),t.bypassAuthState)}class gw{constructor(t,e,n,i,r=!1){this.auth=t,this.resolver=n,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise((async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(t){this.reject(t)}}))}async onAuthEvent(t){const{urlResponse:e,sessionId:n,postBody:i,tenantId:r,error:s,type:o}=t;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:e,sessionId:n,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(t){this.reject(t)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return fw;case"linkViaPopup":case"linkViaRedirect":return mw;case"reauthViaPopup":case"reauthViaRedirect":return pw;default:Iv(this.auth,"internal-error")}}resolve(t){Dv(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){Dv(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const yw=new Mv(2e3,1e4);class vw extends gw{constructor(t,e,n,i,r){super(t,e,i,r),this.provider=n,this.authWindow=null,this.pollId=null,vw.currentPopupAction&&vw.currentPopupAction.cancel(),vw.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return Cv(t,this.auth,"internal-error"),t}async onExecution(){Dv(1===this.filter.length,"Popup operations only handle one event");const t=Q_();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch((t=>{this.reject(t)})),this.resolver._isIframeWebStorageSupported(this.auth,(t=>{t||this.reject(Ev(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(Ev(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,vw.currentPopupAction=null}pollUserCancellation(){const t=()=>{var e,n;(null===(n=null===(e=this.authWindow)||void 0===e?void 0:e.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(Ev(this.auth,"popup-closed-by-user"))}),2e3):this.pollId=window.setTimeout(t,yw.get())};t()}}vw.currentPopupAction=null;const _w=new Map;class ww extends gw{constructor(t,e,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,n),this.eventId=null}async execute(){let t=_w.get(this.auth._key());if(!t){try{const e=await async function(t,e){const n=function(t){return r_("pendingRedirect",t.config.apiKey,t.name)}(e),i=function(t){return Rv(t._redirectPersistence)}(t);if(!await i._isAvailable())return!1;const r="true"===await i._get(n);return await i._remove(n),r}(this.resolver,this.auth),n=e?await super.execute():null;t=()=>Promise.resolve(n)}catch(e){t=()=>Promise.reject(e)}_w.set(this.auth._key(),t)}return this.bypassAuthState||_w.set(this.auth._key(),(()=>Promise.resolve(null))),t()}async onAuthEvent(t){if("signInViaRedirect"===t.type)return super.onAuthEvent(t);if("unknown"!==t.type){if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function bw(t,e){_w.set(t._key(),e)}async function Tw(t,e,n=!1){const i=__(t),r=lw(i,e),s=new ww(i,r,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}class Iw{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(t,n)&&(e=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))})),this.hasHandledPotentialRedirect||!function(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Sw(t);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var n;if(t.error&&!Sw(t)){const i=(null===(n=t.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";e.onError(Ev(this.auth,i))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const n=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ew(t))}saveEventToCache(t){this.cachedEventUids.add(Ew(t)),this.lastProcessedEventTime=Date.now()}}function Ew(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter((t=>t)).join("-")}function Sw({type:t,error:e}){return"unknown"===t&&"auth/no-auth-event"===(null==e?void 0:e.code)}const kw=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Cw=/^https?/;function Aw(t){const e=Ov(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const r=new URL(t);return""===r.hostname&&""===i?"chrome-extension:"===n&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===i}if(!Cw.test(n))return!1;if(kw.test(t))return i===t;const r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const Dw=new Mv(3e4,6e4);function Nw(){const t=Y_().___jsl;if(null==t?void 0:t.H)for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let e=0;e<t.CP.length;e++)t.CP[e]=null}let Rw=null;function Ow(t){return Rw=Rw||function(t){return new Promise(((e,n)=>{var i,r,s,o;function a(){Nw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Nw(),n(Ev(t,"network-request-failed"))},timeout:Dw.get()})}if(null===(r=null===(i=Y_().gapi)||void 0===i?void 0:i.iframes)||void 0===r?void 0:r.Iframe)e(gapi.iframes.getContext());else{if(!(null===(s=Y_().gapi)||void 0===s?void 0:s.load)){const e=uw("iframefcb");return Y_()[e]=()=>{gapi.load?a():n(Ev(t,"network-request-failed"))},(o=`https://apis.google.com/js/api.js?onload=${e}`,new Promise(((t,e)=>{const n=document.createElement("script");n.setAttribute("src",o),n.onload=t,n.onerror=t=>{const n=Ev("internal-error");n.customData=t,e(n)},n.type="text/javascript",n.charset="UTF-8",function(){var t,e;return null!==(e=null===(t=document.getElementsByTagName("head"))||void 0===t?void 0:t[0])&&void 0!==e?e:document}().appendChild(n)}))).catch((t=>n(t)))}a()}})).catch((t=>{throw Rw=null,t}))}(t),Rw}const xw=new Mv(5e3,15e3),Mw={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Lw=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Pw(t){const e=t.config;Cv(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Lv(e,"emulator/auth/iframe"):`https://${t.config.authDomain}/__/auth/iframe`,i={apiKey:e.apiKey,appName:t.name,v:ft},r=Lw.get(t.config.apiHost);r&&(i.eid=r);const s=t._getFrameworks();return s.length&&(i.fw=s.join(",")),`${n}?${v(i).slice(1)}`}const Uw={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Fw{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(t){}}}function Vw(t,e,n,i,r,s){Cv(t.config.authDomain,t,"auth-domain-config-required"),Cv(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:i,v:ft,eventId:r};if(e instanceof R_){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",function(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[t,e]of Object.entries(s||{}))o[t]=e}if(e instanceof O_){const t=e.getScopes().filter((t=>""!==t));t.length>0&&(o.scopes=t.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const t of Object.keys(a))void 0===a[t]&&delete a[t];return`${function({config:t}){return t.emulator?Lv(t,"emulator/auth/handler"):`https://${t.authDomain}/__/auth/handler`}(t)}?${v(a).slice(1)}`}const Bw="webStorageSupport",jw=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=G_,this._completeRedirectFn=Tw,this._overrideRedirectResult=bw}async _openPopup(t,e,n,i){var r;return Dv(null===(r=this.eventManagers[t._key()])||void 0===r?void 0:r.manager,"_initialize() not called before _openPopup()"),function(t,e,n,i=500,r=600){const o=Math.max((window.screen.availHeight-r)/2,0).toString(),a=Math.max((window.screen.availWidth-i)/2,0).toString();let c="";const u=Object.assign(Object.assign({},Uw),{width:i.toString(),height:r.toString(),top:o,left:a}),h=s().toLowerCase();n&&(c=u_(h)?"_blank":n),a_(h)&&(e=e||"http://localhost",u.scrollbars="yes");const l=Object.entries(u).reduce(((t,[e,n])=>`${t}${e}=${n},`),"");if(function(t=s()){var e;return p_(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(h)&&"_self"!==c)return function(t,e){const n=document.createElement("a");n.href=t,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(e||"",c),new Fw(null);const d=window.open(e||"",c,l);Cv(d,t,"popup-blocked");try{d.focus()}catch(t){}return new Fw(d)}(t,Vw(t,e,n,Ov(),i),Q_())}async _openRedirect(t,e,n,i){var r;return await this._originValidation(t),r=Vw(t,e,n,Ov(),i),Y_().location.href=r,new Promise((()=>{}))}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:t,promise:n}=this.eventManagers[e];return t?Promise.resolve(t):(Dv(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(t);return this.eventManagers[e]={promise:n},n.catch((()=>{delete this.eventManagers[e]})),n}async initAndGetManager(t){const e=await async function(t){const e=await Ow(t),n=Y_().gapi;return Cv(n,t,"internal-error"),e.open({where:document.body,url:Pw(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Mw,dontclear:!0},(e=>new Promise((async(n,i)=>{await e.restyle({setHideOnLeave:!1});const r=Ev(t,"network-request-failed"),s=Y_().setTimeout((()=>{i(r)}),xw.get());function o(){Y_().clearTimeout(s),n(e)}e.ping(o).then(o,(()=>{i(r)}))}))))}(t),n=new Iw(t);return e.register("authEvent",(e=>(Cv(null==e?void 0:e.authEvent,t,"invalid-auth-event"),{status:n.onEvent(e.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=e,n}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(Bw,{type:Bw},(n=>{var i;const r=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i.webStorageSupport;void 0!==r&&e(!!r),Iv(t,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=async function(t){if(t.config.emulator)return;const{authorizedDomains:e}=await async function(t,e={}){return Bv(t,"GET","/v1/projects",e)}(t);for(const t of e)try{if(Aw(t))return}catch(t){}Iv(t,"unauthorized-domain")}(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return m_()||c_()||p_()}};var qw="@firebase/auth",zw="0.20.11";class $w{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged((e=>{var n;t((null===(n=e)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)}));this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){Cv(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Hw=l("authIdTokenMaxAge")||300;let Kw=null;var Gw;Gw="Browser",ut(new S("auth",((t,{options:e})=>{const n=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),{apiKey:r,authDomain:s}=n.options;return((t,n)=>{Cv(r&&!r.includes(":"),"invalid-api-key",{appName:t.name}),Cv(!(null==s?void 0:s.includes(":")),"argument-error",{appName:t.name});const i={apiKey:r,authDomain:s,clientPlatform:Gw,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:g_(Gw)},o=new v_(t,n,i);return function(t,e){const n=(null==e?void 0:e.persistence)||[],i=(Array.isArray(n)?n:[n]).map(Rv);(null==e?void 0:e.errorMap)&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,null==e?void 0:e.popupRedirectResolver)}(o,e),o})(n,i)}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((t,e,n)=>{t.getProvider("auth-internal").initialize()}))),ut(new S("auth-internal",(t=>(t=>new $w(t))(__(t.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),gt(qw,zw,void 0),gt(qw,zw,"esm2017");var Ww=function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};const Qw=function(t=mt()){const e=ht(t,"auth");if(e.isInitialized())return e.getImmediate();const n=function(t,e){const n=ht(t,"auth");if(n.isInitialized()){const t=n.getImmediate();if(g(n.getOptions(),null!=e?e:{}))return t;Iv(t,"already-initialized")}return n.initialize({options:e})}(t,{popupRedirectResolver:jw,persistence:[cw,H_,G_]}),i=l("authTokenSyncURL");if(i){const t=(r=i,async t=>{const e=t&&await t.getIdTokenResult(),n=e&&((new Date).getTime()-Date.parse(e.issuedAtTime))/1e3;if(n&&n>Hw)return;const i=null==e?void 0:e.token;Kw!==i&&(Kw=i,await fetch(r,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});!function(t,e,n){E(t).beforeAuthStateChanged(e,n)}(n,t,(()=>t(n.currentUser))),function(e,n,i,r){E(e).onIdTokenChanged((e=>t(e)),void 0,void 0)}(n)}var r;const s=h("auth");return s&&function(t,e,n){const i=__(t);Cv(i._canInitEmulator,i,"emulator-config-failed"),Cv(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!!(null==n?void 0:n.disableWarnings),s=b_(e),{host:o,port:a}=function(t){const e=b_(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const t=r[1];return{host:t,port:T_(i.substr(t.length+1))}}{const[t,e]=i.split(":");return{host:t,port:T_(e)}}}(e),c=null===a?"":`:${a}`;i.config.emulator={url:`${s}//${o}${c}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||function(){function t(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",t):t())}()}(n,`http://${s}`),n}();Qw.onAuthStateChanged((t=>{t?(sessionStorage.setItem("userId",t.uid),hn(Be)):(sessionStorage.removeItem("userId"),hn(Ve))}));const Xw=()=>Ww(void 0,void 0,void 0,(function*(){const t=new M_;yield async function(t,e,n){const i=__(t);!function(t,e,n){if(!(e instanceof n))throw n.name!==e.constructor.name&&Iv(t,"argument-error"),Sv(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}(t,e,R_);const r=lw(i,void 0);return new vw(i,"signInViaPopup",e,r).executeNotNull()}(Qw,t)})),Yw=t=>Ww(void 0,void 0,void 0,(function*(){t.preventDefault();let e=$e.username.value,n=$e.email.value,i=$e.password.value;if(ln(e)||(Ke.innerHTML="please fill in a username"),dn(n)||(Ge.innerHTML="please fill in your email"),fn(i)||(We.innerHTML="password can't be empty"),ln(e)&&dn(n)&&fn(i))try{let t=yield async function(t,e,n){const i=__(t),r=await async function(t,e){return qv(t,"POST","/v1/accounts:signUp",Vv(t,e))}(i,{returnSecureToken:!0,email:e,password:n}),s=await U_._fromIdTokenResponse(i,"signIn",r);return await i._updateCurrentUser(s.user),s}(Qw,n,i);t&&($e.reset(),hn(Ve))}catch(t){He.innerHTML="An account with this email already exists"}})),Jw=t=>Ww(void 0,void 0,void 0,(function*(){t.preventDefault();let e=Xe.email.value,n=Xe.password.value;if(dn(e)||(Je.innerHTML="email can't be empty"),fn(n)||(Ze.innerHTML="password can't be empty"),dn(e)&&fn(n))try{let t=yield function(t,e,n){return async function(t,e){return j_(__(t),e)}(E(t),N_.credential(e,n))}(Qw,e,n);console.log(t),t&&(Xe.reset(),hn(Be))}catch(t){Ye.innerHTML="Wrong email password combination"}}));$e.addEventListener("submit",(t=>{Yw(t)})),Xe.addEventListener("submit",(t=>{Jw(t)})),Re.addEventListener("click",(()=>{Qw.signOut()})),Qe.addEventListener("click",(()=>{hn(Ve)})),tn.addEventListener("click",(()=>{hn(Fe)})),Le.addEventListener("click",(()=>{console.log("google auth popup"),Xw()})),Pe.addEventListener("click",(()=>{console.log("github auth popup")})),Ue.addEventListener("click",(()=>{console.log("facebook auth popup")})),Oe.addEventListener("click",(()=>{hn(qe)})),en.addEventListener("submit",(t=>{(t=>{!function(t,e,n,i){new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))}(void 0,void 0,void 0,(function*(){t.preventDefault();let e=en.groupname.value,n=en.description.value,i=en.theme.value;pn(e)||(nn.innerHTML="please fill in a name"),pn(i)||(rn.innerHTML="please choose a theme");let r={name:e,activeUsers:0,adminUser:sessionStorage.getItem("userId"),description:n,theme:i,lastMessage:"No messages send yet",timeOfLastMessage:""};pn(e)&&pn(i)&&(en.reset(),(t=>{Tf(void 0,void 0,void 0,(function*(){yield yf(Ef,t)}))})(r),hn(Be))}))})(t)})),sn.addEventListener("submit",(t=>{(t=>{!function(t,e,n,i){new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))}(void 0,void 0,void 0,(function*(){t.preventDefault();let e=sn.message.value,n={chatroomId:sessionStorage.getItem("currentChatroomId"),message:e,timestamp:$o.now(),user:sessionStorage.getItem("userId")};pn(e)&&(sn.reset(),(t=>{Tf(void 0,void 0,void 0,(function*(){yield yf(Sf,t)}))})(n))}))})(t)})),xe.forEach((t=>{t.addEventListener("click",(()=>{hn(Be)}))})),Me.forEach((t=>{t.addEventListener("click",(t=>{(t=>{const e=t.target,n=e.parentElement.children[0];"password"==n.getAttribute("type")?(n.setAttribute("type","text"),e.src="./images/icons/eye-open.svg"):(n.setAttribute("type","password"),e.src="./images/icons/eye-closed.svg")})(t)}))})),window.addEventListener("load",(()=>{Tf(void 0,void 0,void 0,(function*(){vf(Ef,(t=>{on.innerHTML="",t.forEach((t=>{((t,e)=>{let n=document.createElement("li");n.classList.add("chatrooms__chat"),n.innerHTML=`\n        <span class="chatrooms__chatroom-id">${t}</span>\n        <div class="chatrooms__chat-icon">\n            <div class="chatrooms__icon-placeholder"></div>\n        </div>\n        <div class="chatrooms__chat-info">\n            <h4 class="primary-font text-inverted">${e.name}</h4>\n            <p class="extra-subtle bold text-xs">${e.lastMessage}</p>\n        </div>\n        <div class="chatrooms__chat-status">\n            <p class="extra-subtle bold text-xs">${e.timeOfLastMessage}</p>\n            <img src="./images/icons/check.svg" alt="status icon" />\n        </div>\n    `,null==n||n.addEventListener("click",(t=>{let e=t.target;Af(e.innerText),kf(e.innerText),sessionStorage.setItem("currentChatroomId",e.innerText),hn(je)})),null==on||on.appendChild(n)})(t.id,t.data())}))}))}))}))})();
//# sourceMappingURL=bundle.js.map